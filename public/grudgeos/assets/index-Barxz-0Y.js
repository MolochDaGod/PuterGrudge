var rx=o=>{throw TypeError(o)};var Rp=(o,e,s)=>e.has(o)||rx("Cannot "+s);var Mn=(o,e,s)=>(Rp(o,e,"read from private field"),s?s.call(o):e.get(o)),Nr=(o,e,s)=>e.has(o)?rx("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(o):e.set(o,s),_r=(o,e,s,a)=>(Rp(o,e,"write to private field"),a?a.call(o,s):e.set(o,s),s),ts=(o,e,s)=>(Rp(o,e,"access private method"),s);var bu=(o,e,s,a)=>({set _(c){_r(o,e,c,s)},get _(){return Mn(o,e,a)}});(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))a(c);new MutationObserver(c=>{for(const d of c)if(d.type==="childList")for(const b of d.addedNodes)b.tagName==="LINK"&&b.rel==="modulepreload"&&a(b)}).observe(document,{childList:!0,subtree:!0});function s(c){const d={};return c.integrity&&(d.integrity=c.integrity),c.referrerPolicy&&(d.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?d.credentials="include":c.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function a(c){if(c.ep)return;c.ep=!0;const d=s(c);fetch(c.href,d)}})();function getDefaultExportFromCjs(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}var jsxRuntime={exports:{}},reactJsxRuntime_production_min={},react={exports:{}},react_production_min={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l$2=Symbol.for("react.element"),n$1=Symbol.for("react.portal"),p$2=Symbol.for("react.fragment"),q$1=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),t=Symbol.for("react.provider"),u=Symbol.for("react.context"),v$2=Symbol.for("react.forward_ref"),w=Symbol.for("react.suspense"),x$1=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),z$1=Symbol.iterator;function A$1(o){return o===null||typeof o!="object"?null:(o=z$1&&o[z$1]||o["@@iterator"],typeof o=="function"?o:null)}var B$1={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C$1=Object.assign,D$3={};function E$2(o,e,s){this.props=o,this.context=e,this.refs=D$3,this.updater=s||B$1}E$2.prototype.isReactComponent={};E$2.prototype.setState=function(o,e){if(typeof o!="object"&&typeof o!="function"&&o!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,o,e,"setState")};E$2.prototype.forceUpdate=function(o){this.updater.enqueueForceUpdate(this,o,"forceUpdate")};function F(){}F.prototype=E$2.prototype;function G$1(o,e,s){this.props=o,this.context=e,this.refs=D$3,this.updater=s||B$1}var H$2=G$1.prototype=new F;H$2.constructor=G$1;C$1(H$2,E$2.prototype);H$2.isPureReactComponent=!0;var I$1=Array.isArray,J=Object.prototype.hasOwnProperty,K$1={current:null},L$1={key:!0,ref:!0,__self:!0,__source:!0};function M$1(o,e,s){var a,c={},d=null,b=null;if(e!=null)for(a in e.ref!==void 0&&(b=e.ref),e.key!==void 0&&(d=""+e.key),e)J.call(e,a)&&!L$1.hasOwnProperty(a)&&(c[a]=e[a]);var _e=arguments.length-2;if(_e===1)c.children=s;else if(1<_e){for(var tt=Array(_e),nt=0;nt<_e;nt++)tt[nt]=arguments[nt+2];c.children=tt}if(o&&o.defaultProps)for(a in _e=o.defaultProps,_e)c[a]===void 0&&(c[a]=_e[a]);return{$$typeof:l$2,type:o,key:d,ref:b,props:c,_owner:K$1.current}}function N$1(o,e){return{$$typeof:l$2,type:o.type,key:e,ref:o.ref,props:o.props,_owner:o._owner}}function O$1(o){return typeof o=="object"&&o!==null&&o.$$typeof===l$2}function escape$1(o){var e={"=":"=0",":":"=2"};return"$"+o.replace(/[=:]/g,function(s){return e[s]})}var P$1=/\/+/g;function Q$1(o,e){return typeof o=="object"&&o!==null&&o.key!=null?escape$1(""+o.key):e.toString(36)}function R$1(o,e,s,a,c){var d=typeof o;(d==="undefined"||d==="boolean")&&(o=null);var b=!1;if(o===null)b=!0;else switch(d){case"string":case"number":b=!0;break;case"object":switch(o.$$typeof){case l$2:case n$1:b=!0}}if(b)return b=o,c=c(b),o=a===""?"."+Q$1(b,0):a,I$1(c)?(s="",o!=null&&(s=o.replace(P$1,"$&/")+"/"),R$1(c,e,s,"",function(nt){return nt})):c!=null&&(O$1(c)&&(c=N$1(c,s+(!c.key||b&&b.key===c.key?"":(""+c.key).replace(P$1,"$&/")+"/")+o)),e.push(c)),1;if(b=0,a=a===""?".":a+":",I$1(o))for(var _e=0;_e<o.length;_e++){d=o[_e];var tt=a+Q$1(d,_e);b+=R$1(d,e,s,tt,c)}else if(tt=A$1(o),typeof tt=="function")for(o=tt.call(o),_e=0;!(d=o.next()).done;)d=d.value,tt=a+Q$1(d,_e++),b+=R$1(d,e,s,tt,c);else if(d==="object")throw e=String(o),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return b}function S$1(o,e,s){if(o==null)return o;var a=[],c=0;return R$1(o,a,"","",function(d){return e.call(s,d,c++)}),a}function T$1(o){if(o._status===-1){var e=o._result;e=e(),e.then(function(s){(o._status===0||o._status===-1)&&(o._status=1,o._result=s)},function(s){(o._status===0||o._status===-1)&&(o._status=2,o._result=s)}),o._status===-1&&(o._status=0,o._result=e)}if(o._status===1)return o._result.default;throw o._result}var U$1={current:null},V$1={transition:null},W$2={ReactCurrentDispatcher:U$1,ReactCurrentBatchConfig:V$1,ReactCurrentOwner:K$1};function X$2(){throw Error("act(...) is not supported in production builds of React.")}react_production_min.Children={map:S$1,forEach:function(o,e,s){S$1(o,function(){e.apply(this,arguments)},s)},count:function(o){var e=0;return S$1(o,function(){e++}),e},toArray:function(o){return S$1(o,function(e){return e})||[]},only:function(o){if(!O$1(o))throw Error("React.Children.only expected to receive a single React element child.");return o}};react_production_min.Component=E$2;react_production_min.Fragment=p$2;react_production_min.Profiler=r;react_production_min.PureComponent=G$1;react_production_min.StrictMode=q$1;react_production_min.Suspense=w;react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W$2;react_production_min.act=X$2;react_production_min.cloneElement=function(o,e,s){if(o==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+o+".");var a=C$1({},o.props),c=o.key,d=o.ref,b=o._owner;if(e!=null){if(e.ref!==void 0&&(d=e.ref,b=K$1.current),e.key!==void 0&&(c=""+e.key),o.type&&o.type.defaultProps)var _e=o.type.defaultProps;for(tt in e)J.call(e,tt)&&!L$1.hasOwnProperty(tt)&&(a[tt]=e[tt]===void 0&&_e!==void 0?_e[tt]:e[tt])}var tt=arguments.length-2;if(tt===1)a.children=s;else if(1<tt){_e=Array(tt);for(var nt=0;nt<tt;nt++)_e[nt]=arguments[nt+2];a.children=_e}return{$$typeof:l$2,type:o.type,key:c,ref:d,props:a,_owner:b}};react_production_min.createContext=function(o){return o={$$typeof:u,_currentValue:o,_currentValue2:o,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},o.Provider={$$typeof:t,_context:o},o.Consumer=o};react_production_min.createElement=M$1;react_production_min.createFactory=function(o){var e=M$1.bind(null,o);return e.type=o,e};react_production_min.createRef=function(){return{current:null}};react_production_min.forwardRef=function(o){return{$$typeof:v$2,render:o}};react_production_min.isValidElement=O$1;react_production_min.lazy=function(o){return{$$typeof:y,_payload:{_status:-1,_result:o},_init:T$1}};react_production_min.memo=function(o,e){return{$$typeof:x$1,type:o,compare:e===void 0?null:e}};react_production_min.startTransition=function(o){var e=V$1.transition;V$1.transition={};try{o()}finally{V$1.transition=e}};react_production_min.unstable_act=X$2;react_production_min.useCallback=function(o,e){return U$1.current.useCallback(o,e)};react_production_min.useContext=function(o){return U$1.current.useContext(o)};react_production_min.useDebugValue=function(){};react_production_min.useDeferredValue=function(o){return U$1.current.useDeferredValue(o)};react_production_min.useEffect=function(o,e){return U$1.current.useEffect(o,e)};react_production_min.useId=function(){return U$1.current.useId()};react_production_min.useImperativeHandle=function(o,e,s){return U$1.current.useImperativeHandle(o,e,s)};react_production_min.useInsertionEffect=function(o,e){return U$1.current.useInsertionEffect(o,e)};react_production_min.useLayoutEffect=function(o,e){return U$1.current.useLayoutEffect(o,e)};react_production_min.useMemo=function(o,e){return U$1.current.useMemo(o,e)};react_production_min.useReducer=function(o,e,s){return U$1.current.useReducer(o,e,s)};react_production_min.useRef=function(o){return U$1.current.useRef(o)};react_production_min.useState=function(o){return U$1.current.useState(o)};react_production_min.useSyncExternalStore=function(o,e,s){return U$1.current.useSyncExternalStore(o,e,s)};react_production_min.useTransition=function(){return U$1.current.useTransition()};react_production_min.version="18.3.1";react.exports=react_production_min;var reactExports=react.exports;const React=getDefaultExportFromCjs(reactExports);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f=reactExports,k$2=Symbol.for("react.element"),l$1=Symbol.for("react.fragment"),m$1=Object.prototype.hasOwnProperty,n=f.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p$1={key:!0,ref:!0,__self:!0,__source:!0};function q(o,e,s){var a,c={},d=null,b=null;s!==void 0&&(d=""+s),e.key!==void 0&&(d=""+e.key),e.ref!==void 0&&(b=e.ref);for(a in e)m$1.call(e,a)&&!p$1.hasOwnProperty(a)&&(c[a]=e[a]);if(o&&o.defaultProps)for(a in e=o.defaultProps,e)c[a]===void 0&&(c[a]=e[a]);return{$$typeof:k$2,type:o,key:d,ref:b,props:c,_owner:n.current}}reactJsxRuntime_production_min.Fragment=l$1;reactJsxRuntime_production_min.jsx=q;reactJsxRuntime_production_min.jsxs=q;jsxRuntime.exports=reactJsxRuntime_production_min;var jsxRuntimeExports=jsxRuntime.exports,reactDom={exports:{}},reactDom_production_min={},scheduler$2={exports:{}},scheduler_production_min$2={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(o){function e(Ct,Ut){var Gt=Ct.length;Ct.push(Ut);e:for(;0<Gt;){var Pt=Gt-1>>>1,Wt=Ct[Pt];if(0<c(Wt,Ut))Ct[Pt]=Ut,Ct[Gt]=Wt,Gt=Pt;else break e}}function s(Ct){return Ct.length===0?null:Ct[0]}function a(Ct){if(Ct.length===0)return null;var Ut=Ct[0],Gt=Ct.pop();if(Gt!==Ut){Ct[0]=Gt;e:for(var Pt=0,Wt=Ct.length,sn=Wt>>>1;Pt<sn;){var Bt=2*(Pt+1)-1,tn=Ct[Bt],cn=Bt+1,vn=Ct[cn];if(0>c(tn,Gt))cn<Wt&&0>c(vn,tn)?(Ct[Pt]=vn,Ct[cn]=Gt,Pt=cn):(Ct[Pt]=tn,Ct[Bt]=Gt,Pt=Bt);else if(cn<Wt&&0>c(vn,Gt))Ct[Pt]=vn,Ct[cn]=Gt,Pt=cn;else break e}}return Ut}function c(Ct,Ut){var Gt=Ct.sortIndex-Ut.sortIndex;return Gt!==0?Gt:Ct.id-Ut.id}if(typeof performance=="object"&&typeof performance.now=="function"){var d=performance;o.unstable_now=function(){return d.now()}}else{var b=Date,_e=b.now();o.unstable_now=function(){return b.now()-_e}}var tt=[],nt=[],it=1,ot=null,at=3,ct=!1,ut=!1,ft=!1,dt=typeof setTimeout=="function"?setTimeout:null,lt=typeof clearTimeout=="function"?clearTimeout:null,ht=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function mt(Ct){for(var Ut=s(nt);Ut!==null;){if(Ut.callback===null)a(nt);else if(Ut.startTime<=Ct)a(nt),Ut.sortIndex=Ut.expirationTime,e(tt,Ut);else break;Ut=s(nt)}}function xt(Ct){if(ft=!1,mt(Ct),!ut)if(s(tt)!==null)ut=!0,Ot(St);else{var Ut=s(nt);Ut!==null&&Ht(xt,Ut.startTime-Ct)}}function St(Ct,Ut){ut=!1,ft&&(ft=!1,lt(Et),Et=-1),ct=!0;var Gt=at;try{for(mt(Ut),ot=s(tt);ot!==null&&(!(ot.expirationTime>Ut)||Ct&&!Mt());){var Pt=ot.callback;if(typeof Pt=="function"){ot.callback=null,at=ot.priorityLevel;var Wt=Pt(ot.expirationTime<=Ut);Ut=o.unstable_now(),typeof Wt=="function"?ot.callback=Wt:ot===s(tt)&&a(tt),mt(Ut)}else a(tt);ot=s(tt)}if(ot!==null)var sn=!0;else{var Bt=s(nt);Bt!==null&&Ht(xt,Bt.startTime-Ut),sn=!1}return sn}finally{ot=null,at=Gt,ct=!1}}var yt=!1,wt=null,Et=-1,_t=5,vt=-1;function Mt(){return!(o.unstable_now()-vt<_t)}function jt(){if(wt!==null){var Ct=o.unstable_now();vt=Ct;var Ut=!0;try{Ut=wt(!0,Ct)}finally{Ut?Lt():(yt=!1,wt=null)}}else yt=!1}var Lt;if(typeof ht=="function")Lt=function(){ht(jt)};else if(typeof MessageChannel<"u"){var Nt=new MessageChannel,kt=Nt.port2;Nt.port1.onmessage=jt,Lt=function(){kt.postMessage(null)}}else Lt=function(){dt(jt,0)};function Ot(Ct){wt=Ct,yt||(yt=!0,Lt())}function Ht(Ct,Ut){Et=dt(function(){Ct(o.unstable_now())},Ut)}o.unstable_IdlePriority=5,o.unstable_ImmediatePriority=1,o.unstable_LowPriority=4,o.unstable_NormalPriority=3,o.unstable_Profiling=null,o.unstable_UserBlockingPriority=2,o.unstable_cancelCallback=function(Ct){Ct.callback=null},o.unstable_continueExecution=function(){ut||ct||(ut=!0,Ot(St))},o.unstable_forceFrameRate=function(Ct){0>Ct||125<Ct?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_t=0<Ct?Math.floor(1e3/Ct):5},o.unstable_getCurrentPriorityLevel=function(){return at},o.unstable_getFirstCallbackNode=function(){return s(tt)},o.unstable_next=function(Ct){switch(at){case 1:case 2:case 3:var Ut=3;break;default:Ut=at}var Gt=at;at=Ut;try{return Ct()}finally{at=Gt}},o.unstable_pauseExecution=function(){},o.unstable_requestPaint=function(){},o.unstable_runWithPriority=function(Ct,Ut){switch(Ct){case 1:case 2:case 3:case 4:case 5:break;default:Ct=3}var Gt=at;at=Ct;try{return Ut()}finally{at=Gt}},o.unstable_scheduleCallback=function(Ct,Ut,Gt){var Pt=o.unstable_now();switch(typeof Gt=="object"&&Gt!==null?(Gt=Gt.delay,Gt=typeof Gt=="number"&&0<Gt?Pt+Gt:Pt):Gt=Pt,Ct){case 1:var Wt=-1;break;case 2:Wt=250;break;case 5:Wt=1073741823;break;case 4:Wt=1e4;break;default:Wt=5e3}return Wt=Gt+Wt,Ct={id:it++,callback:Ut,priorityLevel:Ct,startTime:Gt,expirationTime:Wt,sortIndex:-1},Gt>Pt?(Ct.sortIndex=Gt,e(nt,Ct),s(tt)===null&&Ct===s(nt)&&(ft?(lt(Et),Et=-1):ft=!0,Ht(xt,Gt-Pt))):(Ct.sortIndex=Wt,e(tt,Ct),ut||ct||(ut=!0,Ot(St))),Ct},o.unstable_shouldYield=Mt,o.unstable_wrapCallback=function(Ct){var Ut=at;return function(){var Gt=at;at=Ut;try{return Ct.apply(this,arguments)}finally{at=Gt}}}})(scheduler_production_min$2);scheduler$2.exports=scheduler_production_min$2;var schedulerExports$1=scheduler$2.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aa=reactExports,ca=schedulerExports$1;function p(o){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+o,s=1;s<arguments.length;s++)e+="&args[]="+encodeURIComponent(arguments[s]);return"Minified React error #"+o+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var da=new Set,ea={};function fa(o,e){ha(o,e),ha(o+"Capture",e)}function ha(o,e){for(ea[o]=e,o=0;o<e.length;o++)da.add(e[o])}var ia=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ja=Object.prototype.hasOwnProperty,ka=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,la={},ma={};function oa(o){return ja.call(ma,o)?!0:ja.call(la,o)?!1:ka.test(o)?ma[o]=!0:(la[o]=!0,!1)}function pa(o,e,s,a){if(s!==null&&s.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return a?!1:s!==null?!s.acceptsBooleans:(o=o.toLowerCase().slice(0,5),o!=="data-"&&o!=="aria-");default:return!1}}function qa(o,e,s,a){if(e===null||typeof e>"u"||pa(o,e,s,a))return!0;if(a)return!1;if(s!==null)switch(s.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function v$1(o,e,s,a,c,d,b){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=a,this.attributeNamespace=c,this.mustUseProperty=s,this.propertyName=o,this.type=e,this.sanitizeURL=d,this.removeEmptyString=b}var z={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(o){z[o]=new v$1(o,0,!1,o,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(o){var e=o[0];z[e]=new v$1(e,1,!1,o[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(o){z[o]=new v$1(o,2,!1,o.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(o){z[o]=new v$1(o,2,!1,o,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(o){z[o]=new v$1(o,3,!1,o.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(o){z[o]=new v$1(o,3,!0,o,null,!1,!1)});["capture","download"].forEach(function(o){z[o]=new v$1(o,4,!1,o,null,!1,!1)});["cols","rows","size","span"].forEach(function(o){z[o]=new v$1(o,6,!1,o,null,!1,!1)});["rowSpan","start"].forEach(function(o){z[o]=new v$1(o,5,!1,o.toLowerCase(),null,!1,!1)});var ra=/[\-:]([a-z])/g;function sa(o){return o[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(o){var e=o.replace(ra,sa);z[e]=new v$1(e,1,!1,o,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(o){var e=o.replace(ra,sa);z[e]=new v$1(e,1,!1,o,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(o){var e=o.replace(ra,sa);z[e]=new v$1(e,1,!1,o,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(o){z[o]=new v$1(o,1,!1,o.toLowerCase(),null,!1,!1)});z.xlinkHref=new v$1("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(o){z[o]=new v$1(o,1,!1,o.toLowerCase(),null,!0,!0)});function ta(o,e,s,a){var c=z.hasOwnProperty(e)?z[e]:null;(c!==null?c.type!==0:a||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(qa(e,s,c,a)&&(s=null),a||c===null?oa(e)&&(s===null?o.removeAttribute(e):o.setAttribute(e,""+s)):c.mustUseProperty?o[c.propertyName]=s===null?c.type===3?!1:"":s:(e=c.attributeName,a=c.attributeNamespace,s===null?o.removeAttribute(e):(c=c.type,s=c===3||c===4&&s===!0?"":""+s,a?o.setAttributeNS(a,e,s):o.setAttribute(e,s))))}var ua=aa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,va=Symbol.for("react.element"),wa=Symbol.for("react.portal"),ya=Symbol.for("react.fragment"),za=Symbol.for("react.strict_mode"),Aa=Symbol.for("react.profiler"),Ba=Symbol.for("react.provider"),Ca=Symbol.for("react.context"),Da=Symbol.for("react.forward_ref"),Ea=Symbol.for("react.suspense"),Fa=Symbol.for("react.suspense_list"),Ga=Symbol.for("react.memo"),Ha=Symbol.for("react.lazy"),Ia=Symbol.for("react.offscreen"),Ja=Symbol.iterator;function Ka(o){return o===null||typeof o!="object"?null:(o=Ja&&o[Ja]||o["@@iterator"],typeof o=="function"?o:null)}var A=Object.assign,La;function Ma(o){if(La===void 0)try{throw Error()}catch(s){var e=s.stack.trim().match(/\n( *(at )?)/);La=e&&e[1]||""}return`
`+La+o}var Na=!1;function Oa(o,e){if(!o||Na)return"";Na=!0;var s=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(nt){var a=nt}Reflect.construct(o,[],e)}else{try{e.call()}catch(nt){a=nt}o.call(e.prototype)}else{try{throw Error()}catch(nt){a=nt}o()}}catch(nt){if(nt&&a&&typeof nt.stack=="string"){for(var c=nt.stack.split(`
`),d=a.stack.split(`
`),b=c.length-1,_e=d.length-1;1<=b&&0<=_e&&c[b]!==d[_e];)_e--;for(;1<=b&&0<=_e;b--,_e--)if(c[b]!==d[_e]){if(b!==1||_e!==1)do if(b--,_e--,0>_e||c[b]!==d[_e]){var tt=`
`+c[b].replace(" at new "," at ");return o.displayName&&tt.includes("<anonymous>")&&(tt=tt.replace("<anonymous>",o.displayName)),tt}while(1<=b&&0<=_e);break}}}finally{Na=!1,Error.prepareStackTrace=s}return(o=o?o.displayName||o.name:"")?Ma(o):""}function Pa(o){switch(o.tag){case 5:return Ma(o.type);case 16:return Ma("Lazy");case 13:return Ma("Suspense");case 19:return Ma("SuspenseList");case 0:case 2:case 15:return o=Oa(o.type,!1),o;case 11:return o=Oa(o.type.render,!1),o;case 1:return o=Oa(o.type,!0),o;default:return""}}function Qa(o){if(o==null)return null;if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o;switch(o){case ya:return"Fragment";case wa:return"Portal";case Aa:return"Profiler";case za:return"StrictMode";case Ea:return"Suspense";case Fa:return"SuspenseList"}if(typeof o=="object")switch(o.$$typeof){case Ca:return(o.displayName||"Context")+".Consumer";case Ba:return(o._context.displayName||"Context")+".Provider";case Da:var e=o.render;return o=o.displayName,o||(o=e.displayName||e.name||"",o=o!==""?"ForwardRef("+o+")":"ForwardRef"),o;case Ga:return e=o.displayName||null,e!==null?e:Qa(o.type)||"Memo";case Ha:e=o._payload,o=o._init;try{return Qa(o(e))}catch{}}return null}function Ra(o){var e=o.type;switch(o.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return o=e.render,o=o.displayName||o.name||"",e.displayName||(o!==""?"ForwardRef("+o+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Qa(e);case 8:return e===za?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Sa(o){switch(typeof o){case"boolean":case"number":case"string":case"undefined":return o;case"object":return o;default:return""}}function Ta(o){var e=o.type;return(o=o.nodeName)&&o.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Ua(o){var e=Ta(o)?"checked":"value",s=Object.getOwnPropertyDescriptor(o.constructor.prototype,e),a=""+o[e];if(!o.hasOwnProperty(e)&&typeof s<"u"&&typeof s.get=="function"&&typeof s.set=="function"){var c=s.get,d=s.set;return Object.defineProperty(o,e,{configurable:!0,get:function(){return c.call(this)},set:function(b){a=""+b,d.call(this,b)}}),Object.defineProperty(o,e,{enumerable:s.enumerable}),{getValue:function(){return a},setValue:function(b){a=""+b},stopTracking:function(){o._valueTracker=null,delete o[e]}}}}function Va(o){o._valueTracker||(o._valueTracker=Ua(o))}function Wa(o){if(!o)return!1;var e=o._valueTracker;if(!e)return!0;var s=e.getValue(),a="";return o&&(a=Ta(o)?o.checked?"true":"false":o.value),o=a,o!==s?(e.setValue(o),!0):!1}function Xa(o){if(o=o||(typeof document<"u"?document:void 0),typeof o>"u")return null;try{return o.activeElement||o.body}catch{return o.body}}function Ya(o,e){var s=e.checked;return A({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:s??o._wrapperState.initialChecked})}function Za(o,e){var s=e.defaultValue==null?"":e.defaultValue,a=e.checked!=null?e.checked:e.defaultChecked;s=Sa(e.value!=null?e.value:s),o._wrapperState={initialChecked:a,initialValue:s,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function ab(o,e){e=e.checked,e!=null&&ta(o,"checked",e,!1)}function bb(o,e){ab(o,e);var s=Sa(e.value),a=e.type;if(s!=null)a==="number"?(s===0&&o.value===""||o.value!=s)&&(o.value=""+s):o.value!==""+s&&(o.value=""+s);else if(a==="submit"||a==="reset"){o.removeAttribute("value");return}e.hasOwnProperty("value")?cb(o,e.type,s):e.hasOwnProperty("defaultValue")&&cb(o,e.type,Sa(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(o.defaultChecked=!!e.defaultChecked)}function db(o,e,s){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var a=e.type;if(!(a!=="submit"&&a!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+o._wrapperState.initialValue,s||e===o.value||(o.value=e),o.defaultValue=e}s=o.name,s!==""&&(o.name=""),o.defaultChecked=!!o._wrapperState.initialChecked,s!==""&&(o.name=s)}function cb(o,e,s){(e!=="number"||Xa(o.ownerDocument)!==o)&&(s==null?o.defaultValue=""+o._wrapperState.initialValue:o.defaultValue!==""+s&&(o.defaultValue=""+s))}var eb=Array.isArray;function fb(o,e,s,a){if(o=o.options,e){e={};for(var c=0;c<s.length;c++)e["$"+s[c]]=!0;for(s=0;s<o.length;s++)c=e.hasOwnProperty("$"+o[s].value),o[s].selected!==c&&(o[s].selected=c),c&&a&&(o[s].defaultSelected=!0)}else{for(s=""+Sa(s),e=null,c=0;c<o.length;c++){if(o[c].value===s){o[c].selected=!0,a&&(o[c].defaultSelected=!0);return}e!==null||o[c].disabled||(e=o[c])}e!==null&&(e.selected=!0)}}function gb(o,e){if(e.dangerouslySetInnerHTML!=null)throw Error(p(91));return A({},e,{value:void 0,defaultValue:void 0,children:""+o._wrapperState.initialValue})}function hb(o,e){var s=e.value;if(s==null){if(s=e.children,e=e.defaultValue,s!=null){if(e!=null)throw Error(p(92));if(eb(s)){if(1<s.length)throw Error(p(93));s=s[0]}e=s}e==null&&(e=""),s=e}o._wrapperState={initialValue:Sa(s)}}function ib(o,e){var s=Sa(e.value),a=Sa(e.defaultValue);s!=null&&(s=""+s,s!==o.value&&(o.value=s),e.defaultValue==null&&o.defaultValue!==s&&(o.defaultValue=s)),a!=null&&(o.defaultValue=""+a)}function jb(o){var e=o.textContent;e===o._wrapperState.initialValue&&e!==""&&e!==null&&(o.value=e)}function kb(o){switch(o){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lb(o,e){return o==null||o==="http://www.w3.org/1999/xhtml"?kb(e):o==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":o}var mb,nb=function(o){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,s,a,c){MSApp.execUnsafeLocalFunction(function(){return o(e,s,a,c)})}:o}(function(o,e){if(o.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in o)o.innerHTML=e;else{for(mb=mb||document.createElement("div"),mb.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=mb.firstChild;o.firstChild;)o.removeChild(o.firstChild);for(;e.firstChild;)o.appendChild(e.firstChild)}});function ob(o,e){if(e){var s=o.firstChild;if(s&&s===o.lastChild&&s.nodeType===3){s.nodeValue=e;return}}o.textContent=e}var pb={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qb=["Webkit","ms","Moz","O"];Object.keys(pb).forEach(function(o){qb.forEach(function(e){e=e+o.charAt(0).toUpperCase()+o.substring(1),pb[e]=pb[o]})});function rb(o,e,s){return e==null||typeof e=="boolean"||e===""?"":s||typeof e!="number"||e===0||pb.hasOwnProperty(o)&&pb[o]?(""+e).trim():e+"px"}function sb(o,e){o=o.style;for(var s in e)if(e.hasOwnProperty(s)){var a=s.indexOf("--")===0,c=rb(s,e[s],a);s==="float"&&(s="cssFloat"),a?o.setProperty(s,c):o[s]=c}}var tb=A({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ub(o,e){if(e){if(tb[o]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(p(137,o));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(p(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(p(61))}if(e.style!=null&&typeof e.style!="object")throw Error(p(62))}}function vb(o,e){if(o.indexOf("-")===-1)return typeof e.is=="string";switch(o){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wb=null;function xb(o){return o=o.target||o.srcElement||window,o.correspondingUseElement&&(o=o.correspondingUseElement),o.nodeType===3?o.parentNode:o}var yb=null,zb=null,Ab=null;function Bb(o){if(o=Cb(o)){if(typeof yb!="function")throw Error(p(280));var e=o.stateNode;e&&(e=Db(e),yb(o.stateNode,o.type,e))}}function Eb(o){zb?Ab?Ab.push(o):Ab=[o]:zb=o}function Fb(){if(zb){var o=zb,e=Ab;if(Ab=zb=null,Bb(o),e)for(o=0;o<e.length;o++)Bb(e[o])}}function Gb(o,e){return o(e)}function Hb(){}var Ib=!1;function Jb(o,e,s){if(Ib)return o(e,s);Ib=!0;try{return Gb(o,e,s)}finally{Ib=!1,(zb!==null||Ab!==null)&&(Hb(),Fb())}}function Kb(o,e){var s=o.stateNode;if(s===null)return null;var a=Db(s);if(a===null)return null;s=a[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(a=!a.disabled)||(o=o.type,a=!(o==="button"||o==="input"||o==="select"||o==="textarea")),o=!a;break e;default:o=!1}if(o)return null;if(s&&typeof s!="function")throw Error(p(231,e,typeof s));return s}var Lb=!1;if(ia)try{var Mb={};Object.defineProperty(Mb,"passive",{get:function(){Lb=!0}}),window.addEventListener("test",Mb,Mb),window.removeEventListener("test",Mb,Mb)}catch{Lb=!1}function Nb(o,e,s,a,c,d,b,_e,tt){var nt=Array.prototype.slice.call(arguments,3);try{e.apply(s,nt)}catch(it){this.onError(it)}}var Ob=!1,Pb=null,Qb=!1,Rb=null,Sb={onError:function(o){Ob=!0,Pb=o}};function Tb(o,e,s,a,c,d,b,_e,tt){Ob=!1,Pb=null,Nb.apply(Sb,arguments)}function Ub(o,e,s,a,c,d,b,_e,tt){if(Tb.apply(this,arguments),Ob){if(Ob){var nt=Pb;Ob=!1,Pb=null}else throw Error(p(198));Qb||(Qb=!0,Rb=nt)}}function Vb(o){var e=o,s=o;if(o.alternate)for(;e.return;)e=e.return;else{o=e;do e=o,e.flags&4098&&(s=e.return),o=e.return;while(o)}return e.tag===3?s:null}function Wb(o){if(o.tag===13){var e=o.memoizedState;if(e===null&&(o=o.alternate,o!==null&&(e=o.memoizedState)),e!==null)return e.dehydrated}return null}function Xb(o){if(Vb(o)!==o)throw Error(p(188))}function Yb(o){var e=o.alternate;if(!e){if(e=Vb(o),e===null)throw Error(p(188));return e!==o?null:o}for(var s=o,a=e;;){var c=s.return;if(c===null)break;var d=c.alternate;if(d===null){if(a=c.return,a!==null){s=a;continue}break}if(c.child===d.child){for(d=c.child;d;){if(d===s)return Xb(c),o;if(d===a)return Xb(c),e;d=d.sibling}throw Error(p(188))}if(s.return!==a.return)s=c,a=d;else{for(var b=!1,_e=c.child;_e;){if(_e===s){b=!0,s=c,a=d;break}if(_e===a){b=!0,a=c,s=d;break}_e=_e.sibling}if(!b){for(_e=d.child;_e;){if(_e===s){b=!0,s=d,a=c;break}if(_e===a){b=!0,a=d,s=c;break}_e=_e.sibling}if(!b)throw Error(p(189))}}if(s.alternate!==a)throw Error(p(190))}if(s.tag!==3)throw Error(p(188));return s.stateNode.current===s?o:e}function Zb(o){return o=Yb(o),o!==null?$b(o):null}function $b(o){if(o.tag===5||o.tag===6)return o;for(o=o.child;o!==null;){var e=$b(o);if(e!==null)return e;o=o.sibling}return null}var ac=ca.unstable_scheduleCallback,bc=ca.unstable_cancelCallback,cc=ca.unstable_shouldYield,dc=ca.unstable_requestPaint,B=ca.unstable_now,ec=ca.unstable_getCurrentPriorityLevel,fc=ca.unstable_ImmediatePriority,gc=ca.unstable_UserBlockingPriority,hc=ca.unstable_NormalPriority,ic=ca.unstable_LowPriority,jc=ca.unstable_IdlePriority,kc=null,lc=null;function mc(o){if(lc&&typeof lc.onCommitFiberRoot=="function")try{lc.onCommitFiberRoot(kc,o,void 0,(o.current.flags&128)===128)}catch{}}var oc=Math.clz32?Math.clz32:nc,pc=Math.log,qc=Math.LN2;function nc(o){return o>>>=0,o===0?32:31-(pc(o)/qc|0)|0}var rc=64,sc=4194304;function tc(o){switch(o&-o){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return o&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return o}}function uc(o,e){var s=o.pendingLanes;if(s===0)return 0;var a=0,c=o.suspendedLanes,d=o.pingedLanes,b=s&268435455;if(b!==0){var _e=b&~c;_e!==0?a=tc(_e):(d&=b,d!==0&&(a=tc(d)))}else b=s&~c,b!==0?a=tc(b):d!==0&&(a=tc(d));if(a===0)return 0;if(e!==0&&e!==a&&!(e&c)&&(c=a&-a,d=e&-e,c>=d||c===16&&(d&4194240)!==0))return e;if(a&4&&(a|=s&16),e=o.entangledLanes,e!==0)for(o=o.entanglements,e&=a;0<e;)s=31-oc(e),c=1<<s,a|=o[s],e&=~c;return a}function vc(o,e){switch(o){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wc(o,e){for(var s=o.suspendedLanes,a=o.pingedLanes,c=o.expirationTimes,d=o.pendingLanes;0<d;){var b=31-oc(d),_e=1<<b,tt=c[b];tt===-1?(!(_e&s)||_e&a)&&(c[b]=vc(_e,e)):tt<=e&&(o.expiredLanes|=_e),d&=~_e}}function xc(o){return o=o.pendingLanes&-1073741825,o!==0?o:o&1073741824?1073741824:0}function yc(){var o=rc;return rc<<=1,!(rc&4194240)&&(rc=64),o}function zc(o){for(var e=[],s=0;31>s;s++)e.push(o);return e}function Ac(o,e,s){o.pendingLanes|=e,e!==536870912&&(o.suspendedLanes=0,o.pingedLanes=0),o=o.eventTimes,e=31-oc(e),o[e]=s}function Bc(o,e){var s=o.pendingLanes&~e;o.pendingLanes=e,o.suspendedLanes=0,o.pingedLanes=0,o.expiredLanes&=e,o.mutableReadLanes&=e,o.entangledLanes&=e,e=o.entanglements;var a=o.eventTimes;for(o=o.expirationTimes;0<s;){var c=31-oc(s),d=1<<c;e[c]=0,a[c]=-1,o[c]=-1,s&=~d}}function Cc(o,e){var s=o.entangledLanes|=e;for(o=o.entanglements;s;){var a=31-oc(s),c=1<<a;c&e|o[a]&e&&(o[a]|=e),s&=~c}}var C=0;function Dc(o){return o&=-o,1<o?4<o?o&268435455?16:536870912:4:1}var Ec,Fc,Gc,Hc,Ic,Jc=!1,Kc=[],Lc=null,Mc=null,Nc=null,Oc=new Map,Pc=new Map,Qc=[],Rc="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Sc(o,e){switch(o){case"focusin":case"focusout":Lc=null;break;case"dragenter":case"dragleave":Mc=null;break;case"mouseover":case"mouseout":Nc=null;break;case"pointerover":case"pointerout":Oc.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pc.delete(e.pointerId)}}function Tc(o,e,s,a,c,d){return o===null||o.nativeEvent!==d?(o={blockedOn:e,domEventName:s,eventSystemFlags:a,nativeEvent:d,targetContainers:[c]},e!==null&&(e=Cb(e),e!==null&&Fc(e)),o):(o.eventSystemFlags|=a,e=o.targetContainers,c!==null&&e.indexOf(c)===-1&&e.push(c),o)}function Uc(o,e,s,a,c){switch(e){case"focusin":return Lc=Tc(Lc,o,e,s,a,c),!0;case"dragenter":return Mc=Tc(Mc,o,e,s,a,c),!0;case"mouseover":return Nc=Tc(Nc,o,e,s,a,c),!0;case"pointerover":var d=c.pointerId;return Oc.set(d,Tc(Oc.get(d)||null,o,e,s,a,c)),!0;case"gotpointercapture":return d=c.pointerId,Pc.set(d,Tc(Pc.get(d)||null,o,e,s,a,c)),!0}return!1}function Vc(o){var e=Wc(o.target);if(e!==null){var s=Vb(e);if(s!==null){if(e=s.tag,e===13){if(e=Wb(s),e!==null){o.blockedOn=e,Ic(o.priority,function(){Gc(s)});return}}else if(e===3&&s.stateNode.current.memoizedState.isDehydrated){o.blockedOn=s.tag===3?s.stateNode.containerInfo:null;return}}}o.blockedOn=null}function Xc(o){if(o.blockedOn!==null)return!1;for(var e=o.targetContainers;0<e.length;){var s=Yc(o.domEventName,o.eventSystemFlags,e[0],o.nativeEvent);if(s===null){s=o.nativeEvent;var a=new s.constructor(s.type,s);wb=a,s.target.dispatchEvent(a),wb=null}else return e=Cb(s),e!==null&&Fc(e),o.blockedOn=s,!1;e.shift()}return!0}function Zc(o,e,s){Xc(o)&&s.delete(e)}function $c(){Jc=!1,Lc!==null&&Xc(Lc)&&(Lc=null),Mc!==null&&Xc(Mc)&&(Mc=null),Nc!==null&&Xc(Nc)&&(Nc=null),Oc.forEach(Zc),Pc.forEach(Zc)}function ad(o,e){o.blockedOn===e&&(o.blockedOn=null,Jc||(Jc=!0,ca.unstable_scheduleCallback(ca.unstable_NormalPriority,$c)))}function bd(o){function e(c){return ad(c,o)}if(0<Kc.length){ad(Kc[0],o);for(var s=1;s<Kc.length;s++){var a=Kc[s];a.blockedOn===o&&(a.blockedOn=null)}}for(Lc!==null&&ad(Lc,o),Mc!==null&&ad(Mc,o),Nc!==null&&ad(Nc,o),Oc.forEach(e),Pc.forEach(e),s=0;s<Qc.length;s++)a=Qc[s],a.blockedOn===o&&(a.blockedOn=null);for(;0<Qc.length&&(s=Qc[0],s.blockedOn===null);)Vc(s),s.blockedOn===null&&Qc.shift()}var cd=ua.ReactCurrentBatchConfig,dd=!0;function ed(o,e,s,a){var c=C,d=cd.transition;cd.transition=null;try{C=1,fd$1(o,e,s,a)}finally{C=c,cd.transition=d}}function gd(o,e,s,a){var c=C,d=cd.transition;cd.transition=null;try{C=4,fd$1(o,e,s,a)}finally{C=c,cd.transition=d}}function fd$1(o,e,s,a){if(dd){var c=Yc(o,e,s,a);if(c===null)hd(o,e,a,id,s),Sc(o,a);else if(Uc(c,o,e,s,a))a.stopPropagation();else if(Sc(o,a),e&4&&-1<Rc.indexOf(o)){for(;c!==null;){var d=Cb(c);if(d!==null&&Ec(d),d=Yc(o,e,s,a),d===null&&hd(o,e,a,id,s),d===c)break;c=d}c!==null&&a.stopPropagation()}else hd(o,e,a,null,s)}}var id=null;function Yc(o,e,s,a){if(id=null,o=xb(a),o=Wc(o),o!==null)if(e=Vb(o),e===null)o=null;else if(s=e.tag,s===13){if(o=Wb(e),o!==null)return o;o=null}else if(s===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;o=null}else e!==o&&(o=null);return id=o,null}function jd(o){switch(o){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ec()){case fc:return 1;case gc:return 4;case hc:case ic:return 16;case jc:return 536870912;default:return 16}default:return 16}}var kd=null,ld=null,md=null;function nd(){if(md)return md;var o,e=ld,s=e.length,a,c="value"in kd?kd.value:kd.textContent,d=c.length;for(o=0;o<s&&e[o]===c[o];o++);var b=s-o;for(a=1;a<=b&&e[s-a]===c[d-a];a++);return md=c.slice(o,1<a?1-a:void 0)}function od(o){var e=o.keyCode;return"charCode"in o?(o=o.charCode,o===0&&e===13&&(o=13)):o=e,o===10&&(o=13),32<=o||o===13?o:0}function pd(){return!0}function qd(){return!1}function rd(o){function e(s,a,c,d,b){this._reactName=s,this._targetInst=c,this.type=a,this.nativeEvent=d,this.target=b,this.currentTarget=null;for(var _e in o)o.hasOwnProperty(_e)&&(s=o[_e],this[_e]=s?s(d):d[_e]);return this.isDefaultPrevented=(d.defaultPrevented!=null?d.defaultPrevented:d.returnValue===!1)?pd:qd,this.isPropagationStopped=qd,this}return A(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var s=this.nativeEvent;s&&(s.preventDefault?s.preventDefault():typeof s.returnValue!="unknown"&&(s.returnValue=!1),this.isDefaultPrevented=pd)},stopPropagation:function(){var s=this.nativeEvent;s&&(s.stopPropagation?s.stopPropagation():typeof s.cancelBubble!="unknown"&&(s.cancelBubble=!0),this.isPropagationStopped=pd)},persist:function(){},isPersistent:pd}),e}var sd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(o){return o.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},td$1=rd(sd),ud=A({},sd,{view:0,detail:0}),vd=rd(ud),wd,xd,yd,Ad=A({},ud,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zd,button:0,buttons:0,relatedTarget:function(o){return o.relatedTarget===void 0?o.fromElement===o.srcElement?o.toElement:o.fromElement:o.relatedTarget},movementX:function(o){return"movementX"in o?o.movementX:(o!==yd&&(yd&&o.type==="mousemove"?(wd=o.screenX-yd.screenX,xd=o.screenY-yd.screenY):xd=wd=0,yd=o),wd)},movementY:function(o){return"movementY"in o?o.movementY:xd}}),Bd=rd(Ad),Cd=A({},Ad,{dataTransfer:0}),Dd=rd(Cd),Ed=A({},ud,{relatedTarget:0}),Fd=rd(Ed),Gd=A({},sd,{animationName:0,elapsedTime:0,pseudoElement:0}),Hd=rd(Gd),Id=A({},sd,{clipboardData:function(o){return"clipboardData"in o?o.clipboardData:window.clipboardData}}),Jd=rd(Id),Kd=A({},sd,{data:0}),Ld=rd(Kd),Md={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Nd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Od={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Pd(o){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(o):(o=Od[o])?!!e[o]:!1}function zd(){return Pd}var Qd=A({},ud,{key:function(o){if(o.key){var e=Md[o.key]||o.key;if(e!=="Unidentified")return e}return o.type==="keypress"?(o=od(o),o===13?"Enter":String.fromCharCode(o)):o.type==="keydown"||o.type==="keyup"?Nd[o.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zd,charCode:function(o){return o.type==="keypress"?od(o):0},keyCode:function(o){return o.type==="keydown"||o.type==="keyup"?o.keyCode:0},which:function(o){return o.type==="keypress"?od(o):o.type==="keydown"||o.type==="keyup"?o.keyCode:0}}),Rd=rd(Qd),Sd=A({},Ad,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Td=rd(Sd),Ud=A({},ud,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zd}),Vd=rd(Ud),Wd=A({},sd,{propertyName:0,elapsedTime:0,pseudoElement:0}),Xd=rd(Wd),Yd=A({},Ad,{deltaX:function(o){return"deltaX"in o?o.deltaX:"wheelDeltaX"in o?-o.wheelDeltaX:0},deltaY:function(o){return"deltaY"in o?o.deltaY:"wheelDeltaY"in o?-o.wheelDeltaY:"wheelDelta"in o?-o.wheelDelta:0},deltaZ:0,deltaMode:0}),Zd=rd(Yd),$d=[9,13,27,32],ae$1=ia&&"CompositionEvent"in window,be$1=null;ia&&"documentMode"in document&&(be$1=document.documentMode);var ce=ia&&"TextEvent"in window&&!be$1,de$1=ia&&(!ae$1||be$1&&8<be$1&&11>=be$1),ee$1=" ",fe$1=!1;function ge(o,e){switch(o){case"keyup":return $d.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function he$1(o){return o=o.detail,typeof o=="object"&&"data"in o?o.data:null}var ie$1=!1;function je(o,e){switch(o){case"compositionend":return he$1(e);case"keypress":return e.which!==32?null:(fe$1=!0,ee$1);case"textInput":return o=e.data,o===ee$1&&fe$1?null:o;default:return null}}function ke(o,e){if(ie$1)return o==="compositionend"||!ae$1&&ge(o,e)?(o=nd(),md=ld=kd=null,ie$1=!1,o):null;switch(o){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return de$1&&e.locale!=="ko"?null:e.data;default:return null}}var le$1={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function me(o){var e=o&&o.nodeName&&o.nodeName.toLowerCase();return e==="input"?!!le$1[o.type]:e==="textarea"}function ne(o,e,s,a){Eb(a),e=oe(e,"onChange"),0<e.length&&(s=new td$1("onChange","change",null,s,a),o.push({event:s,listeners:e}))}var pe=null,qe=null;function re(o){se$1(o,0)}function te$1(o){var e=ue(o);if(Wa(e))return o}function ve(o,e){if(o==="change")return e}var we=!1;if(ia){var xe;if(ia){var ye="oninput"in document;if(!ye){var ze=document.createElement("div");ze.setAttribute("oninput","return;"),ye=typeof ze.oninput=="function"}xe=ye}else xe=!1;we=xe&&(!document.documentMode||9<document.documentMode)}function Ae(){pe&&(pe.detachEvent("onpropertychange",Be),qe=pe=null)}function Be(o){if(o.propertyName==="value"&&te$1(qe)){var e=[];ne(e,qe,o,xb(o)),Jb(re,e)}}function Ce$1(o,e,s){o==="focusin"?(Ae(),pe=e,qe=s,pe.attachEvent("onpropertychange",Be)):o==="focusout"&&Ae()}function De$1(o){if(o==="selectionchange"||o==="keyup"||o==="keydown")return te$1(qe)}function Ee$1(o,e){if(o==="click")return te$1(e)}function Fe(o,e){if(o==="input"||o==="change")return te$1(e)}function Ge(o,e){return o===e&&(o!==0||1/o===1/e)||o!==o&&e!==e}var He$1=typeof Object.is=="function"?Object.is:Ge;function Ie(o,e){if(He$1(o,e))return!0;if(typeof o!="object"||o===null||typeof e!="object"||e===null)return!1;var s=Object.keys(o),a=Object.keys(e);if(s.length!==a.length)return!1;for(a=0;a<s.length;a++){var c=s[a];if(!ja.call(e,c)||!He$1(o[c],e[c]))return!1}return!0}function Je(o){for(;o&&o.firstChild;)o=o.firstChild;return o}function Ke(o,e){var s=Je(o);o=0;for(var a;s;){if(s.nodeType===3){if(a=o+s.textContent.length,o<=e&&a>=e)return{node:s,offset:e-o};o=a}e:{for(;s;){if(s.nextSibling){s=s.nextSibling;break e}s=s.parentNode}s=void 0}s=Je(s)}}function Le(o,e){return o&&e?o===e?!0:o&&o.nodeType===3?!1:e&&e.nodeType===3?Le(o,e.parentNode):"contains"in o?o.contains(e):o.compareDocumentPosition?!!(o.compareDocumentPosition(e)&16):!1:!1}function Me$1(){for(var o=window,e=Xa();e instanceof o.HTMLIFrameElement;){try{var s=typeof e.contentWindow.location.href=="string"}catch{s=!1}if(s)o=e.contentWindow;else break;e=Xa(o.document)}return e}function Ne(o){var e=o&&o.nodeName&&o.nodeName.toLowerCase();return e&&(e==="input"&&(o.type==="text"||o.type==="search"||o.type==="tel"||o.type==="url"||o.type==="password")||e==="textarea"||o.contentEditable==="true")}function Oe$1(o){var e=Me$1(),s=o.focusedElem,a=o.selectionRange;if(e!==s&&s&&s.ownerDocument&&Le(s.ownerDocument.documentElement,s)){if(a!==null&&Ne(s)){if(e=a.start,o=a.end,o===void 0&&(o=e),"selectionStart"in s)s.selectionStart=e,s.selectionEnd=Math.min(o,s.value.length);else if(o=(e=s.ownerDocument||document)&&e.defaultView||window,o.getSelection){o=o.getSelection();var c=s.textContent.length,d=Math.min(a.start,c);a=a.end===void 0?d:Math.min(a.end,c),!o.extend&&d>a&&(c=a,a=d,d=c),c=Ke(s,d);var b=Ke(s,a);c&&b&&(o.rangeCount!==1||o.anchorNode!==c.node||o.anchorOffset!==c.offset||o.focusNode!==b.node||o.focusOffset!==b.offset)&&(e=e.createRange(),e.setStart(c.node,c.offset),o.removeAllRanges(),d>a?(o.addRange(e),o.extend(b.node,b.offset)):(e.setEnd(b.node,b.offset),o.addRange(e)))}}for(e=[],o=s;o=o.parentNode;)o.nodeType===1&&e.push({element:o,left:o.scrollLeft,top:o.scrollTop});for(typeof s.focus=="function"&&s.focus(),s=0;s<e.length;s++)o=e[s],o.element.scrollLeft=o.left,o.element.scrollTop=o.top}}var Pe=ia&&"documentMode"in document&&11>=document.documentMode,Qe=null,Re=null,Se=null,Te=!1;function Ue(o,e,s){var a=s.window===s?s.document:s.nodeType===9?s:s.ownerDocument;Te||Qe==null||Qe!==Xa(a)||(a=Qe,"selectionStart"in a&&Ne(a)?a={start:a.selectionStart,end:a.selectionEnd}:(a=(a.ownerDocument&&a.ownerDocument.defaultView||window).getSelection(),a={anchorNode:a.anchorNode,anchorOffset:a.anchorOffset,focusNode:a.focusNode,focusOffset:a.focusOffset}),Se&&Ie(Se,a)||(Se=a,a=oe(Re,"onSelect"),0<a.length&&(e=new td$1("onSelect","select",null,e,s),o.push({event:e,listeners:a}),e.target=Qe)))}function Ve$1(o,e){var s={};return s[o.toLowerCase()]=e.toLowerCase(),s["Webkit"+o]="webkit"+e,s["Moz"+o]="moz"+e,s}var We={animationend:Ve$1("Animation","AnimationEnd"),animationiteration:Ve$1("Animation","AnimationIteration"),animationstart:Ve$1("Animation","AnimationStart"),transitionend:Ve$1("Transition","TransitionEnd")},Xe={},Ye={};ia&&(Ye=document.createElement("div").style,"AnimationEvent"in window||(delete We.animationend.animation,delete We.animationiteration.animation,delete We.animationstart.animation),"TransitionEvent"in window||delete We.transitionend.transition);function Ze(o){if(Xe[o])return Xe[o];if(!We[o])return o;var e=We[o],s;for(s in e)if(e.hasOwnProperty(s)&&s in Ye)return Xe[o]=e[s];return o}var $e=Ze("animationend"),af=Ze("animationiteration"),bf=Ze("animationstart"),cf=Ze("transitionend"),df=new Map,ef="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ff(o,e){df.set(o,e),fa(e,[o])}for(var gf=0;gf<ef.length;gf++){var hf=ef[gf],jf=hf.toLowerCase(),kf=hf[0].toUpperCase()+hf.slice(1);ff(jf,"on"+kf)}ff($e,"onAnimationEnd");ff(af,"onAnimationIteration");ff(bf,"onAnimationStart");ff("dblclick","onDoubleClick");ff("focusin","onFocus");ff("focusout","onBlur");ff(cf,"onTransitionEnd");ha("onMouseEnter",["mouseout","mouseover"]);ha("onMouseLeave",["mouseout","mouseover"]);ha("onPointerEnter",["pointerout","pointerover"]);ha("onPointerLeave",["pointerout","pointerover"]);fa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));fa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));fa("onBeforeInput",["compositionend","keypress","textInput","paste"]);fa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mf=new Set("cancel close invalid load scroll toggle".split(" ").concat(lf));function nf(o,e,s){var a=o.type||"unknown-event";o.currentTarget=s,Ub(a,e,void 0,o),o.currentTarget=null}function se$1(o,e){e=(e&4)!==0;for(var s=0;s<o.length;s++){var a=o[s],c=a.event;a=a.listeners;e:{var d=void 0;if(e)for(var b=a.length-1;0<=b;b--){var _e=a[b],tt=_e.instance,nt=_e.currentTarget;if(_e=_e.listener,tt!==d&&c.isPropagationStopped())break e;nf(c,_e,nt),d=tt}else for(b=0;b<a.length;b++){if(_e=a[b],tt=_e.instance,nt=_e.currentTarget,_e=_e.listener,tt!==d&&c.isPropagationStopped())break e;nf(c,_e,nt),d=tt}}}if(Qb)throw o=Rb,Qb=!1,Rb=null,o}function D$2(o,e){var s=e[of];s===void 0&&(s=e[of]=new Set);var a=o+"__bubble";s.has(a)||(pf(e,o,2,!1),s.add(a))}function qf(o,e,s){var a=0;e&&(a|=4),pf(s,o,a,e)}var rf="_reactListening"+Math.random().toString(36).slice(2);function sf(o){if(!o[rf]){o[rf]=!0,da.forEach(function(s){s!=="selectionchange"&&(mf.has(s)||qf(s,!1,o),qf(s,!0,o))});var e=o.nodeType===9?o:o.ownerDocument;e===null||e[rf]||(e[rf]=!0,qf("selectionchange",!1,e))}}function pf(o,e,s,a){switch(jd(e)){case 1:var c=ed;break;case 4:c=gd;break;default:c=fd$1}s=c.bind(null,e,s,o),c=void 0,!Lb||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(c=!0),a?c!==void 0?o.addEventListener(e,s,{capture:!0,passive:c}):o.addEventListener(e,s,!0):c!==void 0?o.addEventListener(e,s,{passive:c}):o.addEventListener(e,s,!1)}function hd(o,e,s,a,c){var d=a;if(!(e&1)&&!(e&2)&&a!==null)e:for(;;){if(a===null)return;var b=a.tag;if(b===3||b===4){var _e=a.stateNode.containerInfo;if(_e===c||_e.nodeType===8&&_e.parentNode===c)break;if(b===4)for(b=a.return;b!==null;){var tt=b.tag;if((tt===3||tt===4)&&(tt=b.stateNode.containerInfo,tt===c||tt.nodeType===8&&tt.parentNode===c))return;b=b.return}for(;_e!==null;){if(b=Wc(_e),b===null)return;if(tt=b.tag,tt===5||tt===6){a=d=b;continue e}_e=_e.parentNode}}a=a.return}Jb(function(){var nt=d,it=xb(s),ot=[];e:{var at=df.get(o);if(at!==void 0){var ct=td$1,ut=o;switch(o){case"keypress":if(od(s)===0)break e;case"keydown":case"keyup":ct=Rd;break;case"focusin":ut="focus",ct=Fd;break;case"focusout":ut="blur",ct=Fd;break;case"beforeblur":case"afterblur":ct=Fd;break;case"click":if(s.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ct=Bd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ct=Dd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ct=Vd;break;case $e:case af:case bf:ct=Hd;break;case cf:ct=Xd;break;case"scroll":ct=vd;break;case"wheel":ct=Zd;break;case"copy":case"cut":case"paste":ct=Jd;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ct=Td}var ft=(e&4)!==0,dt=!ft&&o==="scroll",lt=ft?at!==null?at+"Capture":null:at;ft=[];for(var ht=nt,mt;ht!==null;){mt=ht;var xt=mt.stateNode;if(mt.tag===5&&xt!==null&&(mt=xt,lt!==null&&(xt=Kb(ht,lt),xt!=null&&ft.push(tf(ht,xt,mt)))),dt)break;ht=ht.return}0<ft.length&&(at=new ct(at,ut,null,s,it),ot.push({event:at,listeners:ft}))}}if(!(e&7)){e:{if(at=o==="mouseover"||o==="pointerover",ct=o==="mouseout"||o==="pointerout",at&&s!==wb&&(ut=s.relatedTarget||s.fromElement)&&(Wc(ut)||ut[uf]))break e;if((ct||at)&&(at=it.window===it?it:(at=it.ownerDocument)?at.defaultView||at.parentWindow:window,ct?(ut=s.relatedTarget||s.toElement,ct=nt,ut=ut?Wc(ut):null,ut!==null&&(dt=Vb(ut),ut!==dt||ut.tag!==5&&ut.tag!==6)&&(ut=null)):(ct=null,ut=nt),ct!==ut)){if(ft=Bd,xt="onMouseLeave",lt="onMouseEnter",ht="mouse",(o==="pointerout"||o==="pointerover")&&(ft=Td,xt="onPointerLeave",lt="onPointerEnter",ht="pointer"),dt=ct==null?at:ue(ct),mt=ut==null?at:ue(ut),at=new ft(xt,ht+"leave",ct,s,it),at.target=dt,at.relatedTarget=mt,xt=null,Wc(it)===nt&&(ft=new ft(lt,ht+"enter",ut,s,it),ft.target=mt,ft.relatedTarget=dt,xt=ft),dt=xt,ct&&ut)t:{for(ft=ct,lt=ut,ht=0,mt=ft;mt;mt=vf(mt))ht++;for(mt=0,xt=lt;xt;xt=vf(xt))mt++;for(;0<ht-mt;)ft=vf(ft),ht--;for(;0<mt-ht;)lt=vf(lt),mt--;for(;ht--;){if(ft===lt||lt!==null&&ft===lt.alternate)break t;ft=vf(ft),lt=vf(lt)}ft=null}else ft=null;ct!==null&&wf(ot,at,ct,ft,!1),ut!==null&&dt!==null&&wf(ot,dt,ut,ft,!0)}}e:{if(at=nt?ue(nt):window,ct=at.nodeName&&at.nodeName.toLowerCase(),ct==="select"||ct==="input"&&at.type==="file")var St=ve;else if(me(at))if(we)St=Fe;else{St=De$1;var yt=Ce$1}else(ct=at.nodeName)&&ct.toLowerCase()==="input"&&(at.type==="checkbox"||at.type==="radio")&&(St=Ee$1);if(St&&(St=St(o,nt))){ne(ot,St,s,it);break e}yt&&yt(o,at,nt),o==="focusout"&&(yt=at._wrapperState)&&yt.controlled&&at.type==="number"&&cb(at,"number",at.value)}switch(yt=nt?ue(nt):window,o){case"focusin":(me(yt)||yt.contentEditable==="true")&&(Qe=yt,Re=nt,Se=null);break;case"focusout":Se=Re=Qe=null;break;case"mousedown":Te=!0;break;case"contextmenu":case"mouseup":case"dragend":Te=!1,Ue(ot,s,it);break;case"selectionchange":if(Pe)break;case"keydown":case"keyup":Ue(ot,s,it)}var wt;if(ae$1)e:{switch(o){case"compositionstart":var Et="onCompositionStart";break e;case"compositionend":Et="onCompositionEnd";break e;case"compositionupdate":Et="onCompositionUpdate";break e}Et=void 0}else ie$1?ge(o,s)&&(Et="onCompositionEnd"):o==="keydown"&&s.keyCode===229&&(Et="onCompositionStart");Et&&(de$1&&s.locale!=="ko"&&(ie$1||Et!=="onCompositionStart"?Et==="onCompositionEnd"&&ie$1&&(wt=nd()):(kd=it,ld="value"in kd?kd.value:kd.textContent,ie$1=!0)),yt=oe(nt,Et),0<yt.length&&(Et=new Ld(Et,o,null,s,it),ot.push({event:Et,listeners:yt}),wt?Et.data=wt:(wt=he$1(s),wt!==null&&(Et.data=wt)))),(wt=ce?je(o,s):ke(o,s))&&(nt=oe(nt,"onBeforeInput"),0<nt.length&&(it=new Ld("onBeforeInput","beforeinput",null,s,it),ot.push({event:it,listeners:nt}),it.data=wt))}se$1(ot,e)})}function tf(o,e,s){return{instance:o,listener:e,currentTarget:s}}function oe(o,e){for(var s=e+"Capture",a=[];o!==null;){var c=o,d=c.stateNode;c.tag===5&&d!==null&&(c=d,d=Kb(o,s),d!=null&&a.unshift(tf(o,d,c)),d=Kb(o,e),d!=null&&a.push(tf(o,d,c))),o=o.return}return a}function vf(o){if(o===null)return null;do o=o.return;while(o&&o.tag!==5);return o||null}function wf(o,e,s,a,c){for(var d=e._reactName,b=[];s!==null&&s!==a;){var _e=s,tt=_e.alternate,nt=_e.stateNode;if(tt!==null&&tt===a)break;_e.tag===5&&nt!==null&&(_e=nt,c?(tt=Kb(s,d),tt!=null&&b.unshift(tf(s,tt,_e))):c||(tt=Kb(s,d),tt!=null&&b.push(tf(s,tt,_e)))),s=s.return}b.length!==0&&o.push({event:e,listeners:b})}var xf=/\r\n?/g,yf=/\u0000|\uFFFD/g;function zf(o){return(typeof o=="string"?o:""+o).replace(xf,`
`).replace(yf,"")}function Af(o,e,s){if(e=zf(e),zf(o)!==e&&s)throw Error(p(425))}function Bf(){}var Cf=null,Df=null;function Ef(o,e){return o==="textarea"||o==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Ff=typeof setTimeout=="function"?setTimeout:void 0,Gf=typeof clearTimeout=="function"?clearTimeout:void 0,Hf=typeof Promise=="function"?Promise:void 0,Jf=typeof queueMicrotask=="function"?queueMicrotask:typeof Hf<"u"?function(o){return Hf.resolve(null).then(o).catch(If)}:Ff;function If(o){setTimeout(function(){throw o})}function Kf(o,e){var s=e,a=0;do{var c=s.nextSibling;if(o.removeChild(s),c&&c.nodeType===8)if(s=c.data,s==="/$"){if(a===0){o.removeChild(c),bd(e);return}a--}else s!=="$"&&s!=="$?"&&s!=="$!"||a++;s=c}while(s);bd(e)}function Lf(o){for(;o!=null;o=o.nextSibling){var e=o.nodeType;if(e===1||e===3)break;if(e===8){if(e=o.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return o}function Mf(o){o=o.previousSibling;for(var e=0;o;){if(o.nodeType===8){var s=o.data;if(s==="$"||s==="$!"||s==="$?"){if(e===0)return o;e--}else s==="/$"&&e++}o=o.previousSibling}return null}var Nf=Math.random().toString(36).slice(2),Of="__reactFiber$"+Nf,Pf="__reactProps$"+Nf,uf="__reactContainer$"+Nf,of="__reactEvents$"+Nf,Qf="__reactListeners$"+Nf,Rf="__reactHandles$"+Nf;function Wc(o){var e=o[Of];if(e)return e;for(var s=o.parentNode;s;){if(e=s[uf]||s[Of]){if(s=e.alternate,e.child!==null||s!==null&&s.child!==null)for(o=Mf(o);o!==null;){if(s=o[Of])return s;o=Mf(o)}return e}o=s,s=o.parentNode}return null}function Cb(o){return o=o[Of]||o[uf],!o||o.tag!==5&&o.tag!==6&&o.tag!==13&&o.tag!==3?null:o}function ue(o){if(o.tag===5||o.tag===6)return o.stateNode;throw Error(p(33))}function Db(o){return o[Pf]||null}var Sf=[],Tf=-1;function Uf(o){return{current:o}}function E$1(o){0>Tf||(o.current=Sf[Tf],Sf[Tf]=null,Tf--)}function G(o,e){Tf++,Sf[Tf]=o.current,o.current=e}var Vf={},H$1=Uf(Vf),Wf=Uf(!1),Xf=Vf;function Yf(o,e){var s=o.type.contextTypes;if(!s)return Vf;var a=o.stateNode;if(a&&a.__reactInternalMemoizedUnmaskedChildContext===e)return a.__reactInternalMemoizedMaskedChildContext;var c={},d;for(d in s)c[d]=e[d];return a&&(o=o.stateNode,o.__reactInternalMemoizedUnmaskedChildContext=e,o.__reactInternalMemoizedMaskedChildContext=c),c}function Zf(o){return o=o.childContextTypes,o!=null}function $f(){E$1(Wf),E$1(H$1)}function ag(o,e,s){if(H$1.current!==Vf)throw Error(p(168));G(H$1,e),G(Wf,s)}function bg(o,e,s){var a=o.stateNode;if(e=e.childContextTypes,typeof a.getChildContext!="function")return s;a=a.getChildContext();for(var c in a)if(!(c in e))throw Error(p(108,Ra(o)||"Unknown",c));return A({},s,a)}function cg(o){return o=(o=o.stateNode)&&o.__reactInternalMemoizedMergedChildContext||Vf,Xf=H$1.current,G(H$1,o),G(Wf,Wf.current),!0}function dg(o,e,s){var a=o.stateNode;if(!a)throw Error(p(169));s?(o=bg(o,e,Xf),a.__reactInternalMemoizedMergedChildContext=o,E$1(Wf),E$1(H$1),G(H$1,o)):E$1(Wf),G(Wf,s)}var eg=null,fg=!1,gg=!1;function hg(o){eg===null?eg=[o]:eg.push(o)}function ig(o){fg=!0,hg(o)}function jg(){if(!gg&&eg!==null){gg=!0;var o=0,e=C;try{var s=eg;for(C=1;o<s.length;o++){var a=s[o];do a=a(!0);while(a!==null)}eg=null,fg=!1}catch(c){throw eg!==null&&(eg=eg.slice(o+1)),ac(fc,jg),c}finally{C=e,gg=!1}}return null}var kg=[],lg=0,mg=null,ng=0,og=[],pg=0,qg=null,rg=1,sg="";function tg(o,e){kg[lg++]=ng,kg[lg++]=mg,mg=o,ng=e}function ug(o,e,s){og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,qg=o;var a=rg;o=sg;var c=32-oc(a)-1;a&=~(1<<c),s+=1;var d=32-oc(e)+c;if(30<d){var b=c-c%5;d=(a&(1<<b)-1).toString(32),a>>=b,c-=b,rg=1<<32-oc(e)+c|s<<c|a,sg=d+o}else rg=1<<d|s<<c|a,sg=o}function vg(o){o.return!==null&&(tg(o,1),ug(o,1,0))}function wg(o){for(;o===mg;)mg=kg[--lg],kg[lg]=null,ng=kg[--lg],kg[lg]=null;for(;o===qg;)qg=og[--pg],og[pg]=null,sg=og[--pg],og[pg]=null,rg=og[--pg],og[pg]=null}var xg=null,yg=null,I=!1,zg=null;function Ag(o,e){var s=Bg(5,null,null,0);s.elementType="DELETED",s.stateNode=e,s.return=o,e=o.deletions,e===null?(o.deletions=[s],o.flags|=16):e.push(s)}function Cg(o,e){switch(o.tag){case 5:var s=o.type;return e=e.nodeType!==1||s.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(o.stateNode=e,xg=o,yg=Lf(e.firstChild),!0):!1;case 6:return e=o.pendingProps===""||e.nodeType!==3?null:e,e!==null?(o.stateNode=e,xg=o,yg=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(s=qg!==null?{id:rg,overflow:sg}:null,o.memoizedState={dehydrated:e,treeContext:s,retryLane:1073741824},s=Bg(18,null,null,0),s.stateNode=e,s.return=o,o.child=s,xg=o,yg=null,!0):!1;default:return!1}}function Dg(o){return(o.mode&1)!==0&&(o.flags&128)===0}function Eg(o){if(I){var e=yg;if(e){var s=e;if(!Cg(o,e)){if(Dg(o))throw Error(p(418));e=Lf(s.nextSibling);var a=xg;e&&Cg(o,e)?Ag(a,s):(o.flags=o.flags&-4097|2,I=!1,xg=o)}}else{if(Dg(o))throw Error(p(418));o.flags=o.flags&-4097|2,I=!1,xg=o}}}function Fg(o){for(o=o.return;o!==null&&o.tag!==5&&o.tag!==3&&o.tag!==13;)o=o.return;xg=o}function Gg(o){if(o!==xg)return!1;if(!I)return Fg(o),I=!0,!1;var e;if((e=o.tag!==3)&&!(e=o.tag!==5)&&(e=o.type,e=e!=="head"&&e!=="body"&&!Ef(o.type,o.memoizedProps)),e&&(e=yg)){if(Dg(o))throw Hg(),Error(p(418));for(;e;)Ag(o,e),e=Lf(e.nextSibling)}if(Fg(o),o.tag===13){if(o=o.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(p(317));e:{for(o=o.nextSibling,e=0;o;){if(o.nodeType===8){var s=o.data;if(s==="/$"){if(e===0){yg=Lf(o.nextSibling);break e}e--}else s!=="$"&&s!=="$!"&&s!=="$?"||e++}o=o.nextSibling}yg=null}}else yg=xg?Lf(o.stateNode.nextSibling):null;return!0}function Hg(){for(var o=yg;o;)o=Lf(o.nextSibling)}function Ig(){yg=xg=null,I=!1}function Jg(o){zg===null?zg=[o]:zg.push(o)}var Kg=ua.ReactCurrentBatchConfig;function Lg(o,e,s){if(o=s.ref,o!==null&&typeof o!="function"&&typeof o!="object"){if(s._owner){if(s=s._owner,s){if(s.tag!==1)throw Error(p(309));var a=s.stateNode}if(!a)throw Error(p(147,o));var c=a,d=""+o;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===d?e.ref:(e=function(b){var _e=c.refs;b===null?delete _e[d]:_e[d]=b},e._stringRef=d,e)}if(typeof o!="string")throw Error(p(284));if(!s._owner)throw Error(p(290,o))}return o}function Mg(o,e){throw o=Object.prototype.toString.call(e),Error(p(31,o==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":o))}function Ng(o){var e=o._init;return e(o._payload)}function Og(o){function e(lt,ht){if(o){var mt=lt.deletions;mt===null?(lt.deletions=[ht],lt.flags|=16):mt.push(ht)}}function s(lt,ht){if(!o)return null;for(;ht!==null;)e(lt,ht),ht=ht.sibling;return null}function a(lt,ht){for(lt=new Map;ht!==null;)ht.key!==null?lt.set(ht.key,ht):lt.set(ht.index,ht),ht=ht.sibling;return lt}function c(lt,ht){return lt=Pg(lt,ht),lt.index=0,lt.sibling=null,lt}function d(lt,ht,mt){return lt.index=mt,o?(mt=lt.alternate,mt!==null?(mt=mt.index,mt<ht?(lt.flags|=2,ht):mt):(lt.flags|=2,ht)):(lt.flags|=1048576,ht)}function b(lt){return o&&lt.alternate===null&&(lt.flags|=2),lt}function _e(lt,ht,mt,xt){return ht===null||ht.tag!==6?(ht=Qg(mt,lt.mode,xt),ht.return=lt,ht):(ht=c(ht,mt),ht.return=lt,ht)}function tt(lt,ht,mt,xt){var St=mt.type;return St===ya?it(lt,ht,mt.props.children,xt,mt.key):ht!==null&&(ht.elementType===St||typeof St=="object"&&St!==null&&St.$$typeof===Ha&&Ng(St)===ht.type)?(xt=c(ht,mt.props),xt.ref=Lg(lt,ht,mt),xt.return=lt,xt):(xt=Rg(mt.type,mt.key,mt.props,null,lt.mode,xt),xt.ref=Lg(lt,ht,mt),xt.return=lt,xt)}function nt(lt,ht,mt,xt){return ht===null||ht.tag!==4||ht.stateNode.containerInfo!==mt.containerInfo||ht.stateNode.implementation!==mt.implementation?(ht=Sg(mt,lt.mode,xt),ht.return=lt,ht):(ht=c(ht,mt.children||[]),ht.return=lt,ht)}function it(lt,ht,mt,xt,St){return ht===null||ht.tag!==7?(ht=Tg(mt,lt.mode,xt,St),ht.return=lt,ht):(ht=c(ht,mt),ht.return=lt,ht)}function ot(lt,ht,mt){if(typeof ht=="string"&&ht!==""||typeof ht=="number")return ht=Qg(""+ht,lt.mode,mt),ht.return=lt,ht;if(typeof ht=="object"&&ht!==null){switch(ht.$$typeof){case va:return mt=Rg(ht.type,ht.key,ht.props,null,lt.mode,mt),mt.ref=Lg(lt,null,ht),mt.return=lt,mt;case wa:return ht=Sg(ht,lt.mode,mt),ht.return=lt,ht;case Ha:var xt=ht._init;return ot(lt,xt(ht._payload),mt)}if(eb(ht)||Ka(ht))return ht=Tg(ht,lt.mode,mt,null),ht.return=lt,ht;Mg(lt,ht)}return null}function at(lt,ht,mt,xt){var St=ht!==null?ht.key:null;if(typeof mt=="string"&&mt!==""||typeof mt=="number")return St!==null?null:_e(lt,ht,""+mt,xt);if(typeof mt=="object"&&mt!==null){switch(mt.$$typeof){case va:return mt.key===St?tt(lt,ht,mt,xt):null;case wa:return mt.key===St?nt(lt,ht,mt,xt):null;case Ha:return St=mt._init,at(lt,ht,St(mt._payload),xt)}if(eb(mt)||Ka(mt))return St!==null?null:it(lt,ht,mt,xt,null);Mg(lt,mt)}return null}function ct(lt,ht,mt,xt,St){if(typeof xt=="string"&&xt!==""||typeof xt=="number")return lt=lt.get(mt)||null,_e(ht,lt,""+xt,St);if(typeof xt=="object"&&xt!==null){switch(xt.$$typeof){case va:return lt=lt.get(xt.key===null?mt:xt.key)||null,tt(ht,lt,xt,St);case wa:return lt=lt.get(xt.key===null?mt:xt.key)||null,nt(ht,lt,xt,St);case Ha:var yt=xt._init;return ct(lt,ht,mt,yt(xt._payload),St)}if(eb(xt)||Ka(xt))return lt=lt.get(mt)||null,it(ht,lt,xt,St,null);Mg(ht,xt)}return null}function ut(lt,ht,mt,xt){for(var St=null,yt=null,wt=ht,Et=ht=0,_t=null;wt!==null&&Et<mt.length;Et++){wt.index>Et?(_t=wt,wt=null):_t=wt.sibling;var vt=at(lt,wt,mt[Et],xt);if(vt===null){wt===null&&(wt=_t);break}o&&wt&&vt.alternate===null&&e(lt,wt),ht=d(vt,ht,Et),yt===null?St=vt:yt.sibling=vt,yt=vt,wt=_t}if(Et===mt.length)return s(lt,wt),I&&tg(lt,Et),St;if(wt===null){for(;Et<mt.length;Et++)wt=ot(lt,mt[Et],xt),wt!==null&&(ht=d(wt,ht,Et),yt===null?St=wt:yt.sibling=wt,yt=wt);return I&&tg(lt,Et),St}for(wt=a(lt,wt);Et<mt.length;Et++)_t=ct(wt,lt,Et,mt[Et],xt),_t!==null&&(o&&_t.alternate!==null&&wt.delete(_t.key===null?Et:_t.key),ht=d(_t,ht,Et),yt===null?St=_t:yt.sibling=_t,yt=_t);return o&&wt.forEach(function(Mt){return e(lt,Mt)}),I&&tg(lt,Et),St}function ft(lt,ht,mt,xt){var St=Ka(mt);if(typeof St!="function")throw Error(p(150));if(mt=St.call(mt),mt==null)throw Error(p(151));for(var yt=St=null,wt=ht,Et=ht=0,_t=null,vt=mt.next();wt!==null&&!vt.done;Et++,vt=mt.next()){wt.index>Et?(_t=wt,wt=null):_t=wt.sibling;var Mt=at(lt,wt,vt.value,xt);if(Mt===null){wt===null&&(wt=_t);break}o&&wt&&Mt.alternate===null&&e(lt,wt),ht=d(Mt,ht,Et),yt===null?St=Mt:yt.sibling=Mt,yt=Mt,wt=_t}if(vt.done)return s(lt,wt),I&&tg(lt,Et),St;if(wt===null){for(;!vt.done;Et++,vt=mt.next())vt=ot(lt,vt.value,xt),vt!==null&&(ht=d(vt,ht,Et),yt===null?St=vt:yt.sibling=vt,yt=vt);return I&&tg(lt,Et),St}for(wt=a(lt,wt);!vt.done;Et++,vt=mt.next())vt=ct(wt,lt,Et,vt.value,xt),vt!==null&&(o&&vt.alternate!==null&&wt.delete(vt.key===null?Et:vt.key),ht=d(vt,ht,Et),yt===null?St=vt:yt.sibling=vt,yt=vt);return o&&wt.forEach(function(jt){return e(lt,jt)}),I&&tg(lt,Et),St}function dt(lt,ht,mt,xt){if(typeof mt=="object"&&mt!==null&&mt.type===ya&&mt.key===null&&(mt=mt.props.children),typeof mt=="object"&&mt!==null){switch(mt.$$typeof){case va:e:{for(var St=mt.key,yt=ht;yt!==null;){if(yt.key===St){if(St=mt.type,St===ya){if(yt.tag===7){s(lt,yt.sibling),ht=c(yt,mt.props.children),ht.return=lt,lt=ht;break e}}else if(yt.elementType===St||typeof St=="object"&&St!==null&&St.$$typeof===Ha&&Ng(St)===yt.type){s(lt,yt.sibling),ht=c(yt,mt.props),ht.ref=Lg(lt,yt,mt),ht.return=lt,lt=ht;break e}s(lt,yt);break}else e(lt,yt);yt=yt.sibling}mt.type===ya?(ht=Tg(mt.props.children,lt.mode,xt,mt.key),ht.return=lt,lt=ht):(xt=Rg(mt.type,mt.key,mt.props,null,lt.mode,xt),xt.ref=Lg(lt,ht,mt),xt.return=lt,lt=xt)}return b(lt);case wa:e:{for(yt=mt.key;ht!==null;){if(ht.key===yt)if(ht.tag===4&&ht.stateNode.containerInfo===mt.containerInfo&&ht.stateNode.implementation===mt.implementation){s(lt,ht.sibling),ht=c(ht,mt.children||[]),ht.return=lt,lt=ht;break e}else{s(lt,ht);break}else e(lt,ht);ht=ht.sibling}ht=Sg(mt,lt.mode,xt),ht.return=lt,lt=ht}return b(lt);case Ha:return yt=mt._init,dt(lt,ht,yt(mt._payload),xt)}if(eb(mt))return ut(lt,ht,mt,xt);if(Ka(mt))return ft(lt,ht,mt,xt);Mg(lt,mt)}return typeof mt=="string"&&mt!==""||typeof mt=="number"?(mt=""+mt,ht!==null&&ht.tag===6?(s(lt,ht.sibling),ht=c(ht,mt),ht.return=lt,lt=ht):(s(lt,ht),ht=Qg(mt,lt.mode,xt),ht.return=lt,lt=ht),b(lt)):s(lt,ht)}return dt}var Ug=Og(!0),Vg=Og(!1),Wg=Uf(null),Xg=null,Yg=null,Zg=null;function $g(){Zg=Yg=Xg=null}function ah(o){var e=Wg.current;E$1(Wg),o._currentValue=e}function bh(o,e,s){for(;o!==null;){var a=o.alternate;if((o.childLanes&e)!==e?(o.childLanes|=e,a!==null&&(a.childLanes|=e)):a!==null&&(a.childLanes&e)!==e&&(a.childLanes|=e),o===s)break;o=o.return}}function ch(o,e){Xg=o,Zg=Yg=null,o=o.dependencies,o!==null&&o.firstContext!==null&&(o.lanes&e&&(dh=!0),o.firstContext=null)}function eh(o){var e=o._currentValue;if(Zg!==o)if(o={context:o,memoizedValue:e,next:null},Yg===null){if(Xg===null)throw Error(p(308));Yg=o,Xg.dependencies={lanes:0,firstContext:o}}else Yg=Yg.next=o;return e}var fh=null;function gh(o){fh===null?fh=[o]:fh.push(o)}function hh(o,e,s,a){var c=e.interleaved;return c===null?(s.next=s,gh(e)):(s.next=c.next,c.next=s),e.interleaved=s,ih(o,a)}function ih(o,e){o.lanes|=e;var s=o.alternate;for(s!==null&&(s.lanes|=e),s=o,o=o.return;o!==null;)o.childLanes|=e,s=o.alternate,s!==null&&(s.childLanes|=e),s=o,o=o.return;return s.tag===3?s.stateNode:null}var jh=!1;function kh(o){o.updateQueue={baseState:o.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function lh(o,e){o=o.updateQueue,e.updateQueue===o&&(e.updateQueue={baseState:o.baseState,firstBaseUpdate:o.firstBaseUpdate,lastBaseUpdate:o.lastBaseUpdate,shared:o.shared,effects:o.effects})}function mh(o,e){return{eventTime:o,lane:e,tag:0,payload:null,callback:null,next:null}}function nh(o,e,s){var a=o.updateQueue;if(a===null)return null;if(a=a.shared,K&2){var c=a.pending;return c===null?e.next=e:(e.next=c.next,c.next=e),a.pending=e,ih(o,s)}return c=a.interleaved,c===null?(e.next=e,gh(a)):(e.next=c.next,c.next=e),a.interleaved=e,ih(o,s)}function oh(o,e,s){if(e=e.updateQueue,e!==null&&(e=e.shared,(s&4194240)!==0)){var a=e.lanes;a&=o.pendingLanes,s|=a,e.lanes=s,Cc(o,s)}}function ph(o,e){var s=o.updateQueue,a=o.alternate;if(a!==null&&(a=a.updateQueue,s===a)){var c=null,d=null;if(s=s.firstBaseUpdate,s!==null){do{var b={eventTime:s.eventTime,lane:s.lane,tag:s.tag,payload:s.payload,callback:s.callback,next:null};d===null?c=d=b:d=d.next=b,s=s.next}while(s!==null);d===null?c=d=e:d=d.next=e}else c=d=e;s={baseState:a.baseState,firstBaseUpdate:c,lastBaseUpdate:d,shared:a.shared,effects:a.effects},o.updateQueue=s;return}o=s.lastBaseUpdate,o===null?s.firstBaseUpdate=e:o.next=e,s.lastBaseUpdate=e}function qh(o,e,s,a){var c=o.updateQueue;jh=!1;var d=c.firstBaseUpdate,b=c.lastBaseUpdate,_e=c.shared.pending;if(_e!==null){c.shared.pending=null;var tt=_e,nt=tt.next;tt.next=null,b===null?d=nt:b.next=nt,b=tt;var it=o.alternate;it!==null&&(it=it.updateQueue,_e=it.lastBaseUpdate,_e!==b&&(_e===null?it.firstBaseUpdate=nt:_e.next=nt,it.lastBaseUpdate=tt))}if(d!==null){var ot=c.baseState;b=0,it=nt=tt=null,_e=d;do{var at=_e.lane,ct=_e.eventTime;if((a&at)===at){it!==null&&(it=it.next={eventTime:ct,lane:0,tag:_e.tag,payload:_e.payload,callback:_e.callback,next:null});e:{var ut=o,ft=_e;switch(at=e,ct=s,ft.tag){case 1:if(ut=ft.payload,typeof ut=="function"){ot=ut.call(ct,ot,at);break e}ot=ut;break e;case 3:ut.flags=ut.flags&-65537|128;case 0:if(ut=ft.payload,at=typeof ut=="function"?ut.call(ct,ot,at):ut,at==null)break e;ot=A({},ot,at);break e;case 2:jh=!0}}_e.callback!==null&&_e.lane!==0&&(o.flags|=64,at=c.effects,at===null?c.effects=[_e]:at.push(_e))}else ct={eventTime:ct,lane:at,tag:_e.tag,payload:_e.payload,callback:_e.callback,next:null},it===null?(nt=it=ct,tt=ot):it=it.next=ct,b|=at;if(_e=_e.next,_e===null){if(_e=c.shared.pending,_e===null)break;at=_e,_e=at.next,at.next=null,c.lastBaseUpdate=at,c.shared.pending=null}}while(!0);if(it===null&&(tt=ot),c.baseState=tt,c.firstBaseUpdate=nt,c.lastBaseUpdate=it,e=c.shared.interleaved,e!==null){c=e;do b|=c.lane,c=c.next;while(c!==e)}else d===null&&(c.shared.lanes=0);rh|=b,o.lanes=b,o.memoizedState=ot}}function sh(o,e,s){if(o=e.effects,e.effects=null,o!==null)for(e=0;e<o.length;e++){var a=o[e],c=a.callback;if(c!==null){if(a.callback=null,a=s,typeof c!="function")throw Error(p(191,c));c.call(a)}}}var th={},uh=Uf(th),vh=Uf(th),wh=Uf(th);function xh(o){if(o===th)throw Error(p(174));return o}function yh(o,e){switch(G(wh,e),G(vh,o),G(uh,th),o=e.nodeType,o){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:lb(null,"");break;default:o=o===8?e.parentNode:e,e=o.namespaceURI||null,o=o.tagName,e=lb(e,o)}E$1(uh),G(uh,e)}function zh(){E$1(uh),E$1(vh),E$1(wh)}function Ah(o){xh(wh.current);var e=xh(uh.current),s=lb(e,o.type);e!==s&&(G(vh,o),G(uh,s))}function Bh(o){vh.current===o&&(E$1(uh),E$1(vh))}var L=Uf(0);function Ch(o){for(var e=o;e!==null;){if(e.tag===13){var s=e.memoizedState;if(s!==null&&(s=s.dehydrated,s===null||s.data==="$?"||s.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===o)break;for(;e.sibling===null;){if(e.return===null||e.return===o)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Dh=[];function Eh(){for(var o=0;o<Dh.length;o++)Dh[o]._workInProgressVersionPrimary=null;Dh.length=0}var Fh=ua.ReactCurrentDispatcher,Gh=ua.ReactCurrentBatchConfig,Hh=0,M=null,N=null,O=null,Ih=!1,Jh=!1,Kh=0,Lh=0;function P(){throw Error(p(321))}function Mh(o,e){if(e===null)return!1;for(var s=0;s<e.length&&s<o.length;s++)if(!He$1(o[s],e[s]))return!1;return!0}function Nh(o,e,s,a,c,d){if(Hh=d,M=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Fh.current=o===null||o.memoizedState===null?Oh:Ph,o=s(a,c),Jh){d=0;do{if(Jh=!1,Kh=0,25<=d)throw Error(p(301));d+=1,O=N=null,e.updateQueue=null,Fh.current=Qh,o=s(a,c)}while(Jh)}if(Fh.current=Rh,e=N!==null&&N.next!==null,Hh=0,O=N=M=null,Ih=!1,e)throw Error(p(300));return o}function Sh(){var o=Kh!==0;return Kh=0,o}function Th(){var o={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return O===null?M.memoizedState=O=o:O=O.next=o,O}function Uh(){if(N===null){var o=M.alternate;o=o!==null?o.memoizedState:null}else o=N.next;var e=O===null?M.memoizedState:O.next;if(e!==null)O=e,N=o;else{if(o===null)throw Error(p(310));N=o,o={memoizedState:N.memoizedState,baseState:N.baseState,baseQueue:N.baseQueue,queue:N.queue,next:null},O===null?M.memoizedState=O=o:O=O.next=o}return O}function Vh(o,e){return typeof e=="function"?e(o):e}function Wh(o){var e=Uh(),s=e.queue;if(s===null)throw Error(p(311));s.lastRenderedReducer=o;var a=N,c=a.baseQueue,d=s.pending;if(d!==null){if(c!==null){var b=c.next;c.next=d.next,d.next=b}a.baseQueue=c=d,s.pending=null}if(c!==null){d=c.next,a=a.baseState;var _e=b=null,tt=null,nt=d;do{var it=nt.lane;if((Hh&it)===it)tt!==null&&(tt=tt.next={lane:0,action:nt.action,hasEagerState:nt.hasEagerState,eagerState:nt.eagerState,next:null}),a=nt.hasEagerState?nt.eagerState:o(a,nt.action);else{var ot={lane:it,action:nt.action,hasEagerState:nt.hasEagerState,eagerState:nt.eagerState,next:null};tt===null?(_e=tt=ot,b=a):tt=tt.next=ot,M.lanes|=it,rh|=it}nt=nt.next}while(nt!==null&&nt!==d);tt===null?b=a:tt.next=_e,He$1(a,e.memoizedState)||(dh=!0),e.memoizedState=a,e.baseState=b,e.baseQueue=tt,s.lastRenderedState=a}if(o=s.interleaved,o!==null){c=o;do d=c.lane,M.lanes|=d,rh|=d,c=c.next;while(c!==o)}else c===null&&(s.lanes=0);return[e.memoizedState,s.dispatch]}function Xh(o){var e=Uh(),s=e.queue;if(s===null)throw Error(p(311));s.lastRenderedReducer=o;var a=s.dispatch,c=s.pending,d=e.memoizedState;if(c!==null){s.pending=null;var b=c=c.next;do d=o(d,b.action),b=b.next;while(b!==c);He$1(d,e.memoizedState)||(dh=!0),e.memoizedState=d,e.baseQueue===null&&(e.baseState=d),s.lastRenderedState=d}return[d,a]}function Yh(){}function Zh(o,e){var s=M,a=Uh(),c=e(),d=!He$1(a.memoizedState,c);if(d&&(a.memoizedState=c,dh=!0),a=a.queue,$h(ai.bind(null,s,a,o),[o]),a.getSnapshot!==e||d||O!==null&&O.memoizedState.tag&1){if(s.flags|=2048,bi(9,ci.bind(null,s,a,c,e),void 0,null),Q===null)throw Error(p(349));Hh&30||di(s,e,c)}return c}function di(o,e,s){o.flags|=16384,o={getSnapshot:e,value:s},e=M.updateQueue,e===null?(e={lastEffect:null,stores:null},M.updateQueue=e,e.stores=[o]):(s=e.stores,s===null?e.stores=[o]:s.push(o))}function ci(o,e,s,a){e.value=s,e.getSnapshot=a,ei(e)&&fi(o)}function ai(o,e,s){return s(function(){ei(e)&&fi(o)})}function ei(o){var e=o.getSnapshot;o=o.value;try{var s=e();return!He$1(o,s)}catch{return!0}}function fi(o){var e=ih(o,1);e!==null&&gi(e,o,1,-1)}function hi(o){var e=Th();return typeof o=="function"&&(o=o()),e.memoizedState=e.baseState=o,o={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Vh,lastRenderedState:o},e.queue=o,o=o.dispatch=ii.bind(null,M,o),[e.memoizedState,o]}function bi(o,e,s,a){return o={tag:o,create:e,destroy:s,deps:a,next:null},e=M.updateQueue,e===null?(e={lastEffect:null,stores:null},M.updateQueue=e,e.lastEffect=o.next=o):(s=e.lastEffect,s===null?e.lastEffect=o.next=o:(a=s.next,s.next=o,o.next=a,e.lastEffect=o)),o}function ji(){return Uh().memoizedState}function ki(o,e,s,a){var c=Th();M.flags|=o,c.memoizedState=bi(1|e,s,void 0,a===void 0?null:a)}function li(o,e,s,a){var c=Uh();a=a===void 0?null:a;var d=void 0;if(N!==null){var b=N.memoizedState;if(d=b.destroy,a!==null&&Mh(a,b.deps)){c.memoizedState=bi(e,s,d,a);return}}M.flags|=o,c.memoizedState=bi(1|e,s,d,a)}function mi(o,e){return ki(8390656,8,o,e)}function $h(o,e){return li(2048,8,o,e)}function ni(o,e){return li(4,2,o,e)}function oi(o,e){return li(4,4,o,e)}function pi(o,e){if(typeof e=="function")return o=o(),e(o),function(){e(null)};if(e!=null)return o=o(),e.current=o,function(){e.current=null}}function qi(o,e,s){return s=s!=null?s.concat([o]):null,li(4,4,pi.bind(null,e,o),s)}function ri(){}function si(o,e){var s=Uh();e=e===void 0?null:e;var a=s.memoizedState;return a!==null&&e!==null&&Mh(e,a[1])?a[0]:(s.memoizedState=[o,e],o)}function ti(o,e){var s=Uh();e=e===void 0?null:e;var a=s.memoizedState;return a!==null&&e!==null&&Mh(e,a[1])?a[0]:(o=o(),s.memoizedState=[o,e],o)}function ui(o,e,s){return Hh&21?(He$1(s,e)||(s=yc(),M.lanes|=s,rh|=s,o.baseState=!0),e):(o.baseState&&(o.baseState=!1,dh=!0),o.memoizedState=s)}function vi(o,e){var s=C;C=s!==0&&4>s?s:4,o(!0);var a=Gh.transition;Gh.transition={};try{o(!1),e()}finally{C=s,Gh.transition=a}}function wi(){return Uh().memoizedState}function xi(o,e,s){var a=yi(o);if(s={lane:a,action:s,hasEagerState:!1,eagerState:null,next:null},zi(o))Ai(e,s);else if(s=hh(o,e,s,a),s!==null){var c=R();gi(s,o,a,c),Bi(s,e,a)}}function ii(o,e,s){var a=yi(o),c={lane:a,action:s,hasEagerState:!1,eagerState:null,next:null};if(zi(o))Ai(e,c);else{var d=o.alternate;if(o.lanes===0&&(d===null||d.lanes===0)&&(d=e.lastRenderedReducer,d!==null))try{var b=e.lastRenderedState,_e=d(b,s);if(c.hasEagerState=!0,c.eagerState=_e,He$1(_e,b)){var tt=e.interleaved;tt===null?(c.next=c,gh(e)):(c.next=tt.next,tt.next=c),e.interleaved=c;return}}catch{}finally{}s=hh(o,e,c,a),s!==null&&(c=R(),gi(s,o,a,c),Bi(s,e,a))}}function zi(o){var e=o.alternate;return o===M||e!==null&&e===M}function Ai(o,e){Jh=Ih=!0;var s=o.pending;s===null?e.next=e:(e.next=s.next,s.next=e),o.pending=e}function Bi(o,e,s){if(s&4194240){var a=e.lanes;a&=o.pendingLanes,s|=a,e.lanes=s,Cc(o,s)}}var Rh={readContext:eh,useCallback:P,useContext:P,useEffect:P,useImperativeHandle:P,useInsertionEffect:P,useLayoutEffect:P,useMemo:P,useReducer:P,useRef:P,useState:P,useDebugValue:P,useDeferredValue:P,useTransition:P,useMutableSource:P,useSyncExternalStore:P,useId:P,unstable_isNewReconciler:!1},Oh={readContext:eh,useCallback:function(o,e){return Th().memoizedState=[o,e===void 0?null:e],o},useContext:eh,useEffect:mi,useImperativeHandle:function(o,e,s){return s=s!=null?s.concat([o]):null,ki(4194308,4,pi.bind(null,e,o),s)},useLayoutEffect:function(o,e){return ki(4194308,4,o,e)},useInsertionEffect:function(o,e){return ki(4,2,o,e)},useMemo:function(o,e){var s=Th();return e=e===void 0?null:e,o=o(),s.memoizedState=[o,e],o},useReducer:function(o,e,s){var a=Th();return e=s!==void 0?s(e):e,a.memoizedState=a.baseState=e,o={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:o,lastRenderedState:e},a.queue=o,o=o.dispatch=xi.bind(null,M,o),[a.memoizedState,o]},useRef:function(o){var e=Th();return o={current:o},e.memoizedState=o},useState:hi,useDebugValue:ri,useDeferredValue:function(o){return Th().memoizedState=o},useTransition:function(){var o=hi(!1),e=o[0];return o=vi.bind(null,o[1]),Th().memoizedState=o,[e,o]},useMutableSource:function(){},useSyncExternalStore:function(o,e,s){var a=M,c=Th();if(I){if(s===void 0)throw Error(p(407));s=s()}else{if(s=e(),Q===null)throw Error(p(349));Hh&30||di(a,e,s)}c.memoizedState=s;var d={value:s,getSnapshot:e};return c.queue=d,mi(ai.bind(null,a,d,o),[o]),a.flags|=2048,bi(9,ci.bind(null,a,d,s,e),void 0,null),s},useId:function(){var o=Th(),e=Q.identifierPrefix;if(I){var s=sg,a=rg;s=(a&~(1<<32-oc(a)-1)).toString(32)+s,e=":"+e+"R"+s,s=Kh++,0<s&&(e+="H"+s.toString(32)),e+=":"}else s=Lh++,e=":"+e+"r"+s.toString(32)+":";return o.memoizedState=e},unstable_isNewReconciler:!1},Ph={readContext:eh,useCallback:si,useContext:eh,useEffect:$h,useImperativeHandle:qi,useInsertionEffect:ni,useLayoutEffect:oi,useMemo:ti,useReducer:Wh,useRef:ji,useState:function(){return Wh(Vh)},useDebugValue:ri,useDeferredValue:function(o){var e=Uh();return ui(e,N.memoizedState,o)},useTransition:function(){var o=Wh(Vh)[0],e=Uh().memoizedState;return[o,e]},useMutableSource:Yh,useSyncExternalStore:Zh,useId:wi,unstable_isNewReconciler:!1},Qh={readContext:eh,useCallback:si,useContext:eh,useEffect:$h,useImperativeHandle:qi,useInsertionEffect:ni,useLayoutEffect:oi,useMemo:ti,useReducer:Xh,useRef:ji,useState:function(){return Xh(Vh)},useDebugValue:ri,useDeferredValue:function(o){var e=Uh();return N===null?e.memoizedState=o:ui(e,N.memoizedState,o)},useTransition:function(){var o=Xh(Vh)[0],e=Uh().memoizedState;return[o,e]},useMutableSource:Yh,useSyncExternalStore:Zh,useId:wi,unstable_isNewReconciler:!1};function Ci(o,e){if(o&&o.defaultProps){e=A({},e),o=o.defaultProps;for(var s in o)e[s]===void 0&&(e[s]=o[s]);return e}return e}function Di(o,e,s,a){e=o.memoizedState,s=s(a,e),s=s==null?e:A({},e,s),o.memoizedState=s,o.lanes===0&&(o.updateQueue.baseState=s)}var Ei={isMounted:function(o){return(o=o._reactInternals)?Vb(o)===o:!1},enqueueSetState:function(o,e,s){o=o._reactInternals;var a=R(),c=yi(o),d=mh(a,c);d.payload=e,s!=null&&(d.callback=s),e=nh(o,d,c),e!==null&&(gi(e,o,c,a),oh(e,o,c))},enqueueReplaceState:function(o,e,s){o=o._reactInternals;var a=R(),c=yi(o),d=mh(a,c);d.tag=1,d.payload=e,s!=null&&(d.callback=s),e=nh(o,d,c),e!==null&&(gi(e,o,c,a),oh(e,o,c))},enqueueForceUpdate:function(o,e){o=o._reactInternals;var s=R(),a=yi(o),c=mh(s,a);c.tag=2,e!=null&&(c.callback=e),e=nh(o,c,a),e!==null&&(gi(e,o,a,s),oh(e,o,a))}};function Fi(o,e,s,a,c,d,b){return o=o.stateNode,typeof o.shouldComponentUpdate=="function"?o.shouldComponentUpdate(a,d,b):e.prototype&&e.prototype.isPureReactComponent?!Ie(s,a)||!Ie(c,d):!0}function Gi(o,e,s){var a=!1,c=Vf,d=e.contextType;return typeof d=="object"&&d!==null?d=eh(d):(c=Zf(e)?Xf:H$1.current,a=e.contextTypes,d=(a=a!=null)?Yf(o,c):Vf),e=new e(s,d),o.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Ei,o.stateNode=e,e._reactInternals=o,a&&(o=o.stateNode,o.__reactInternalMemoizedUnmaskedChildContext=c,o.__reactInternalMemoizedMaskedChildContext=d),e}function Hi(o,e,s,a){o=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(s,a),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(s,a),e.state!==o&&Ei.enqueueReplaceState(e,e.state,null)}function Ii(o,e,s,a){var c=o.stateNode;c.props=s,c.state=o.memoizedState,c.refs={},kh(o);var d=e.contextType;typeof d=="object"&&d!==null?c.context=eh(d):(d=Zf(e)?Xf:H$1.current,c.context=Yf(o,d)),c.state=o.memoizedState,d=e.getDerivedStateFromProps,typeof d=="function"&&(Di(o,e,d,s),c.state=o.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof c.getSnapshotBeforeUpdate=="function"||typeof c.UNSAFE_componentWillMount!="function"&&typeof c.componentWillMount!="function"||(e=c.state,typeof c.componentWillMount=="function"&&c.componentWillMount(),typeof c.UNSAFE_componentWillMount=="function"&&c.UNSAFE_componentWillMount(),e!==c.state&&Ei.enqueueReplaceState(c,c.state,null),qh(o,s,c,a),c.state=o.memoizedState),typeof c.componentDidMount=="function"&&(o.flags|=4194308)}function Ji(o,e){try{var s="",a=e;do s+=Pa(a),a=a.return;while(a);var c=s}catch(d){c=`
Error generating stack: `+d.message+`
`+d.stack}return{value:o,source:e,stack:c,digest:null}}function Ki(o,e,s){return{value:o,source:null,stack:s??null,digest:e??null}}function Li(o,e){try{console.error(e.value)}catch(s){setTimeout(function(){throw s})}}var Mi=typeof WeakMap=="function"?WeakMap:Map;function Ni(o,e,s){s=mh(-1,s),s.tag=3,s.payload={element:null};var a=e.value;return s.callback=function(){Oi||(Oi=!0,Pi=a),Li(o,e)},s}function Qi(o,e,s){s=mh(-1,s),s.tag=3;var a=o.type.getDerivedStateFromError;if(typeof a=="function"){var c=e.value;s.payload=function(){return a(c)},s.callback=function(){Li(o,e)}}var d=o.stateNode;return d!==null&&typeof d.componentDidCatch=="function"&&(s.callback=function(){Li(o,e),typeof a!="function"&&(Ri===null?Ri=new Set([this]):Ri.add(this));var b=e.stack;this.componentDidCatch(e.value,{componentStack:b!==null?b:""})}),s}function Si(o,e,s){var a=o.pingCache;if(a===null){a=o.pingCache=new Mi;var c=new Set;a.set(e,c)}else c=a.get(e),c===void 0&&(c=new Set,a.set(e,c));c.has(s)||(c.add(s),o=Ti.bind(null,o,e,s),e.then(o,o))}function Ui(o){do{var e;if((e=o.tag===13)&&(e=o.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return o;o=o.return}while(o!==null);return null}function Vi(o,e,s,a,c){return o.mode&1?(o.flags|=65536,o.lanes=c,o):(o===e?o.flags|=65536:(o.flags|=128,s.flags|=131072,s.flags&=-52805,s.tag===1&&(s.alternate===null?s.tag=17:(e=mh(-1,1),e.tag=2,nh(s,e,1))),s.lanes|=1),o)}var Wi=ua.ReactCurrentOwner,dh=!1;function Xi(o,e,s,a){e.child=o===null?Vg(e,null,s,a):Ug(e,o.child,s,a)}function Yi(o,e,s,a,c){s=s.render;var d=e.ref;return ch(e,c),a=Nh(o,e,s,a,d,c),s=Sh(),o!==null&&!dh?(e.updateQueue=o.updateQueue,e.flags&=-2053,o.lanes&=~c,Zi(o,e,c)):(I&&s&&vg(e),e.flags|=1,Xi(o,e,a,c),e.child)}function $i(o,e,s,a,c){if(o===null){var d=s.type;return typeof d=="function"&&!aj(d)&&d.defaultProps===void 0&&s.compare===null&&s.defaultProps===void 0?(e.tag=15,e.type=d,bj(o,e,d,a,c)):(o=Rg(s.type,null,a,e,e.mode,c),o.ref=e.ref,o.return=e,e.child=o)}if(d=o.child,!(o.lanes&c)){var b=d.memoizedProps;if(s=s.compare,s=s!==null?s:Ie,s(b,a)&&o.ref===e.ref)return Zi(o,e,c)}return e.flags|=1,o=Pg(d,a),o.ref=e.ref,o.return=e,e.child=o}function bj(o,e,s,a,c){if(o!==null){var d=o.memoizedProps;if(Ie(d,a)&&o.ref===e.ref)if(dh=!1,e.pendingProps=a=d,(o.lanes&c)!==0)o.flags&131072&&(dh=!0);else return e.lanes=o.lanes,Zi(o,e,c)}return cj(o,e,s,a,c)}function dj(o,e,s){var a=e.pendingProps,c=a.children,d=o!==null?o.memoizedState:null;if(a.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},G(ej,fj),fj|=s;else{if(!(s&1073741824))return o=d!==null?d.baseLanes|s:s,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:o,cachePool:null,transitions:null},e.updateQueue=null,G(ej,fj),fj|=o,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},a=d!==null?d.baseLanes:s,G(ej,fj),fj|=a}else d!==null?(a=d.baseLanes|s,e.memoizedState=null):a=s,G(ej,fj),fj|=a;return Xi(o,e,c,s),e.child}function gj(o,e){var s=e.ref;(o===null&&s!==null||o!==null&&o.ref!==s)&&(e.flags|=512,e.flags|=2097152)}function cj(o,e,s,a,c){var d=Zf(s)?Xf:H$1.current;return d=Yf(e,d),ch(e,c),s=Nh(o,e,s,a,d,c),a=Sh(),o!==null&&!dh?(e.updateQueue=o.updateQueue,e.flags&=-2053,o.lanes&=~c,Zi(o,e,c)):(I&&a&&vg(e),e.flags|=1,Xi(o,e,s,c),e.child)}function hj(o,e,s,a,c){if(Zf(s)){var d=!0;cg(e)}else d=!1;if(ch(e,c),e.stateNode===null)ij(o,e),Gi(e,s,a),Ii(e,s,a,c),a=!0;else if(o===null){var b=e.stateNode,_e=e.memoizedProps;b.props=_e;var tt=b.context,nt=s.contextType;typeof nt=="object"&&nt!==null?nt=eh(nt):(nt=Zf(s)?Xf:H$1.current,nt=Yf(e,nt));var it=s.getDerivedStateFromProps,ot=typeof it=="function"||typeof b.getSnapshotBeforeUpdate=="function";ot||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(_e!==a||tt!==nt)&&Hi(e,b,a,nt),jh=!1;var at=e.memoizedState;b.state=at,qh(e,a,b,c),tt=e.memoizedState,_e!==a||at!==tt||Wf.current||jh?(typeof it=="function"&&(Di(e,s,it,a),tt=e.memoizedState),(_e=jh||Fi(e,s,_e,a,at,tt,nt))?(ot||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount()),typeof b.componentDidMount=="function"&&(e.flags|=4194308)):(typeof b.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=a,e.memoizedState=tt),b.props=a,b.state=tt,b.context=nt,a=_e):(typeof b.componentDidMount=="function"&&(e.flags|=4194308),a=!1)}else{b=e.stateNode,lh(o,e),_e=e.memoizedProps,nt=e.type===e.elementType?_e:Ci(e.type,_e),b.props=nt,ot=e.pendingProps,at=b.context,tt=s.contextType,typeof tt=="object"&&tt!==null?tt=eh(tt):(tt=Zf(s)?Xf:H$1.current,tt=Yf(e,tt));var ct=s.getDerivedStateFromProps;(it=typeof ct=="function"||typeof b.getSnapshotBeforeUpdate=="function")||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(_e!==ot||at!==tt)&&Hi(e,b,a,tt),jh=!1,at=e.memoizedState,b.state=at,qh(e,a,b,c);var ut=e.memoizedState;_e!==ot||at!==ut||Wf.current||jh?(typeof ct=="function"&&(Di(e,s,ct,a),ut=e.memoizedState),(nt=jh||Fi(e,s,nt,a,at,ut,tt)||!1)?(it||typeof b.UNSAFE_componentWillUpdate!="function"&&typeof b.componentWillUpdate!="function"||(typeof b.componentWillUpdate=="function"&&b.componentWillUpdate(a,ut,tt),typeof b.UNSAFE_componentWillUpdate=="function"&&b.UNSAFE_componentWillUpdate(a,ut,tt)),typeof b.componentDidUpdate=="function"&&(e.flags|=4),typeof b.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof b.componentDidUpdate!="function"||_e===o.memoizedProps&&at===o.memoizedState||(e.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||_e===o.memoizedProps&&at===o.memoizedState||(e.flags|=1024),e.memoizedProps=a,e.memoizedState=ut),b.props=a,b.state=ut,b.context=tt,a=nt):(typeof b.componentDidUpdate!="function"||_e===o.memoizedProps&&at===o.memoizedState||(e.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||_e===o.memoizedProps&&at===o.memoizedState||(e.flags|=1024),a=!1)}return jj(o,e,s,a,d,c)}function jj(o,e,s,a,c,d){gj(o,e);var b=(e.flags&128)!==0;if(!a&&!b)return c&&dg(e,s,!1),Zi(o,e,d);a=e.stateNode,Wi.current=e;var _e=b&&typeof s.getDerivedStateFromError!="function"?null:a.render();return e.flags|=1,o!==null&&b?(e.child=Ug(e,o.child,null,d),e.child=Ug(e,null,_e,d)):Xi(o,e,_e,d),e.memoizedState=a.state,c&&dg(e,s,!0),e.child}function kj(o){var e=o.stateNode;e.pendingContext?ag(o,e.pendingContext,e.pendingContext!==e.context):e.context&&ag(o,e.context,!1),yh(o,e.containerInfo)}function lj(o,e,s,a,c){return Ig(),Jg(c),e.flags|=256,Xi(o,e,s,a),e.child}var mj={dehydrated:null,treeContext:null,retryLane:0};function nj(o){return{baseLanes:o,cachePool:null,transitions:null}}function oj(o,e,s){var a=e.pendingProps,c=L.current,d=!1,b=(e.flags&128)!==0,_e;if((_e=b)||(_e=o!==null&&o.memoizedState===null?!1:(c&2)!==0),_e?(d=!0,e.flags&=-129):(o===null||o.memoizedState!==null)&&(c|=1),G(L,c&1),o===null)return Eg(e),o=e.memoizedState,o!==null&&(o=o.dehydrated,o!==null)?(e.mode&1?o.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(b=a.children,o=a.fallback,d?(a=e.mode,d=e.child,b={mode:"hidden",children:b},!(a&1)&&d!==null?(d.childLanes=0,d.pendingProps=b):d=pj(b,a,0,null),o=Tg(o,a,s,null),d.return=e,o.return=e,d.sibling=o,e.child=d,e.child.memoizedState=nj(s),e.memoizedState=mj,o):qj(e,b));if(c=o.memoizedState,c!==null&&(_e=c.dehydrated,_e!==null))return rj(o,e,b,a,_e,c,s);if(d){d=a.fallback,b=e.mode,c=o.child,_e=c.sibling;var tt={mode:"hidden",children:a.children};return!(b&1)&&e.child!==c?(a=e.child,a.childLanes=0,a.pendingProps=tt,e.deletions=null):(a=Pg(c,tt),a.subtreeFlags=c.subtreeFlags&14680064),_e!==null?d=Pg(_e,d):(d=Tg(d,b,s,null),d.flags|=2),d.return=e,a.return=e,a.sibling=d,e.child=a,a=d,d=e.child,b=o.child.memoizedState,b=b===null?nj(s):{baseLanes:b.baseLanes|s,cachePool:null,transitions:b.transitions},d.memoizedState=b,d.childLanes=o.childLanes&~s,e.memoizedState=mj,a}return d=o.child,o=d.sibling,a=Pg(d,{mode:"visible",children:a.children}),!(e.mode&1)&&(a.lanes=s),a.return=e,a.sibling=null,o!==null&&(s=e.deletions,s===null?(e.deletions=[o],e.flags|=16):s.push(o)),e.child=a,e.memoizedState=null,a}function qj(o,e){return e=pj({mode:"visible",children:e},o.mode,0,null),e.return=o,o.child=e}function sj(o,e,s,a){return a!==null&&Jg(a),Ug(e,o.child,null,s),o=qj(e,e.pendingProps.children),o.flags|=2,e.memoizedState=null,o}function rj(o,e,s,a,c,d,b){if(s)return e.flags&256?(e.flags&=-257,a=Ki(Error(p(422))),sj(o,e,b,a)):e.memoizedState!==null?(e.child=o.child,e.flags|=128,null):(d=a.fallback,c=e.mode,a=pj({mode:"visible",children:a.children},c,0,null),d=Tg(d,c,b,null),d.flags|=2,a.return=e,d.return=e,a.sibling=d,e.child=a,e.mode&1&&Ug(e,o.child,null,b),e.child.memoizedState=nj(b),e.memoizedState=mj,d);if(!(e.mode&1))return sj(o,e,b,null);if(c.data==="$!"){if(a=c.nextSibling&&c.nextSibling.dataset,a)var _e=a.dgst;return a=_e,d=Error(p(419)),a=Ki(d,a,void 0),sj(o,e,b,a)}if(_e=(b&o.childLanes)!==0,dh||_e){if(a=Q,a!==null){switch(b&-b){case 4:c=2;break;case 16:c=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:c=32;break;case 536870912:c=268435456;break;default:c=0}c=c&(a.suspendedLanes|b)?0:c,c!==0&&c!==d.retryLane&&(d.retryLane=c,ih(o,c),gi(a,o,c,-1))}return tj(),a=Ki(Error(p(421))),sj(o,e,b,a)}return c.data==="$?"?(e.flags|=128,e.child=o.child,e=uj.bind(null,o),c._reactRetry=e,null):(o=d.treeContext,yg=Lf(c.nextSibling),xg=e,I=!0,zg=null,o!==null&&(og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,rg=o.id,sg=o.overflow,qg=e),e=qj(e,a.children),e.flags|=4096,e)}function vj(o,e,s){o.lanes|=e;var a=o.alternate;a!==null&&(a.lanes|=e),bh(o.return,e,s)}function wj(o,e,s,a,c){var d=o.memoizedState;d===null?o.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:a,tail:s,tailMode:c}:(d.isBackwards=e,d.rendering=null,d.renderingStartTime=0,d.last=a,d.tail=s,d.tailMode=c)}function xj(o,e,s){var a=e.pendingProps,c=a.revealOrder,d=a.tail;if(Xi(o,e,a.children,s),a=L.current,a&2)a=a&1|2,e.flags|=128;else{if(o!==null&&o.flags&128)e:for(o=e.child;o!==null;){if(o.tag===13)o.memoizedState!==null&&vj(o,s,e);else if(o.tag===19)vj(o,s,e);else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===e)break e;for(;o.sibling===null;){if(o.return===null||o.return===e)break e;o=o.return}o.sibling.return=o.return,o=o.sibling}a&=1}if(G(L,a),!(e.mode&1))e.memoizedState=null;else switch(c){case"forwards":for(s=e.child,c=null;s!==null;)o=s.alternate,o!==null&&Ch(o)===null&&(c=s),s=s.sibling;s=c,s===null?(c=e.child,e.child=null):(c=s.sibling,s.sibling=null),wj(e,!1,c,s,d);break;case"backwards":for(s=null,c=e.child,e.child=null;c!==null;){if(o=c.alternate,o!==null&&Ch(o)===null){e.child=c;break}o=c.sibling,c.sibling=s,s=c,c=o}wj(e,!0,s,null,d);break;case"together":wj(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function ij(o,e){!(e.mode&1)&&o!==null&&(o.alternate=null,e.alternate=null,e.flags|=2)}function Zi(o,e,s){if(o!==null&&(e.dependencies=o.dependencies),rh|=e.lanes,!(s&e.childLanes))return null;if(o!==null&&e.child!==o.child)throw Error(p(153));if(e.child!==null){for(o=e.child,s=Pg(o,o.pendingProps),e.child=s,s.return=e;o.sibling!==null;)o=o.sibling,s=s.sibling=Pg(o,o.pendingProps),s.return=e;s.sibling=null}return e.child}function yj(o,e,s){switch(e.tag){case 3:kj(e),Ig();break;case 5:Ah(e);break;case 1:Zf(e.type)&&cg(e);break;case 4:yh(e,e.stateNode.containerInfo);break;case 10:var a=e.type._context,c=e.memoizedProps.value;G(Wg,a._currentValue),a._currentValue=c;break;case 13:if(a=e.memoizedState,a!==null)return a.dehydrated!==null?(G(L,L.current&1),e.flags|=128,null):s&e.child.childLanes?oj(o,e,s):(G(L,L.current&1),o=Zi(o,e,s),o!==null?o.sibling:null);G(L,L.current&1);break;case 19:if(a=(s&e.childLanes)!==0,o.flags&128){if(a)return xj(o,e,s);e.flags|=128}if(c=e.memoizedState,c!==null&&(c.rendering=null,c.tail=null,c.lastEffect=null),G(L,L.current),a)break;return null;case 22:case 23:return e.lanes=0,dj(o,e,s)}return Zi(o,e,s)}var zj,Aj,Bj,Cj;zj=function(o,e){for(var s=e.child;s!==null;){if(s.tag===5||s.tag===6)o.appendChild(s.stateNode);else if(s.tag!==4&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===e)break;for(;s.sibling===null;){if(s.return===null||s.return===e)return;s=s.return}s.sibling.return=s.return,s=s.sibling}};Aj=function(){};Bj=function(o,e,s,a){var c=o.memoizedProps;if(c!==a){o=e.stateNode,xh(uh.current);var d=null;switch(s){case"input":c=Ya(o,c),a=Ya(o,a),d=[];break;case"select":c=A({},c,{value:void 0}),a=A({},a,{value:void 0}),d=[];break;case"textarea":c=gb(o,c),a=gb(o,a),d=[];break;default:typeof c.onClick!="function"&&typeof a.onClick=="function"&&(o.onclick=Bf)}ub(s,a);var b;s=null;for(nt in c)if(!a.hasOwnProperty(nt)&&c.hasOwnProperty(nt)&&c[nt]!=null)if(nt==="style"){var _e=c[nt];for(b in _e)_e.hasOwnProperty(b)&&(s||(s={}),s[b]="")}else nt!=="dangerouslySetInnerHTML"&&nt!=="children"&&nt!=="suppressContentEditableWarning"&&nt!=="suppressHydrationWarning"&&nt!=="autoFocus"&&(ea.hasOwnProperty(nt)?d||(d=[]):(d=d||[]).push(nt,null));for(nt in a){var tt=a[nt];if(_e=c!=null?c[nt]:void 0,a.hasOwnProperty(nt)&&tt!==_e&&(tt!=null||_e!=null))if(nt==="style")if(_e){for(b in _e)!_e.hasOwnProperty(b)||tt&&tt.hasOwnProperty(b)||(s||(s={}),s[b]="");for(b in tt)tt.hasOwnProperty(b)&&_e[b]!==tt[b]&&(s||(s={}),s[b]=tt[b])}else s||(d||(d=[]),d.push(nt,s)),s=tt;else nt==="dangerouslySetInnerHTML"?(tt=tt?tt.__html:void 0,_e=_e?_e.__html:void 0,tt!=null&&_e!==tt&&(d=d||[]).push(nt,tt)):nt==="children"?typeof tt!="string"&&typeof tt!="number"||(d=d||[]).push(nt,""+tt):nt!=="suppressContentEditableWarning"&&nt!=="suppressHydrationWarning"&&(ea.hasOwnProperty(nt)?(tt!=null&&nt==="onScroll"&&D$2("scroll",o),d||_e===tt||(d=[])):(d=d||[]).push(nt,tt))}s&&(d=d||[]).push("style",s);var nt=d;(e.updateQueue=nt)&&(e.flags|=4)}};Cj=function(o,e,s,a){s!==a&&(e.flags|=4)};function Dj(o,e){if(!I)switch(o.tailMode){case"hidden":e=o.tail;for(var s=null;e!==null;)e.alternate!==null&&(s=e),e=e.sibling;s===null?o.tail=null:s.sibling=null;break;case"collapsed":s=o.tail;for(var a=null;s!==null;)s.alternate!==null&&(a=s),s=s.sibling;a===null?e||o.tail===null?o.tail=null:o.tail.sibling=null:a.sibling=null}}function S(o){var e=o.alternate!==null&&o.alternate.child===o.child,s=0,a=0;if(e)for(var c=o.child;c!==null;)s|=c.lanes|c.childLanes,a|=c.subtreeFlags&14680064,a|=c.flags&14680064,c.return=o,c=c.sibling;else for(c=o.child;c!==null;)s|=c.lanes|c.childLanes,a|=c.subtreeFlags,a|=c.flags,c.return=o,c=c.sibling;return o.subtreeFlags|=a,o.childLanes=s,e}function Ej(o,e,s){var a=e.pendingProps;switch(wg(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return S(e),null;case 1:return Zf(e.type)&&$f(),S(e),null;case 3:return a=e.stateNode,zh(),E$1(Wf),E$1(H$1),Eh(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),(o===null||o.child===null)&&(Gg(e)?e.flags|=4:o===null||o.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,zg!==null&&(Fj(zg),zg=null))),Aj(o,e),S(e),null;case 5:Bh(e);var c=xh(wh.current);if(s=e.type,o!==null&&e.stateNode!=null)Bj(o,e,s,a,c),o.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!a){if(e.stateNode===null)throw Error(p(166));return S(e),null}if(o=xh(uh.current),Gg(e)){a=e.stateNode,s=e.type;var d=e.memoizedProps;switch(a[Of]=e,a[Pf]=d,o=(e.mode&1)!==0,s){case"dialog":D$2("cancel",a),D$2("close",a);break;case"iframe":case"object":case"embed":D$2("load",a);break;case"video":case"audio":for(c=0;c<lf.length;c++)D$2(lf[c],a);break;case"source":D$2("error",a);break;case"img":case"image":case"link":D$2("error",a),D$2("load",a);break;case"details":D$2("toggle",a);break;case"input":Za(a,d),D$2("invalid",a);break;case"select":a._wrapperState={wasMultiple:!!d.multiple},D$2("invalid",a);break;case"textarea":hb(a,d),D$2("invalid",a)}ub(s,d),c=null;for(var b in d)if(d.hasOwnProperty(b)){var _e=d[b];b==="children"?typeof _e=="string"?a.textContent!==_e&&(d.suppressHydrationWarning!==!0&&Af(a.textContent,_e,o),c=["children",_e]):typeof _e=="number"&&a.textContent!==""+_e&&(d.suppressHydrationWarning!==!0&&Af(a.textContent,_e,o),c=["children",""+_e]):ea.hasOwnProperty(b)&&_e!=null&&b==="onScroll"&&D$2("scroll",a)}switch(s){case"input":Va(a),db(a,d,!0);break;case"textarea":Va(a),jb(a);break;case"select":case"option":break;default:typeof d.onClick=="function"&&(a.onclick=Bf)}a=c,e.updateQueue=a,a!==null&&(e.flags|=4)}else{b=c.nodeType===9?c:c.ownerDocument,o==="http://www.w3.org/1999/xhtml"&&(o=kb(s)),o==="http://www.w3.org/1999/xhtml"?s==="script"?(o=b.createElement("div"),o.innerHTML="<script><\/script>",o=o.removeChild(o.firstChild)):typeof a.is=="string"?o=b.createElement(s,{is:a.is}):(o=b.createElement(s),s==="select"&&(b=o,a.multiple?b.multiple=!0:a.size&&(b.size=a.size))):o=b.createElementNS(o,s),o[Of]=e,o[Pf]=a,zj(o,e,!1,!1),e.stateNode=o;e:{switch(b=vb(s,a),s){case"dialog":D$2("cancel",o),D$2("close",o),c=a;break;case"iframe":case"object":case"embed":D$2("load",o),c=a;break;case"video":case"audio":for(c=0;c<lf.length;c++)D$2(lf[c],o);c=a;break;case"source":D$2("error",o),c=a;break;case"img":case"image":case"link":D$2("error",o),D$2("load",o),c=a;break;case"details":D$2("toggle",o),c=a;break;case"input":Za(o,a),c=Ya(o,a),D$2("invalid",o);break;case"option":c=a;break;case"select":o._wrapperState={wasMultiple:!!a.multiple},c=A({},a,{value:void 0}),D$2("invalid",o);break;case"textarea":hb(o,a),c=gb(o,a),D$2("invalid",o);break;default:c=a}ub(s,c),_e=c;for(d in _e)if(_e.hasOwnProperty(d)){var tt=_e[d];d==="style"?sb(o,tt):d==="dangerouslySetInnerHTML"?(tt=tt?tt.__html:void 0,tt!=null&&nb(o,tt)):d==="children"?typeof tt=="string"?(s!=="textarea"||tt!=="")&&ob(o,tt):typeof tt=="number"&&ob(o,""+tt):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(ea.hasOwnProperty(d)?tt!=null&&d==="onScroll"&&D$2("scroll",o):tt!=null&&ta(o,d,tt,b))}switch(s){case"input":Va(o),db(o,a,!1);break;case"textarea":Va(o),jb(o);break;case"option":a.value!=null&&o.setAttribute("value",""+Sa(a.value));break;case"select":o.multiple=!!a.multiple,d=a.value,d!=null?fb(o,!!a.multiple,d,!1):a.defaultValue!=null&&fb(o,!!a.multiple,a.defaultValue,!0);break;default:typeof c.onClick=="function"&&(o.onclick=Bf)}switch(s){case"button":case"input":case"select":case"textarea":a=!!a.autoFocus;break e;case"img":a=!0;break e;default:a=!1}}a&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return S(e),null;case 6:if(o&&e.stateNode!=null)Cj(o,e,o.memoizedProps,a);else{if(typeof a!="string"&&e.stateNode===null)throw Error(p(166));if(s=xh(wh.current),xh(uh.current),Gg(e)){if(a=e.stateNode,s=e.memoizedProps,a[Of]=e,(d=a.nodeValue!==s)&&(o=xg,o!==null))switch(o.tag){case 3:Af(a.nodeValue,s,(o.mode&1)!==0);break;case 5:o.memoizedProps.suppressHydrationWarning!==!0&&Af(a.nodeValue,s,(o.mode&1)!==0)}d&&(e.flags|=4)}else a=(s.nodeType===9?s:s.ownerDocument).createTextNode(a),a[Of]=e,e.stateNode=a}return S(e),null;case 13:if(E$1(L),a=e.memoizedState,o===null||o.memoizedState!==null&&o.memoizedState.dehydrated!==null){if(I&&yg!==null&&e.mode&1&&!(e.flags&128))Hg(),Ig(),e.flags|=98560,d=!1;else if(d=Gg(e),a!==null&&a.dehydrated!==null){if(o===null){if(!d)throw Error(p(318));if(d=e.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(p(317));d[Of]=e}else Ig(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;S(e),d=!1}else zg!==null&&(Fj(zg),zg=null),d=!0;if(!d)return e.flags&65536?e:null}return e.flags&128?(e.lanes=s,e):(a=a!==null,a!==(o!==null&&o.memoizedState!==null)&&a&&(e.child.flags|=8192,e.mode&1&&(o===null||L.current&1?T===0&&(T=3):tj())),e.updateQueue!==null&&(e.flags|=4),S(e),null);case 4:return zh(),Aj(o,e),o===null&&sf(e.stateNode.containerInfo),S(e),null;case 10:return ah(e.type._context),S(e),null;case 17:return Zf(e.type)&&$f(),S(e),null;case 19:if(E$1(L),d=e.memoizedState,d===null)return S(e),null;if(a=(e.flags&128)!==0,b=d.rendering,b===null)if(a)Dj(d,!1);else{if(T!==0||o!==null&&o.flags&128)for(o=e.child;o!==null;){if(b=Ch(o),b!==null){for(e.flags|=128,Dj(d,!1),a=b.updateQueue,a!==null&&(e.updateQueue=a,e.flags|=4),e.subtreeFlags=0,a=s,s=e.child;s!==null;)d=s,o=a,d.flags&=14680066,b=d.alternate,b===null?(d.childLanes=0,d.lanes=o,d.child=null,d.subtreeFlags=0,d.memoizedProps=null,d.memoizedState=null,d.updateQueue=null,d.dependencies=null,d.stateNode=null):(d.childLanes=b.childLanes,d.lanes=b.lanes,d.child=b.child,d.subtreeFlags=0,d.deletions=null,d.memoizedProps=b.memoizedProps,d.memoizedState=b.memoizedState,d.updateQueue=b.updateQueue,d.type=b.type,o=b.dependencies,d.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),s=s.sibling;return G(L,L.current&1|2),e.child}o=o.sibling}d.tail!==null&&B()>Gj&&(e.flags|=128,a=!0,Dj(d,!1),e.lanes=4194304)}else{if(!a)if(o=Ch(b),o!==null){if(e.flags|=128,a=!0,s=o.updateQueue,s!==null&&(e.updateQueue=s,e.flags|=4),Dj(d,!0),d.tail===null&&d.tailMode==="hidden"&&!b.alternate&&!I)return S(e),null}else 2*B()-d.renderingStartTime>Gj&&s!==1073741824&&(e.flags|=128,a=!0,Dj(d,!1),e.lanes=4194304);d.isBackwards?(b.sibling=e.child,e.child=b):(s=d.last,s!==null?s.sibling=b:e.child=b,d.last=b)}return d.tail!==null?(e=d.tail,d.rendering=e,d.tail=e.sibling,d.renderingStartTime=B(),e.sibling=null,s=L.current,G(L,a?s&1|2:s&1),e):(S(e),null);case 22:case 23:return Hj(),a=e.memoizedState!==null,o!==null&&o.memoizedState!==null!==a&&(e.flags|=8192),a&&e.mode&1?fj&1073741824&&(S(e),e.subtreeFlags&6&&(e.flags|=8192)):S(e),null;case 24:return null;case 25:return null}throw Error(p(156,e.tag))}function Ij(o,e){switch(wg(e),e.tag){case 1:return Zf(e.type)&&$f(),o=e.flags,o&65536?(e.flags=o&-65537|128,e):null;case 3:return zh(),E$1(Wf),E$1(H$1),Eh(),o=e.flags,o&65536&&!(o&128)?(e.flags=o&-65537|128,e):null;case 5:return Bh(e),null;case 13:if(E$1(L),o=e.memoizedState,o!==null&&o.dehydrated!==null){if(e.alternate===null)throw Error(p(340));Ig()}return o=e.flags,o&65536?(e.flags=o&-65537|128,e):null;case 19:return E$1(L),null;case 4:return zh(),null;case 10:return ah(e.type._context),null;case 22:case 23:return Hj(),null;case 24:return null;default:return null}}var Jj=!1,U=!1,Kj=typeof WeakSet=="function"?WeakSet:Set,V=null;function Lj(o,e){var s=o.ref;if(s!==null)if(typeof s=="function")try{s(null)}catch(a){W$1(o,e,a)}else s.current=null}function Mj(o,e,s){try{s()}catch(a){W$1(o,e,a)}}var Nj=!1;function Oj(o,e){if(Cf=dd,o=Me$1(),Ne(o)){if("selectionStart"in o)var s={start:o.selectionStart,end:o.selectionEnd};else e:{s=(s=o.ownerDocument)&&s.defaultView||window;var a=s.getSelection&&s.getSelection();if(a&&a.rangeCount!==0){s=a.anchorNode;var c=a.anchorOffset,d=a.focusNode;a=a.focusOffset;try{s.nodeType,d.nodeType}catch{s=null;break e}var b=0,_e=-1,tt=-1,nt=0,it=0,ot=o,at=null;t:for(;;){for(var ct;ot!==s||c!==0&&ot.nodeType!==3||(_e=b+c),ot!==d||a!==0&&ot.nodeType!==3||(tt=b+a),ot.nodeType===3&&(b+=ot.nodeValue.length),(ct=ot.firstChild)!==null;)at=ot,ot=ct;for(;;){if(ot===o)break t;if(at===s&&++nt===c&&(_e=b),at===d&&++it===a&&(tt=b),(ct=ot.nextSibling)!==null)break;ot=at,at=ot.parentNode}ot=ct}s=_e===-1||tt===-1?null:{start:_e,end:tt}}else s=null}s=s||{start:0,end:0}}else s=null;for(Df={focusedElem:o,selectionRange:s},dd=!1,V=e;V!==null;)if(e=V,o=e.child,(e.subtreeFlags&1028)!==0&&o!==null)o.return=e,V=o;else for(;V!==null;){e=V;try{var ut=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(ut!==null){var ft=ut.memoizedProps,dt=ut.memoizedState,lt=e.stateNode,ht=lt.getSnapshotBeforeUpdate(e.elementType===e.type?ft:Ci(e.type,ft),dt);lt.__reactInternalSnapshotBeforeUpdate=ht}break;case 3:var mt=e.stateNode.containerInfo;mt.nodeType===1?mt.textContent="":mt.nodeType===9&&mt.documentElement&&mt.removeChild(mt.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(p(163))}}catch(xt){W$1(e,e.return,xt)}if(o=e.sibling,o!==null){o.return=e.return,V=o;break}V=e.return}return ut=Nj,Nj=!1,ut}function Pj(o,e,s){var a=e.updateQueue;if(a=a!==null?a.lastEffect:null,a!==null){var c=a=a.next;do{if((c.tag&o)===o){var d=c.destroy;c.destroy=void 0,d!==void 0&&Mj(e,s,d)}c=c.next}while(c!==a)}}function Qj(o,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var s=e=e.next;do{if((s.tag&o)===o){var a=s.create;s.destroy=a()}s=s.next}while(s!==e)}}function Rj(o){var e=o.ref;if(e!==null){var s=o.stateNode;switch(o.tag){case 5:o=s;break;default:o=s}typeof e=="function"?e(o):e.current=o}}function Sj(o){var e=o.alternate;e!==null&&(o.alternate=null,Sj(e)),o.child=null,o.deletions=null,o.sibling=null,o.tag===5&&(e=o.stateNode,e!==null&&(delete e[Of],delete e[Pf],delete e[of],delete e[Qf],delete e[Rf])),o.stateNode=null,o.return=null,o.dependencies=null,o.memoizedProps=null,o.memoizedState=null,o.pendingProps=null,o.stateNode=null,o.updateQueue=null}function Tj(o){return o.tag===5||o.tag===3||o.tag===4}function Uj(o){e:for(;;){for(;o.sibling===null;){if(o.return===null||Tj(o.return))return null;o=o.return}for(o.sibling.return=o.return,o=o.sibling;o.tag!==5&&o.tag!==6&&o.tag!==18;){if(o.flags&2||o.child===null||o.tag===4)continue e;o.child.return=o,o=o.child}if(!(o.flags&2))return o.stateNode}}function Vj(o,e,s){var a=o.tag;if(a===5||a===6)o=o.stateNode,e?s.nodeType===8?s.parentNode.insertBefore(o,e):s.insertBefore(o,e):(s.nodeType===8?(e=s.parentNode,e.insertBefore(o,s)):(e=s,e.appendChild(o)),s=s._reactRootContainer,s!=null||e.onclick!==null||(e.onclick=Bf));else if(a!==4&&(o=o.child,o!==null))for(Vj(o,e,s),o=o.sibling;o!==null;)Vj(o,e,s),o=o.sibling}function Wj(o,e,s){var a=o.tag;if(a===5||a===6)o=o.stateNode,e?s.insertBefore(o,e):s.appendChild(o);else if(a!==4&&(o=o.child,o!==null))for(Wj(o,e,s),o=o.sibling;o!==null;)Wj(o,e,s),o=o.sibling}var X$1=null,Xj=!1;function Yj(o,e,s){for(s=s.child;s!==null;)Zj(o,e,s),s=s.sibling}function Zj(o,e,s){if(lc&&typeof lc.onCommitFiberUnmount=="function")try{lc.onCommitFiberUnmount(kc,s)}catch{}switch(s.tag){case 5:U||Lj(s,e);case 6:var a=X$1,c=Xj;X$1=null,Yj(o,e,s),X$1=a,Xj=c,X$1!==null&&(Xj?(o=X$1,s=s.stateNode,o.nodeType===8?o.parentNode.removeChild(s):o.removeChild(s)):X$1.removeChild(s.stateNode));break;case 18:X$1!==null&&(Xj?(o=X$1,s=s.stateNode,o.nodeType===8?Kf(o.parentNode,s):o.nodeType===1&&Kf(o,s),bd(o)):Kf(X$1,s.stateNode));break;case 4:a=X$1,c=Xj,X$1=s.stateNode.containerInfo,Xj=!0,Yj(o,e,s),X$1=a,Xj=c;break;case 0:case 11:case 14:case 15:if(!U&&(a=s.updateQueue,a!==null&&(a=a.lastEffect,a!==null))){c=a=a.next;do{var d=c,b=d.destroy;d=d.tag,b!==void 0&&(d&2||d&4)&&Mj(s,e,b),c=c.next}while(c!==a)}Yj(o,e,s);break;case 1:if(!U&&(Lj(s,e),a=s.stateNode,typeof a.componentWillUnmount=="function"))try{a.props=s.memoizedProps,a.state=s.memoizedState,a.componentWillUnmount()}catch(_e){W$1(s,e,_e)}Yj(o,e,s);break;case 21:Yj(o,e,s);break;case 22:s.mode&1?(U=(a=U)||s.memoizedState!==null,Yj(o,e,s),U=a):Yj(o,e,s);break;default:Yj(o,e,s)}}function ak(o){var e=o.updateQueue;if(e!==null){o.updateQueue=null;var s=o.stateNode;s===null&&(s=o.stateNode=new Kj),e.forEach(function(a){var c=bk.bind(null,o,a);s.has(a)||(s.add(a),a.then(c,c))})}}function ck(o,e){var s=e.deletions;if(s!==null)for(var a=0;a<s.length;a++){var c=s[a];try{var d=o,b=e,_e=b;e:for(;_e!==null;){switch(_e.tag){case 5:X$1=_e.stateNode,Xj=!1;break e;case 3:X$1=_e.stateNode.containerInfo,Xj=!0;break e;case 4:X$1=_e.stateNode.containerInfo,Xj=!0;break e}_e=_e.return}if(X$1===null)throw Error(p(160));Zj(d,b,c),X$1=null,Xj=!1;var tt=c.alternate;tt!==null&&(tt.return=null),c.return=null}catch(nt){W$1(c,e,nt)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)dk(e,o),e=e.sibling}function dk(o,e){var s=o.alternate,a=o.flags;switch(o.tag){case 0:case 11:case 14:case 15:if(ck(e,o),ek(o),a&4){try{Pj(3,o,o.return),Qj(3,o)}catch(ft){W$1(o,o.return,ft)}try{Pj(5,o,o.return)}catch(ft){W$1(o,o.return,ft)}}break;case 1:ck(e,o),ek(o),a&512&&s!==null&&Lj(s,s.return);break;case 5:if(ck(e,o),ek(o),a&512&&s!==null&&Lj(s,s.return),o.flags&32){var c=o.stateNode;try{ob(c,"")}catch(ft){W$1(o,o.return,ft)}}if(a&4&&(c=o.stateNode,c!=null)){var d=o.memoizedProps,b=s!==null?s.memoizedProps:d,_e=o.type,tt=o.updateQueue;if(o.updateQueue=null,tt!==null)try{_e==="input"&&d.type==="radio"&&d.name!=null&&ab(c,d),vb(_e,b);var nt=vb(_e,d);for(b=0;b<tt.length;b+=2){var it=tt[b],ot=tt[b+1];it==="style"?sb(c,ot):it==="dangerouslySetInnerHTML"?nb(c,ot):it==="children"?ob(c,ot):ta(c,it,ot,nt)}switch(_e){case"input":bb(c,d);break;case"textarea":ib(c,d);break;case"select":var at=c._wrapperState.wasMultiple;c._wrapperState.wasMultiple=!!d.multiple;var ct=d.value;ct!=null?fb(c,!!d.multiple,ct,!1):at!==!!d.multiple&&(d.defaultValue!=null?fb(c,!!d.multiple,d.defaultValue,!0):fb(c,!!d.multiple,d.multiple?[]:"",!1))}c[Pf]=d}catch(ft){W$1(o,o.return,ft)}}break;case 6:if(ck(e,o),ek(o),a&4){if(o.stateNode===null)throw Error(p(162));c=o.stateNode,d=o.memoizedProps;try{c.nodeValue=d}catch(ft){W$1(o,o.return,ft)}}break;case 3:if(ck(e,o),ek(o),a&4&&s!==null&&s.memoizedState.isDehydrated)try{bd(e.containerInfo)}catch(ft){W$1(o,o.return,ft)}break;case 4:ck(e,o),ek(o);break;case 13:ck(e,o),ek(o),c=o.child,c.flags&8192&&(d=c.memoizedState!==null,c.stateNode.isHidden=d,!d||c.alternate!==null&&c.alternate.memoizedState!==null||(fk=B())),a&4&&ak(o);break;case 22:if(it=s!==null&&s.memoizedState!==null,o.mode&1?(U=(nt=U)||it,ck(e,o),U=nt):ck(e,o),ek(o),a&8192){if(nt=o.memoizedState!==null,(o.stateNode.isHidden=nt)&&!it&&o.mode&1)for(V=o,it=o.child;it!==null;){for(ot=V=it;V!==null;){switch(at=V,ct=at.child,at.tag){case 0:case 11:case 14:case 15:Pj(4,at,at.return);break;case 1:Lj(at,at.return);var ut=at.stateNode;if(typeof ut.componentWillUnmount=="function"){a=at,s=at.return;try{e=a,ut.props=e.memoizedProps,ut.state=e.memoizedState,ut.componentWillUnmount()}catch(ft){W$1(a,s,ft)}}break;case 5:Lj(at,at.return);break;case 22:if(at.memoizedState!==null){gk(ot);continue}}ct!==null?(ct.return=at,V=ct):gk(ot)}it=it.sibling}e:for(it=null,ot=o;;){if(ot.tag===5){if(it===null){it=ot;try{c=ot.stateNode,nt?(d=c.style,typeof d.setProperty=="function"?d.setProperty("display","none","important"):d.display="none"):(_e=ot.stateNode,tt=ot.memoizedProps.style,b=tt!=null&&tt.hasOwnProperty("display")?tt.display:null,_e.style.display=rb("display",b))}catch(ft){W$1(o,o.return,ft)}}}else if(ot.tag===6){if(it===null)try{ot.stateNode.nodeValue=nt?"":ot.memoizedProps}catch(ft){W$1(o,o.return,ft)}}else if((ot.tag!==22&&ot.tag!==23||ot.memoizedState===null||ot===o)&&ot.child!==null){ot.child.return=ot,ot=ot.child;continue}if(ot===o)break e;for(;ot.sibling===null;){if(ot.return===null||ot.return===o)break e;it===ot&&(it=null),ot=ot.return}it===ot&&(it=null),ot.sibling.return=ot.return,ot=ot.sibling}}break;case 19:ck(e,o),ek(o),a&4&&ak(o);break;case 21:break;default:ck(e,o),ek(o)}}function ek(o){var e=o.flags;if(e&2){try{e:{for(var s=o.return;s!==null;){if(Tj(s)){var a=s;break e}s=s.return}throw Error(p(160))}switch(a.tag){case 5:var c=a.stateNode;a.flags&32&&(ob(c,""),a.flags&=-33);var d=Uj(o);Wj(o,d,c);break;case 3:case 4:var b=a.stateNode.containerInfo,_e=Uj(o);Vj(o,_e,b);break;default:throw Error(p(161))}}catch(tt){W$1(o,o.return,tt)}o.flags&=-3}e&4096&&(o.flags&=-4097)}function hk(o,e,s){V=o,ik(o)}function ik(o,e,s){for(var a=(o.mode&1)!==0;V!==null;){var c=V,d=c.child;if(c.tag===22&&a){var b=c.memoizedState!==null||Jj;if(!b){var _e=c.alternate,tt=_e!==null&&_e.memoizedState!==null||U;_e=Jj;var nt=U;if(Jj=b,(U=tt)&&!nt)for(V=c;V!==null;)b=V,tt=b.child,b.tag===22&&b.memoizedState!==null?jk(c):tt!==null?(tt.return=b,V=tt):jk(c);for(;d!==null;)V=d,ik(d),d=d.sibling;V=c,Jj=_e,U=nt}kk(o)}else c.subtreeFlags&8772&&d!==null?(d.return=c,V=d):kk(o)}}function kk(o){for(;V!==null;){var e=V;if(e.flags&8772){var s=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:U||Qj(5,e);break;case 1:var a=e.stateNode;if(e.flags&4&&!U)if(s===null)a.componentDidMount();else{var c=e.elementType===e.type?s.memoizedProps:Ci(e.type,s.memoizedProps);a.componentDidUpdate(c,s.memoizedState,a.__reactInternalSnapshotBeforeUpdate)}var d=e.updateQueue;d!==null&&sh(e,d,a);break;case 3:var b=e.updateQueue;if(b!==null){if(s=null,e.child!==null)switch(e.child.tag){case 5:s=e.child.stateNode;break;case 1:s=e.child.stateNode}sh(e,b,s)}break;case 5:var _e=e.stateNode;if(s===null&&e.flags&4){s=_e;var tt=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":tt.autoFocus&&s.focus();break;case"img":tt.src&&(s.src=tt.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var nt=e.alternate;if(nt!==null){var it=nt.memoizedState;if(it!==null){var ot=it.dehydrated;ot!==null&&bd(ot)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(p(163))}U||e.flags&512&&Rj(e)}catch(at){W$1(e,e.return,at)}}if(e===o){V=null;break}if(s=e.sibling,s!==null){s.return=e.return,V=s;break}V=e.return}}function gk(o){for(;V!==null;){var e=V;if(e===o){V=null;break}var s=e.sibling;if(s!==null){s.return=e.return,V=s;break}V=e.return}}function jk(o){for(;V!==null;){var e=V;try{switch(e.tag){case 0:case 11:case 15:var s=e.return;try{Qj(4,e)}catch(tt){W$1(e,s,tt)}break;case 1:var a=e.stateNode;if(typeof a.componentDidMount=="function"){var c=e.return;try{a.componentDidMount()}catch(tt){W$1(e,c,tt)}}var d=e.return;try{Rj(e)}catch(tt){W$1(e,d,tt)}break;case 5:var b=e.return;try{Rj(e)}catch(tt){W$1(e,b,tt)}}}catch(tt){W$1(e,e.return,tt)}if(e===o){V=null;break}var _e=e.sibling;if(_e!==null){_e.return=e.return,V=_e;break}V=e.return}}var lk=Math.ceil,mk=ua.ReactCurrentDispatcher,nk=ua.ReactCurrentOwner,ok=ua.ReactCurrentBatchConfig,K=0,Q=null,Y$1=null,Z$1=0,fj=0,ej=Uf(0),T=0,pk=null,rh=0,qk=0,rk=0,sk=null,tk=null,fk=0,Gj=1/0,uk=null,Oi=!1,Pi=null,Ri=null,vk=!1,wk=null,xk=0,yk=0,zk=null,Ak=-1,Bk=0;function R(){return K&6?B():Ak!==-1?Ak:Ak=B()}function yi(o){return o.mode&1?K&2&&Z$1!==0?Z$1&-Z$1:Kg.transition!==null?(Bk===0&&(Bk=yc()),Bk):(o=C,o!==0||(o=window.event,o=o===void 0?16:jd(o.type)),o):1}function gi(o,e,s,a){if(50<yk)throw yk=0,zk=null,Error(p(185));Ac(o,s,a),(!(K&2)||o!==Q)&&(o===Q&&(!(K&2)&&(qk|=s),T===4&&Ck(o,Z$1)),Dk(o,a),s===1&&K===0&&!(e.mode&1)&&(Gj=B()+500,fg&&jg()))}function Dk(o,e){var s=o.callbackNode;wc(o,e);var a=uc(o,o===Q?Z$1:0);if(a===0)s!==null&&bc(s),o.callbackNode=null,o.callbackPriority=0;else if(e=a&-a,o.callbackPriority!==e){if(s!=null&&bc(s),e===1)o.tag===0?ig(Ek.bind(null,o)):hg(Ek.bind(null,o)),Jf(function(){!(K&6)&&jg()}),s=null;else{switch(Dc(a)){case 1:s=fc;break;case 4:s=gc;break;case 16:s=hc;break;case 536870912:s=jc;break;default:s=hc}s=Fk(s,Gk.bind(null,o))}o.callbackPriority=e,o.callbackNode=s}}function Gk(o,e){if(Ak=-1,Bk=0,K&6)throw Error(p(327));var s=o.callbackNode;if(Hk()&&o.callbackNode!==s)return null;var a=uc(o,o===Q?Z$1:0);if(a===0)return null;if(a&30||a&o.expiredLanes||e)e=Ik(o,a);else{e=a;var c=K;K|=2;var d=Jk();(Q!==o||Z$1!==e)&&(uk=null,Gj=B()+500,Kk(o,e));do try{Lk();break}catch(_e){Mk(o,_e)}while(!0);$g(),mk.current=d,K=c,Y$1!==null?e=0:(Q=null,Z$1=0,e=T)}if(e!==0){if(e===2&&(c=xc(o),c!==0&&(a=c,e=Nk(o,c))),e===1)throw s=pk,Kk(o,0),Ck(o,a),Dk(o,B()),s;if(e===6)Ck(o,a);else{if(c=o.current.alternate,!(a&30)&&!Ok(c)&&(e=Ik(o,a),e===2&&(d=xc(o),d!==0&&(a=d,e=Nk(o,d))),e===1))throw s=pk,Kk(o,0),Ck(o,a),Dk(o,B()),s;switch(o.finishedWork=c,o.finishedLanes=a,e){case 0:case 1:throw Error(p(345));case 2:Pk(o,tk,uk);break;case 3:if(Ck(o,a),(a&130023424)===a&&(e=fk+500-B(),10<e)){if(uc(o,0)!==0)break;if(c=o.suspendedLanes,(c&a)!==a){R(),o.pingedLanes|=o.suspendedLanes&c;break}o.timeoutHandle=Ff(Pk.bind(null,o,tk,uk),e);break}Pk(o,tk,uk);break;case 4:if(Ck(o,a),(a&4194240)===a)break;for(e=o.eventTimes,c=-1;0<a;){var b=31-oc(a);d=1<<b,b=e[b],b>c&&(c=b),a&=~d}if(a=c,a=B()-a,a=(120>a?120:480>a?480:1080>a?1080:1920>a?1920:3e3>a?3e3:4320>a?4320:1960*lk(a/1960))-a,10<a){o.timeoutHandle=Ff(Pk.bind(null,o,tk,uk),a);break}Pk(o,tk,uk);break;case 5:Pk(o,tk,uk);break;default:throw Error(p(329))}}}return Dk(o,B()),o.callbackNode===s?Gk.bind(null,o):null}function Nk(o,e){var s=sk;return o.current.memoizedState.isDehydrated&&(Kk(o,e).flags|=256),o=Ik(o,e),o!==2&&(e=tk,tk=s,e!==null&&Fj(e)),o}function Fj(o){tk===null?tk=o:tk.push.apply(tk,o)}function Ok(o){for(var e=o;;){if(e.flags&16384){var s=e.updateQueue;if(s!==null&&(s=s.stores,s!==null))for(var a=0;a<s.length;a++){var c=s[a],d=c.getSnapshot;c=c.value;try{if(!He$1(d(),c))return!1}catch{return!1}}}if(s=e.child,e.subtreeFlags&16384&&s!==null)s.return=e,e=s;else{if(e===o)break;for(;e.sibling===null;){if(e.return===null||e.return===o)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Ck(o,e){for(e&=~rk,e&=~qk,o.suspendedLanes|=e,o.pingedLanes&=~e,o=o.expirationTimes;0<e;){var s=31-oc(e),a=1<<s;o[s]=-1,e&=~a}}function Ek(o){if(K&6)throw Error(p(327));Hk();var e=uc(o,0);if(!(e&1))return Dk(o,B()),null;var s=Ik(o,e);if(o.tag!==0&&s===2){var a=xc(o);a!==0&&(e=a,s=Nk(o,a))}if(s===1)throw s=pk,Kk(o,0),Ck(o,e),Dk(o,B()),s;if(s===6)throw Error(p(345));return o.finishedWork=o.current.alternate,o.finishedLanes=e,Pk(o,tk,uk),Dk(o,B()),null}function Qk(o,e){var s=K;K|=1;try{return o(e)}finally{K=s,K===0&&(Gj=B()+500,fg&&jg())}}function Rk(o){wk!==null&&wk.tag===0&&!(K&6)&&Hk();var e=K;K|=1;var s=ok.transition,a=C;try{if(ok.transition=null,C=1,o)return o()}finally{C=a,ok.transition=s,K=e,!(K&6)&&jg()}}function Hj(){fj=ej.current,E$1(ej)}function Kk(o,e){o.finishedWork=null,o.finishedLanes=0;var s=o.timeoutHandle;if(s!==-1&&(o.timeoutHandle=-1,Gf(s)),Y$1!==null)for(s=Y$1.return;s!==null;){var a=s;switch(wg(a),a.tag){case 1:a=a.type.childContextTypes,a!=null&&$f();break;case 3:zh(),E$1(Wf),E$1(H$1),Eh();break;case 5:Bh(a);break;case 4:zh();break;case 13:E$1(L);break;case 19:E$1(L);break;case 10:ah(a.type._context);break;case 22:case 23:Hj()}s=s.return}if(Q=o,Y$1=o=Pg(o.current,null),Z$1=fj=e,T=0,pk=null,rk=qk=rh=0,tk=sk=null,fh!==null){for(e=0;e<fh.length;e++)if(s=fh[e],a=s.interleaved,a!==null){s.interleaved=null;var c=a.next,d=s.pending;if(d!==null){var b=d.next;d.next=c,a.next=b}s.pending=a}fh=null}return o}function Mk(o,e){do{var s=Y$1;try{if($g(),Fh.current=Rh,Ih){for(var a=M.memoizedState;a!==null;){var c=a.queue;c!==null&&(c.pending=null),a=a.next}Ih=!1}if(Hh=0,O=N=M=null,Jh=!1,Kh=0,nk.current=null,s===null||s.return===null){T=1,pk=e,Y$1=null;break}e:{var d=o,b=s.return,_e=s,tt=e;if(e=Z$1,_e.flags|=32768,tt!==null&&typeof tt=="object"&&typeof tt.then=="function"){var nt=tt,it=_e,ot=it.tag;if(!(it.mode&1)&&(ot===0||ot===11||ot===15)){var at=it.alternate;at?(it.updateQueue=at.updateQueue,it.memoizedState=at.memoizedState,it.lanes=at.lanes):(it.updateQueue=null,it.memoizedState=null)}var ct=Ui(b);if(ct!==null){ct.flags&=-257,Vi(ct,b,_e,d,e),ct.mode&1&&Si(d,nt,e),e=ct,tt=nt;var ut=e.updateQueue;if(ut===null){var ft=new Set;ft.add(tt),e.updateQueue=ft}else ut.add(tt);break e}else{if(!(e&1)){Si(d,nt,e),tj();break e}tt=Error(p(426))}}else if(I&&_e.mode&1){var dt=Ui(b);if(dt!==null){!(dt.flags&65536)&&(dt.flags|=256),Vi(dt,b,_e,d,e),Jg(Ji(tt,_e));break e}}d=tt=Ji(tt,_e),T!==4&&(T=2),sk===null?sk=[d]:sk.push(d),d=b;do{switch(d.tag){case 3:d.flags|=65536,e&=-e,d.lanes|=e;var lt=Ni(d,tt,e);ph(d,lt);break e;case 1:_e=tt;var ht=d.type,mt=d.stateNode;if(!(d.flags&128)&&(typeof ht.getDerivedStateFromError=="function"||mt!==null&&typeof mt.componentDidCatch=="function"&&(Ri===null||!Ri.has(mt)))){d.flags|=65536,e&=-e,d.lanes|=e;var xt=Qi(d,_e,e);ph(d,xt);break e}}d=d.return}while(d!==null)}Sk(s)}catch(St){e=St,Y$1===s&&s!==null&&(Y$1=s=s.return);continue}break}while(!0)}function Jk(){var o=mk.current;return mk.current=Rh,o===null?Rh:o}function tj(){(T===0||T===3||T===2)&&(T=4),Q===null||!(rh&268435455)&&!(qk&268435455)||Ck(Q,Z$1)}function Ik(o,e){var s=K;K|=2;var a=Jk();(Q!==o||Z$1!==e)&&(uk=null,Kk(o,e));do try{Tk();break}catch(c){Mk(o,c)}while(!0);if($g(),K=s,mk.current=a,Y$1!==null)throw Error(p(261));return Q=null,Z$1=0,T}function Tk(){for(;Y$1!==null;)Uk(Y$1)}function Lk(){for(;Y$1!==null&&!cc();)Uk(Y$1)}function Uk(o){var e=Vk(o.alternate,o,fj);o.memoizedProps=o.pendingProps,e===null?Sk(o):Y$1=e,nk.current=null}function Sk(o){var e=o;do{var s=e.alternate;if(o=e.return,e.flags&32768){if(s=Ij(s,e),s!==null){s.flags&=32767,Y$1=s;return}if(o!==null)o.flags|=32768,o.subtreeFlags=0,o.deletions=null;else{T=6,Y$1=null;return}}else if(s=Ej(s,e,fj),s!==null){Y$1=s;return}if(e=e.sibling,e!==null){Y$1=e;return}Y$1=e=o}while(e!==null);T===0&&(T=5)}function Pk(o,e,s){var a=C,c=ok.transition;try{ok.transition=null,C=1,Wk(o,e,s,a)}finally{ok.transition=c,C=a}return null}function Wk(o,e,s,a){do Hk();while(wk!==null);if(K&6)throw Error(p(327));s=o.finishedWork;var c=o.finishedLanes;if(s===null)return null;if(o.finishedWork=null,o.finishedLanes=0,s===o.current)throw Error(p(177));o.callbackNode=null,o.callbackPriority=0;var d=s.lanes|s.childLanes;if(Bc(o,d),o===Q&&(Y$1=Q=null,Z$1=0),!(s.subtreeFlags&2064)&&!(s.flags&2064)||vk||(vk=!0,Fk(hc,function(){return Hk(),null})),d=(s.flags&15990)!==0,s.subtreeFlags&15990||d){d=ok.transition,ok.transition=null;var b=C;C=1;var _e=K;K|=4,nk.current=null,Oj(o,s),dk(s,o),Oe$1(Df),dd=!!Cf,Df=Cf=null,o.current=s,hk(s),dc(),K=_e,C=b,ok.transition=d}else o.current=s;if(vk&&(vk=!1,wk=o,xk=c),d=o.pendingLanes,d===0&&(Ri=null),mc(s.stateNode),Dk(o,B()),e!==null)for(a=o.onRecoverableError,s=0;s<e.length;s++)c=e[s],a(c.value,{componentStack:c.stack,digest:c.digest});if(Oi)throw Oi=!1,o=Pi,Pi=null,o;return xk&1&&o.tag!==0&&Hk(),d=o.pendingLanes,d&1?o===zk?yk++:(yk=0,zk=o):yk=0,jg(),null}function Hk(){if(wk!==null){var o=Dc(xk),e=ok.transition,s=C;try{if(ok.transition=null,C=16>o?16:o,wk===null)var a=!1;else{if(o=wk,wk=null,xk=0,K&6)throw Error(p(331));var c=K;for(K|=4,V=o.current;V!==null;){var d=V,b=d.child;if(V.flags&16){var _e=d.deletions;if(_e!==null){for(var tt=0;tt<_e.length;tt++){var nt=_e[tt];for(V=nt;V!==null;){var it=V;switch(it.tag){case 0:case 11:case 15:Pj(8,it,d)}var ot=it.child;if(ot!==null)ot.return=it,V=ot;else for(;V!==null;){it=V;var at=it.sibling,ct=it.return;if(Sj(it),it===nt){V=null;break}if(at!==null){at.return=ct,V=at;break}V=ct}}}var ut=d.alternate;if(ut!==null){var ft=ut.child;if(ft!==null){ut.child=null;do{var dt=ft.sibling;ft.sibling=null,ft=dt}while(ft!==null)}}V=d}}if(d.subtreeFlags&2064&&b!==null)b.return=d,V=b;else e:for(;V!==null;){if(d=V,d.flags&2048)switch(d.tag){case 0:case 11:case 15:Pj(9,d,d.return)}var lt=d.sibling;if(lt!==null){lt.return=d.return,V=lt;break e}V=d.return}}var ht=o.current;for(V=ht;V!==null;){b=V;var mt=b.child;if(b.subtreeFlags&2064&&mt!==null)mt.return=b,V=mt;else e:for(b=ht;V!==null;){if(_e=V,_e.flags&2048)try{switch(_e.tag){case 0:case 11:case 15:Qj(9,_e)}}catch(St){W$1(_e,_e.return,St)}if(_e===b){V=null;break e}var xt=_e.sibling;if(xt!==null){xt.return=_e.return,V=xt;break e}V=_e.return}}if(K=c,jg(),lc&&typeof lc.onPostCommitFiberRoot=="function")try{lc.onPostCommitFiberRoot(kc,o)}catch{}a=!0}return a}finally{C=s,ok.transition=e}}return!1}function Xk(o,e,s){e=Ji(s,e),e=Ni(o,e,1),o=nh(o,e,1),e=R(),o!==null&&(Ac(o,1,e),Dk(o,e))}function W$1(o,e,s){if(o.tag===3)Xk(o,o,s);else for(;e!==null;){if(e.tag===3){Xk(e,o,s);break}else if(e.tag===1){var a=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof a.componentDidCatch=="function"&&(Ri===null||!Ri.has(a))){o=Ji(s,o),o=Qi(e,o,1),e=nh(e,o,1),o=R(),e!==null&&(Ac(e,1,o),Dk(e,o));break}}e=e.return}}function Ti(o,e,s){var a=o.pingCache;a!==null&&a.delete(e),e=R(),o.pingedLanes|=o.suspendedLanes&s,Q===o&&(Z$1&s)===s&&(T===4||T===3&&(Z$1&130023424)===Z$1&&500>B()-fk?Kk(o,0):rk|=s),Dk(o,e)}function Yk(o,e){e===0&&(o.mode&1?(e=sc,sc<<=1,!(sc&130023424)&&(sc=4194304)):e=1);var s=R();o=ih(o,e),o!==null&&(Ac(o,e,s),Dk(o,s))}function uj(o){var e=o.memoizedState,s=0;e!==null&&(s=e.retryLane),Yk(o,s)}function bk(o,e){var s=0;switch(o.tag){case 13:var a=o.stateNode,c=o.memoizedState;c!==null&&(s=c.retryLane);break;case 19:a=o.stateNode;break;default:throw Error(p(314))}a!==null&&a.delete(e),Yk(o,s)}var Vk;Vk=function(o,e,s){if(o!==null)if(o.memoizedProps!==e.pendingProps||Wf.current)dh=!0;else{if(!(o.lanes&s)&&!(e.flags&128))return dh=!1,yj(o,e,s);dh=!!(o.flags&131072)}else dh=!1,I&&e.flags&1048576&&ug(e,ng,e.index);switch(e.lanes=0,e.tag){case 2:var a=e.type;ij(o,e),o=e.pendingProps;var c=Yf(e,H$1.current);ch(e,s),c=Nh(null,e,a,o,c,s);var d=Sh();return e.flags|=1,typeof c=="object"&&c!==null&&typeof c.render=="function"&&c.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Zf(a)?(d=!0,cg(e)):d=!1,e.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,kh(e),c.updater=Ei,e.stateNode=c,c._reactInternals=e,Ii(e,a,o,s),e=jj(null,e,a,!0,d,s)):(e.tag=0,I&&d&&vg(e),Xi(null,e,c,s),e=e.child),e;case 16:a=e.elementType;e:{switch(ij(o,e),o=e.pendingProps,c=a._init,a=c(a._payload),e.type=a,c=e.tag=Zk(a),o=Ci(a,o),c){case 0:e=cj(null,e,a,o,s);break e;case 1:e=hj(null,e,a,o,s);break e;case 11:e=Yi(null,e,a,o,s);break e;case 14:e=$i(null,e,a,Ci(a.type,o),s);break e}throw Error(p(306,a,""))}return e;case 0:return a=e.type,c=e.pendingProps,c=e.elementType===a?c:Ci(a,c),cj(o,e,a,c,s);case 1:return a=e.type,c=e.pendingProps,c=e.elementType===a?c:Ci(a,c),hj(o,e,a,c,s);case 3:e:{if(kj(e),o===null)throw Error(p(387));a=e.pendingProps,d=e.memoizedState,c=d.element,lh(o,e),qh(e,a,null,s);var b=e.memoizedState;if(a=b.element,d.isDehydrated)if(d={element:a,isDehydrated:!1,cache:b.cache,pendingSuspenseBoundaries:b.pendingSuspenseBoundaries,transitions:b.transitions},e.updateQueue.baseState=d,e.memoizedState=d,e.flags&256){c=Ji(Error(p(423)),e),e=lj(o,e,a,s,c);break e}else if(a!==c){c=Ji(Error(p(424)),e),e=lj(o,e,a,s,c);break e}else for(yg=Lf(e.stateNode.containerInfo.firstChild),xg=e,I=!0,zg=null,s=Vg(e,null,a,s),e.child=s;s;)s.flags=s.flags&-3|4096,s=s.sibling;else{if(Ig(),a===c){e=Zi(o,e,s);break e}Xi(o,e,a,s)}e=e.child}return e;case 5:return Ah(e),o===null&&Eg(e),a=e.type,c=e.pendingProps,d=o!==null?o.memoizedProps:null,b=c.children,Ef(a,c)?b=null:d!==null&&Ef(a,d)&&(e.flags|=32),gj(o,e),Xi(o,e,b,s),e.child;case 6:return o===null&&Eg(e),null;case 13:return oj(o,e,s);case 4:return yh(e,e.stateNode.containerInfo),a=e.pendingProps,o===null?e.child=Ug(e,null,a,s):Xi(o,e,a,s),e.child;case 11:return a=e.type,c=e.pendingProps,c=e.elementType===a?c:Ci(a,c),Yi(o,e,a,c,s);case 7:return Xi(o,e,e.pendingProps,s),e.child;case 8:return Xi(o,e,e.pendingProps.children,s),e.child;case 12:return Xi(o,e,e.pendingProps.children,s),e.child;case 10:e:{if(a=e.type._context,c=e.pendingProps,d=e.memoizedProps,b=c.value,G(Wg,a._currentValue),a._currentValue=b,d!==null)if(He$1(d.value,b)){if(d.children===c.children&&!Wf.current){e=Zi(o,e,s);break e}}else for(d=e.child,d!==null&&(d.return=e);d!==null;){var _e=d.dependencies;if(_e!==null){b=d.child;for(var tt=_e.firstContext;tt!==null;){if(tt.context===a){if(d.tag===1){tt=mh(-1,s&-s),tt.tag=2;var nt=d.updateQueue;if(nt!==null){nt=nt.shared;var it=nt.pending;it===null?tt.next=tt:(tt.next=it.next,it.next=tt),nt.pending=tt}}d.lanes|=s,tt=d.alternate,tt!==null&&(tt.lanes|=s),bh(d.return,s,e),_e.lanes|=s;break}tt=tt.next}}else if(d.tag===10)b=d.type===e.type?null:d.child;else if(d.tag===18){if(b=d.return,b===null)throw Error(p(341));b.lanes|=s,_e=b.alternate,_e!==null&&(_e.lanes|=s),bh(b,s,e),b=d.sibling}else b=d.child;if(b!==null)b.return=d;else for(b=d;b!==null;){if(b===e){b=null;break}if(d=b.sibling,d!==null){d.return=b.return,b=d;break}b=b.return}d=b}Xi(o,e,c.children,s),e=e.child}return e;case 9:return c=e.type,a=e.pendingProps.children,ch(e,s),c=eh(c),a=a(c),e.flags|=1,Xi(o,e,a,s),e.child;case 14:return a=e.type,c=Ci(a,e.pendingProps),c=Ci(a.type,c),$i(o,e,a,c,s);case 15:return bj(o,e,e.type,e.pendingProps,s);case 17:return a=e.type,c=e.pendingProps,c=e.elementType===a?c:Ci(a,c),ij(o,e),e.tag=1,Zf(a)?(o=!0,cg(e)):o=!1,ch(e,s),Gi(e,a,c),Ii(e,a,c,s),jj(null,e,a,!0,o,s);case 19:return xj(o,e,s);case 22:return dj(o,e,s)}throw Error(p(156,e.tag))};function Fk(o,e){return ac(o,e)}function $k(o,e,s,a){this.tag=o,this.key=s,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=a,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bg(o,e,s,a){return new $k(o,e,s,a)}function aj(o){return o=o.prototype,!(!o||!o.isReactComponent)}function Zk(o){if(typeof o=="function")return aj(o)?1:0;if(o!=null){if(o=o.$$typeof,o===Da)return 11;if(o===Ga)return 14}return 2}function Pg(o,e){var s=o.alternate;return s===null?(s=Bg(o.tag,e,o.key,o.mode),s.elementType=o.elementType,s.type=o.type,s.stateNode=o.stateNode,s.alternate=o,o.alternate=s):(s.pendingProps=e,s.type=o.type,s.flags=0,s.subtreeFlags=0,s.deletions=null),s.flags=o.flags&14680064,s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,e=o.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},s.sibling=o.sibling,s.index=o.index,s.ref=o.ref,s}function Rg(o,e,s,a,c,d){var b=2;if(a=o,typeof o=="function")aj(o)&&(b=1);else if(typeof o=="string")b=5;else e:switch(o){case ya:return Tg(s.children,c,d,e);case za:b=8,c|=8;break;case Aa:return o=Bg(12,s,e,c|2),o.elementType=Aa,o.lanes=d,o;case Ea:return o=Bg(13,s,e,c),o.elementType=Ea,o.lanes=d,o;case Fa:return o=Bg(19,s,e,c),o.elementType=Fa,o.lanes=d,o;case Ia:return pj(s,c,d,e);default:if(typeof o=="object"&&o!==null)switch(o.$$typeof){case Ba:b=10;break e;case Ca:b=9;break e;case Da:b=11;break e;case Ga:b=14;break e;case Ha:b=16,a=null;break e}throw Error(p(130,o==null?o:typeof o,""))}return e=Bg(b,s,e,c),e.elementType=o,e.type=a,e.lanes=d,e}function Tg(o,e,s,a){return o=Bg(7,o,a,e),o.lanes=s,o}function pj(o,e,s,a){return o=Bg(22,o,a,e),o.elementType=Ia,o.lanes=s,o.stateNode={isHidden:!1},o}function Qg(o,e,s){return o=Bg(6,o,null,e),o.lanes=s,o}function Sg(o,e,s){return e=Bg(4,o.children!==null?o.children:[],o.key,e),e.lanes=s,e.stateNode={containerInfo:o.containerInfo,pendingChildren:null,implementation:o.implementation},e}function al(o,e,s,a,c){this.tag=e,this.containerInfo=o,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zc(0),this.expirationTimes=zc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zc(0),this.identifierPrefix=a,this.onRecoverableError=c,this.mutableSourceEagerHydrationData=null}function bl(o,e,s,a,c,d,b,_e,tt){return o=new al(o,e,s,_e,tt),e===1?(e=1,d===!0&&(e|=8)):e=0,d=Bg(3,null,null,e),o.current=d,d.stateNode=o,d.memoizedState={element:a,isDehydrated:s,cache:null,transitions:null,pendingSuspenseBoundaries:null},kh(d),o}function cl(o,e,s){var a=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:wa,key:a==null?null:""+a,children:o,containerInfo:e,implementation:s}}function dl(o){if(!o)return Vf;o=o._reactInternals;e:{if(Vb(o)!==o||o.tag!==1)throw Error(p(170));var e=o;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Zf(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(p(171))}if(o.tag===1){var s=o.type;if(Zf(s))return bg(o,s,e)}return e}function el(o,e,s,a,c,d,b,_e,tt){return o=bl(s,a,!0,o,c,d,b,_e,tt),o.context=dl(null),s=o.current,a=R(),c=yi(s),d=mh(a,c),d.callback=e??null,nh(s,d,c),o.current.lanes=c,Ac(o,c,a),Dk(o,a),o}function fl$1(o,e,s,a){var c=e.current,d=R(),b=yi(c);return s=dl(s),e.context===null?e.context=s:e.pendingContext=s,e=mh(d,b),e.payload={element:o},a=a===void 0?null:a,a!==null&&(e.callback=a),o=nh(c,e,b),o!==null&&(gi(o,c,b,d),oh(o,c,b)),b}function gl(o){if(o=o.current,!o.child)return null;switch(o.child.tag){case 5:return o.child.stateNode;default:return o.child.stateNode}}function hl(o,e){if(o=o.memoizedState,o!==null&&o.dehydrated!==null){var s=o.retryLane;o.retryLane=s!==0&&s<e?s:e}}function il(o,e){hl(o,e),(o=o.alternate)&&hl(o,e)}function jl(){return null}var kl=typeof reportError=="function"?reportError:function(o){console.error(o)};function ll(o){this._internalRoot=o}ml.prototype.render=ll.prototype.render=function(o){var e=this._internalRoot;if(e===null)throw Error(p(409));fl$1(o,e,null,null)};ml.prototype.unmount=ll.prototype.unmount=function(){var o=this._internalRoot;if(o!==null){this._internalRoot=null;var e=o.containerInfo;Rk(function(){fl$1(null,o,null,null)}),e[uf]=null}};function ml(o){this._internalRoot=o}ml.prototype.unstable_scheduleHydration=function(o){if(o){var e=Hc();o={blockedOn:null,target:o,priority:e};for(var s=0;s<Qc.length&&e!==0&&e<Qc[s].priority;s++);Qc.splice(s,0,o),s===0&&Vc(o)}};function nl(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11)}function ol(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11&&(o.nodeType!==8||o.nodeValue!==" react-mount-point-unstable "))}function pl(){}function ql(o,e,s,a,c){if(c){if(typeof a=="function"){var d=a;a=function(){var nt=gl(b);d.call(nt)}}var b=el(e,a,o,0,null,!1,!1,"",pl);return o._reactRootContainer=b,o[uf]=b.current,sf(o.nodeType===8?o.parentNode:o),Rk(),b}for(;c=o.lastChild;)o.removeChild(c);if(typeof a=="function"){var _e=a;a=function(){var nt=gl(tt);_e.call(nt)}}var tt=bl(o,0,!1,null,null,!1,!1,"",pl);return o._reactRootContainer=tt,o[uf]=tt.current,sf(o.nodeType===8?o.parentNode:o),Rk(function(){fl$1(e,tt,s,a)}),tt}function rl(o,e,s,a,c){var d=s._reactRootContainer;if(d){var b=d;if(typeof c=="function"){var _e=c;c=function(){var tt=gl(b);_e.call(tt)}}fl$1(e,b,o,c)}else b=ql(s,e,o,c,a);return gl(b)}Ec=function(o){switch(o.tag){case 3:var e=o.stateNode;if(e.current.memoizedState.isDehydrated){var s=tc(e.pendingLanes);s!==0&&(Cc(e,s|1),Dk(e,B()),!(K&6)&&(Gj=B()+500,jg()))}break;case 13:Rk(function(){var a=ih(o,1);if(a!==null){var c=R();gi(a,o,1,c)}}),il(o,1)}};Fc=function(o){if(o.tag===13){var e=ih(o,134217728);if(e!==null){var s=R();gi(e,o,134217728,s)}il(o,134217728)}};Gc=function(o){if(o.tag===13){var e=yi(o),s=ih(o,e);if(s!==null){var a=R();gi(s,o,e,a)}il(o,e)}};Hc=function(){return C};Ic=function(o,e){var s=C;try{return C=o,e()}finally{C=s}};yb=function(o,e,s){switch(e){case"input":if(bb(o,s),e=s.name,s.type==="radio"&&e!=null){for(s=o;s.parentNode;)s=s.parentNode;for(s=s.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<s.length;e++){var a=s[e];if(a!==o&&a.form===o.form){var c=Db(a);if(!c)throw Error(p(90));Wa(a),bb(a,c)}}}break;case"textarea":ib(o,s);break;case"select":e=s.value,e!=null&&fb(o,!!s.multiple,e,!1)}};Gb=Qk;Hb=Rk;var sl={usingClientEntryPoint:!1,Events:[Cb,ue,Db,Eb,Fb,Qk]},tl={findFiberByHostInstance:Wc,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ul={bundleType:tl.bundleType,version:tl.version,rendererPackageName:tl.rendererPackageName,rendererConfig:tl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ua.ReactCurrentDispatcher,findHostInstanceByFiber:function(o){return o=Zb(o),o===null?null:o.stateNode},findFiberByHostInstance:tl.findFiberByHostInstance||jl,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var vl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!vl.isDisabled&&vl.supportsFiber)try{kc=vl.inject(ul),lc=vl}catch{}}reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sl;reactDom_production_min.createPortal=function(o,e){var s=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!nl(e))throw Error(p(200));return cl(o,e,null,s)};reactDom_production_min.createRoot=function(o,e){if(!nl(o))throw Error(p(299));var s=!1,a="",c=kl;return e!=null&&(e.unstable_strictMode===!0&&(s=!0),e.identifierPrefix!==void 0&&(a=e.identifierPrefix),e.onRecoverableError!==void 0&&(c=e.onRecoverableError)),e=bl(o,1,!1,null,null,s,!1,a,c),o[uf]=e.current,sf(o.nodeType===8?o.parentNode:o),new ll(e)};reactDom_production_min.findDOMNode=function(o){if(o==null)return null;if(o.nodeType===1)return o;var e=o._reactInternals;if(e===void 0)throw typeof o.render=="function"?Error(p(188)):(o=Object.keys(o).join(","),Error(p(268,o)));return o=Zb(e),o=o===null?null:o.stateNode,o};reactDom_production_min.flushSync=function(o){return Rk(o)};reactDom_production_min.hydrate=function(o,e,s){if(!ol(e))throw Error(p(200));return rl(null,o,e,!0,s)};reactDom_production_min.hydrateRoot=function(o,e,s){if(!nl(o))throw Error(p(405));var a=s!=null&&s.hydratedSources||null,c=!1,d="",b=kl;if(s!=null&&(s.unstable_strictMode===!0&&(c=!0),s.identifierPrefix!==void 0&&(d=s.identifierPrefix),s.onRecoverableError!==void 0&&(b=s.onRecoverableError)),e=el(e,null,o,1,s??null,c,!1,d,b),o[uf]=e.current,sf(o),a)for(o=0;o<a.length;o++)s=a[o],c=s._getVersion,c=c(s._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[s,c]:e.mutableSourceEagerHydrationData.push(s,c);return new ml(e)};reactDom_production_min.render=function(o,e,s){if(!ol(e))throw Error(p(200));return rl(null,o,e,!1,s)};reactDom_production_min.unmountComponentAtNode=function(o){if(!ol(o))throw Error(p(40));return o._reactRootContainer?(Rk(function(){rl(null,null,o,!1,function(){o._reactRootContainer=null,o[uf]=null})}),!0):!1};reactDom_production_min.unstable_batchedUpdates=Qk;reactDom_production_min.unstable_renderSubtreeIntoContainer=function(o,e,s,a){if(!ol(s))throw Error(p(200));if(o==null||o._reactInternals===void 0)throw Error(p(38));return rl(o,e,s,!1,a)};reactDom_production_min.version="18.3.1-next-f1338f8080-20240426";function checkDCE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(checkDCE)}catch(o){console.error(o)}}checkDCE(),reactDom.exports=reactDom_production_min;var reactDomExports=reactDom.exports,createRoot$1,m=reactDomExports;createRoot$1=m.createRoot,m.hydrateRoot;var Subscribable=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(o){return this.listeners.add(o),this.onSubscribe(),()=>{this.listeners.delete(o),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},isServer=typeof window>"u"||"Deno"in globalThis;function noop(){}function functionalUpdate(o,e){return typeof o=="function"?o(e):o}function isValidTimeout(o){return typeof o=="number"&&o>=0&&o!==1/0}function timeUntilStale(o,e){return Math.max(o+(e||0)-Date.now(),0)}function resolveStaleTime(o,e){return typeof o=="function"?o(e):o}function resolveEnabled(o,e){return typeof o=="function"?o(e):o}function matchQuery(o,e){const{type:s="all",exact:a,fetchStatus:c,predicate:d,queryKey:b,stale:_e}=o;if(b){if(a){if(e.queryHash!==hashQueryKeyByOptions(b,e.options))return!1}else if(!partialMatchKey(e.queryKey,b))return!1}if(s!=="all"){const tt=e.isActive();if(s==="active"&&!tt||s==="inactive"&&tt)return!1}return!(typeof _e=="boolean"&&e.isStale()!==_e||c&&c!==e.state.fetchStatus||d&&!d(e))}function matchMutation(o,e){const{exact:s,status:a,predicate:c,mutationKey:d}=o;if(d){if(!e.options.mutationKey)return!1;if(s){if(hashKey(e.options.mutationKey)!==hashKey(d))return!1}else if(!partialMatchKey(e.options.mutationKey,d))return!1}return!(a&&e.state.status!==a||c&&!c(e))}function hashQueryKeyByOptions(o,e){return((e==null?void 0:e.queryKeyHashFn)||hashKey)(o)}function hashKey(o){return JSON.stringify(o,(e,s)=>isPlainObject(s)?Object.keys(s).sort().reduce((a,c)=>(a[c]=s[c],a),{}):s)}function partialMatchKey(o,e){return o===e?!0:typeof o!=typeof e?!1:o&&e&&typeof o=="object"&&typeof e=="object"?!Object.keys(e).some(s=>!partialMatchKey(o[s],e[s])):!1}function replaceEqualDeep(o,e){if(o===e)return o;const s=isPlainArray(o)&&isPlainArray(e);if(s||isPlainObject(o)&&isPlainObject(e)){const a=s?o:Object.keys(o),c=a.length,d=s?e:Object.keys(e),b=d.length,_e=s?[]:{};let tt=0;for(let nt=0;nt<b;nt++){const it=s?nt:d[nt];(!s&&a.includes(it)||s)&&o[it]===void 0&&e[it]===void 0?(_e[it]=void 0,tt++):(_e[it]=replaceEqualDeep(o[it],e[it]),_e[it]===o[it]&&o[it]!==void 0&&tt++)}return c===b&&tt===c?o:_e}return e}function isPlainArray(o){return Array.isArray(o)&&o.length===Object.keys(o).length}function isPlainObject(o){if(!hasObjectPrototype(o))return!1;const e=o.constructor;if(e===void 0)return!0;const s=e.prototype;return!(!hasObjectPrototype(s)||!s.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(o)!==Object.prototype)}function hasObjectPrototype(o){return Object.prototype.toString.call(o)==="[object Object]"}function sleep(o){return new Promise(e=>{setTimeout(e,o)})}function replaceData(o,e,s){return typeof s.structuralSharing=="function"?s.structuralSharing(o,e):s.structuralSharing!==!1?replaceEqualDeep(o,e):e}function addToEnd(o,e,s=0){const a=[...o,e];return s&&a.length>s?a.slice(1):a}function addToStart(o,e,s=0){const a=[e,...o];return s&&a.length>s?a.slice(0,-1):a}var skipToken=Symbol();function ensureQueryFn(o,e){return!o.queryFn&&(e!=null&&e.initialPromise)?()=>e.initialPromise:!o.queryFn||o.queryFn===skipToken?()=>Promise.reject(new Error(`Missing queryFn: '${o.queryHash}'`)):o.queryFn}var _o,so,Oo,ix,FocusManager=(ix=class extends Subscribable{constructor(){super();Nr(this,_o);Nr(this,so);Nr(this,Oo);_r(this,Oo,e=>{if(!isServer&&window.addEventListener){const s=()=>e();return window.addEventListener("visibilitychange",s,!1),()=>{window.removeEventListener("visibilitychange",s)}}})}onSubscribe(){Mn(this,so)||this.setEventListener(Mn(this,Oo))}onUnsubscribe(){var e;this.hasListeners()||((e=Mn(this,so))==null||e.call(this),_r(this,so,void 0))}setEventListener(e){var s;_r(this,Oo,e),(s=Mn(this,so))==null||s.call(this),_r(this,so,e(a=>{typeof a=="boolean"?this.setFocused(a):this.onFocus()}))}setFocused(e){Mn(this,_o)!==e&&(_r(this,_o,e),this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(s=>{s(e)})}isFocused(){var e;return typeof Mn(this,_o)=="boolean"?Mn(this,_o):((e=globalThis.document)==null?void 0:e.visibilityState)!=="hidden"}},_o=new WeakMap,so=new WeakMap,Oo=new WeakMap,ix),focusManager=new FocusManager,Uo,oo,Go,sx,OnlineManager=(sx=class extends Subscribable{constructor(){super();Nr(this,Uo,!0);Nr(this,oo);Nr(this,Go);_r(this,Go,e=>{if(!isServer&&window.addEventListener){const s=()=>e(!0),a=()=>e(!1);return window.addEventListener("online",s,!1),window.addEventListener("offline",a,!1),()=>{window.removeEventListener("online",s),window.removeEventListener("offline",a)}}})}onSubscribe(){Mn(this,oo)||this.setEventListener(Mn(this,Go))}onUnsubscribe(){var e;this.hasListeners()||((e=Mn(this,oo))==null||e.call(this),_r(this,oo,void 0))}setEventListener(e){var s;_r(this,Go,e),(s=Mn(this,oo))==null||s.call(this),_r(this,oo,e(this.setOnline.bind(this)))}setOnline(e){Mn(this,Uo)!==e&&(_r(this,Uo,e),this.listeners.forEach(a=>{a(e)}))}isOnline(){return Mn(this,Uo)}},Uo=new WeakMap,oo=new WeakMap,Go=new WeakMap,sx),onlineManager=new OnlineManager;function pendingThenable(){let o,e;const s=new Promise((c,d)=>{o=c,e=d});s.status="pending",s.catch(()=>{});function a(c){Object.assign(s,c),delete s.resolve,delete s.reject}return s.resolve=c=>{a({status:"fulfilled",value:c}),o(c)},s.reject=c=>{a({status:"rejected",reason:c}),e(c)},s}function defaultRetryDelay(o){return Math.min(1e3*2**o,3e4)}function canFetch(o){return(o??"online")==="online"?onlineManager.isOnline():!0}var CancelledError=class extends Error{constructor(o){super("CancelledError"),this.revert=o==null?void 0:o.revert,this.silent=o==null?void 0:o.silent}};function isCancelledError(o){return o instanceof CancelledError}function createRetryer(o){let e=!1,s=0,a=!1,c;const d=pendingThenable(),b=ft=>{var dt;a||(at(new CancelledError(ft)),(dt=o.abort)==null||dt.call(o))},_e=()=>{e=!0},tt=()=>{e=!1},nt=()=>focusManager.isFocused()&&(o.networkMode==="always"||onlineManager.isOnline())&&o.canRun(),it=()=>canFetch(o.networkMode)&&o.canRun(),ot=ft=>{var dt;a||(a=!0,(dt=o.onSuccess)==null||dt.call(o,ft),c==null||c(),d.resolve(ft))},at=ft=>{var dt;a||(a=!0,(dt=o.onError)==null||dt.call(o,ft),c==null||c(),d.reject(ft))},ct=()=>new Promise(ft=>{var dt;c=lt=>{(a||nt())&&ft(lt)},(dt=o.onPause)==null||dt.call(o)}).then(()=>{var ft;c=void 0,a||(ft=o.onContinue)==null||ft.call(o)}),ut=()=>{if(a)return;let ft;const dt=s===0?o.initialPromise:void 0;try{ft=dt??o.fn()}catch(lt){ft=Promise.reject(lt)}Promise.resolve(ft).then(ot).catch(lt=>{var yt;if(a)return;const ht=o.retry??(isServer?0:3),mt=o.retryDelay??defaultRetryDelay,xt=typeof mt=="function"?mt(s,lt):mt,St=ht===!0||typeof ht=="number"&&s<ht||typeof ht=="function"&&ht(s,lt);if(e||!St){at(lt);return}s++,(yt=o.onFail)==null||yt.call(o,s,lt),sleep(xt).then(()=>nt()?void 0:ct()).then(()=>{e?at(lt):ut()})})};return{promise:d,cancel:b,continue:()=>(c==null||c(),d),cancelRetry:_e,continueRetry:tt,canStart:it,start:()=>(it()?ut():ct().then(ut),d)}}function createNotifyManager(){let o=[],e=0,s=_e=>{_e()},a=_e=>{_e()},c=_e=>setTimeout(_e,0);const d=_e=>{e?o.push(_e):c(()=>{s(_e)})},b=()=>{const _e=o;o=[],_e.length&&c(()=>{a(()=>{_e.forEach(tt=>{s(tt)})})})};return{batch:_e=>{let tt;e++;try{tt=_e()}finally{e--,e||b()}return tt},batchCalls:_e=>(...tt)=>{d(()=>{_e(...tt)})},schedule:d,setNotifyFunction:_e=>{s=_e},setBatchNotifyFunction:_e=>{a=_e},setScheduler:_e=>{c=_e}}}var notifyManager=createNotifyManager(),So,ox,Removable=(ox=class{constructor(){Nr(this,So)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),isValidTimeout(this.gcTime)&&_r(this,So,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(o){this.gcTime=Math.max(this.gcTime||0,o??(isServer?1/0:5*60*1e3))}clearGcTimeout(){Mn(this,So)&&(clearTimeout(Mn(this,So)),_r(this,So,void 0))}},So=new WeakMap,ox),zo,Ho,Rs,ns,Al,bo,Ts,Ks,ax,Query=(ax=class extends Removable{constructor(e){super();Nr(this,Ts);Nr(this,zo);Nr(this,Ho);Nr(this,Rs);Nr(this,ns);Nr(this,Al);Nr(this,bo);_r(this,bo,!1),_r(this,Al,e.defaultOptions),this.setOptions(e.options),this.observers=[],_r(this,Rs,e.cache),this.queryKey=e.queryKey,this.queryHash=e.queryHash,_r(this,zo,getDefaultState$1(this.options)),this.state=e.state??Mn(this,zo),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var e;return(e=Mn(this,ns))==null?void 0:e.promise}setOptions(e){this.options={...Mn(this,Al),...e},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&Mn(this,Rs).remove(this)}setData(e,s){const a=replaceData(this.state.data,e,this.options);return ts(this,Ts,Ks).call(this,{data:a,type:"success",dataUpdatedAt:s==null?void 0:s.updatedAt,manual:s==null?void 0:s.manual}),a}setState(e,s){ts(this,Ts,Ks).call(this,{type:"setState",state:e,setStateOptions:s})}cancel(e){var a,c;const s=(a=Mn(this,ns))==null?void 0:a.promise;return(c=Mn(this,ns))==null||c.cancel(e),s?s.then(noop).catch(noop):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(Mn(this,zo))}isActive(){return this.observers.some(e=>resolveEnabled(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===skipToken||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStale(){return this.state.isInvalidated?!0:this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0}isStaleByTime(e=0){return this.state.isInvalidated||this.state.data===void 0||!timeUntilStale(this.state.dataUpdatedAt,e)}onFocus(){var s;const e=this.observers.find(a=>a.shouldFetchOnWindowFocus());e==null||e.refetch({cancelRefetch:!1}),(s=Mn(this,ns))==null||s.continue()}onOnline(){var s;const e=this.observers.find(a=>a.shouldFetchOnReconnect());e==null||e.refetch({cancelRefetch:!1}),(s=Mn(this,ns))==null||s.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),Mn(this,Rs).notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(s=>s!==e),this.observers.length||(Mn(this,ns)&&(Mn(this,bo)?Mn(this,ns).cancel({revert:!0}):Mn(this,ns).cancelRetry()),this.scheduleGc()),Mn(this,Rs).notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||ts(this,Ts,Ks).call(this,{type:"invalidate"})}fetch(e,s){var tt,nt,it;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(s!=null&&s.cancelRefetch))this.cancel({silent:!0});else if(Mn(this,ns))return Mn(this,ns).continueRetry(),Mn(this,ns).promise}if(e&&this.setOptions(e),!this.options.queryFn){const ot=this.observers.find(at=>at.options.queryFn);ot&&this.setOptions(ot.options)}const a=new AbortController,c=ot=>{Object.defineProperty(ot,"signal",{enumerable:!0,get:()=>(_r(this,bo,!0),a.signal)})},d=()=>{const ot=ensureQueryFn(this.options,s),at={queryKey:this.queryKey,meta:this.meta};return c(at),_r(this,bo,!1),this.options.persister?this.options.persister(ot,at,this):ot(at)},b={fetchOptions:s,options:this.options,queryKey:this.queryKey,state:this.state,fetchFn:d};c(b),(tt=this.options.behavior)==null||tt.onFetch(b,this),_r(this,Ho,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((nt=b.fetchOptions)==null?void 0:nt.meta))&&ts(this,Ts,Ks).call(this,{type:"fetch",meta:(it=b.fetchOptions)==null?void 0:it.meta});const _e=ot=>{var at,ct,ut,ft;isCancelledError(ot)&&ot.silent||ts(this,Ts,Ks).call(this,{type:"error",error:ot}),isCancelledError(ot)||((ct=(at=Mn(this,Rs).config).onError)==null||ct.call(at,ot,this),(ft=(ut=Mn(this,Rs).config).onSettled)==null||ft.call(ut,this.state.data,ot,this)),this.scheduleGc()};return _r(this,ns,createRetryer({initialPromise:s==null?void 0:s.initialPromise,fn:b.fetchFn,abort:a.abort.bind(a),onSuccess:ot=>{var at,ct,ut,ft;if(ot===void 0){_e(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(ot)}catch(dt){_e(dt);return}(ct=(at=Mn(this,Rs).config).onSuccess)==null||ct.call(at,ot,this),(ft=(ut=Mn(this,Rs).config).onSettled)==null||ft.call(ut,ot,this.state.error,this),this.scheduleGc()},onError:_e,onFail:(ot,at)=>{ts(this,Ts,Ks).call(this,{type:"failed",failureCount:ot,error:at})},onPause:()=>{ts(this,Ts,Ks).call(this,{type:"pause"})},onContinue:()=>{ts(this,Ts,Ks).call(this,{type:"continue"})},retry:b.options.retry,retryDelay:b.options.retryDelay,networkMode:b.options.networkMode,canRun:()=>!0})),Mn(this,ns).start()}},zo=new WeakMap,Ho=new WeakMap,Rs=new WeakMap,ns=new WeakMap,Al=new WeakMap,bo=new WeakMap,Ts=new WeakSet,Ks=function(e){const s=a=>{switch(e.type){case"failed":return{...a,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...a,fetchStatus:"paused"};case"continue":return{...a,fetchStatus:"fetching"};case"fetch":return{...a,...fetchState(a.data,this.options),fetchMeta:e.meta??null};case"success":return{...a,data:e.data,dataUpdateCount:a.dataUpdateCount+1,dataUpdatedAt:e.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const c=e.error;return isCancelledError(c)&&c.revert&&Mn(this,Ho)?{...Mn(this,Ho),fetchStatus:"idle"}:{...a,error:c,errorUpdateCount:a.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:a.fetchFailureCount+1,fetchFailureReason:c,fetchStatus:"idle",status:"error"};case"invalidate":return{...a,isInvalidated:!0};case"setState":return{...a,...e.state}}};this.state=s(this.state),notifyManager.batch(()=>{this.observers.forEach(a=>{a.onQueryUpdate()}),Mn(this,Rs).notify({query:this,type:"updated",action:e})})},ax);function fetchState(o,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:canFetch(e.networkMode)?"fetching":"paused",...o===void 0&&{error:null,status:"pending"}}}function getDefaultState$1(o){const e=typeof o.initialData=="function"?o.initialData():o.initialData,s=e!==void 0,a=s?typeof o.initialDataUpdatedAt=="function"?o.initialDataUpdatedAt():o.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:s?a??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:s?"success":"pending",fetchStatus:"idle"}}var ks,lx,QueryCache=(lx=class extends Subscribable{constructor(e={}){super();Nr(this,ks);this.config=e,_r(this,ks,new Map)}build(e,s,a){const c=s.queryKey,d=s.queryHash??hashQueryKeyByOptions(c,s);let b=this.get(d);return b||(b=new Query({cache:this,queryKey:c,queryHash:d,options:e.defaultQueryOptions(s),state:a,defaultOptions:e.getQueryDefaults(c)}),this.add(b)),b}add(e){Mn(this,ks).has(e.queryHash)||(Mn(this,ks).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const s=Mn(this,ks).get(e.queryHash);s&&(e.destroy(),s===e&&Mn(this,ks).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){notifyManager.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return Mn(this,ks).get(e)}getAll(){return[...Mn(this,ks).values()]}find(e){const s={exact:!0,...e};return this.getAll().find(a=>matchQuery(s,a))}findAll(e={}){const s=this.getAll();return Object.keys(e).length>0?s.filter(a=>matchQuery(e,a)):s}notify(e){notifyManager.batch(()=>{this.listeners.forEach(s=>{s(e)})})}onFocus(){notifyManager.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){notifyManager.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},ks=new WeakMap,lx),Os,as,wo,Us,io,cx,Mutation=(cx=class extends Removable{constructor(e){super();Nr(this,Us);Nr(this,Os);Nr(this,as);Nr(this,wo);this.mutationId=e.mutationId,_r(this,as,e.mutationCache),_r(this,Os,[]),this.state=e.state||getDefaultState(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){Mn(this,Os).includes(e)||(Mn(this,Os).push(e),this.clearGcTimeout(),Mn(this,as).notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){_r(this,Os,Mn(this,Os).filter(s=>s!==e)),this.scheduleGc(),Mn(this,as).notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){Mn(this,Os).length||(this.state.status==="pending"?this.scheduleGc():Mn(this,as).remove(this))}continue(){var e;return((e=Mn(this,wo))==null?void 0:e.continue())??this.execute(this.state.variables)}async execute(e){var c,d,b,_e,tt,nt,it,ot,at,ct,ut,ft,dt,lt,ht,mt,xt,St,yt,wt;_r(this,wo,createRetryer({fn:()=>this.options.mutationFn?this.options.mutationFn(e):Promise.reject(new Error("No mutationFn found")),onFail:(Et,_t)=>{ts(this,Us,io).call(this,{type:"failed",failureCount:Et,error:_t})},onPause:()=>{ts(this,Us,io).call(this,{type:"pause"})},onContinue:()=>{ts(this,Us,io).call(this,{type:"continue"})},retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>Mn(this,as).canRun(this)}));const s=this.state.status==="pending",a=!Mn(this,wo).canStart();try{if(!s){ts(this,Us,io).call(this,{type:"pending",variables:e,isPaused:a}),await((d=(c=Mn(this,as).config).onMutate)==null?void 0:d.call(c,e,this));const _t=await((_e=(b=this.options).onMutate)==null?void 0:_e.call(b,e));_t!==this.state.context&&ts(this,Us,io).call(this,{type:"pending",context:_t,variables:e,isPaused:a})}const Et=await Mn(this,wo).start();return await((nt=(tt=Mn(this,as).config).onSuccess)==null?void 0:nt.call(tt,Et,e,this.state.context,this)),await((ot=(it=this.options).onSuccess)==null?void 0:ot.call(it,Et,e,this.state.context)),await((ct=(at=Mn(this,as).config).onSettled)==null?void 0:ct.call(at,Et,null,this.state.variables,this.state.context,this)),await((ft=(ut=this.options).onSettled)==null?void 0:ft.call(ut,Et,null,e,this.state.context)),ts(this,Us,io).call(this,{type:"success",data:Et}),Et}catch(Et){try{throw await((lt=(dt=Mn(this,as).config).onError)==null?void 0:lt.call(dt,Et,e,this.state.context,this)),await((mt=(ht=this.options).onError)==null?void 0:mt.call(ht,Et,e,this.state.context)),await((St=(xt=Mn(this,as).config).onSettled)==null?void 0:St.call(xt,void 0,Et,this.state.variables,this.state.context,this)),await((wt=(yt=this.options).onSettled)==null?void 0:wt.call(yt,void 0,Et,e,this.state.context)),Et}finally{ts(this,Us,io).call(this,{type:"error",error:Et})}}finally{Mn(this,as).runNext(this)}}},Os=new WeakMap,as=new WeakMap,wo=new WeakMap,Us=new WeakSet,io=function(e){const s=a=>{switch(e.type){case"failed":return{...a,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...a,isPaused:!0};case"continue":return{...a,isPaused:!1};case"pending":return{...a,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...a,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...a,data:void 0,error:e.error,failureCount:a.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=s(this.state),notifyManager.batch(()=>{Mn(this,Os).forEach(a=>{a.onMutationUpdate(e)}),Mn(this,as).notify({mutation:this,type:"updated",action:e})})},cx);function getDefaultState(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var gs,Cl,ux,MutationCache=(ux=class extends Subscribable{constructor(e={}){super();Nr(this,gs);Nr(this,Cl);this.config=e,_r(this,gs,new Map),_r(this,Cl,Date.now())}build(e,s,a){const c=new Mutation({mutationCache:this,mutationId:++bu(this,Cl)._,options:e.defaultMutationOptions(s),state:a});return this.add(c),c}add(e){const s=scopeFor(e),a=Mn(this,gs).get(s)??[];a.push(e),Mn(this,gs).set(s,a),this.notify({type:"added",mutation:e})}remove(e){var a;const s=scopeFor(e);if(Mn(this,gs).has(s)){const c=(a=Mn(this,gs).get(s))==null?void 0:a.filter(d=>d!==e);c&&(c.length===0?Mn(this,gs).delete(s):Mn(this,gs).set(s,c))}this.notify({type:"removed",mutation:e})}canRun(e){var a;const s=(a=Mn(this,gs).get(scopeFor(e)))==null?void 0:a.find(c=>c.state.status==="pending");return!s||s===e}runNext(e){var a;const s=(a=Mn(this,gs).get(scopeFor(e)))==null?void 0:a.find(c=>c!==e&&c.state.isPaused);return(s==null?void 0:s.continue())??Promise.resolve()}clear(){notifyManager.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}getAll(){return[...Mn(this,gs).values()].flat()}find(e){const s={exact:!0,...e};return this.getAll().find(a=>matchMutation(s,a))}findAll(e={}){return this.getAll().filter(s=>matchMutation(e,s))}notify(e){notifyManager.batch(()=>{this.listeners.forEach(s=>{s(e)})})}resumePausedMutations(){const e=this.getAll().filter(s=>s.state.isPaused);return notifyManager.batch(()=>Promise.all(e.map(s=>s.continue().catch(noop))))}},gs=new WeakMap,Cl=new WeakMap,ux);function scopeFor(o){var e;return((e=o.options.scope)==null?void 0:e.id)??String(o.mutationId)}function infiniteQueryBehavior(o){return{onFetch:(e,s)=>{var it,ot,at,ct,ut;const a=e.options,c=(at=(ot=(it=e.fetchOptions)==null?void 0:it.meta)==null?void 0:ot.fetchMore)==null?void 0:at.direction,d=((ct=e.state.data)==null?void 0:ct.pages)||[],b=((ut=e.state.data)==null?void 0:ut.pageParams)||[];let _e={pages:[],pageParams:[]},tt=0;const nt=async()=>{let ft=!1;const dt=mt=>{Object.defineProperty(mt,"signal",{enumerable:!0,get:()=>(e.signal.aborted?ft=!0:e.signal.addEventListener("abort",()=>{ft=!0}),e.signal)})},lt=ensureQueryFn(e.options,e.fetchOptions),ht=async(mt,xt,St)=>{if(ft)return Promise.reject();if(xt==null&&mt.pages.length)return Promise.resolve(mt);const yt={queryKey:e.queryKey,pageParam:xt,direction:St?"backward":"forward",meta:e.options.meta};dt(yt);const wt=await lt(yt),{maxPages:Et}=e.options,_t=St?addToStart:addToEnd;return{pages:_t(mt.pages,wt,Et),pageParams:_t(mt.pageParams,xt,Et)}};if(c&&d.length){const mt=c==="backward",xt=mt?getPreviousPageParam:getNextPageParam,St={pages:d,pageParams:b},yt=xt(a,St);_e=await ht(St,yt,mt)}else{const mt=o??d.length;do{const xt=tt===0?b[0]??a.initialPageParam:getNextPageParam(a,_e);if(tt>0&&xt==null)break;_e=await ht(_e,xt),tt++}while(tt<mt)}return _e};e.options.persister?e.fetchFn=()=>{var ft,dt;return(dt=(ft=e.options).persister)==null?void 0:dt.call(ft,nt,{queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},s)}:e.fetchFn=nt}}}function getNextPageParam(o,{pages:e,pageParams:s}){const a=e.length-1;return e.length>0?o.getNextPageParam(e[a],e,s[a],s):void 0}function getPreviousPageParam(o,{pages:e,pageParams:s}){var a;return e.length>0?(a=o.getPreviousPageParam)==null?void 0:a.call(o,e[0],e,s[0],s):void 0}var Gr,ao,lo,Vo,$o,co,Wo,Xo,dx,QueryClient=(dx=class{constructor(o={}){Nr(this,Gr);Nr(this,ao);Nr(this,lo);Nr(this,Vo);Nr(this,$o);Nr(this,co);Nr(this,Wo);Nr(this,Xo);_r(this,Gr,o.queryCache||new QueryCache),_r(this,ao,o.mutationCache||new MutationCache),_r(this,lo,o.defaultOptions||{}),_r(this,Vo,new Map),_r(this,$o,new Map),_r(this,co,0)}mount(){bu(this,co)._++,Mn(this,co)===1&&(_r(this,Wo,focusManager.subscribe(async o=>{o&&(await this.resumePausedMutations(),Mn(this,Gr).onFocus())})),_r(this,Xo,onlineManager.subscribe(async o=>{o&&(await this.resumePausedMutations(),Mn(this,Gr).onOnline())})))}unmount(){var o,e;bu(this,co)._--,Mn(this,co)===0&&((o=Mn(this,Wo))==null||o.call(this),_r(this,Wo,void 0),(e=Mn(this,Xo))==null||e.call(this),_r(this,Xo,void 0))}isFetching(o){return Mn(this,Gr).findAll({...o,fetchStatus:"fetching"}).length}isMutating(o){return Mn(this,ao).findAll({...o,status:"pending"}).length}getQueryData(o){var s;const e=this.defaultQueryOptions({queryKey:o});return(s=Mn(this,Gr).get(e.queryHash))==null?void 0:s.state.data}ensureQueryData(o){const e=this.getQueryData(o.queryKey);if(e===void 0)return this.fetchQuery(o);{const s=this.defaultQueryOptions(o),a=Mn(this,Gr).build(this,s);return o.revalidateIfStale&&a.isStaleByTime(resolveStaleTime(s.staleTime,a))&&this.prefetchQuery(s),Promise.resolve(e)}}getQueriesData(o){return Mn(this,Gr).findAll(o).map(({queryKey:e,state:s})=>{const a=s.data;return[e,a]})}setQueryData(o,e,s){const a=this.defaultQueryOptions({queryKey:o}),c=Mn(this,Gr).get(a.queryHash),d=c==null?void 0:c.state.data,b=functionalUpdate(e,d);if(b!==void 0)return Mn(this,Gr).build(this,a).setData(b,{...s,manual:!0})}setQueriesData(o,e,s){return notifyManager.batch(()=>Mn(this,Gr).findAll(o).map(({queryKey:a})=>[a,this.setQueryData(a,e,s)]))}getQueryState(o){var s;const e=this.defaultQueryOptions({queryKey:o});return(s=Mn(this,Gr).get(e.queryHash))==null?void 0:s.state}removeQueries(o){const e=Mn(this,Gr);notifyManager.batch(()=>{e.findAll(o).forEach(s=>{e.remove(s)})})}resetQueries(o,e){const s=Mn(this,Gr),a={type:"active",...o};return notifyManager.batch(()=>(s.findAll(o).forEach(c=>{c.reset()}),this.refetchQueries(a,e)))}cancelQueries(o={},e={}){const s={revert:!0,...e},a=notifyManager.batch(()=>Mn(this,Gr).findAll(o).map(c=>c.cancel(s)));return Promise.all(a).then(noop).catch(noop)}invalidateQueries(o={},e={}){return notifyManager.batch(()=>{if(Mn(this,Gr).findAll(o).forEach(a=>{a.invalidate()}),o.refetchType==="none")return Promise.resolve();const s={...o,type:o.refetchType??o.type??"active"};return this.refetchQueries(s,e)})}refetchQueries(o={},e){const s={...e,cancelRefetch:(e==null?void 0:e.cancelRefetch)??!0},a=notifyManager.batch(()=>Mn(this,Gr).findAll(o).filter(c=>!c.isDisabled()).map(c=>{let d=c.fetch(void 0,s);return s.throwOnError||(d=d.catch(noop)),c.state.fetchStatus==="paused"?Promise.resolve():d}));return Promise.all(a).then(noop)}fetchQuery(o){const e=this.defaultQueryOptions(o);e.retry===void 0&&(e.retry=!1);const s=Mn(this,Gr).build(this,e);return s.isStaleByTime(resolveStaleTime(e.staleTime,s))?s.fetch(e):Promise.resolve(s.state.data)}prefetchQuery(o){return this.fetchQuery(o).then(noop).catch(noop)}fetchInfiniteQuery(o){return o.behavior=infiniteQueryBehavior(o.pages),this.fetchQuery(o)}prefetchInfiniteQuery(o){return this.fetchInfiniteQuery(o).then(noop).catch(noop)}ensureInfiniteQueryData(o){return o.behavior=infiniteQueryBehavior(o.pages),this.ensureQueryData(o)}resumePausedMutations(){return onlineManager.isOnline()?Mn(this,ao).resumePausedMutations():Promise.resolve()}getQueryCache(){return Mn(this,Gr)}getMutationCache(){return Mn(this,ao)}getDefaultOptions(){return Mn(this,lo)}setDefaultOptions(o){_r(this,lo,o)}setQueryDefaults(o,e){Mn(this,Vo).set(hashKey(o),{queryKey:o,defaultOptions:e})}getQueryDefaults(o){const e=[...Mn(this,Vo).values()];let s={};return e.forEach(a=>{partialMatchKey(o,a.queryKey)&&(s={...s,...a.defaultOptions})}),s}setMutationDefaults(o,e){Mn(this,$o).set(hashKey(o),{mutationKey:o,defaultOptions:e})}getMutationDefaults(o){const e=[...Mn(this,$o).values()];let s={};return e.forEach(a=>{partialMatchKey(o,a.mutationKey)&&(s={...s,...a.defaultOptions})}),s}defaultQueryOptions(o){if(o._defaulted)return o;const e={...Mn(this,lo).queries,...this.getQueryDefaults(o.queryKey),...o,_defaulted:!0};return e.queryHash||(e.queryHash=hashQueryKeyByOptions(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.enabled!==!0&&e.queryFn===skipToken&&(e.enabled=!1),e}defaultMutationOptions(o){return o!=null&&o._defaulted?o:{...Mn(this,lo).mutations,...(o==null?void 0:o.mutationKey)&&this.getMutationDefaults(o.mutationKey),...o,_defaulted:!0}}clear(){Mn(this,Gr).clear(),Mn(this,ao).clear()}},Gr=new WeakMap,ao=new WeakMap,lo=new WeakMap,Vo=new WeakMap,$o=new WeakMap,co=new WeakMap,Wo=new WeakMap,Xo=new WeakMap,dx),QueryClientContext=reactExports.createContext(void 0),QueryClientProvider=({client:o,children:e})=>(reactExports.useEffect(()=>(o.mount(),()=>{o.unmount()}),[o]),jsxRuntimeExports.jsx(QueryClientContext.Provider,{value:o,children:e}));const DesktopContext=reactExports.createContext(void 0),DesktopProvider=({children:o})=>{const[e,s]=reactExports.useState({}),[a,c]=reactExports.useState(1e3),d=reactExports.useCallback(it=>{const{id:ot,title:at,component:ct,position:ut,size:ft,props:dt}=it;s(lt=>{if(lt[ot])return{...lt,[ot]:{...lt[ot],isMinimized:!1,zIndex:a}};const ht=Object.keys(lt).length,mt={id:ot,title:at,component:ct,position:ut||{x:100+ht*30,y:100+ht*30},size:ft||{width:800,height:600},isMinimized:!1,isMaximized:!1,zIndex:a,props:dt||{}};return c(xt=>xt+1),{...lt,[ot]:mt}})},[a]),b=reactExports.useCallback(it=>{s(ot=>{const{[it]:at,...ct}=ot;return ct})},[]),_e=reactExports.useCallback((it,ot)=>{s(at=>({...at,[it]:{...at[it],...ot}}))},[]),tt=reactExports.useCallback(it=>{s(ot=>{const at=Math.max(...Object.values(ot).map(ct=>ct.zIndex),1e3);return{...ot,[it]:{...ot[it],zIndex:at+1,isMinimized:!1}}}),c(ot=>ot+1)},[]),nt={windows:e,openWindow:d,closeWindow:b,updateWindow:_e,focusWindow:tt};return jsxRuntimeExports.jsx(DesktopContext.Provider,{value:nt,children:o})},useDesktop=()=>{const o=reactExports.useContext(DesktopContext);if(!o)throw new Error("useDesktop must be used within a DesktopProvider");return o},initialGameState={player:{id:"player1",position:{x:0,y:.5,z:0},velocity:{x:0,y:0,z:0},health:100,money:1e3,wantedLevel:0,isGrounded:!0,currentVehicle:null,currentTerritory:"Downtown",color:"#4169E1"},vehicles:[{id:"car1",type:"car",position:{x:5,y:.5,z:5},rotation:{x:0,y:0,z:0},health:100,speed:0,playerId:null},{id:"boat1",type:"boat",position:{x:80,y:.5,z:80},rotation:{x:0,y:0,z:0},health:100,speed:0,playerId:null}],bosses:[{id:"rodriguez",type:"rodriguez",position:{x:30,y:.5,z:30},health:200,maxHealth:200,isActive:!0,attackCooldown:0}],missions:[{id:"mission1",title:"Steal the Golden Block",description:"Infiltrate the boss hideout and steal the golden block",objectives:[{type:"steal",target:"golden_block",position:{x:25,y:1,z:25},completed:!1}],reward:5e3,isActive:!0,isCompleted:!1}],currentMission:null,weedFarm:{plots:[{id:"plot1",position:{x:-18,y:0,z:-18},stage:"mature",growthTime:60,value:500},{id:"plot2",position:{x:-16,y:0,z:-18},stage:"growing",growthTime:30,value:300},{id:"plot3",position:{x:-14,y:0,z:-18},stage:"sprout",growthTime:15,value:100},{id:"plot4",position:{x:-12,y:0,z:-18},stage:"seed",growthTime:5,value:50}],totalValue:950},gameStats:{money:1e3,completedMissions:0,totalKills:0,timePlayed:0},territories:["Downtown","Industrial","Beach","Suburbs"],isPaused:!1},GameContext=reactExports.createContext(void 0),GameStateProvider=({children:o})=>{const[e,s]=reactExports.useState(initialGameState),a=reactExports.useCallback(lt=>{s(ht=>({...ht,player:{...ht.player,...lt}}))},[]),c=reactExports.useCallback((lt,ht)=>{s(mt=>({...mt,vehicles:mt.vehicles.map(xt=>xt.id===lt?{...xt,...ht}:xt)}))},[]),d=reactExports.useCallback((lt,ht)=>{s(mt=>({...mt,bosses:mt.bosses.map(xt=>xt.id===lt?{...xt,...ht}:xt)}))},[]),b=reactExports.useCallback((lt,ht)=>{s(mt=>({...mt,weedFarm:{...mt.weedFarm,plots:mt.weedFarm.plots.map(xt=>xt.id===lt?{...xt,...ht}:xt)}}))},[]),_e=reactExports.useCallback(lt=>{s(ht=>{const mt=ht.vehicles.find(xt=>xt.id===lt);return mt?{...ht,player:{...ht.player,currentVehicle:mt},vehicles:ht.vehicles.map(xt=>xt.id===lt?{...xt,playerId:ht.player.id}:xt)}:ht})},[]),tt=reactExports.useCallback(()=>{s(lt=>({...lt,player:{...lt.player,currentVehicle:null},vehicles:lt.vehicles.map(ht=>ht.playerId===lt.player.id?{...ht,playerId:null}:ht)}))},[]),nt=reactExports.useCallback((lt,ht)=>{s(mt=>({...mt,bosses:mt.bosses.map(xt=>xt.id===lt?{...xt,health:Math.max(0,xt.health-ht)}:xt)}))},[]),it=reactExports.useCallback(lt=>{s(ht=>{const mt=ht.missions.find(xt=>xt.id===lt);return mt?{...ht,currentMission:mt,missions:ht.missions.map(xt=>xt.id===lt?{...xt,isActive:!0}:xt)}:ht})},[]),ot=reactExports.useCallback(lt=>{s(ht=>{const mt=ht.missions.find(xt=>xt.id===lt);return mt?{...ht,player:{...ht.player,money:ht.player.money+mt.reward},currentMission:null,missions:ht.missions.map(xt=>xt.id===lt?{...xt,isActive:!1,isCompleted:!0}:xt),gameStats:{...ht.gameStats,money:ht.gameStats.money+mt.reward,completedMissions:ht.gameStats.completedMissions+1}}:ht})},[]),at=reactExports.useCallback(lt=>{s(ht=>{const mt=ht.weedFarm.plots.find(xt=>xt.id===lt);return!mt||mt.stage!=="mature"?ht:{...ht,player:{...ht.player,money:ht.player.money+mt.value},weedFarm:{...ht.weedFarm,plots:ht.weedFarm.plots.map(xt=>xt.id===lt?{...xt,stage:"harvested",growthTime:0}:xt)},gameStats:{...ht.gameStats,money:ht.gameStats.money+mt.value}}})},[]),ct=reactExports.useCallback(()=>{s(lt=>({...lt,isPaused:!0}))},[]),ut=reactExports.useCallback(()=>{s(lt=>({...lt,isPaused:!1}))},[]),ft=reactExports.useCallback(()=>{s(initialGameState)},[]),dt={...e,updatePlayer:a,updateVehicle:c,updateBoss:d,updateWeedFarm:b,enterVehicle:_e,exitVehicle:tt,damageBoss:nt,startMission:it,completeMission:ot,harvestWeed:at,pauseGame:ct,resumeGame:ut,resetGame:ft};return jsxRuntimeExports.jsx(GameContext.Provider,{value:dt,children:o})},Calculator=()=>{const[o,e]=reactExports.useState("0"),[s,a]=reactExports.useState(null),[c,d]=reactExports.useState(null),[b,_e]=reactExports.useState(!1),tt=ht=>{b?(e(ht),_e(!1)):e(o==="0"?ht:o+ht)},nt=()=>{b?(e("0."),_e(!1)):o.includes(".")||e(o+".")},it=()=>{e("0"),a(null),d(null),_e(!1)},ot=ht=>{const mt=parseFloat(o);if(s===null)a(mt);else if(c){const xt=s;let St=0;switch(c){case"+":St=xt+mt;break;case"-":St=xt-mt;break;case"":St=xt*mt;break;case"":St=mt!==0?xt/mt:0;break;default:St=mt}e(String(St)),a(St)}_e(!0),d(ht)},at=()=>{if(!c||s===null)return;const ht=parseFloat(o);let mt=0;switch(c){case"+":mt=s+ht;break;case"-":mt=s-ht;break;case"":mt=s*ht;break;case"":mt=ht!==0?s/ht:0;break}e(String(mt)),a(null),d(null),_e(!0)},ct=()=>{const ht=parseFloat(o);e(String(-ht))},ut=()=>{const ht=parseFloat(o);e(String(ht/100))},ft=[["C","","%",""],["7","8","9",""],["4","5","6","-"],["1","2","3","+"],["0",".","="]],dt=ht=>{ht>="0"&&ht<="9"?tt(ht):ht==="."?nt():ht==="C"?it():ht===""?ct():ht==="%"?ut():ht==="="?at():["+","-","",""].includes(ht)&&ot(ht)},lt=ht=>{const mt="text-lg font-bold rounded transition-colors focus:outline-none active:scale-95";return["+","-","","","="].includes(ht)?`${mt} bg-[#c9a227] text-black hover:bg-[#d9b237]`:["C","","%"].includes(ht)?`${mt} bg-[#1a5a5a] text-white hover:bg-[#1a6a6a]`:`${mt} bg-[#252525] text-white hover:bg-[#353535]`};return jsxRuntimeExports.jsxs("div",{className:"h-full flex flex-col bg-[#0a0a0a] p-3",children:[jsxRuntimeExports.jsxs("div",{className:"bg-[#1a1a1a] rounded-lg p-4 mb-3 border border-[#1a5a5a]",children:[jsxRuntimeExports.jsx("div",{className:"text-right text-white text-3xl font-mono overflow-hidden",children:o}),c&&jsxRuntimeExports.jsxs("div",{className:"text-right text-[#c9a227] text-sm",children:[s," ",c]})]}),jsxRuntimeExports.jsx("div",{className:"flex-1 grid grid-rows-5 gap-2",children:ft.map((ht,mt)=>jsxRuntimeExports.jsx("div",{className:"grid gap-2",style:{gridTemplateColumns:mt===4?"2fr 1fr 1fr":"repeat(4, 1fr)"},children:ht.map(xt=>jsxRuntimeExports.jsx("button",{onClick:()=>dt(xt),className:lt(xt),children:xt},xt))},mt))})]})};/**
 * @license
 * Copyright 2010-2024 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const REVISION="170",MOUSE={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},TOUCH={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},CullFaceNone=0,CullFaceBack=1,CullFaceFront=2,CullFaceFrontBack=3,BasicShadowMap=0,PCFShadowMap=1,PCFSoftShadowMap=2,VSMShadowMap=3,FrontSide=0,BackSide=1,DoubleSide=2,NoBlending=0,NormalBlending=1,AdditiveBlending=2,SubtractiveBlending=3,MultiplyBlending=4,CustomBlending=5,AddEquation=100,SubtractEquation=101,ReverseSubtractEquation=102,MinEquation=103,MaxEquation=104,ZeroFactor=200,OneFactor=201,SrcColorFactor=202,OneMinusSrcColorFactor=203,SrcAlphaFactor=204,OneMinusSrcAlphaFactor=205,DstAlphaFactor=206,OneMinusDstAlphaFactor=207,DstColorFactor=208,OneMinusDstColorFactor=209,SrcAlphaSaturateFactor=210,ConstantColorFactor=211,OneMinusConstantColorFactor=212,ConstantAlphaFactor=213,OneMinusConstantAlphaFactor=214,NeverDepth=0,AlwaysDepth=1,LessDepth=2,LessEqualDepth=3,EqualDepth=4,GreaterEqualDepth=5,GreaterDepth=6,NotEqualDepth=7,MultiplyOperation=0,MixOperation=1,AddOperation=2,NoToneMapping=0,LinearToneMapping=1,ReinhardToneMapping=2,CineonToneMapping=3,ACESFilmicToneMapping=4,CustomToneMapping=5,AgXToneMapping=6,NeutralToneMapping=7,AttachedBindMode="attached",DetachedBindMode="detached",UVMapping=300,CubeReflectionMapping=301,CubeRefractionMapping=302,EquirectangularReflectionMapping=303,EquirectangularRefractionMapping=304,CubeUVReflectionMapping=306,RepeatWrapping=1e3,ClampToEdgeWrapping=1001,MirroredRepeatWrapping=1002,NearestFilter=1003,NearestMipmapNearestFilter=1004,NearestMipMapNearestFilter=1004,NearestMipmapLinearFilter=1005,NearestMipMapLinearFilter=1005,LinearFilter=1006,LinearMipmapNearestFilter=1007,LinearMipMapNearestFilter=1007,LinearMipmapLinearFilter=1008,LinearMipMapLinearFilter=1008,UnsignedByteType=1009,ByteType=1010,ShortType=1011,UnsignedShortType=1012,IntType=1013,UnsignedIntType=1014,FloatType=1015,HalfFloatType=1016,UnsignedShort4444Type=1017,UnsignedShort5551Type=1018,UnsignedInt248Type=1020,UnsignedInt5999Type=35902,AlphaFormat=1021,RGBFormat=1022,RGBAFormat=1023,LuminanceFormat=1024,LuminanceAlphaFormat=1025,DepthFormat=1026,DepthStencilFormat=1027,RedFormat=1028,RedIntegerFormat=1029,RGFormat=1030,RGIntegerFormat=1031,RGBIntegerFormat=1032,RGBAIntegerFormat=1033,RGB_S3TC_DXT1_Format=33776,RGBA_S3TC_DXT1_Format=33777,RGBA_S3TC_DXT3_Format=33778,RGBA_S3TC_DXT5_Format=33779,RGB_PVRTC_4BPPV1_Format=35840,RGB_PVRTC_2BPPV1_Format=35841,RGBA_PVRTC_4BPPV1_Format=35842,RGBA_PVRTC_2BPPV1_Format=35843,RGB_ETC1_Format=36196,RGB_ETC2_Format=37492,RGBA_ETC2_EAC_Format=37496,RGBA_ASTC_4x4_Format=37808,RGBA_ASTC_5x4_Format=37809,RGBA_ASTC_5x5_Format=37810,RGBA_ASTC_6x5_Format=37811,RGBA_ASTC_6x6_Format=37812,RGBA_ASTC_8x5_Format=37813,RGBA_ASTC_8x6_Format=37814,RGBA_ASTC_8x8_Format=37815,RGBA_ASTC_10x5_Format=37816,RGBA_ASTC_10x6_Format=37817,RGBA_ASTC_10x8_Format=37818,RGBA_ASTC_10x10_Format=37819,RGBA_ASTC_12x10_Format=37820,RGBA_ASTC_12x12_Format=37821,RGBA_BPTC_Format=36492,RGB_BPTC_SIGNED_Format=36494,RGB_BPTC_UNSIGNED_Format=36495,RED_RGTC1_Format=36283,SIGNED_RED_RGTC1_Format=36284,RED_GREEN_RGTC2_Format=36285,SIGNED_RED_GREEN_RGTC2_Format=36286,LoopOnce=2200,LoopRepeat=2201,LoopPingPong=2202,InterpolateDiscrete=2300,InterpolateLinear=2301,InterpolateSmooth=2302,ZeroCurvatureEnding=2400,ZeroSlopeEnding=2401,WrapAroundEnding=2402,NormalAnimationBlendMode=2500,AdditiveAnimationBlendMode=2501,TrianglesDrawMode=0,TriangleStripDrawMode=1,TriangleFanDrawMode=2,BasicDepthPacking=3200,RGBADepthPacking=3201,RGBDepthPacking=3202,RGDepthPacking=3203,TangentSpaceNormalMap=0,ObjectSpaceNormalMap=1,NoColorSpace="",SRGBColorSpace$1="srgb",LinearSRGBColorSpace$1="srgb-linear",LinearTransfer="linear",SRGBTransfer="srgb",ZeroStencilOp=0,KeepStencilOp=7680,ReplaceStencilOp=7681,IncrementStencilOp=7682,DecrementStencilOp=7683,IncrementWrapStencilOp=34055,DecrementWrapStencilOp=34056,InvertStencilOp=5386,NeverStencilFunc=512,LessStencilFunc=513,EqualStencilFunc=514,LessEqualStencilFunc=515,GreaterStencilFunc=516,NotEqualStencilFunc=517,GreaterEqualStencilFunc=518,AlwaysStencilFunc=519,NeverCompare=512,LessCompare=513,EqualCompare=514,LessEqualCompare=515,GreaterCompare=516,NotEqualCompare=517,GreaterEqualCompare=518,AlwaysCompare=519,StaticDrawUsage=35044,DynamicDrawUsage=35048,StreamDrawUsage=35040,StaticReadUsage=35045,DynamicReadUsage=35049,StreamReadUsage=35041,StaticCopyUsage=35046,DynamicCopyUsage=35050,StreamCopyUsage=35042,GLSL1="100",GLSL3="300 es",WebGLCoordinateSystem=2e3,WebGPUCoordinateSystem=2001;let EventDispatcher$1=class{addEventListener(e,s){this._listeners===void 0&&(this._listeners={});const a=this._listeners;a[e]===void 0&&(a[e]=[]),a[e].indexOf(s)===-1&&a[e].push(s)}hasEventListener(e,s){if(this._listeners===void 0)return!1;const a=this._listeners;return a[e]!==void 0&&a[e].indexOf(s)!==-1}removeEventListener(e,s){if(this._listeners===void 0)return;const c=this._listeners[e];if(c!==void 0){const d=c.indexOf(s);d!==-1&&c.splice(d,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const a=this._listeners[e.type];if(a!==void 0){e.target=this;const c=a.slice(0);for(let d=0,b=c.length;d<b;d++)c[d].call(this,e);e.target=null}}};const _lut=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let _seed=1234567;const DEG2RAD=Math.PI/180,RAD2DEG=180/Math.PI;function generateUUID(){const o=Math.random()*4294967295|0,e=Math.random()*4294967295|0,s=Math.random()*4294967295|0,a=Math.random()*4294967295|0;return(_lut[o&255]+_lut[o>>8&255]+_lut[o>>16&255]+_lut[o>>24&255]+"-"+_lut[e&255]+_lut[e>>8&255]+"-"+_lut[e>>16&15|64]+_lut[e>>24&255]+"-"+_lut[s&63|128]+_lut[s>>8&255]+"-"+_lut[s>>16&255]+_lut[s>>24&255]+_lut[a&255]+_lut[a>>8&255]+_lut[a>>16&255]+_lut[a>>24&255]).toLowerCase()}function clamp(o,e,s){return Math.max(e,Math.min(s,o))}function euclideanModulo(o,e){return(o%e+e)%e}function mapLinear(o,e,s,a,c){return a+(o-e)*(c-a)/(s-e)}function inverseLerp(o,e,s){return o!==e?(s-o)/(e-o):0}function lerp(o,e,s){return(1-s)*o+s*e}function damp(o,e,s,a){return lerp(o,e,1-Math.exp(-s*a))}function pingpong(o,e=1){return e-Math.abs(euclideanModulo(o,e*2)-e)}function smoothstep(o,e,s){return o<=e?0:o>=s?1:(o=(o-e)/(s-e),o*o*(3-2*o))}function smootherstep(o,e,s){return o<=e?0:o>=s?1:(o=(o-e)/(s-e),o*o*o*(o*(o*6-15)+10))}function randInt(o,e){return o+Math.floor(Math.random()*(e-o+1))}function randFloat(o,e){return o+Math.random()*(e-o)}function randFloatSpread(o){return o*(.5-Math.random())}function seededRandom(o){o!==void 0&&(_seed=o);let e=_seed+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function degToRad(o){return o*DEG2RAD}function radToDeg(o){return o*RAD2DEG}function isPowerOfTwo(o){return(o&o-1)===0&&o!==0}function ceilPowerOfTwo(o){return Math.pow(2,Math.ceil(Math.log(o)/Math.LN2))}function floorPowerOfTwo(o){return Math.pow(2,Math.floor(Math.log(o)/Math.LN2))}function setQuaternionFromProperEuler(o,e,s,a,c){const d=Math.cos,b=Math.sin,_e=d(s/2),tt=b(s/2),nt=d((e+a)/2),it=b((e+a)/2),ot=d((e-a)/2),at=b((e-a)/2),ct=d((a-e)/2),ut=b((a-e)/2);switch(c){case"XYX":o.set(_e*it,tt*ot,tt*at,_e*nt);break;case"YZY":o.set(tt*at,_e*it,tt*ot,_e*nt);break;case"ZXZ":o.set(tt*ot,tt*at,_e*it,_e*nt);break;case"XZX":o.set(_e*it,tt*ut,tt*ct,_e*nt);break;case"YXY":o.set(tt*ct,_e*it,tt*ut,_e*nt);break;case"ZYZ":o.set(tt*ut,tt*ct,_e*it,_e*nt);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+c)}}function denormalize(o,e){switch(e.constructor){case Float32Array:return o;case Uint32Array:return o/4294967295;case Uint16Array:return o/65535;case Uint8Array:return o/255;case Int32Array:return Math.max(o/2147483647,-1);case Int16Array:return Math.max(o/32767,-1);case Int8Array:return Math.max(o/127,-1);default:throw new Error("Invalid component type.")}}function normalize(o,e){switch(e.constructor){case Float32Array:return o;case Uint32Array:return Math.round(o*4294967295);case Uint16Array:return Math.round(o*65535);case Uint8Array:return Math.round(o*255);case Int32Array:return Math.round(o*2147483647);case Int16Array:return Math.round(o*32767);case Int8Array:return Math.round(o*127);default:throw new Error("Invalid component type.")}}const MathUtils={DEG2RAD,RAD2DEG,generateUUID,clamp,euclideanModulo,mapLinear,inverseLerp,lerp,damp,pingpong,smoothstep,smootherstep,randInt,randFloat,randFloatSpread,seededRandom,degToRad,radToDeg,isPowerOfTwo,ceilPowerOfTwo,floorPowerOfTwo,setQuaternionFromProperEuler,normalize,denormalize};class Vector2{constructor(e=0,s=0){Vector2.prototype.isVector2=!0,this.x=e,this.y=s}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,s){return this.x=e,this.y=s,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,s){switch(e){case 0:this.x=s;break;case 1:this.y=s;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,s){return this.x=e.x+s.x,this.y=e.y+s.y,this}addScaledVector(e,s){return this.x+=e.x*s,this.y+=e.y*s,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,s){return this.x=e.x-s.x,this.y=e.y-s.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const s=this.x,a=this.y,c=e.elements;return this.x=c[0]*s+c[3]*a+c[6],this.y=c[1]*s+c[4]*a+c[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,s){return this.x=Math.max(e.x,Math.min(s.x,this.x)),this.y=Math.max(e.y,Math.min(s.y,this.y)),this}clampScalar(e,s){return this.x=Math.max(e,Math.min(s,this.x)),this.y=Math.max(e,Math.min(s,this.y)),this}clampLength(e,s){const a=this.length();return this.divideScalar(a||1).multiplyScalar(Math.max(e,Math.min(s,a)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const s=Math.sqrt(this.lengthSq()*e.lengthSq());if(s===0)return Math.PI/2;const a=this.dot(e)/s;return Math.acos(clamp(a,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const s=this.x-e.x,a=this.y-e.y;return s*s+a*a}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,s){return this.x+=(e.x-this.x)*s,this.y+=(e.y-this.y)*s,this}lerpVectors(e,s,a){return this.x=e.x+(s.x-e.x)*a,this.y=e.y+(s.y-e.y)*a,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,s=0){return this.x=e[s],this.y=e[s+1],this}toArray(e=[],s=0){return e[s]=this.x,e[s+1]=this.y,e}fromBufferAttribute(e,s){return this.x=e.getX(s),this.y=e.getY(s),this}rotateAround(e,s){const a=Math.cos(s),c=Math.sin(s),d=this.x-e.x,b=this.y-e.y;return this.x=d*a-b*c+e.x,this.y=d*c+b*a+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Matrix3{constructor(e,s,a,c,d,b,_e,tt,nt){Matrix3.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,s,a,c,d,b,_e,tt,nt)}set(e,s,a,c,d,b,_e,tt,nt){const it=this.elements;return it[0]=e,it[1]=c,it[2]=_e,it[3]=s,it[4]=d,it[5]=tt,it[6]=a,it[7]=b,it[8]=nt,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const s=this.elements,a=e.elements;return s[0]=a[0],s[1]=a[1],s[2]=a[2],s[3]=a[3],s[4]=a[4],s[5]=a[5],s[6]=a[6],s[7]=a[7],s[8]=a[8],this}extractBasis(e,s,a){return e.setFromMatrix3Column(this,0),s.setFromMatrix3Column(this,1),a.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const s=e.elements;return this.set(s[0],s[4],s[8],s[1],s[5],s[9],s[2],s[6],s[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,s){const a=e.elements,c=s.elements,d=this.elements,b=a[0],_e=a[3],tt=a[6],nt=a[1],it=a[4],ot=a[7],at=a[2],ct=a[5],ut=a[8],ft=c[0],dt=c[3],lt=c[6],ht=c[1],mt=c[4],xt=c[7],St=c[2],yt=c[5],wt=c[8];return d[0]=b*ft+_e*ht+tt*St,d[3]=b*dt+_e*mt+tt*yt,d[6]=b*lt+_e*xt+tt*wt,d[1]=nt*ft+it*ht+ot*St,d[4]=nt*dt+it*mt+ot*yt,d[7]=nt*lt+it*xt+ot*wt,d[2]=at*ft+ct*ht+ut*St,d[5]=at*dt+ct*mt+ut*yt,d[8]=at*lt+ct*xt+ut*wt,this}multiplyScalar(e){const s=this.elements;return s[0]*=e,s[3]*=e,s[6]*=e,s[1]*=e,s[4]*=e,s[7]*=e,s[2]*=e,s[5]*=e,s[8]*=e,this}determinant(){const e=this.elements,s=e[0],a=e[1],c=e[2],d=e[3],b=e[4],_e=e[5],tt=e[6],nt=e[7],it=e[8];return s*b*it-s*_e*nt-a*d*it+a*_e*tt+c*d*nt-c*b*tt}invert(){const e=this.elements,s=e[0],a=e[1],c=e[2],d=e[3],b=e[4],_e=e[5],tt=e[6],nt=e[7],it=e[8],ot=it*b-_e*nt,at=_e*tt-it*d,ct=nt*d-b*tt,ut=s*ot+a*at+c*ct;if(ut===0)return this.set(0,0,0,0,0,0,0,0,0);const ft=1/ut;return e[0]=ot*ft,e[1]=(c*nt-it*a)*ft,e[2]=(_e*a-c*b)*ft,e[3]=at*ft,e[4]=(it*s-c*tt)*ft,e[5]=(c*d-_e*s)*ft,e[6]=ct*ft,e[7]=(a*tt-nt*s)*ft,e[8]=(b*s-a*d)*ft,this}transpose(){let e;const s=this.elements;return e=s[1],s[1]=s[3],s[3]=e,e=s[2],s[2]=s[6],s[6]=e,e=s[5],s[5]=s[7],s[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const s=this.elements;return e[0]=s[0],e[1]=s[3],e[2]=s[6],e[3]=s[1],e[4]=s[4],e[5]=s[7],e[6]=s[2],e[7]=s[5],e[8]=s[8],this}setUvTransform(e,s,a,c,d,b,_e){const tt=Math.cos(d),nt=Math.sin(d);return this.set(a*tt,a*nt,-a*(tt*b+nt*_e)+b+e,-c*nt,c*tt,-c*(-nt*b+tt*_e)+_e+s,0,0,1),this}scale(e,s){return this.premultiply(_m3.makeScale(e,s)),this}rotate(e){return this.premultiply(_m3.makeRotation(-e)),this}translate(e,s){return this.premultiply(_m3.makeTranslation(e,s)),this}makeTranslation(e,s){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,s,0,0,1),this}makeRotation(e){const s=Math.cos(e),a=Math.sin(e);return this.set(s,-a,0,a,s,0,0,0,1),this}makeScale(e,s){return this.set(e,0,0,0,s,0,0,0,1),this}equals(e){const s=this.elements,a=e.elements;for(let c=0;c<9;c++)if(s[c]!==a[c])return!1;return!0}fromArray(e,s=0){for(let a=0;a<9;a++)this.elements[a]=e[a+s];return this}toArray(e=[],s=0){const a=this.elements;return e[s]=a[0],e[s+1]=a[1],e[s+2]=a[2],e[s+3]=a[3],e[s+4]=a[4],e[s+5]=a[5],e[s+6]=a[6],e[s+7]=a[7],e[s+8]=a[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const _m3=new Matrix3;function arrayNeedsUint32(o){for(let e=o.length-1;e>=0;--e)if(o[e]>=65535)return!0;return!1}const TYPED_ARRAYS={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function getTypedArray(o,e){return new TYPED_ARRAYS[o](e)}function createElementNS(o){return document.createElementNS("http://www.w3.org/1999/xhtml",o)}function createCanvasElement(){const o=createElementNS("canvas");return o.style.display="block",o}const _cache={};function warnOnce(o){o in _cache||(_cache[o]=!0,console.warn(o))}function probeAsync(o,e,s){return new Promise(function(a,c){function d(){switch(o.clientWaitSync(e,o.SYNC_FLUSH_COMMANDS_BIT,0)){case o.WAIT_FAILED:c();break;case o.TIMEOUT_EXPIRED:setTimeout(d,s);break;default:a()}}setTimeout(d,s)})}function toNormalizedProjectionMatrix(o){const e=o.elements;e[2]=.5*e[2]+.5*e[3],e[6]=.5*e[6]+.5*e[7],e[10]=.5*e[10]+.5*e[11],e[14]=.5*e[14]+.5*e[15]}function toReversedProjectionMatrix(o){const e=o.elements;e[11]===-1?(e[10]=-e[10]-1,e[14]=-e[14]):(e[10]=-e[10],e[14]=-e[14]+1)}const ColorManagement={enabled:!0,workingColorSpace:LinearSRGBColorSpace$1,spaces:{},convert:function(o,e,s){return this.enabled===!1||e===s||!e||!s||(this.spaces[e].transfer===SRGBTransfer&&(o.r=SRGBToLinear(o.r),o.g=SRGBToLinear(o.g),o.b=SRGBToLinear(o.b)),this.spaces[e].primaries!==this.spaces[s].primaries&&(o.applyMatrix3(this.spaces[e].toXYZ),o.applyMatrix3(this.spaces[s].fromXYZ)),this.spaces[s].transfer===SRGBTransfer&&(o.r=LinearToSRGB(o.r),o.g=LinearToSRGB(o.g),o.b=LinearToSRGB(o.b))),o},fromWorkingColorSpace:function(o,e){return this.convert(o,this.workingColorSpace,e)},toWorkingColorSpace:function(o,e){return this.convert(o,e,this.workingColorSpace)},getPrimaries:function(o){return this.spaces[o].primaries},getTransfer:function(o){return o===NoColorSpace?LinearTransfer:this.spaces[o].transfer},getLuminanceCoefficients:function(o,e=this.workingColorSpace){return o.fromArray(this.spaces[e].luminanceCoefficients)},define:function(o){Object.assign(this.spaces,o)},_getMatrix:function(o,e,s){return o.copy(this.spaces[e].toXYZ).multiply(this.spaces[s].fromXYZ)},_getDrawingBufferColorSpace:function(o){return this.spaces[o].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(o=this.workingColorSpace){return this.spaces[o].workingColorSpaceConfig.unpackColorSpace}};function SRGBToLinear(o){return o<.04045?o*.0773993808:Math.pow(o*.9478672986+.0521327014,2.4)}function LinearToSRGB(o){return o<.0031308?o*12.92:1.055*Math.pow(o,.41666)-.055}const REC709_PRIMARIES=[.64,.33,.3,.6,.15,.06],REC709_LUMINANCE_COEFFICIENTS=[.2126,.7152,.0722],D65=[.3127,.329],LINEAR_REC709_TO_XYZ=new Matrix3().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),XYZ_TO_LINEAR_REC709=new Matrix3().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);ColorManagement.define({[LinearSRGBColorSpace$1]:{primaries:REC709_PRIMARIES,whitePoint:D65,transfer:LinearTransfer,toXYZ:LINEAR_REC709_TO_XYZ,fromXYZ:XYZ_TO_LINEAR_REC709,luminanceCoefficients:REC709_LUMINANCE_COEFFICIENTS,workingColorSpaceConfig:{unpackColorSpace:SRGBColorSpace$1},outputColorSpaceConfig:{drawingBufferColorSpace:SRGBColorSpace$1}},[SRGBColorSpace$1]:{primaries:REC709_PRIMARIES,whitePoint:D65,transfer:SRGBTransfer,toXYZ:LINEAR_REC709_TO_XYZ,fromXYZ:XYZ_TO_LINEAR_REC709,luminanceCoefficients:REC709_LUMINANCE_COEFFICIENTS,outputColorSpaceConfig:{drawingBufferColorSpace:SRGBColorSpace$1}}});let _canvas;class ImageUtils{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let s;if(e instanceof HTMLCanvasElement)s=e;else{_canvas===void 0&&(_canvas=createElementNS("canvas")),_canvas.width=e.width,_canvas.height=e.height;const a=_canvas.getContext("2d");e instanceof ImageData?a.putImageData(e,0,0):a.drawImage(e,0,0,e.width,e.height),s=_canvas}return s.width>2048||s.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),s.toDataURL("image/jpeg",.6)):s.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const s=createElementNS("canvas");s.width=e.width,s.height=e.height;const a=s.getContext("2d");a.drawImage(e,0,0,e.width,e.height);const c=a.getImageData(0,0,e.width,e.height),d=c.data;for(let b=0;b<d.length;b++)d[b]=SRGBToLinear(d[b]/255)*255;return a.putImageData(c,0,0),s}else if(e.data){const s=e.data.slice(0);for(let a=0;a<s.length;a++)s instanceof Uint8Array||s instanceof Uint8ClampedArray?s[a]=Math.floor(SRGBToLinear(s[a]/255)*255):s[a]=SRGBToLinear(s[a]);return{data:s,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let _sourceId=0;class Source{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:_sourceId++}),this.uuid=generateUUID(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const s=e===void 0||typeof e=="string";if(!s&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const a={uuid:this.uuid,url:""},c=this.data;if(c!==null){let d;if(Array.isArray(c)){d=[];for(let b=0,_e=c.length;b<_e;b++)c[b].isDataTexture?d.push(serializeImage(c[b].image)):d.push(serializeImage(c[b]))}else d=serializeImage(c);a.url=d}return s||(e.images[this.uuid]=a),a}}function serializeImage(o){return typeof HTMLImageElement<"u"&&o instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&o instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&o instanceof ImageBitmap?ImageUtils.getDataURL(o):o.data?{data:Array.from(o.data),width:o.width,height:o.height,type:o.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let _textureId=0;class Texture extends EventDispatcher$1{constructor(e=Texture.DEFAULT_IMAGE,s=Texture.DEFAULT_MAPPING,a=ClampToEdgeWrapping,c=ClampToEdgeWrapping,d=LinearFilter,b=LinearMipmapLinearFilter,_e=RGBAFormat,tt=UnsignedByteType,nt=Texture.DEFAULT_ANISOTROPY,it=NoColorSpace){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:_textureId++}),this.uuid=generateUUID(),this.name="",this.source=new Source(e),this.mipmaps=[],this.mapping=s,this.channel=0,this.wrapS=a,this.wrapT=c,this.magFilter=d,this.minFilter=b,this.anisotropy=nt,this.format=_e,this.internalFormat=null,this.type=tt,this.offset=new Vector2(0,0),this.repeat=new Vector2(1,1),this.center=new Vector2(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Matrix3,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=it,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const s=e===void 0||typeof e=="string";if(!s&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const a={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(a.userData=this.userData),s||(e.textures[this.uuid]=a),a}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==UVMapping)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case RepeatWrapping:e.x=e.x-Math.floor(e.x);break;case ClampToEdgeWrapping:e.x=e.x<0?0:1;break;case MirroredRepeatWrapping:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case RepeatWrapping:e.y=e.y-Math.floor(e.y);break;case ClampToEdgeWrapping:e.y=e.y<0?0:1;break;case MirroredRepeatWrapping:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}}Texture.DEFAULT_IMAGE=null;Texture.DEFAULT_MAPPING=UVMapping;Texture.DEFAULT_ANISOTROPY=1;class Vector4{constructor(e=0,s=0,a=0,c=1){Vector4.prototype.isVector4=!0,this.x=e,this.y=s,this.z=a,this.w=c}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,s,a,c){return this.x=e,this.y=s,this.z=a,this.w=c,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,s){switch(e){case 0:this.x=s;break;case 1:this.y=s;break;case 2:this.z=s;break;case 3:this.w=s;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,s){return this.x=e.x+s.x,this.y=e.y+s.y,this.z=e.z+s.z,this.w=e.w+s.w,this}addScaledVector(e,s){return this.x+=e.x*s,this.y+=e.y*s,this.z+=e.z*s,this.w+=e.w*s,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,s){return this.x=e.x-s.x,this.y=e.y-s.y,this.z=e.z-s.z,this.w=e.w-s.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const s=this.x,a=this.y,c=this.z,d=this.w,b=e.elements;return this.x=b[0]*s+b[4]*a+b[8]*c+b[12]*d,this.y=b[1]*s+b[5]*a+b[9]*c+b[13]*d,this.z=b[2]*s+b[6]*a+b[10]*c+b[14]*d,this.w=b[3]*s+b[7]*a+b[11]*c+b[15]*d,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const s=Math.sqrt(1-e.w*e.w);return s<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/s,this.y=e.y/s,this.z=e.z/s),this}setAxisAngleFromRotationMatrix(e){let s,a,c,d;const tt=e.elements,nt=tt[0],it=tt[4],ot=tt[8],at=tt[1],ct=tt[5],ut=tt[9],ft=tt[2],dt=tt[6],lt=tt[10];if(Math.abs(it-at)<.01&&Math.abs(ot-ft)<.01&&Math.abs(ut-dt)<.01){if(Math.abs(it+at)<.1&&Math.abs(ot+ft)<.1&&Math.abs(ut+dt)<.1&&Math.abs(nt+ct+lt-3)<.1)return this.set(1,0,0,0),this;s=Math.PI;const mt=(nt+1)/2,xt=(ct+1)/2,St=(lt+1)/2,yt=(it+at)/4,wt=(ot+ft)/4,Et=(ut+dt)/4;return mt>xt&&mt>St?mt<.01?(a=0,c=.707106781,d=.707106781):(a=Math.sqrt(mt),c=yt/a,d=wt/a):xt>St?xt<.01?(a=.707106781,c=0,d=.707106781):(c=Math.sqrt(xt),a=yt/c,d=Et/c):St<.01?(a=.707106781,c=.707106781,d=0):(d=Math.sqrt(St),a=wt/d,c=Et/d),this.set(a,c,d,s),this}let ht=Math.sqrt((dt-ut)*(dt-ut)+(ot-ft)*(ot-ft)+(at-it)*(at-it));return Math.abs(ht)<.001&&(ht=1),this.x=(dt-ut)/ht,this.y=(ot-ft)/ht,this.z=(at-it)/ht,this.w=Math.acos((nt+ct+lt-1)/2),this}setFromMatrixPosition(e){const s=e.elements;return this.x=s[12],this.y=s[13],this.z=s[14],this.w=s[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,s){return this.x=Math.max(e.x,Math.min(s.x,this.x)),this.y=Math.max(e.y,Math.min(s.y,this.y)),this.z=Math.max(e.z,Math.min(s.z,this.z)),this.w=Math.max(e.w,Math.min(s.w,this.w)),this}clampScalar(e,s){return this.x=Math.max(e,Math.min(s,this.x)),this.y=Math.max(e,Math.min(s,this.y)),this.z=Math.max(e,Math.min(s,this.z)),this.w=Math.max(e,Math.min(s,this.w)),this}clampLength(e,s){const a=this.length();return this.divideScalar(a||1).multiplyScalar(Math.max(e,Math.min(s,a)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,s){return this.x+=(e.x-this.x)*s,this.y+=(e.y-this.y)*s,this.z+=(e.z-this.z)*s,this.w+=(e.w-this.w)*s,this}lerpVectors(e,s,a){return this.x=e.x+(s.x-e.x)*a,this.y=e.y+(s.y-e.y)*a,this.z=e.z+(s.z-e.z)*a,this.w=e.w+(s.w-e.w)*a,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,s=0){return this.x=e[s],this.y=e[s+1],this.z=e[s+2],this.w=e[s+3],this}toArray(e=[],s=0){return e[s]=this.x,e[s+1]=this.y,e[s+2]=this.z,e[s+3]=this.w,e}fromBufferAttribute(e,s){return this.x=e.getX(s),this.y=e.getY(s),this.z=e.getZ(s),this.w=e.getW(s),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class RenderTarget extends EventDispatcher$1{constructor(e=1,s=1,a={}){super(),this.isRenderTarget=!0,this.width=e,this.height=s,this.depth=1,this.scissor=new Vector4(0,0,e,s),this.scissorTest=!1,this.viewport=new Vector4(0,0,e,s);const c={width:e,height:s,depth:1};a=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:LinearFilter,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1},a);const d=new Texture(c,a.mapping,a.wrapS,a.wrapT,a.magFilter,a.minFilter,a.format,a.type,a.anisotropy,a.colorSpace);d.flipY=!1,d.generateMipmaps=a.generateMipmaps,d.internalFormat=a.internalFormat,this.textures=[];const b=a.count;for(let _e=0;_e<b;_e++)this.textures[_e]=d.clone(),this.textures[_e].isRenderTargetTexture=!0;this.depthBuffer=a.depthBuffer,this.stencilBuffer=a.stencilBuffer,this.resolveDepthBuffer=a.resolveDepthBuffer,this.resolveStencilBuffer=a.resolveStencilBuffer,this.depthTexture=a.depthTexture,this.samples=a.samples}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}setSize(e,s,a=1){if(this.width!==e||this.height!==s||this.depth!==a){this.width=e,this.height=s,this.depth=a;for(let c=0,d=this.textures.length;c<d;c++)this.textures[c].image.width=e,this.textures[c].image.height=s,this.textures[c].image.depth=a;this.dispose()}this.viewport.set(0,0,e,s),this.scissor.set(0,0,e,s)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let a=0,c=e.textures.length;a<c;a++)this.textures[a]=e.textures[a].clone(),this.textures[a].isRenderTargetTexture=!0;const s=Object.assign({},e.texture.image);return this.texture.source=new Source(s),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class WebGLRenderTarget extends RenderTarget{constructor(e=1,s=1,a={}){super(e,s,a),this.isWebGLRenderTarget=!0}}class DataArrayTexture extends Texture{constructor(e=null,s=1,a=1,c=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:s,height:a,depth:c},this.magFilter=NearestFilter,this.minFilter=NearestFilter,this.wrapR=ClampToEdgeWrapping,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class WebGLArrayRenderTarget extends WebGLRenderTarget{constructor(e=1,s=1,a=1,c={}){super(e,s,c),this.isWebGLArrayRenderTarget=!0,this.depth=a,this.texture=new DataArrayTexture(null,e,s,a),this.texture.isRenderTargetTexture=!0}}class Data3DTexture extends Texture{constructor(e=null,s=1,a=1,c=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:s,height:a,depth:c},this.magFilter=NearestFilter,this.minFilter=NearestFilter,this.wrapR=ClampToEdgeWrapping,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class WebGL3DRenderTarget extends WebGLRenderTarget{constructor(e=1,s=1,a=1,c={}){super(e,s,c),this.isWebGL3DRenderTarget=!0,this.depth=a,this.texture=new Data3DTexture(null,e,s,a),this.texture.isRenderTargetTexture=!0}}class Quaternion{constructor(e=0,s=0,a=0,c=1){this.isQuaternion=!0,this._x=e,this._y=s,this._z=a,this._w=c}static slerpFlat(e,s,a,c,d,b,_e){let tt=a[c+0],nt=a[c+1],it=a[c+2],ot=a[c+3];const at=d[b+0],ct=d[b+1],ut=d[b+2],ft=d[b+3];if(_e===0){e[s+0]=tt,e[s+1]=nt,e[s+2]=it,e[s+3]=ot;return}if(_e===1){e[s+0]=at,e[s+1]=ct,e[s+2]=ut,e[s+3]=ft;return}if(ot!==ft||tt!==at||nt!==ct||it!==ut){let dt=1-_e;const lt=tt*at+nt*ct+it*ut+ot*ft,ht=lt>=0?1:-1,mt=1-lt*lt;if(mt>Number.EPSILON){const St=Math.sqrt(mt),yt=Math.atan2(St,lt*ht);dt=Math.sin(dt*yt)/St,_e=Math.sin(_e*yt)/St}const xt=_e*ht;if(tt=tt*dt+at*xt,nt=nt*dt+ct*xt,it=it*dt+ut*xt,ot=ot*dt+ft*xt,dt===1-_e){const St=1/Math.sqrt(tt*tt+nt*nt+it*it+ot*ot);tt*=St,nt*=St,it*=St,ot*=St}}e[s]=tt,e[s+1]=nt,e[s+2]=it,e[s+3]=ot}static multiplyQuaternionsFlat(e,s,a,c,d,b){const _e=a[c],tt=a[c+1],nt=a[c+2],it=a[c+3],ot=d[b],at=d[b+1],ct=d[b+2],ut=d[b+3];return e[s]=_e*ut+it*ot+tt*ct-nt*at,e[s+1]=tt*ut+it*at+nt*ot-_e*ct,e[s+2]=nt*ut+it*ct+_e*at-tt*ot,e[s+3]=it*ut-_e*ot-tt*at-nt*ct,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,s,a,c){return this._x=e,this._y=s,this._z=a,this._w=c,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,s=!0){const a=e._x,c=e._y,d=e._z,b=e._order,_e=Math.cos,tt=Math.sin,nt=_e(a/2),it=_e(c/2),ot=_e(d/2),at=tt(a/2),ct=tt(c/2),ut=tt(d/2);switch(b){case"XYZ":this._x=at*it*ot+nt*ct*ut,this._y=nt*ct*ot-at*it*ut,this._z=nt*it*ut+at*ct*ot,this._w=nt*it*ot-at*ct*ut;break;case"YXZ":this._x=at*it*ot+nt*ct*ut,this._y=nt*ct*ot-at*it*ut,this._z=nt*it*ut-at*ct*ot,this._w=nt*it*ot+at*ct*ut;break;case"ZXY":this._x=at*it*ot-nt*ct*ut,this._y=nt*ct*ot+at*it*ut,this._z=nt*it*ut+at*ct*ot,this._w=nt*it*ot-at*ct*ut;break;case"ZYX":this._x=at*it*ot-nt*ct*ut,this._y=nt*ct*ot+at*it*ut,this._z=nt*it*ut-at*ct*ot,this._w=nt*it*ot+at*ct*ut;break;case"YZX":this._x=at*it*ot+nt*ct*ut,this._y=nt*ct*ot+at*it*ut,this._z=nt*it*ut-at*ct*ot,this._w=nt*it*ot-at*ct*ut;break;case"XZY":this._x=at*it*ot-nt*ct*ut,this._y=nt*ct*ot-at*it*ut,this._z=nt*it*ut+at*ct*ot,this._w=nt*it*ot+at*ct*ut;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+b)}return s===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,s){const a=s/2,c=Math.sin(a);return this._x=e.x*c,this._y=e.y*c,this._z=e.z*c,this._w=Math.cos(a),this._onChangeCallback(),this}setFromRotationMatrix(e){const s=e.elements,a=s[0],c=s[4],d=s[8],b=s[1],_e=s[5],tt=s[9],nt=s[2],it=s[6],ot=s[10],at=a+_e+ot;if(at>0){const ct=.5/Math.sqrt(at+1);this._w=.25/ct,this._x=(it-tt)*ct,this._y=(d-nt)*ct,this._z=(b-c)*ct}else if(a>_e&&a>ot){const ct=2*Math.sqrt(1+a-_e-ot);this._w=(it-tt)/ct,this._x=.25*ct,this._y=(c+b)/ct,this._z=(d+nt)/ct}else if(_e>ot){const ct=2*Math.sqrt(1+_e-a-ot);this._w=(d-nt)/ct,this._x=(c+b)/ct,this._y=.25*ct,this._z=(tt+it)/ct}else{const ct=2*Math.sqrt(1+ot-a-_e);this._w=(b-c)/ct,this._x=(d+nt)/ct,this._y=(tt+it)/ct,this._z=.25*ct}return this._onChangeCallback(),this}setFromUnitVectors(e,s){let a=e.dot(s)+1;return a<Number.EPSILON?(a=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=a):(this._x=0,this._y=-e.z,this._z=e.y,this._w=a)):(this._x=e.y*s.z-e.z*s.y,this._y=e.z*s.x-e.x*s.z,this._z=e.x*s.y-e.y*s.x,this._w=a),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(clamp(this.dot(e),-1,1)))}rotateTowards(e,s){const a=this.angleTo(e);if(a===0)return this;const c=Math.min(1,s/a);return this.slerp(e,c),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,s){const a=e._x,c=e._y,d=e._z,b=e._w,_e=s._x,tt=s._y,nt=s._z,it=s._w;return this._x=a*it+b*_e+c*nt-d*tt,this._y=c*it+b*tt+d*_e-a*nt,this._z=d*it+b*nt+a*tt-c*_e,this._w=b*it-a*_e-c*tt-d*nt,this._onChangeCallback(),this}slerp(e,s){if(s===0)return this;if(s===1)return this.copy(e);const a=this._x,c=this._y,d=this._z,b=this._w;let _e=b*e._w+a*e._x+c*e._y+d*e._z;if(_e<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,_e=-_e):this.copy(e),_e>=1)return this._w=b,this._x=a,this._y=c,this._z=d,this;const tt=1-_e*_e;if(tt<=Number.EPSILON){const ct=1-s;return this._w=ct*b+s*this._w,this._x=ct*a+s*this._x,this._y=ct*c+s*this._y,this._z=ct*d+s*this._z,this.normalize(),this}const nt=Math.sqrt(tt),it=Math.atan2(nt,_e),ot=Math.sin((1-s)*it)/nt,at=Math.sin(s*it)/nt;return this._w=b*ot+this._w*at,this._x=a*ot+this._x*at,this._y=c*ot+this._y*at,this._z=d*ot+this._z*at,this._onChangeCallback(),this}slerpQuaternions(e,s,a){return this.copy(e).slerp(s,a)}random(){const e=2*Math.PI*Math.random(),s=2*Math.PI*Math.random(),a=Math.random(),c=Math.sqrt(1-a),d=Math.sqrt(a);return this.set(c*Math.sin(e),c*Math.cos(e),d*Math.sin(s),d*Math.cos(s))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,s=0){return this._x=e[s],this._y=e[s+1],this._z=e[s+2],this._w=e[s+3],this._onChangeCallback(),this}toArray(e=[],s=0){return e[s]=this._x,e[s+1]=this._y,e[s+2]=this._z,e[s+3]=this._w,e}fromBufferAttribute(e,s){return this._x=e.getX(s),this._y=e.getY(s),this._z=e.getZ(s),this._w=e.getW(s),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Vector3{constructor(e=0,s=0,a=0){Vector3.prototype.isVector3=!0,this.x=e,this.y=s,this.z=a}set(e,s,a){return a===void 0&&(a=this.z),this.x=e,this.y=s,this.z=a,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,s){switch(e){case 0:this.x=s;break;case 1:this.y=s;break;case 2:this.z=s;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,s){return this.x=e.x+s.x,this.y=e.y+s.y,this.z=e.z+s.z,this}addScaledVector(e,s){return this.x+=e.x*s,this.y+=e.y*s,this.z+=e.z*s,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,s){return this.x=e.x-s.x,this.y=e.y-s.y,this.z=e.z-s.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,s){return this.x=e.x*s.x,this.y=e.y*s.y,this.z=e.z*s.z,this}applyEuler(e){return this.applyQuaternion(_quaternion$4.setFromEuler(e))}applyAxisAngle(e,s){return this.applyQuaternion(_quaternion$4.setFromAxisAngle(e,s))}applyMatrix3(e){const s=this.x,a=this.y,c=this.z,d=e.elements;return this.x=d[0]*s+d[3]*a+d[6]*c,this.y=d[1]*s+d[4]*a+d[7]*c,this.z=d[2]*s+d[5]*a+d[8]*c,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const s=this.x,a=this.y,c=this.z,d=e.elements,b=1/(d[3]*s+d[7]*a+d[11]*c+d[15]);return this.x=(d[0]*s+d[4]*a+d[8]*c+d[12])*b,this.y=(d[1]*s+d[5]*a+d[9]*c+d[13])*b,this.z=(d[2]*s+d[6]*a+d[10]*c+d[14])*b,this}applyQuaternion(e){const s=this.x,a=this.y,c=this.z,d=e.x,b=e.y,_e=e.z,tt=e.w,nt=2*(b*c-_e*a),it=2*(_e*s-d*c),ot=2*(d*a-b*s);return this.x=s+tt*nt+b*ot-_e*it,this.y=a+tt*it+_e*nt-d*ot,this.z=c+tt*ot+d*it-b*nt,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const s=this.x,a=this.y,c=this.z,d=e.elements;return this.x=d[0]*s+d[4]*a+d[8]*c,this.y=d[1]*s+d[5]*a+d[9]*c,this.z=d[2]*s+d[6]*a+d[10]*c,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,s){return this.x=Math.max(e.x,Math.min(s.x,this.x)),this.y=Math.max(e.y,Math.min(s.y,this.y)),this.z=Math.max(e.z,Math.min(s.z,this.z)),this}clampScalar(e,s){return this.x=Math.max(e,Math.min(s,this.x)),this.y=Math.max(e,Math.min(s,this.y)),this.z=Math.max(e,Math.min(s,this.z)),this}clampLength(e,s){const a=this.length();return this.divideScalar(a||1).multiplyScalar(Math.max(e,Math.min(s,a)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,s){return this.x+=(e.x-this.x)*s,this.y+=(e.y-this.y)*s,this.z+=(e.z-this.z)*s,this}lerpVectors(e,s,a){return this.x=e.x+(s.x-e.x)*a,this.y=e.y+(s.y-e.y)*a,this.z=e.z+(s.z-e.z)*a,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,s){const a=e.x,c=e.y,d=e.z,b=s.x,_e=s.y,tt=s.z;return this.x=c*tt-d*_e,this.y=d*b-a*tt,this.z=a*_e-c*b,this}projectOnVector(e){const s=e.lengthSq();if(s===0)return this.set(0,0,0);const a=e.dot(this)/s;return this.copy(e).multiplyScalar(a)}projectOnPlane(e){return _vector$c.copy(this).projectOnVector(e),this.sub(_vector$c)}reflect(e){return this.sub(_vector$c.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const s=Math.sqrt(this.lengthSq()*e.lengthSq());if(s===0)return Math.PI/2;const a=this.dot(e)/s;return Math.acos(clamp(a,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const s=this.x-e.x,a=this.y-e.y,c=this.z-e.z;return s*s+a*a+c*c}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,s,a){const c=Math.sin(s)*e;return this.x=c*Math.sin(a),this.y=Math.cos(s)*e,this.z=c*Math.cos(a),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,s,a){return this.x=e*Math.sin(s),this.y=a,this.z=e*Math.cos(s),this}setFromMatrixPosition(e){const s=e.elements;return this.x=s[12],this.y=s[13],this.z=s[14],this}setFromMatrixScale(e){const s=this.setFromMatrixColumn(e,0).length(),a=this.setFromMatrixColumn(e,1).length(),c=this.setFromMatrixColumn(e,2).length();return this.x=s,this.y=a,this.z=c,this}setFromMatrixColumn(e,s){return this.fromArray(e.elements,s*4)}setFromMatrix3Column(e,s){return this.fromArray(e.elements,s*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,s=0){return this.x=e[s],this.y=e[s+1],this.z=e[s+2],this}toArray(e=[],s=0){return e[s]=this.x,e[s+1]=this.y,e[s+2]=this.z,e}fromBufferAttribute(e,s){return this.x=e.getX(s),this.y=e.getY(s),this.z=e.getZ(s),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,s=Math.random()*2-1,a=Math.sqrt(1-s*s);return this.x=a*Math.cos(e),this.y=s,this.z=a*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const _vector$c=new Vector3,_quaternion$4=new Quaternion;class Box3{constructor(e=new Vector3(1/0,1/0,1/0),s=new Vector3(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=s}set(e,s){return this.min.copy(e),this.max.copy(s),this}setFromArray(e){this.makeEmpty();for(let s=0,a=e.length;s<a;s+=3)this.expandByPoint(_vector$b.fromArray(e,s));return this}setFromBufferAttribute(e){this.makeEmpty();for(let s=0,a=e.count;s<a;s++)this.expandByPoint(_vector$b.fromBufferAttribute(e,s));return this}setFromPoints(e){this.makeEmpty();for(let s=0,a=e.length;s<a;s++)this.expandByPoint(e[s]);return this}setFromCenterAndSize(e,s){const a=_vector$b.copy(s).multiplyScalar(.5);return this.min.copy(e).sub(a),this.max.copy(e).add(a),this}setFromObject(e,s=!1){return this.makeEmpty(),this.expandByObject(e,s)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,s=!1){e.updateWorldMatrix(!1,!1);const a=e.geometry;if(a!==void 0){const d=a.getAttribute("position");if(s===!0&&d!==void 0&&e.isInstancedMesh!==!0)for(let b=0,_e=d.count;b<_e;b++)e.isMesh===!0?e.getVertexPosition(b,_vector$b):_vector$b.fromBufferAttribute(d,b),_vector$b.applyMatrix4(e.matrixWorld),this.expandByPoint(_vector$b);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),_box$4.copy(e.boundingBox)):(a.boundingBox===null&&a.computeBoundingBox(),_box$4.copy(a.boundingBox)),_box$4.applyMatrix4(e.matrixWorld),this.union(_box$4)}const c=e.children;for(let d=0,b=c.length;d<b;d++)this.expandByObject(c[d],s);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,s){return s.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,_vector$b),_vector$b.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let s,a;return e.normal.x>0?(s=e.normal.x*this.min.x,a=e.normal.x*this.max.x):(s=e.normal.x*this.max.x,a=e.normal.x*this.min.x),e.normal.y>0?(s+=e.normal.y*this.min.y,a+=e.normal.y*this.max.y):(s+=e.normal.y*this.max.y,a+=e.normal.y*this.min.y),e.normal.z>0?(s+=e.normal.z*this.min.z,a+=e.normal.z*this.max.z):(s+=e.normal.z*this.max.z,a+=e.normal.z*this.min.z),s<=-e.constant&&a>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(_center),_extents.subVectors(this.max,_center),_v0$3.subVectors(e.a,_center),_v1$7.subVectors(e.b,_center),_v2$4.subVectors(e.c,_center),_f0.subVectors(_v1$7,_v0$3),_f1.subVectors(_v2$4,_v1$7),_f2.subVectors(_v0$3,_v2$4);let s=[0,-_f0.z,_f0.y,0,-_f1.z,_f1.y,0,-_f2.z,_f2.y,_f0.z,0,-_f0.x,_f1.z,0,-_f1.x,_f2.z,0,-_f2.x,-_f0.y,_f0.x,0,-_f1.y,_f1.x,0,-_f2.y,_f2.x,0];return!satForAxes(s,_v0$3,_v1$7,_v2$4,_extents)||(s=[1,0,0,0,1,0,0,0,1],!satForAxes(s,_v0$3,_v1$7,_v2$4,_extents))?!1:(_triangleNormal.crossVectors(_f0,_f1),s=[_triangleNormal.x,_triangleNormal.y,_triangleNormal.z],satForAxes(s,_v0$3,_v1$7,_v2$4,_extents))}clampPoint(e,s){return s.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,_vector$b).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(_vector$b).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(_points[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),_points[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),_points[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),_points[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),_points[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),_points[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),_points[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),_points[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(_points),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const _points=[new Vector3,new Vector3,new Vector3,new Vector3,new Vector3,new Vector3,new Vector3,new Vector3],_vector$b=new Vector3,_box$4=new Box3,_v0$3=new Vector3,_v1$7=new Vector3,_v2$4=new Vector3,_f0=new Vector3,_f1=new Vector3,_f2=new Vector3,_center=new Vector3,_extents=new Vector3,_triangleNormal=new Vector3,_testAxis=new Vector3;function satForAxes(o,e,s,a,c){for(let d=0,b=o.length-3;d<=b;d+=3){_testAxis.fromArray(o,d);const _e=c.x*Math.abs(_testAxis.x)+c.y*Math.abs(_testAxis.y)+c.z*Math.abs(_testAxis.z),tt=e.dot(_testAxis),nt=s.dot(_testAxis),it=a.dot(_testAxis);if(Math.max(-Math.max(tt,nt,it),Math.min(tt,nt,it))>_e)return!1}return!0}const _box$3=new Box3,_v1$6=new Vector3,_v2$3=new Vector3;class Sphere{constructor(e=new Vector3,s=-1){this.isSphere=!0,this.center=e,this.radius=s}set(e,s){return this.center.copy(e),this.radius=s,this}setFromPoints(e,s){const a=this.center;s!==void 0?a.copy(s):_box$3.setFromPoints(e).getCenter(a);let c=0;for(let d=0,b=e.length;d<b;d++)c=Math.max(c,a.distanceToSquared(e[d]));return this.radius=Math.sqrt(c),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const s=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=s*s}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,s){const a=this.center.distanceToSquared(e);return s.copy(e),a>this.radius*this.radius&&(s.sub(this.center).normalize(),s.multiplyScalar(this.radius).add(this.center)),s}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;_v1$6.subVectors(e,this.center);const s=_v1$6.lengthSq();if(s>this.radius*this.radius){const a=Math.sqrt(s),c=(a-this.radius)*.5;this.center.addScaledVector(_v1$6,c/a),this.radius+=c}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(_v2$3.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(_v1$6.copy(e.center).add(_v2$3)),this.expandByPoint(_v1$6.copy(e.center).sub(_v2$3))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const _vector$a=new Vector3,_segCenter=new Vector3,_segDir=new Vector3,_diff=new Vector3,_edge1=new Vector3,_edge2=new Vector3,_normal$1=new Vector3;class Ray{constructor(e=new Vector3,s=new Vector3(0,0,-1)){this.origin=e,this.direction=s}set(e,s){return this.origin.copy(e),this.direction.copy(s),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,s){return s.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,_vector$a)),this}closestPointToPoint(e,s){s.subVectors(e,this.origin);const a=s.dot(this.direction);return a<0?s.copy(this.origin):s.copy(this.origin).addScaledVector(this.direction,a)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const s=_vector$a.subVectors(e,this.origin).dot(this.direction);return s<0?this.origin.distanceToSquared(e):(_vector$a.copy(this.origin).addScaledVector(this.direction,s),_vector$a.distanceToSquared(e))}distanceSqToSegment(e,s,a,c){_segCenter.copy(e).add(s).multiplyScalar(.5),_segDir.copy(s).sub(e).normalize(),_diff.copy(this.origin).sub(_segCenter);const d=e.distanceTo(s)*.5,b=-this.direction.dot(_segDir),_e=_diff.dot(this.direction),tt=-_diff.dot(_segDir),nt=_diff.lengthSq(),it=Math.abs(1-b*b);let ot,at,ct,ut;if(it>0)if(ot=b*tt-_e,at=b*_e-tt,ut=d*it,ot>=0)if(at>=-ut)if(at<=ut){const ft=1/it;ot*=ft,at*=ft,ct=ot*(ot+b*at+2*_e)+at*(b*ot+at+2*tt)+nt}else at=d,ot=Math.max(0,-(b*at+_e)),ct=-ot*ot+at*(at+2*tt)+nt;else at=-d,ot=Math.max(0,-(b*at+_e)),ct=-ot*ot+at*(at+2*tt)+nt;else at<=-ut?(ot=Math.max(0,-(-b*d+_e)),at=ot>0?-d:Math.min(Math.max(-d,-tt),d),ct=-ot*ot+at*(at+2*tt)+nt):at<=ut?(ot=0,at=Math.min(Math.max(-d,-tt),d),ct=at*(at+2*tt)+nt):(ot=Math.max(0,-(b*d+_e)),at=ot>0?d:Math.min(Math.max(-d,-tt),d),ct=-ot*ot+at*(at+2*tt)+nt);else at=b>0?-d:d,ot=Math.max(0,-(b*at+_e)),ct=-ot*ot+at*(at+2*tt)+nt;return a&&a.copy(this.origin).addScaledVector(this.direction,ot),c&&c.copy(_segCenter).addScaledVector(_segDir,at),ct}intersectSphere(e,s){_vector$a.subVectors(e.center,this.origin);const a=_vector$a.dot(this.direction),c=_vector$a.dot(_vector$a)-a*a,d=e.radius*e.radius;if(c>d)return null;const b=Math.sqrt(d-c),_e=a-b,tt=a+b;return tt<0?null:_e<0?this.at(tt,s):this.at(_e,s)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const s=e.normal.dot(this.direction);if(s===0)return e.distanceToPoint(this.origin)===0?0:null;const a=-(this.origin.dot(e.normal)+e.constant)/s;return a>=0?a:null}intersectPlane(e,s){const a=this.distanceToPlane(e);return a===null?null:this.at(a,s)}intersectsPlane(e){const s=e.distanceToPoint(this.origin);return s===0||e.normal.dot(this.direction)*s<0}intersectBox(e,s){let a,c,d,b,_e,tt;const nt=1/this.direction.x,it=1/this.direction.y,ot=1/this.direction.z,at=this.origin;return nt>=0?(a=(e.min.x-at.x)*nt,c=(e.max.x-at.x)*nt):(a=(e.max.x-at.x)*nt,c=(e.min.x-at.x)*nt),it>=0?(d=(e.min.y-at.y)*it,b=(e.max.y-at.y)*it):(d=(e.max.y-at.y)*it,b=(e.min.y-at.y)*it),a>b||d>c||((d>a||isNaN(a))&&(a=d),(b<c||isNaN(c))&&(c=b),ot>=0?(_e=(e.min.z-at.z)*ot,tt=(e.max.z-at.z)*ot):(_e=(e.max.z-at.z)*ot,tt=(e.min.z-at.z)*ot),a>tt||_e>c)||((_e>a||a!==a)&&(a=_e),(tt<c||c!==c)&&(c=tt),c<0)?null:this.at(a>=0?a:c,s)}intersectsBox(e){return this.intersectBox(e,_vector$a)!==null}intersectTriangle(e,s,a,c,d){_edge1.subVectors(s,e),_edge2.subVectors(a,e),_normal$1.crossVectors(_edge1,_edge2);let b=this.direction.dot(_normal$1),_e;if(b>0){if(c)return null;_e=1}else if(b<0)_e=-1,b=-b;else return null;_diff.subVectors(this.origin,e);const tt=_e*this.direction.dot(_edge2.crossVectors(_diff,_edge2));if(tt<0)return null;const nt=_e*this.direction.dot(_edge1.cross(_diff));if(nt<0||tt+nt>b)return null;const it=-_e*_diff.dot(_normal$1);return it<0?null:this.at(it/b,d)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Matrix4{constructor(e,s,a,c,d,b,_e,tt,nt,it,ot,at,ct,ut,ft,dt){Matrix4.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,s,a,c,d,b,_e,tt,nt,it,ot,at,ct,ut,ft,dt)}set(e,s,a,c,d,b,_e,tt,nt,it,ot,at,ct,ut,ft,dt){const lt=this.elements;return lt[0]=e,lt[4]=s,lt[8]=a,lt[12]=c,lt[1]=d,lt[5]=b,lt[9]=_e,lt[13]=tt,lt[2]=nt,lt[6]=it,lt[10]=ot,lt[14]=at,lt[3]=ct,lt[7]=ut,lt[11]=ft,lt[15]=dt,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Matrix4().fromArray(this.elements)}copy(e){const s=this.elements,a=e.elements;return s[0]=a[0],s[1]=a[1],s[2]=a[2],s[3]=a[3],s[4]=a[4],s[5]=a[5],s[6]=a[6],s[7]=a[7],s[8]=a[8],s[9]=a[9],s[10]=a[10],s[11]=a[11],s[12]=a[12],s[13]=a[13],s[14]=a[14],s[15]=a[15],this}copyPosition(e){const s=this.elements,a=e.elements;return s[12]=a[12],s[13]=a[13],s[14]=a[14],this}setFromMatrix3(e){const s=e.elements;return this.set(s[0],s[3],s[6],0,s[1],s[4],s[7],0,s[2],s[5],s[8],0,0,0,0,1),this}extractBasis(e,s,a){return e.setFromMatrixColumn(this,0),s.setFromMatrixColumn(this,1),a.setFromMatrixColumn(this,2),this}makeBasis(e,s,a){return this.set(e.x,s.x,a.x,0,e.y,s.y,a.y,0,e.z,s.z,a.z,0,0,0,0,1),this}extractRotation(e){const s=this.elements,a=e.elements,c=1/_v1$5.setFromMatrixColumn(e,0).length(),d=1/_v1$5.setFromMatrixColumn(e,1).length(),b=1/_v1$5.setFromMatrixColumn(e,2).length();return s[0]=a[0]*c,s[1]=a[1]*c,s[2]=a[2]*c,s[3]=0,s[4]=a[4]*d,s[5]=a[5]*d,s[6]=a[6]*d,s[7]=0,s[8]=a[8]*b,s[9]=a[9]*b,s[10]=a[10]*b,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,this}makeRotationFromEuler(e){const s=this.elements,a=e.x,c=e.y,d=e.z,b=Math.cos(a),_e=Math.sin(a),tt=Math.cos(c),nt=Math.sin(c),it=Math.cos(d),ot=Math.sin(d);if(e.order==="XYZ"){const at=b*it,ct=b*ot,ut=_e*it,ft=_e*ot;s[0]=tt*it,s[4]=-tt*ot,s[8]=nt,s[1]=ct+ut*nt,s[5]=at-ft*nt,s[9]=-_e*tt,s[2]=ft-at*nt,s[6]=ut+ct*nt,s[10]=b*tt}else if(e.order==="YXZ"){const at=tt*it,ct=tt*ot,ut=nt*it,ft=nt*ot;s[0]=at+ft*_e,s[4]=ut*_e-ct,s[8]=b*nt,s[1]=b*ot,s[5]=b*it,s[9]=-_e,s[2]=ct*_e-ut,s[6]=ft+at*_e,s[10]=b*tt}else if(e.order==="ZXY"){const at=tt*it,ct=tt*ot,ut=nt*it,ft=nt*ot;s[0]=at-ft*_e,s[4]=-b*ot,s[8]=ut+ct*_e,s[1]=ct+ut*_e,s[5]=b*it,s[9]=ft-at*_e,s[2]=-b*nt,s[6]=_e,s[10]=b*tt}else if(e.order==="ZYX"){const at=b*it,ct=b*ot,ut=_e*it,ft=_e*ot;s[0]=tt*it,s[4]=ut*nt-ct,s[8]=at*nt+ft,s[1]=tt*ot,s[5]=ft*nt+at,s[9]=ct*nt-ut,s[2]=-nt,s[6]=_e*tt,s[10]=b*tt}else if(e.order==="YZX"){const at=b*tt,ct=b*nt,ut=_e*tt,ft=_e*nt;s[0]=tt*it,s[4]=ft-at*ot,s[8]=ut*ot+ct,s[1]=ot,s[5]=b*it,s[9]=-_e*it,s[2]=-nt*it,s[6]=ct*ot+ut,s[10]=at-ft*ot}else if(e.order==="XZY"){const at=b*tt,ct=b*nt,ut=_e*tt,ft=_e*nt;s[0]=tt*it,s[4]=-ot,s[8]=nt*it,s[1]=at*ot+ft,s[5]=b*it,s[9]=ct*ot-ut,s[2]=ut*ot-ct,s[6]=_e*it,s[10]=ft*ot+at}return s[3]=0,s[7]=0,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,this}makeRotationFromQuaternion(e){return this.compose(_zero,e,_one)}lookAt(e,s,a){const c=this.elements;return _z.subVectors(e,s),_z.lengthSq()===0&&(_z.z=1),_z.normalize(),_x.crossVectors(a,_z),_x.lengthSq()===0&&(Math.abs(a.z)===1?_z.x+=1e-4:_z.z+=1e-4,_z.normalize(),_x.crossVectors(a,_z)),_x.normalize(),_y.crossVectors(_z,_x),c[0]=_x.x,c[4]=_y.x,c[8]=_z.x,c[1]=_x.y,c[5]=_y.y,c[9]=_z.y,c[2]=_x.z,c[6]=_y.z,c[10]=_z.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,s){const a=e.elements,c=s.elements,d=this.elements,b=a[0],_e=a[4],tt=a[8],nt=a[12],it=a[1],ot=a[5],at=a[9],ct=a[13],ut=a[2],ft=a[6],dt=a[10],lt=a[14],ht=a[3],mt=a[7],xt=a[11],St=a[15],yt=c[0],wt=c[4],Et=c[8],_t=c[12],vt=c[1],Mt=c[5],jt=c[9],Lt=c[13],Nt=c[2],kt=c[6],Ot=c[10],Ht=c[14],Ct=c[3],Ut=c[7],Gt=c[11],Pt=c[15];return d[0]=b*yt+_e*vt+tt*Nt+nt*Ct,d[4]=b*wt+_e*Mt+tt*kt+nt*Ut,d[8]=b*Et+_e*jt+tt*Ot+nt*Gt,d[12]=b*_t+_e*Lt+tt*Ht+nt*Pt,d[1]=it*yt+ot*vt+at*Nt+ct*Ct,d[5]=it*wt+ot*Mt+at*kt+ct*Ut,d[9]=it*Et+ot*jt+at*Ot+ct*Gt,d[13]=it*_t+ot*Lt+at*Ht+ct*Pt,d[2]=ut*yt+ft*vt+dt*Nt+lt*Ct,d[6]=ut*wt+ft*Mt+dt*kt+lt*Ut,d[10]=ut*Et+ft*jt+dt*Ot+lt*Gt,d[14]=ut*_t+ft*Lt+dt*Ht+lt*Pt,d[3]=ht*yt+mt*vt+xt*Nt+St*Ct,d[7]=ht*wt+mt*Mt+xt*kt+St*Ut,d[11]=ht*Et+mt*jt+xt*Ot+St*Gt,d[15]=ht*_t+mt*Lt+xt*Ht+St*Pt,this}multiplyScalar(e){const s=this.elements;return s[0]*=e,s[4]*=e,s[8]*=e,s[12]*=e,s[1]*=e,s[5]*=e,s[9]*=e,s[13]*=e,s[2]*=e,s[6]*=e,s[10]*=e,s[14]*=e,s[3]*=e,s[7]*=e,s[11]*=e,s[15]*=e,this}determinant(){const e=this.elements,s=e[0],a=e[4],c=e[8],d=e[12],b=e[1],_e=e[5],tt=e[9],nt=e[13],it=e[2],ot=e[6],at=e[10],ct=e[14],ut=e[3],ft=e[7],dt=e[11],lt=e[15];return ut*(+d*tt*ot-c*nt*ot-d*_e*at+a*nt*at+c*_e*ct-a*tt*ct)+ft*(+s*tt*ct-s*nt*at+d*b*at-c*b*ct+c*nt*it-d*tt*it)+dt*(+s*nt*ot-s*_e*ct-d*b*ot+a*b*ct+d*_e*it-a*nt*it)+lt*(-c*_e*it-s*tt*ot+s*_e*at+c*b*ot-a*b*at+a*tt*it)}transpose(){const e=this.elements;let s;return s=e[1],e[1]=e[4],e[4]=s,s=e[2],e[2]=e[8],e[8]=s,s=e[6],e[6]=e[9],e[9]=s,s=e[3],e[3]=e[12],e[12]=s,s=e[7],e[7]=e[13],e[13]=s,s=e[11],e[11]=e[14],e[14]=s,this}setPosition(e,s,a){const c=this.elements;return e.isVector3?(c[12]=e.x,c[13]=e.y,c[14]=e.z):(c[12]=e,c[13]=s,c[14]=a),this}invert(){const e=this.elements,s=e[0],a=e[1],c=e[2],d=e[3],b=e[4],_e=e[5],tt=e[6],nt=e[7],it=e[8],ot=e[9],at=e[10],ct=e[11],ut=e[12],ft=e[13],dt=e[14],lt=e[15],ht=ot*dt*nt-ft*at*nt+ft*tt*ct-_e*dt*ct-ot*tt*lt+_e*at*lt,mt=ut*at*nt-it*dt*nt-ut*tt*ct+b*dt*ct+it*tt*lt-b*at*lt,xt=it*ft*nt-ut*ot*nt+ut*_e*ct-b*ft*ct-it*_e*lt+b*ot*lt,St=ut*ot*tt-it*ft*tt-ut*_e*at+b*ft*at+it*_e*dt-b*ot*dt,yt=s*ht+a*mt+c*xt+d*St;if(yt===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const wt=1/yt;return e[0]=ht*wt,e[1]=(ft*at*d-ot*dt*d-ft*c*ct+a*dt*ct+ot*c*lt-a*at*lt)*wt,e[2]=(_e*dt*d-ft*tt*d+ft*c*nt-a*dt*nt-_e*c*lt+a*tt*lt)*wt,e[3]=(ot*tt*d-_e*at*d-ot*c*nt+a*at*nt+_e*c*ct-a*tt*ct)*wt,e[4]=mt*wt,e[5]=(it*dt*d-ut*at*d+ut*c*ct-s*dt*ct-it*c*lt+s*at*lt)*wt,e[6]=(ut*tt*d-b*dt*d-ut*c*nt+s*dt*nt+b*c*lt-s*tt*lt)*wt,e[7]=(b*at*d-it*tt*d+it*c*nt-s*at*nt-b*c*ct+s*tt*ct)*wt,e[8]=xt*wt,e[9]=(ut*ot*d-it*ft*d-ut*a*ct+s*ft*ct+it*a*lt-s*ot*lt)*wt,e[10]=(b*ft*d-ut*_e*d+ut*a*nt-s*ft*nt-b*a*lt+s*_e*lt)*wt,e[11]=(it*_e*d-b*ot*d-it*a*nt+s*ot*nt+b*a*ct-s*_e*ct)*wt,e[12]=St*wt,e[13]=(it*ft*c-ut*ot*c+ut*a*at-s*ft*at-it*a*dt+s*ot*dt)*wt,e[14]=(ut*_e*c-b*ft*c-ut*a*tt+s*ft*tt+b*a*dt-s*_e*dt)*wt,e[15]=(b*ot*c-it*_e*c+it*a*tt-s*ot*tt-b*a*at+s*_e*at)*wt,this}scale(e){const s=this.elements,a=e.x,c=e.y,d=e.z;return s[0]*=a,s[4]*=c,s[8]*=d,s[1]*=a,s[5]*=c,s[9]*=d,s[2]*=a,s[6]*=c,s[10]*=d,s[3]*=a,s[7]*=c,s[11]*=d,this}getMaxScaleOnAxis(){const e=this.elements,s=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],a=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],c=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(s,a,c))}makeTranslation(e,s,a){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,s,0,0,1,a,0,0,0,1),this}makeRotationX(e){const s=Math.cos(e),a=Math.sin(e);return this.set(1,0,0,0,0,s,-a,0,0,a,s,0,0,0,0,1),this}makeRotationY(e){const s=Math.cos(e),a=Math.sin(e);return this.set(s,0,a,0,0,1,0,0,-a,0,s,0,0,0,0,1),this}makeRotationZ(e){const s=Math.cos(e),a=Math.sin(e);return this.set(s,-a,0,0,a,s,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,s){const a=Math.cos(s),c=Math.sin(s),d=1-a,b=e.x,_e=e.y,tt=e.z,nt=d*b,it=d*_e;return this.set(nt*b+a,nt*_e-c*tt,nt*tt+c*_e,0,nt*_e+c*tt,it*_e+a,it*tt-c*b,0,nt*tt-c*_e,it*tt+c*b,d*tt*tt+a,0,0,0,0,1),this}makeScale(e,s,a){return this.set(e,0,0,0,0,s,0,0,0,0,a,0,0,0,0,1),this}makeShear(e,s,a,c,d,b){return this.set(1,a,d,0,e,1,b,0,s,c,1,0,0,0,0,1),this}compose(e,s,a){const c=this.elements,d=s._x,b=s._y,_e=s._z,tt=s._w,nt=d+d,it=b+b,ot=_e+_e,at=d*nt,ct=d*it,ut=d*ot,ft=b*it,dt=b*ot,lt=_e*ot,ht=tt*nt,mt=tt*it,xt=tt*ot,St=a.x,yt=a.y,wt=a.z;return c[0]=(1-(ft+lt))*St,c[1]=(ct+xt)*St,c[2]=(ut-mt)*St,c[3]=0,c[4]=(ct-xt)*yt,c[5]=(1-(at+lt))*yt,c[6]=(dt+ht)*yt,c[7]=0,c[8]=(ut+mt)*wt,c[9]=(dt-ht)*wt,c[10]=(1-(at+ft))*wt,c[11]=0,c[12]=e.x,c[13]=e.y,c[14]=e.z,c[15]=1,this}decompose(e,s,a){const c=this.elements;let d=_v1$5.set(c[0],c[1],c[2]).length();const b=_v1$5.set(c[4],c[5],c[6]).length(),_e=_v1$5.set(c[8],c[9],c[10]).length();this.determinant()<0&&(d=-d),e.x=c[12],e.y=c[13],e.z=c[14],_m1$4.copy(this);const nt=1/d,it=1/b,ot=1/_e;return _m1$4.elements[0]*=nt,_m1$4.elements[1]*=nt,_m1$4.elements[2]*=nt,_m1$4.elements[4]*=it,_m1$4.elements[5]*=it,_m1$4.elements[6]*=it,_m1$4.elements[8]*=ot,_m1$4.elements[9]*=ot,_m1$4.elements[10]*=ot,s.setFromRotationMatrix(_m1$4),a.x=d,a.y=b,a.z=_e,this}makePerspective(e,s,a,c,d,b,_e=WebGLCoordinateSystem){const tt=this.elements,nt=2*d/(s-e),it=2*d/(a-c),ot=(s+e)/(s-e),at=(a+c)/(a-c);let ct,ut;if(_e===WebGLCoordinateSystem)ct=-(b+d)/(b-d),ut=-2*b*d/(b-d);else if(_e===WebGPUCoordinateSystem)ct=-b/(b-d),ut=-b*d/(b-d);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+_e);return tt[0]=nt,tt[4]=0,tt[8]=ot,tt[12]=0,tt[1]=0,tt[5]=it,tt[9]=at,tt[13]=0,tt[2]=0,tt[6]=0,tt[10]=ct,tt[14]=ut,tt[3]=0,tt[7]=0,tt[11]=-1,tt[15]=0,this}makeOrthographic(e,s,a,c,d,b,_e=WebGLCoordinateSystem){const tt=this.elements,nt=1/(s-e),it=1/(a-c),ot=1/(b-d),at=(s+e)*nt,ct=(a+c)*it;let ut,ft;if(_e===WebGLCoordinateSystem)ut=(b+d)*ot,ft=-2*ot;else if(_e===WebGPUCoordinateSystem)ut=d*ot,ft=-1*ot;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+_e);return tt[0]=2*nt,tt[4]=0,tt[8]=0,tt[12]=-at,tt[1]=0,tt[5]=2*it,tt[9]=0,tt[13]=-ct,tt[2]=0,tt[6]=0,tt[10]=ft,tt[14]=-ut,tt[3]=0,tt[7]=0,tt[11]=0,tt[15]=1,this}equals(e){const s=this.elements,a=e.elements;for(let c=0;c<16;c++)if(s[c]!==a[c])return!1;return!0}fromArray(e,s=0){for(let a=0;a<16;a++)this.elements[a]=e[a+s];return this}toArray(e=[],s=0){const a=this.elements;return e[s]=a[0],e[s+1]=a[1],e[s+2]=a[2],e[s+3]=a[3],e[s+4]=a[4],e[s+5]=a[5],e[s+6]=a[6],e[s+7]=a[7],e[s+8]=a[8],e[s+9]=a[9],e[s+10]=a[10],e[s+11]=a[11],e[s+12]=a[12],e[s+13]=a[13],e[s+14]=a[14],e[s+15]=a[15],e}}const _v1$5=new Vector3,_m1$4=new Matrix4,_zero=new Vector3(0,0,0),_one=new Vector3(1,1,1),_x=new Vector3,_y=new Vector3,_z=new Vector3,_matrix$2=new Matrix4,_quaternion$3=new Quaternion;class Euler{constructor(e=0,s=0,a=0,c=Euler.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=s,this._z=a,this._order=c}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,s,a,c=this._order){return this._x=e,this._y=s,this._z=a,this._order=c,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,s=this._order,a=!0){const c=e.elements,d=c[0],b=c[4],_e=c[8],tt=c[1],nt=c[5],it=c[9],ot=c[2],at=c[6],ct=c[10];switch(s){case"XYZ":this._y=Math.asin(clamp(_e,-1,1)),Math.abs(_e)<.9999999?(this._x=Math.atan2(-it,ct),this._z=Math.atan2(-b,d)):(this._x=Math.atan2(at,nt),this._z=0);break;case"YXZ":this._x=Math.asin(-clamp(it,-1,1)),Math.abs(it)<.9999999?(this._y=Math.atan2(_e,ct),this._z=Math.atan2(tt,nt)):(this._y=Math.atan2(-ot,d),this._z=0);break;case"ZXY":this._x=Math.asin(clamp(at,-1,1)),Math.abs(at)<.9999999?(this._y=Math.atan2(-ot,ct),this._z=Math.atan2(-b,nt)):(this._y=0,this._z=Math.atan2(tt,d));break;case"ZYX":this._y=Math.asin(-clamp(ot,-1,1)),Math.abs(ot)<.9999999?(this._x=Math.atan2(at,ct),this._z=Math.atan2(tt,d)):(this._x=0,this._z=Math.atan2(-b,nt));break;case"YZX":this._z=Math.asin(clamp(tt,-1,1)),Math.abs(tt)<.9999999?(this._x=Math.atan2(-it,nt),this._y=Math.atan2(-ot,d)):(this._x=0,this._y=Math.atan2(_e,ct));break;case"XZY":this._z=Math.asin(-clamp(b,-1,1)),Math.abs(b)<.9999999?(this._x=Math.atan2(at,nt),this._y=Math.atan2(_e,d)):(this._x=Math.atan2(-it,ct),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+s)}return this._order=s,a===!0&&this._onChangeCallback(),this}setFromQuaternion(e,s,a){return _matrix$2.makeRotationFromQuaternion(e),this.setFromRotationMatrix(_matrix$2,s,a)}setFromVector3(e,s=this._order){return this.set(e.x,e.y,e.z,s)}reorder(e){return _quaternion$3.setFromEuler(this),this.setFromQuaternion(_quaternion$3,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],s=0){return e[s]=this._x,e[s+1]=this._y,e[s+2]=this._z,e[s+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Euler.DEFAULT_ORDER="XYZ";class Layers{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let _object3DId=0;const _v1$4=new Vector3,_q1=new Quaternion,_m1$3=new Matrix4,_target=new Vector3,_position$3=new Vector3,_scale$2=new Vector3,_quaternion$2=new Quaternion,_xAxis=new Vector3(1,0,0),_yAxis=new Vector3(0,1,0),_zAxis=new Vector3(0,0,1),_addedEvent={type:"added"},_removedEvent={type:"removed"},_childaddedEvent={type:"childadded",child:null},_childremovedEvent={type:"childremoved",child:null};class Object3D extends EventDispatcher$1{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:_object3DId++}),this.uuid=generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Object3D.DEFAULT_UP.clone();const e=new Vector3,s=new Euler,a=new Quaternion,c=new Vector3(1,1,1);function d(){a.setFromEuler(s,!1)}function b(){s.setFromQuaternion(a,void 0,!1)}s._onChange(d),a._onChange(b),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:s},quaternion:{configurable:!0,enumerable:!0,value:a},scale:{configurable:!0,enumerable:!0,value:c},modelViewMatrix:{value:new Matrix4},normalMatrix:{value:new Matrix3}}),this.matrix=new Matrix4,this.matrixWorld=new Matrix4,this.matrixAutoUpdate=Object3D.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Object3D.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new Layers,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,s){this.quaternion.setFromAxisAngle(e,s)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,s){return _q1.setFromAxisAngle(e,s),this.quaternion.multiply(_q1),this}rotateOnWorldAxis(e,s){return _q1.setFromAxisAngle(e,s),this.quaternion.premultiply(_q1),this}rotateX(e){return this.rotateOnAxis(_xAxis,e)}rotateY(e){return this.rotateOnAxis(_yAxis,e)}rotateZ(e){return this.rotateOnAxis(_zAxis,e)}translateOnAxis(e,s){return _v1$4.copy(e).applyQuaternion(this.quaternion),this.position.add(_v1$4.multiplyScalar(s)),this}translateX(e){return this.translateOnAxis(_xAxis,e)}translateY(e){return this.translateOnAxis(_yAxis,e)}translateZ(e){return this.translateOnAxis(_zAxis,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(_m1$3.copy(this.matrixWorld).invert())}lookAt(e,s,a){e.isVector3?_target.copy(e):_target.set(e,s,a);const c=this.parent;this.updateWorldMatrix(!0,!1),_position$3.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?_m1$3.lookAt(_position$3,_target,this.up):_m1$3.lookAt(_target,_position$3,this.up),this.quaternion.setFromRotationMatrix(_m1$3),c&&(_m1$3.extractRotation(c.matrixWorld),_q1.setFromRotationMatrix(_m1$3),this.quaternion.premultiply(_q1.invert()))}add(e){if(arguments.length>1){for(let s=0;s<arguments.length;s++)this.add(arguments[s]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(_addedEvent),_childaddedEvent.child=e,this.dispatchEvent(_childaddedEvent),_childaddedEvent.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let a=0;a<arguments.length;a++)this.remove(arguments[a]);return this}const s=this.children.indexOf(e);return s!==-1&&(e.parent=null,this.children.splice(s,1),e.dispatchEvent(_removedEvent),_childremovedEvent.child=e,this.dispatchEvent(_childremovedEvent),_childremovedEvent.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),_m1$3.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),_m1$3.multiply(e.parent.matrixWorld)),e.applyMatrix4(_m1$3),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(_addedEvent),_childaddedEvent.child=e,this.dispatchEvent(_childaddedEvent),_childaddedEvent.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,s){if(this[e]===s)return this;for(let a=0,c=this.children.length;a<c;a++){const b=this.children[a].getObjectByProperty(e,s);if(b!==void 0)return b}}getObjectsByProperty(e,s,a=[]){this[e]===s&&a.push(this);const c=this.children;for(let d=0,b=c.length;d<b;d++)c[d].getObjectsByProperty(e,s,a);return a}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(_position$3,e,_scale$2),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(_position$3,_quaternion$2,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const s=this.matrixWorld.elements;return e.set(s[8],s[9],s[10]).normalize()}raycast(){}traverse(e){e(this);const s=this.children;for(let a=0,c=s.length;a<c;a++)s[a].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const s=this.children;for(let a=0,c=s.length;a<c;a++)s[a].traverseVisible(e)}traverseAncestors(e){const s=this.parent;s!==null&&(e(s),s.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const s=this.children;for(let a=0,c=s.length;a<c;a++)s[a].updateMatrixWorld(e)}updateWorldMatrix(e,s){const a=this.parent;if(e===!0&&a!==null&&a.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),s===!0){const c=this.children;for(let d=0,b=c.length;d<b;d++)c[d].updateWorldMatrix(!1,!0)}}toJSON(e){const s=e===void 0||typeof e=="string",a={};s&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},a.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const c={};c.uuid=this.uuid,c.type=this.type,this.name!==""&&(c.name=this.name),this.castShadow===!0&&(c.castShadow=!0),this.receiveShadow===!0&&(c.receiveShadow=!0),this.visible===!1&&(c.visible=!1),this.frustumCulled===!1&&(c.frustumCulled=!1),this.renderOrder!==0&&(c.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(c.userData=this.userData),c.layers=this.layers.mask,c.matrix=this.matrix.toArray(),c.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(c.matrixAutoUpdate=!1),this.isInstancedMesh&&(c.type="InstancedMesh",c.count=this.count,c.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(c.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(c.type="BatchedMesh",c.perObjectFrustumCulled=this.perObjectFrustumCulled,c.sortObjects=this.sortObjects,c.drawRanges=this._drawRanges,c.reservedRanges=this._reservedRanges,c.visibility=this._visibility,c.active=this._active,c.bounds=this._bounds.map(_e=>({boxInitialized:_e.boxInitialized,boxMin:_e.box.min.toArray(),boxMax:_e.box.max.toArray(),sphereInitialized:_e.sphereInitialized,sphereRadius:_e.sphere.radius,sphereCenter:_e.sphere.center.toArray()})),c.maxInstanceCount=this._maxInstanceCount,c.maxVertexCount=this._maxVertexCount,c.maxIndexCount=this._maxIndexCount,c.geometryInitialized=this._geometryInitialized,c.geometryCount=this._geometryCount,c.matricesTexture=this._matricesTexture.toJSON(e),this._colorsTexture!==null&&(c.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(c.boundingSphere={center:c.boundingSphere.center.toArray(),radius:c.boundingSphere.radius}),this.boundingBox!==null&&(c.boundingBox={min:c.boundingBox.min.toArray(),max:c.boundingBox.max.toArray()}));function d(_e,tt){return _e[tt.uuid]===void 0&&(_e[tt.uuid]=tt.toJSON(e)),tt.uuid}if(this.isScene)this.background&&(this.background.isColor?c.background=this.background.toJSON():this.background.isTexture&&(c.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(c.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){c.geometry=d(e.geometries,this.geometry);const _e=this.geometry.parameters;if(_e!==void 0&&_e.shapes!==void 0){const tt=_e.shapes;if(Array.isArray(tt))for(let nt=0,it=tt.length;nt<it;nt++){const ot=tt[nt];d(e.shapes,ot)}else d(e.shapes,tt)}}if(this.isSkinnedMesh&&(c.bindMode=this.bindMode,c.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(d(e.skeletons,this.skeleton),c.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const _e=[];for(let tt=0,nt=this.material.length;tt<nt;tt++)_e.push(d(e.materials,this.material[tt]));c.material=_e}else c.material=d(e.materials,this.material);if(this.children.length>0){c.children=[];for(let _e=0;_e<this.children.length;_e++)c.children.push(this.children[_e].toJSON(e).object)}if(this.animations.length>0){c.animations=[];for(let _e=0;_e<this.animations.length;_e++){const tt=this.animations[_e];c.animations.push(d(e.animations,tt))}}if(s){const _e=b(e.geometries),tt=b(e.materials),nt=b(e.textures),it=b(e.images),ot=b(e.shapes),at=b(e.skeletons),ct=b(e.animations),ut=b(e.nodes);_e.length>0&&(a.geometries=_e),tt.length>0&&(a.materials=tt),nt.length>0&&(a.textures=nt),it.length>0&&(a.images=it),ot.length>0&&(a.shapes=ot),at.length>0&&(a.skeletons=at),ct.length>0&&(a.animations=ct),ut.length>0&&(a.nodes=ut)}return a.object=c,a;function b(_e){const tt=[];for(const nt in _e){const it=_e[nt];delete it.metadata,tt.push(it)}return tt}}clone(e){return new this.constructor().copy(this,e)}copy(e,s=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),s===!0)for(let a=0;a<e.children.length;a++){const c=e.children[a];this.add(c.clone())}return this}}Object3D.DEFAULT_UP=new Vector3(0,1,0);Object3D.DEFAULT_MATRIX_AUTO_UPDATE=!0;Object3D.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const _v0$2=new Vector3,_v1$3=new Vector3,_v2$2=new Vector3,_v3$2=new Vector3,_vab=new Vector3,_vac=new Vector3,_vbc=new Vector3,_vap=new Vector3,_vbp=new Vector3,_vcp=new Vector3,_v40=new Vector4,_v41=new Vector4,_v42=new Vector4;class Triangle{constructor(e=new Vector3,s=new Vector3,a=new Vector3){this.a=e,this.b=s,this.c=a}static getNormal(e,s,a,c){c.subVectors(a,s),_v0$2.subVectors(e,s),c.cross(_v0$2);const d=c.lengthSq();return d>0?c.multiplyScalar(1/Math.sqrt(d)):c.set(0,0,0)}static getBarycoord(e,s,a,c,d){_v0$2.subVectors(c,s),_v1$3.subVectors(a,s),_v2$2.subVectors(e,s);const b=_v0$2.dot(_v0$2),_e=_v0$2.dot(_v1$3),tt=_v0$2.dot(_v2$2),nt=_v1$3.dot(_v1$3),it=_v1$3.dot(_v2$2),ot=b*nt-_e*_e;if(ot===0)return d.set(0,0,0),null;const at=1/ot,ct=(nt*tt-_e*it)*at,ut=(b*it-_e*tt)*at;return d.set(1-ct-ut,ut,ct)}static containsPoint(e,s,a,c){return this.getBarycoord(e,s,a,c,_v3$2)===null?!1:_v3$2.x>=0&&_v3$2.y>=0&&_v3$2.x+_v3$2.y<=1}static getInterpolation(e,s,a,c,d,b,_e,tt){return this.getBarycoord(e,s,a,c,_v3$2)===null?(tt.x=0,tt.y=0,"z"in tt&&(tt.z=0),"w"in tt&&(tt.w=0),null):(tt.setScalar(0),tt.addScaledVector(d,_v3$2.x),tt.addScaledVector(b,_v3$2.y),tt.addScaledVector(_e,_v3$2.z),tt)}static getInterpolatedAttribute(e,s,a,c,d,b){return _v40.setScalar(0),_v41.setScalar(0),_v42.setScalar(0),_v40.fromBufferAttribute(e,s),_v41.fromBufferAttribute(e,a),_v42.fromBufferAttribute(e,c),b.setScalar(0),b.addScaledVector(_v40,d.x),b.addScaledVector(_v41,d.y),b.addScaledVector(_v42,d.z),b}static isFrontFacing(e,s,a,c){return _v0$2.subVectors(a,s),_v1$3.subVectors(e,s),_v0$2.cross(_v1$3).dot(c)<0}set(e,s,a){return this.a.copy(e),this.b.copy(s),this.c.copy(a),this}setFromPointsAndIndices(e,s,a,c){return this.a.copy(e[s]),this.b.copy(e[a]),this.c.copy(e[c]),this}setFromAttributeAndIndices(e,s,a,c){return this.a.fromBufferAttribute(e,s),this.b.fromBufferAttribute(e,a),this.c.fromBufferAttribute(e,c),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return _v0$2.subVectors(this.c,this.b),_v1$3.subVectors(this.a,this.b),_v0$2.cross(_v1$3).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Triangle.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,s){return Triangle.getBarycoord(e,this.a,this.b,this.c,s)}getInterpolation(e,s,a,c,d){return Triangle.getInterpolation(e,this.a,this.b,this.c,s,a,c,d)}containsPoint(e){return Triangle.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Triangle.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,s){const a=this.a,c=this.b,d=this.c;let b,_e;_vab.subVectors(c,a),_vac.subVectors(d,a),_vap.subVectors(e,a);const tt=_vab.dot(_vap),nt=_vac.dot(_vap);if(tt<=0&&nt<=0)return s.copy(a);_vbp.subVectors(e,c);const it=_vab.dot(_vbp),ot=_vac.dot(_vbp);if(it>=0&&ot<=it)return s.copy(c);const at=tt*ot-it*nt;if(at<=0&&tt>=0&&it<=0)return b=tt/(tt-it),s.copy(a).addScaledVector(_vab,b);_vcp.subVectors(e,d);const ct=_vab.dot(_vcp),ut=_vac.dot(_vcp);if(ut>=0&&ct<=ut)return s.copy(d);const ft=ct*nt-tt*ut;if(ft<=0&&nt>=0&&ut<=0)return _e=nt/(nt-ut),s.copy(a).addScaledVector(_vac,_e);const dt=it*ut-ct*ot;if(dt<=0&&ot-it>=0&&ct-ut>=0)return _vbc.subVectors(d,c),_e=(ot-it)/(ot-it+(ct-ut)),s.copy(c).addScaledVector(_vbc,_e);const lt=1/(dt+ft+at);return b=ft*lt,_e=at*lt,s.copy(a).addScaledVector(_vab,b).addScaledVector(_vac,_e)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const _colorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},_hslA={h:0,s:0,l:0},_hslB={h:0,s:0,l:0};function hue2rgb(o,e,s){return s<0&&(s+=1),s>1&&(s-=1),s<1/6?o+(e-o)*6*s:s<1/2?e:s<2/3?o+(e-o)*6*(2/3-s):o}class Color{constructor(e,s,a){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,s,a)}set(e,s,a){if(s===void 0&&a===void 0){const c=e;c&&c.isColor?this.copy(c):typeof c=="number"?this.setHex(c):typeof c=="string"&&this.setStyle(c)}else this.setRGB(e,s,a);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,s=SRGBColorSpace$1){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,ColorManagement.toWorkingColorSpace(this,s),this}setRGB(e,s,a,c=ColorManagement.workingColorSpace){return this.r=e,this.g=s,this.b=a,ColorManagement.toWorkingColorSpace(this,c),this}setHSL(e,s,a,c=ColorManagement.workingColorSpace){if(e=euclideanModulo(e,1),s=clamp(s,0,1),a=clamp(a,0,1),s===0)this.r=this.g=this.b=a;else{const d=a<=.5?a*(1+s):a+s-a*s,b=2*a-d;this.r=hue2rgb(b,d,e+1/3),this.g=hue2rgb(b,d,e),this.b=hue2rgb(b,d,e-1/3)}return ColorManagement.toWorkingColorSpace(this,c),this}setStyle(e,s=SRGBColorSpace$1){function a(d){d!==void 0&&parseFloat(d)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let c;if(c=/^(\w+)\(([^\)]*)\)/.exec(e)){let d;const b=c[1],_e=c[2];switch(b){case"rgb":case"rgba":if(d=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(_e))return a(d[4]),this.setRGB(Math.min(255,parseInt(d[1],10))/255,Math.min(255,parseInt(d[2],10))/255,Math.min(255,parseInt(d[3],10))/255,s);if(d=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(_e))return a(d[4]),this.setRGB(Math.min(100,parseInt(d[1],10))/100,Math.min(100,parseInt(d[2],10))/100,Math.min(100,parseInt(d[3],10))/100,s);break;case"hsl":case"hsla":if(d=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(_e))return a(d[4]),this.setHSL(parseFloat(d[1])/360,parseFloat(d[2])/100,parseFloat(d[3])/100,s);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(c=/^\#([A-Fa-f\d]+)$/.exec(e)){const d=c[1],b=d.length;if(b===3)return this.setRGB(parseInt(d.charAt(0),16)/15,parseInt(d.charAt(1),16)/15,parseInt(d.charAt(2),16)/15,s);if(b===6)return this.setHex(parseInt(d,16),s);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,s);return this}setColorName(e,s=SRGBColorSpace$1){const a=_colorKeywords[e.toLowerCase()];return a!==void 0?this.setHex(a,s):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=SRGBToLinear(e.r),this.g=SRGBToLinear(e.g),this.b=SRGBToLinear(e.b),this}copyLinearToSRGB(e){return this.r=LinearToSRGB(e.r),this.g=LinearToSRGB(e.g),this.b=LinearToSRGB(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=SRGBColorSpace$1){return ColorManagement.fromWorkingColorSpace(_color.copy(this),e),Math.round(clamp(_color.r*255,0,255))*65536+Math.round(clamp(_color.g*255,0,255))*256+Math.round(clamp(_color.b*255,0,255))}getHexString(e=SRGBColorSpace$1){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,s=ColorManagement.workingColorSpace){ColorManagement.fromWorkingColorSpace(_color.copy(this),s);const a=_color.r,c=_color.g,d=_color.b,b=Math.max(a,c,d),_e=Math.min(a,c,d);let tt,nt;const it=(_e+b)/2;if(_e===b)tt=0,nt=0;else{const ot=b-_e;switch(nt=it<=.5?ot/(b+_e):ot/(2-b-_e),b){case a:tt=(c-d)/ot+(c<d?6:0);break;case c:tt=(d-a)/ot+2;break;case d:tt=(a-c)/ot+4;break}tt/=6}return e.h=tt,e.s=nt,e.l=it,e}getRGB(e,s=ColorManagement.workingColorSpace){return ColorManagement.fromWorkingColorSpace(_color.copy(this),s),e.r=_color.r,e.g=_color.g,e.b=_color.b,e}getStyle(e=SRGBColorSpace$1){ColorManagement.fromWorkingColorSpace(_color.copy(this),e);const s=_color.r,a=_color.g,c=_color.b;return e!==SRGBColorSpace$1?`color(${e} ${s.toFixed(3)} ${a.toFixed(3)} ${c.toFixed(3)})`:`rgb(${Math.round(s*255)},${Math.round(a*255)},${Math.round(c*255)})`}offsetHSL(e,s,a){return this.getHSL(_hslA),this.setHSL(_hslA.h+e,_hslA.s+s,_hslA.l+a)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,s){return this.r=e.r+s.r,this.g=e.g+s.g,this.b=e.b+s.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,s){return this.r+=(e.r-this.r)*s,this.g+=(e.g-this.g)*s,this.b+=(e.b-this.b)*s,this}lerpColors(e,s,a){return this.r=e.r+(s.r-e.r)*a,this.g=e.g+(s.g-e.g)*a,this.b=e.b+(s.b-e.b)*a,this}lerpHSL(e,s){this.getHSL(_hslA),e.getHSL(_hslB);const a=lerp(_hslA.h,_hslB.h,s),c=lerp(_hslA.s,_hslB.s,s),d=lerp(_hslA.l,_hslB.l,s);return this.setHSL(a,c,d),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const s=this.r,a=this.g,c=this.b,d=e.elements;return this.r=d[0]*s+d[3]*a+d[6]*c,this.g=d[1]*s+d[4]*a+d[7]*c,this.b=d[2]*s+d[5]*a+d[8]*c,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,s=0){return this.r=e[s],this.g=e[s+1],this.b=e[s+2],this}toArray(e=[],s=0){return e[s]=this.r,e[s+1]=this.g,e[s+2]=this.b,e}fromBufferAttribute(e,s){return this.r=e.getX(s),this.g=e.getY(s),this.b=e.getZ(s),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const _color=new Color;Color.NAMES=_colorKeywords;let _materialId=0;class Material extends EventDispatcher$1{static get type(){return"Material"}get type(){return this.constructor.type}set type(e){}constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:_materialId++}),this.uuid=generateUUID(),this.name="",this.blending=NormalBlending,this.side=FrontSide,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=SrcAlphaFactor,this.blendDst=OneMinusSrcAlphaFactor,this.blendEquation=AddEquation,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Color(0,0,0),this.blendAlpha=0,this.depthFunc=LessEqualDepth,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=AlwaysStencilFunc,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=KeepStencilOp,this.stencilZFail=KeepStencilOp,this.stencilZPass=KeepStencilOp,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const s in e){const a=e[s];if(a===void 0){console.warn(`THREE.Material: parameter '${s}' has value of undefined.`);continue}const c=this[s];if(c===void 0){console.warn(`THREE.Material: '${s}' is not a property of THREE.${this.type}.`);continue}c&&c.isColor?c.set(a):c&&c.isVector3&&a&&a.isVector3?c.copy(a):this[s]=a}}toJSON(e){const s=e===void 0||typeof e=="string";s&&(e={textures:{},images:{}});const a={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};a.uuid=this.uuid,a.type=this.type,this.name!==""&&(a.name=this.name),this.color&&this.color.isColor&&(a.color=this.color.getHex()),this.roughness!==void 0&&(a.roughness=this.roughness),this.metalness!==void 0&&(a.metalness=this.metalness),this.sheen!==void 0&&(a.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(a.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(a.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(a.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(a.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(a.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(a.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(a.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(a.shininess=this.shininess),this.clearcoat!==void 0&&(a.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(a.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(a.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(a.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(a.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,a.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(a.dispersion=this.dispersion),this.iridescence!==void 0&&(a.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(a.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(a.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(a.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(a.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(a.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(a.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(a.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(a.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(a.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(a.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(a.lightMap=this.lightMap.toJSON(e).uuid,a.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(a.aoMap=this.aoMap.toJSON(e).uuid,a.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(a.bumpMap=this.bumpMap.toJSON(e).uuid,a.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(a.normalMap=this.normalMap.toJSON(e).uuid,a.normalMapType=this.normalMapType,a.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(a.displacementMap=this.displacementMap.toJSON(e).uuid,a.displacementScale=this.displacementScale,a.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(a.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(a.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(a.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(a.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(a.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(a.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(a.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(a.combine=this.combine)),this.envMapRotation!==void 0&&(a.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(a.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(a.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(a.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(a.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(a.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(a.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(a.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(a.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(a.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(a.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(a.size=this.size),this.shadowSide!==null&&(a.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(a.sizeAttenuation=this.sizeAttenuation),this.blending!==NormalBlending&&(a.blending=this.blending),this.side!==FrontSide&&(a.side=this.side),this.vertexColors===!0&&(a.vertexColors=!0),this.opacity<1&&(a.opacity=this.opacity),this.transparent===!0&&(a.transparent=!0),this.blendSrc!==SrcAlphaFactor&&(a.blendSrc=this.blendSrc),this.blendDst!==OneMinusSrcAlphaFactor&&(a.blendDst=this.blendDst),this.blendEquation!==AddEquation&&(a.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(a.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(a.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(a.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(a.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(a.blendAlpha=this.blendAlpha),this.depthFunc!==LessEqualDepth&&(a.depthFunc=this.depthFunc),this.depthTest===!1&&(a.depthTest=this.depthTest),this.depthWrite===!1&&(a.depthWrite=this.depthWrite),this.colorWrite===!1&&(a.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(a.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==AlwaysStencilFunc&&(a.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(a.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(a.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==KeepStencilOp&&(a.stencilFail=this.stencilFail),this.stencilZFail!==KeepStencilOp&&(a.stencilZFail=this.stencilZFail),this.stencilZPass!==KeepStencilOp&&(a.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(a.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(a.rotation=this.rotation),this.polygonOffset===!0&&(a.polygonOffset=!0),this.polygonOffsetFactor!==0&&(a.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(a.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(a.linewidth=this.linewidth),this.dashSize!==void 0&&(a.dashSize=this.dashSize),this.gapSize!==void 0&&(a.gapSize=this.gapSize),this.scale!==void 0&&(a.scale=this.scale),this.dithering===!0&&(a.dithering=!0),this.alphaTest>0&&(a.alphaTest=this.alphaTest),this.alphaHash===!0&&(a.alphaHash=!0),this.alphaToCoverage===!0&&(a.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(a.premultipliedAlpha=!0),this.forceSinglePass===!0&&(a.forceSinglePass=!0),this.wireframe===!0&&(a.wireframe=!0),this.wireframeLinewidth>1&&(a.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(a.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(a.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(a.flatShading=!0),this.visible===!1&&(a.visible=!1),this.toneMapped===!1&&(a.toneMapped=!1),this.fog===!1&&(a.fog=!1),Object.keys(this.userData).length>0&&(a.userData=this.userData);function c(d){const b=[];for(const _e in d){const tt=d[_e];delete tt.metadata,b.push(tt)}return b}if(s){const d=c(e.textures),b=c(e.images);d.length>0&&(a.textures=d),b.length>0&&(a.images=b)}return a}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const s=e.clippingPlanes;let a=null;if(s!==null){const c=s.length;a=new Array(c);for(let d=0;d!==c;++d)a[d]=s[d].clone()}return this.clippingPlanes=a,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}onBuild(){console.warn("Material: onBuild() has been removed.")}}class MeshBasicMaterial extends Material{static get type(){return"MeshBasicMaterial"}constructor(e){super(),this.isMeshBasicMaterial=!0,this.color=new Color(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Euler,this.combine=MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const _tables=_generateTables();function _generateTables(){const o=new ArrayBuffer(4),e=new Float32Array(o),s=new Uint32Array(o),a=new Uint32Array(512),c=new Uint32Array(512);for(let tt=0;tt<256;++tt){const nt=tt-127;nt<-27?(a[tt]=0,a[tt|256]=32768,c[tt]=24,c[tt|256]=24):nt<-14?(a[tt]=1024>>-nt-14,a[tt|256]=1024>>-nt-14|32768,c[tt]=-nt-1,c[tt|256]=-nt-1):nt<=15?(a[tt]=nt+15<<10,a[tt|256]=nt+15<<10|32768,c[tt]=13,c[tt|256]=13):nt<128?(a[tt]=31744,a[tt|256]=64512,c[tt]=24,c[tt|256]=24):(a[tt]=31744,a[tt|256]=64512,c[tt]=13,c[tt|256]=13)}const d=new Uint32Array(2048),b=new Uint32Array(64),_e=new Uint32Array(64);for(let tt=1;tt<1024;++tt){let nt=tt<<13,it=0;for(;!(nt&8388608);)nt<<=1,it-=8388608;nt&=-8388609,it+=947912704,d[tt]=nt|it}for(let tt=1024;tt<2048;++tt)d[tt]=939524096+(tt-1024<<13);for(let tt=1;tt<31;++tt)b[tt]=tt<<23;b[31]=1199570944,b[32]=2147483648;for(let tt=33;tt<63;++tt)b[tt]=2147483648+(tt-32<<23);b[63]=3347054592;for(let tt=1;tt<64;++tt)tt!==32&&(_e[tt]=1024);return{floatView:e,uint32View:s,baseTable:a,shiftTable:c,mantissaTable:d,exponentTable:b,offsetTable:_e}}function toHalfFloat(o){Math.abs(o)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),o=clamp(o,-65504,65504),_tables.floatView[0]=o;const e=_tables.uint32View[0],s=e>>23&511;return _tables.baseTable[s]+((e&8388607)>>_tables.shiftTable[s])}function fromHalfFloat(o){const e=o>>10;return _tables.uint32View[0]=_tables.mantissaTable[_tables.offsetTable[e]+(o&1023)]+_tables.exponentTable[e],_tables.floatView[0]}const DataUtils={toHalfFloat,fromHalfFloat},_vector$9=new Vector3,_vector2$1=new Vector2;class BufferAttribute{constructor(e,s,a=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=s,this.count=e!==void 0?e.length/s:0,this.normalized=a,this.usage=StaticDrawUsage,this.updateRanges=[],this.gpuType=FloatType,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,s){this.updateRanges.push({start:e,count:s})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,s,a){e*=this.itemSize,a*=s.itemSize;for(let c=0,d=this.itemSize;c<d;c++)this.array[e+c]=s.array[a+c];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let s=0,a=this.count;s<a;s++)_vector2$1.fromBufferAttribute(this,s),_vector2$1.applyMatrix3(e),this.setXY(s,_vector2$1.x,_vector2$1.y);else if(this.itemSize===3)for(let s=0,a=this.count;s<a;s++)_vector$9.fromBufferAttribute(this,s),_vector$9.applyMatrix3(e),this.setXYZ(s,_vector$9.x,_vector$9.y,_vector$9.z);return this}applyMatrix4(e){for(let s=0,a=this.count;s<a;s++)_vector$9.fromBufferAttribute(this,s),_vector$9.applyMatrix4(e),this.setXYZ(s,_vector$9.x,_vector$9.y,_vector$9.z);return this}applyNormalMatrix(e){for(let s=0,a=this.count;s<a;s++)_vector$9.fromBufferAttribute(this,s),_vector$9.applyNormalMatrix(e),this.setXYZ(s,_vector$9.x,_vector$9.y,_vector$9.z);return this}transformDirection(e){for(let s=0,a=this.count;s<a;s++)_vector$9.fromBufferAttribute(this,s),_vector$9.transformDirection(e),this.setXYZ(s,_vector$9.x,_vector$9.y,_vector$9.z);return this}set(e,s=0){return this.array.set(e,s),this}getComponent(e,s){let a=this.array[e*this.itemSize+s];return this.normalized&&(a=denormalize(a,this.array)),a}setComponent(e,s,a){return this.normalized&&(a=normalize(a,this.array)),this.array[e*this.itemSize+s]=a,this}getX(e){let s=this.array[e*this.itemSize];return this.normalized&&(s=denormalize(s,this.array)),s}setX(e,s){return this.normalized&&(s=normalize(s,this.array)),this.array[e*this.itemSize]=s,this}getY(e){let s=this.array[e*this.itemSize+1];return this.normalized&&(s=denormalize(s,this.array)),s}setY(e,s){return this.normalized&&(s=normalize(s,this.array)),this.array[e*this.itemSize+1]=s,this}getZ(e){let s=this.array[e*this.itemSize+2];return this.normalized&&(s=denormalize(s,this.array)),s}setZ(e,s){return this.normalized&&(s=normalize(s,this.array)),this.array[e*this.itemSize+2]=s,this}getW(e){let s=this.array[e*this.itemSize+3];return this.normalized&&(s=denormalize(s,this.array)),s}setW(e,s){return this.normalized&&(s=normalize(s,this.array)),this.array[e*this.itemSize+3]=s,this}setXY(e,s,a){return e*=this.itemSize,this.normalized&&(s=normalize(s,this.array),a=normalize(a,this.array)),this.array[e+0]=s,this.array[e+1]=a,this}setXYZ(e,s,a,c){return e*=this.itemSize,this.normalized&&(s=normalize(s,this.array),a=normalize(a,this.array),c=normalize(c,this.array)),this.array[e+0]=s,this.array[e+1]=a,this.array[e+2]=c,this}setXYZW(e,s,a,c,d){return e*=this.itemSize,this.normalized&&(s=normalize(s,this.array),a=normalize(a,this.array),c=normalize(c,this.array),d=normalize(d,this.array)),this.array[e+0]=s,this.array[e+1]=a,this.array[e+2]=c,this.array[e+3]=d,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==StaticDrawUsage&&(e.usage=this.usage),e}}class Int8BufferAttribute extends BufferAttribute{constructor(e,s,a){super(new Int8Array(e),s,a)}}class Uint8BufferAttribute extends BufferAttribute{constructor(e,s,a){super(new Uint8Array(e),s,a)}}class Uint8ClampedBufferAttribute extends BufferAttribute{constructor(e,s,a){super(new Uint8ClampedArray(e),s,a)}}class Int16BufferAttribute extends BufferAttribute{constructor(e,s,a){super(new Int16Array(e),s,a)}}class Uint16BufferAttribute extends BufferAttribute{constructor(e,s,a){super(new Uint16Array(e),s,a)}}class Int32BufferAttribute extends BufferAttribute{constructor(e,s,a){super(new Int32Array(e),s,a)}}class Uint32BufferAttribute extends BufferAttribute{constructor(e,s,a){super(new Uint32Array(e),s,a)}}class Float16BufferAttribute extends BufferAttribute{constructor(e,s,a){super(new Uint16Array(e),s,a),this.isFloat16BufferAttribute=!0}getX(e){let s=fromHalfFloat(this.array[e*this.itemSize]);return this.normalized&&(s=denormalize(s,this.array)),s}setX(e,s){return this.normalized&&(s=normalize(s,this.array)),this.array[e*this.itemSize]=toHalfFloat(s),this}getY(e){let s=fromHalfFloat(this.array[e*this.itemSize+1]);return this.normalized&&(s=denormalize(s,this.array)),s}setY(e,s){return this.normalized&&(s=normalize(s,this.array)),this.array[e*this.itemSize+1]=toHalfFloat(s),this}getZ(e){let s=fromHalfFloat(this.array[e*this.itemSize+2]);return this.normalized&&(s=denormalize(s,this.array)),s}setZ(e,s){return this.normalized&&(s=normalize(s,this.array)),this.array[e*this.itemSize+2]=toHalfFloat(s),this}getW(e){let s=fromHalfFloat(this.array[e*this.itemSize+3]);return this.normalized&&(s=denormalize(s,this.array)),s}setW(e,s){return this.normalized&&(s=normalize(s,this.array)),this.array[e*this.itemSize+3]=toHalfFloat(s),this}setXY(e,s,a){return e*=this.itemSize,this.normalized&&(s=normalize(s,this.array),a=normalize(a,this.array)),this.array[e+0]=toHalfFloat(s),this.array[e+1]=toHalfFloat(a),this}setXYZ(e,s,a,c){return e*=this.itemSize,this.normalized&&(s=normalize(s,this.array),a=normalize(a,this.array),c=normalize(c,this.array)),this.array[e+0]=toHalfFloat(s),this.array[e+1]=toHalfFloat(a),this.array[e+2]=toHalfFloat(c),this}setXYZW(e,s,a,c,d){return e*=this.itemSize,this.normalized&&(s=normalize(s,this.array),a=normalize(a,this.array),c=normalize(c,this.array),d=normalize(d,this.array)),this.array[e+0]=toHalfFloat(s),this.array[e+1]=toHalfFloat(a),this.array[e+2]=toHalfFloat(c),this.array[e+3]=toHalfFloat(d),this}}class Float32BufferAttribute extends BufferAttribute{constructor(e,s,a){super(new Float32Array(e),s,a)}}let _id$2=0;const _m1$2=new Matrix4,_obj=new Object3D,_offset=new Vector3,_box$2=new Box3,_boxMorphTargets=new Box3,_vector$8=new Vector3;class BufferGeometry extends EventDispatcher$1{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:_id$2++}),this.uuid=generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(arrayNeedsUint32(e)?Uint32BufferAttribute:Uint16BufferAttribute)(e,1):this.index=e,this}setIndirect(e){return this.indirect=e,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,s){return this.attributes[e]=s,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,s,a=0){this.groups.push({start:e,count:s,materialIndex:a})}clearGroups(){this.groups=[]}setDrawRange(e,s){this.drawRange.start=e,this.drawRange.count=s}applyMatrix4(e){const s=this.attributes.position;s!==void 0&&(s.applyMatrix4(e),s.needsUpdate=!0);const a=this.attributes.normal;if(a!==void 0){const d=new Matrix3().getNormalMatrix(e);a.applyNormalMatrix(d),a.needsUpdate=!0}const c=this.attributes.tangent;return c!==void 0&&(c.transformDirection(e),c.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return _m1$2.makeRotationFromQuaternion(e),this.applyMatrix4(_m1$2),this}rotateX(e){return _m1$2.makeRotationX(e),this.applyMatrix4(_m1$2),this}rotateY(e){return _m1$2.makeRotationY(e),this.applyMatrix4(_m1$2),this}rotateZ(e){return _m1$2.makeRotationZ(e),this.applyMatrix4(_m1$2),this}translate(e,s,a){return _m1$2.makeTranslation(e,s,a),this.applyMatrix4(_m1$2),this}scale(e,s,a){return _m1$2.makeScale(e,s,a),this.applyMatrix4(_m1$2),this}lookAt(e){return _obj.lookAt(e),_obj.updateMatrix(),this.applyMatrix4(_obj.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(_offset).negate(),this.translate(_offset.x,_offset.y,_offset.z),this}setFromPoints(e){const s=this.getAttribute("position");if(s===void 0){const a=[];for(let c=0,d=e.length;c<d;c++){const b=e[c];a.push(b.x,b.y,b.z||0)}this.setAttribute("position",new Float32BufferAttribute(a,3))}else{for(let a=0,c=s.count;a<c;a++){const d=e[a];s.setXYZ(a,d.x,d.y,d.z||0)}e.length>s.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),s.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Box3);const e=this.attributes.position,s=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new Vector3(-1/0,-1/0,-1/0),new Vector3(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),s)for(let a=0,c=s.length;a<c;a++){const d=s[a];_box$2.setFromBufferAttribute(d),this.morphTargetsRelative?(_vector$8.addVectors(this.boundingBox.min,_box$2.min),this.boundingBox.expandByPoint(_vector$8),_vector$8.addVectors(this.boundingBox.max,_box$2.max),this.boundingBox.expandByPoint(_vector$8)):(this.boundingBox.expandByPoint(_box$2.min),this.boundingBox.expandByPoint(_box$2.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Sphere);const e=this.attributes.position,s=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new Vector3,1/0);return}if(e){const a=this.boundingSphere.center;if(_box$2.setFromBufferAttribute(e),s)for(let d=0,b=s.length;d<b;d++){const _e=s[d];_boxMorphTargets.setFromBufferAttribute(_e),this.morphTargetsRelative?(_vector$8.addVectors(_box$2.min,_boxMorphTargets.min),_box$2.expandByPoint(_vector$8),_vector$8.addVectors(_box$2.max,_boxMorphTargets.max),_box$2.expandByPoint(_vector$8)):(_box$2.expandByPoint(_boxMorphTargets.min),_box$2.expandByPoint(_boxMorphTargets.max))}_box$2.getCenter(a);let c=0;for(let d=0,b=e.count;d<b;d++)_vector$8.fromBufferAttribute(e,d),c=Math.max(c,a.distanceToSquared(_vector$8));if(s)for(let d=0,b=s.length;d<b;d++){const _e=s[d],tt=this.morphTargetsRelative;for(let nt=0,it=_e.count;nt<it;nt++)_vector$8.fromBufferAttribute(_e,nt),tt&&(_offset.fromBufferAttribute(e,nt),_vector$8.add(_offset)),c=Math.max(c,a.distanceToSquared(_vector$8))}this.boundingSphere.radius=Math.sqrt(c),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,s=this.attributes;if(e===null||s.position===void 0||s.normal===void 0||s.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const a=s.position,c=s.normal,d=s.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new BufferAttribute(new Float32Array(4*a.count),4));const b=this.getAttribute("tangent"),_e=[],tt=[];for(let Et=0;Et<a.count;Et++)_e[Et]=new Vector3,tt[Et]=new Vector3;const nt=new Vector3,it=new Vector3,ot=new Vector3,at=new Vector2,ct=new Vector2,ut=new Vector2,ft=new Vector3,dt=new Vector3;function lt(Et,_t,vt){nt.fromBufferAttribute(a,Et),it.fromBufferAttribute(a,_t),ot.fromBufferAttribute(a,vt),at.fromBufferAttribute(d,Et),ct.fromBufferAttribute(d,_t),ut.fromBufferAttribute(d,vt),it.sub(nt),ot.sub(nt),ct.sub(at),ut.sub(at);const Mt=1/(ct.x*ut.y-ut.x*ct.y);isFinite(Mt)&&(ft.copy(it).multiplyScalar(ut.y).addScaledVector(ot,-ct.y).multiplyScalar(Mt),dt.copy(ot).multiplyScalar(ct.x).addScaledVector(it,-ut.x).multiplyScalar(Mt),_e[Et].add(ft),_e[_t].add(ft),_e[vt].add(ft),tt[Et].add(dt),tt[_t].add(dt),tt[vt].add(dt))}let ht=this.groups;ht.length===0&&(ht=[{start:0,count:e.count}]);for(let Et=0,_t=ht.length;Et<_t;++Et){const vt=ht[Et],Mt=vt.start,jt=vt.count;for(let Lt=Mt,Nt=Mt+jt;Lt<Nt;Lt+=3)lt(e.getX(Lt+0),e.getX(Lt+1),e.getX(Lt+2))}const mt=new Vector3,xt=new Vector3,St=new Vector3,yt=new Vector3;function wt(Et){St.fromBufferAttribute(c,Et),yt.copy(St);const _t=_e[Et];mt.copy(_t),mt.sub(St.multiplyScalar(St.dot(_t))).normalize(),xt.crossVectors(yt,_t);const Mt=xt.dot(tt[Et])<0?-1:1;b.setXYZW(Et,mt.x,mt.y,mt.z,Mt)}for(let Et=0,_t=ht.length;Et<_t;++Et){const vt=ht[Et],Mt=vt.start,jt=vt.count;for(let Lt=Mt,Nt=Mt+jt;Lt<Nt;Lt+=3)wt(e.getX(Lt+0)),wt(e.getX(Lt+1)),wt(e.getX(Lt+2))}}computeVertexNormals(){const e=this.index,s=this.getAttribute("position");if(s!==void 0){let a=this.getAttribute("normal");if(a===void 0)a=new BufferAttribute(new Float32Array(s.count*3),3),this.setAttribute("normal",a);else for(let at=0,ct=a.count;at<ct;at++)a.setXYZ(at,0,0,0);const c=new Vector3,d=new Vector3,b=new Vector3,_e=new Vector3,tt=new Vector3,nt=new Vector3,it=new Vector3,ot=new Vector3;if(e)for(let at=0,ct=e.count;at<ct;at+=3){const ut=e.getX(at+0),ft=e.getX(at+1),dt=e.getX(at+2);c.fromBufferAttribute(s,ut),d.fromBufferAttribute(s,ft),b.fromBufferAttribute(s,dt),it.subVectors(b,d),ot.subVectors(c,d),it.cross(ot),_e.fromBufferAttribute(a,ut),tt.fromBufferAttribute(a,ft),nt.fromBufferAttribute(a,dt),_e.add(it),tt.add(it),nt.add(it),a.setXYZ(ut,_e.x,_e.y,_e.z),a.setXYZ(ft,tt.x,tt.y,tt.z),a.setXYZ(dt,nt.x,nt.y,nt.z)}else for(let at=0,ct=s.count;at<ct;at+=3)c.fromBufferAttribute(s,at+0),d.fromBufferAttribute(s,at+1),b.fromBufferAttribute(s,at+2),it.subVectors(b,d),ot.subVectors(c,d),it.cross(ot),a.setXYZ(at+0,it.x,it.y,it.z),a.setXYZ(at+1,it.x,it.y,it.z),a.setXYZ(at+2,it.x,it.y,it.z);this.normalizeNormals(),a.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let s=0,a=e.count;s<a;s++)_vector$8.fromBufferAttribute(e,s),_vector$8.normalize(),e.setXYZ(s,_vector$8.x,_vector$8.y,_vector$8.z)}toNonIndexed(){function e(_e,tt){const nt=_e.array,it=_e.itemSize,ot=_e.normalized,at=new nt.constructor(tt.length*it);let ct=0,ut=0;for(let ft=0,dt=tt.length;ft<dt;ft++){_e.isInterleavedBufferAttribute?ct=tt[ft]*_e.data.stride+_e.offset:ct=tt[ft]*it;for(let lt=0;lt<it;lt++)at[ut++]=nt[ct++]}return new BufferAttribute(at,it,ot)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const s=new BufferGeometry,a=this.index.array,c=this.attributes;for(const _e in c){const tt=c[_e],nt=e(tt,a);s.setAttribute(_e,nt)}const d=this.morphAttributes;for(const _e in d){const tt=[],nt=d[_e];for(let it=0,ot=nt.length;it<ot;it++){const at=nt[it],ct=e(at,a);tt.push(ct)}s.morphAttributes[_e]=tt}s.morphTargetsRelative=this.morphTargetsRelative;const b=this.groups;for(let _e=0,tt=b.length;_e<tt;_e++){const nt=b[_e];s.addGroup(nt.start,nt.count,nt.materialIndex)}return s}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const tt=this.parameters;for(const nt in tt)tt[nt]!==void 0&&(e[nt]=tt[nt]);return e}e.data={attributes:{}};const s=this.index;s!==null&&(e.data.index={type:s.array.constructor.name,array:Array.prototype.slice.call(s.array)});const a=this.attributes;for(const tt in a){const nt=a[tt];e.data.attributes[tt]=nt.toJSON(e.data)}const c={};let d=!1;for(const tt in this.morphAttributes){const nt=this.morphAttributes[tt],it=[];for(let ot=0,at=nt.length;ot<at;ot++){const ct=nt[ot];it.push(ct.toJSON(e.data))}it.length>0&&(c[tt]=it,d=!0)}d&&(e.data.morphAttributes=c,e.data.morphTargetsRelative=this.morphTargetsRelative);const b=this.groups;b.length>0&&(e.data.groups=JSON.parse(JSON.stringify(b)));const _e=this.boundingSphere;return _e!==null&&(e.data.boundingSphere={center:_e.center.toArray(),radius:_e.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const s={};this.name=e.name;const a=e.index;a!==null&&this.setIndex(a.clone(s));const c=e.attributes;for(const nt in c){const it=c[nt];this.setAttribute(nt,it.clone(s))}const d=e.morphAttributes;for(const nt in d){const it=[],ot=d[nt];for(let at=0,ct=ot.length;at<ct;at++)it.push(ot[at].clone(s));this.morphAttributes[nt]=it}this.morphTargetsRelative=e.morphTargetsRelative;const b=e.groups;for(let nt=0,it=b.length;nt<it;nt++){const ot=b[nt];this.addGroup(ot.start,ot.count,ot.materialIndex)}const _e=e.boundingBox;_e!==null&&(this.boundingBox=_e.clone());const tt=e.boundingSphere;return tt!==null&&(this.boundingSphere=tt.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const _inverseMatrix$3=new Matrix4,_ray$3=new Ray,_sphere$6=new Sphere,_sphereHitAt=new Vector3,_vA$1=new Vector3,_vB$1=new Vector3,_vC$1=new Vector3,_tempA=new Vector3,_morphA=new Vector3,_intersectionPoint=new Vector3,_intersectionPointWorld=new Vector3;class Mesh extends Object3D{constructor(e=new BufferGeometry,s=new MeshBasicMaterial){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=s,this.updateMorphTargets()}copy(e,s){return super.copy(e,s),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const s=this.geometry.morphAttributes,a=Object.keys(s);if(a.length>0){const c=s[a[0]];if(c!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let d=0,b=c.length;d<b;d++){const _e=c[d].name||String(d);this.morphTargetInfluences.push(0),this.morphTargetDictionary[_e]=d}}}}getVertexPosition(e,s){const a=this.geometry,c=a.attributes.position,d=a.morphAttributes.position,b=a.morphTargetsRelative;s.fromBufferAttribute(c,e);const _e=this.morphTargetInfluences;if(d&&_e){_morphA.set(0,0,0);for(let tt=0,nt=d.length;tt<nt;tt++){const it=_e[tt],ot=d[tt];it!==0&&(_tempA.fromBufferAttribute(ot,e),b?_morphA.addScaledVector(_tempA,it):_morphA.addScaledVector(_tempA.sub(s),it))}s.add(_morphA)}return s}raycast(e,s){const a=this.geometry,c=this.material,d=this.matrixWorld;c!==void 0&&(a.boundingSphere===null&&a.computeBoundingSphere(),_sphere$6.copy(a.boundingSphere),_sphere$6.applyMatrix4(d),_ray$3.copy(e.ray).recast(e.near),!(_sphere$6.containsPoint(_ray$3.origin)===!1&&(_ray$3.intersectSphere(_sphere$6,_sphereHitAt)===null||_ray$3.origin.distanceToSquared(_sphereHitAt)>(e.far-e.near)**2))&&(_inverseMatrix$3.copy(d).invert(),_ray$3.copy(e.ray).applyMatrix4(_inverseMatrix$3),!(a.boundingBox!==null&&_ray$3.intersectsBox(a.boundingBox)===!1)&&this._computeIntersections(e,s,_ray$3)))}_computeIntersections(e,s,a){let c;const d=this.geometry,b=this.material,_e=d.index,tt=d.attributes.position,nt=d.attributes.uv,it=d.attributes.uv1,ot=d.attributes.normal,at=d.groups,ct=d.drawRange;if(_e!==null)if(Array.isArray(b))for(let ut=0,ft=at.length;ut<ft;ut++){const dt=at[ut],lt=b[dt.materialIndex],ht=Math.max(dt.start,ct.start),mt=Math.min(_e.count,Math.min(dt.start+dt.count,ct.start+ct.count));for(let xt=ht,St=mt;xt<St;xt+=3){const yt=_e.getX(xt),wt=_e.getX(xt+1),Et=_e.getX(xt+2);c=checkGeometryIntersection(this,lt,e,a,nt,it,ot,yt,wt,Et),c&&(c.faceIndex=Math.floor(xt/3),c.face.materialIndex=dt.materialIndex,s.push(c))}}else{const ut=Math.max(0,ct.start),ft=Math.min(_e.count,ct.start+ct.count);for(let dt=ut,lt=ft;dt<lt;dt+=3){const ht=_e.getX(dt),mt=_e.getX(dt+1),xt=_e.getX(dt+2);c=checkGeometryIntersection(this,b,e,a,nt,it,ot,ht,mt,xt),c&&(c.faceIndex=Math.floor(dt/3),s.push(c))}}else if(tt!==void 0)if(Array.isArray(b))for(let ut=0,ft=at.length;ut<ft;ut++){const dt=at[ut],lt=b[dt.materialIndex],ht=Math.max(dt.start,ct.start),mt=Math.min(tt.count,Math.min(dt.start+dt.count,ct.start+ct.count));for(let xt=ht,St=mt;xt<St;xt+=3){const yt=xt,wt=xt+1,Et=xt+2;c=checkGeometryIntersection(this,lt,e,a,nt,it,ot,yt,wt,Et),c&&(c.faceIndex=Math.floor(xt/3),c.face.materialIndex=dt.materialIndex,s.push(c))}}else{const ut=Math.max(0,ct.start),ft=Math.min(tt.count,ct.start+ct.count);for(let dt=ut,lt=ft;dt<lt;dt+=3){const ht=dt,mt=dt+1,xt=dt+2;c=checkGeometryIntersection(this,b,e,a,nt,it,ot,ht,mt,xt),c&&(c.faceIndex=Math.floor(dt/3),s.push(c))}}}}function checkIntersection$1(o,e,s,a,c,d,b,_e){let tt;if(e.side===BackSide?tt=a.intersectTriangle(b,d,c,!0,_e):tt=a.intersectTriangle(c,d,b,e.side===FrontSide,_e),tt===null)return null;_intersectionPointWorld.copy(_e),_intersectionPointWorld.applyMatrix4(o.matrixWorld);const nt=s.ray.origin.distanceTo(_intersectionPointWorld);return nt<s.near||nt>s.far?null:{distance:nt,point:_intersectionPointWorld.clone(),object:o}}function checkGeometryIntersection(o,e,s,a,c,d,b,_e,tt,nt){o.getVertexPosition(_e,_vA$1),o.getVertexPosition(tt,_vB$1),o.getVertexPosition(nt,_vC$1);const it=checkIntersection$1(o,e,s,a,_vA$1,_vB$1,_vC$1,_intersectionPoint);if(it){const ot=new Vector3;Triangle.getBarycoord(_intersectionPoint,_vA$1,_vB$1,_vC$1,ot),c&&(it.uv=Triangle.getInterpolatedAttribute(c,_e,tt,nt,ot,new Vector2)),d&&(it.uv1=Triangle.getInterpolatedAttribute(d,_e,tt,nt,ot,new Vector2)),b&&(it.normal=Triangle.getInterpolatedAttribute(b,_e,tt,nt,ot,new Vector3),it.normal.dot(a.direction)>0&&it.normal.multiplyScalar(-1));const at={a:_e,b:tt,c:nt,normal:new Vector3,materialIndex:0};Triangle.getNormal(_vA$1,_vB$1,_vC$1,at.normal),it.face=at,it.barycoord=ot}return it}class BoxGeometry extends BufferGeometry{constructor(e=1,s=1,a=1,c=1,d=1,b=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:s,depth:a,widthSegments:c,heightSegments:d,depthSegments:b};const _e=this;c=Math.floor(c),d=Math.floor(d),b=Math.floor(b);const tt=[],nt=[],it=[],ot=[];let at=0,ct=0;ut("z","y","x",-1,-1,a,s,e,b,d,0),ut("z","y","x",1,-1,a,s,-e,b,d,1),ut("x","z","y",1,1,e,a,s,c,b,2),ut("x","z","y",1,-1,e,a,-s,c,b,3),ut("x","y","z",1,-1,e,s,a,c,d,4),ut("x","y","z",-1,-1,e,s,-a,c,d,5),this.setIndex(tt),this.setAttribute("position",new Float32BufferAttribute(nt,3)),this.setAttribute("normal",new Float32BufferAttribute(it,3)),this.setAttribute("uv",new Float32BufferAttribute(ot,2));function ut(ft,dt,lt,ht,mt,xt,St,yt,wt,Et,_t){const vt=xt/wt,Mt=St/Et,jt=xt/2,Lt=St/2,Nt=yt/2,kt=wt+1,Ot=Et+1;let Ht=0,Ct=0;const Ut=new Vector3;for(let Gt=0;Gt<Ot;Gt++){const Pt=Gt*Mt-Lt;for(let Wt=0;Wt<kt;Wt++){const sn=Wt*vt-jt;Ut[ft]=sn*ht,Ut[dt]=Pt*mt,Ut[lt]=Nt,nt.push(Ut.x,Ut.y,Ut.z),Ut[ft]=0,Ut[dt]=0,Ut[lt]=yt>0?1:-1,it.push(Ut.x,Ut.y,Ut.z),ot.push(Wt/wt),ot.push(1-Gt/Et),Ht+=1}}for(let Gt=0;Gt<Et;Gt++)for(let Pt=0;Pt<wt;Pt++){const Wt=at+Pt+kt*Gt,sn=at+Pt+kt*(Gt+1),Bt=at+(Pt+1)+kt*(Gt+1),tn=at+(Pt+1)+kt*Gt;tt.push(Wt,sn,tn),tt.push(sn,Bt,tn),Ct+=6}_e.addGroup(ct,Ct,_t),ct+=Ct,at+=Ht}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new BoxGeometry(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function cloneUniforms(o){const e={};for(const s in o){e[s]={};for(const a in o[s]){const c=o[s][a];c&&(c.isColor||c.isMatrix3||c.isMatrix4||c.isVector2||c.isVector3||c.isVector4||c.isTexture||c.isQuaternion)?c.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[s][a]=null):e[s][a]=c.clone():Array.isArray(c)?e[s][a]=c.slice():e[s][a]=c}}return e}function mergeUniforms(o){const e={};for(let s=0;s<o.length;s++){const a=cloneUniforms(o[s]);for(const c in a)e[c]=a[c]}return e}function cloneUniformsGroups(o){const e=[];for(let s=0;s<o.length;s++)e.push(o[s].clone());return e}function getUnlitUniformColorSpace(o){const e=o.getRenderTarget();return e===null?o.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:ColorManagement.workingColorSpace}const UniformsUtils={clone:cloneUniforms,merge:mergeUniforms};var default_vertex=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,default_fragment=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class ShaderMaterial extends Material{static get type(){return"ShaderMaterial"}constructor(e){super(),this.isShaderMaterial=!0,this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=default_vertex,this.fragmentShader=default_fragment,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=cloneUniforms(e.uniforms),this.uniformsGroups=cloneUniformsGroups(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const s=super.toJSON(e);s.glslVersion=this.glslVersion,s.uniforms={};for(const c in this.uniforms){const b=this.uniforms[c].value;b&&b.isTexture?s.uniforms[c]={type:"t",value:b.toJSON(e).uuid}:b&&b.isColor?s.uniforms[c]={type:"c",value:b.getHex()}:b&&b.isVector2?s.uniforms[c]={type:"v2",value:b.toArray()}:b&&b.isVector3?s.uniforms[c]={type:"v3",value:b.toArray()}:b&&b.isVector4?s.uniforms[c]={type:"v4",value:b.toArray()}:b&&b.isMatrix3?s.uniforms[c]={type:"m3",value:b.toArray()}:b&&b.isMatrix4?s.uniforms[c]={type:"m4",value:b.toArray()}:s.uniforms[c]={value:b}}Object.keys(this.defines).length>0&&(s.defines=this.defines),s.vertexShader=this.vertexShader,s.fragmentShader=this.fragmentShader,s.lights=this.lights,s.clipping=this.clipping;const a={};for(const c in this.extensions)this.extensions[c]===!0&&(a[c]=!0);return Object.keys(a).length>0&&(s.extensions=a),s}}class Camera extends Object3D{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Matrix4,this.projectionMatrix=new Matrix4,this.projectionMatrixInverse=new Matrix4,this.coordinateSystem=WebGLCoordinateSystem}copy(e,s){return super.copy(e,s),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,s){super.updateWorldMatrix(e,s),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const _v3$1=new Vector3,_minTarget=new Vector2,_maxTarget=new Vector2;class PerspectiveCamera extends Camera{constructor(e=50,s=1,a=.1,c=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=a,this.far=c,this.focus=10,this.aspect=s,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,s){return super.copy(e,s),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const s=.5*this.getFilmHeight()/e;this.fov=RAD2DEG*2*Math.atan(s),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(DEG2RAD*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return RAD2DEG*2*Math.atan(Math.tan(DEG2RAD*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,s,a){_v3$1.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),s.set(_v3$1.x,_v3$1.y).multiplyScalar(-e/_v3$1.z),_v3$1.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),a.set(_v3$1.x,_v3$1.y).multiplyScalar(-e/_v3$1.z)}getViewSize(e,s){return this.getViewBounds(e,_minTarget,_maxTarget),s.subVectors(_maxTarget,_minTarget)}setViewOffset(e,s,a,c,d,b){this.aspect=e/s,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=s,this.view.offsetX=a,this.view.offsetY=c,this.view.width=d,this.view.height=b,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let s=e*Math.tan(DEG2RAD*.5*this.fov)/this.zoom,a=2*s,c=this.aspect*a,d=-.5*c;const b=this.view;if(this.view!==null&&this.view.enabled){const tt=b.fullWidth,nt=b.fullHeight;d+=b.offsetX*c/tt,s-=b.offsetY*a/nt,c*=b.width/tt,a*=b.height/nt}const _e=this.filmOffset;_e!==0&&(d+=e*_e/this.getFilmWidth()),this.projectionMatrix.makePerspective(d,d+c,s,s-a,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const s=super.toJSON(e);return s.object.fov=this.fov,s.object.zoom=this.zoom,s.object.near=this.near,s.object.far=this.far,s.object.focus=this.focus,s.object.aspect=this.aspect,this.view!==null&&(s.object.view=Object.assign({},this.view)),s.object.filmGauge=this.filmGauge,s.object.filmOffset=this.filmOffset,s}}const fov=-90,aspect=1;class CubeCamera extends Object3D{constructor(e,s,a){super(),this.type="CubeCamera",this.renderTarget=a,this.coordinateSystem=null,this.activeMipmapLevel=0;const c=new PerspectiveCamera(fov,aspect,e,s);c.layers=this.layers,this.add(c);const d=new PerspectiveCamera(fov,aspect,e,s);d.layers=this.layers,this.add(d);const b=new PerspectiveCamera(fov,aspect,e,s);b.layers=this.layers,this.add(b);const _e=new PerspectiveCamera(fov,aspect,e,s);_e.layers=this.layers,this.add(_e);const tt=new PerspectiveCamera(fov,aspect,e,s);tt.layers=this.layers,this.add(tt);const nt=new PerspectiveCamera(fov,aspect,e,s);nt.layers=this.layers,this.add(nt)}updateCoordinateSystem(){const e=this.coordinateSystem,s=this.children.concat(),[a,c,d,b,_e,tt]=s;for(const nt of s)this.remove(nt);if(e===WebGLCoordinateSystem)a.up.set(0,1,0),a.lookAt(1,0,0),c.up.set(0,1,0),c.lookAt(-1,0,0),d.up.set(0,0,-1),d.lookAt(0,1,0),b.up.set(0,0,1),b.lookAt(0,-1,0),_e.up.set(0,1,0),_e.lookAt(0,0,1),tt.up.set(0,1,0),tt.lookAt(0,0,-1);else if(e===WebGPUCoordinateSystem)a.up.set(0,-1,0),a.lookAt(-1,0,0),c.up.set(0,-1,0),c.lookAt(1,0,0),d.up.set(0,0,1),d.lookAt(0,1,0),b.up.set(0,0,-1),b.lookAt(0,-1,0),_e.up.set(0,-1,0),_e.lookAt(0,0,1),tt.up.set(0,-1,0),tt.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const nt of s)this.add(nt),nt.updateMatrixWorld()}update(e,s){this.parent===null&&this.updateMatrixWorld();const{renderTarget:a,activeMipmapLevel:c}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[d,b,_e,tt,nt,it]=this.children,ot=e.getRenderTarget(),at=e.getActiveCubeFace(),ct=e.getActiveMipmapLevel(),ut=e.xr.enabled;e.xr.enabled=!1;const ft=a.texture.generateMipmaps;a.texture.generateMipmaps=!1,e.setRenderTarget(a,0,c),e.render(s,d),e.setRenderTarget(a,1,c),e.render(s,b),e.setRenderTarget(a,2,c),e.render(s,_e),e.setRenderTarget(a,3,c),e.render(s,tt),e.setRenderTarget(a,4,c),e.render(s,nt),a.texture.generateMipmaps=ft,e.setRenderTarget(a,5,c),e.render(s,it),e.setRenderTarget(ot,at,ct),e.xr.enabled=ut,a.texture.needsPMREMUpdate=!0}}class CubeTexture extends Texture{constructor(e,s,a,c,d,b,_e,tt,nt,it){e=e!==void 0?e:[],s=s!==void 0?s:CubeReflectionMapping,super(e,s,a,c,d,b,_e,tt,nt,it),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class WebGLCubeRenderTarget extends WebGLRenderTarget{constructor(e=1,s={}){super(e,e,s),this.isWebGLCubeRenderTarget=!0;const a={width:e,height:e,depth:1},c=[a,a,a,a,a,a];this.texture=new CubeTexture(c,s.mapping,s.wrapS,s.wrapT,s.magFilter,s.minFilter,s.format,s.type,s.anisotropy,s.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=s.generateMipmaps!==void 0?s.generateMipmaps:!1,this.texture.minFilter=s.minFilter!==void 0?s.minFilter:LinearFilter}fromEquirectangularTexture(e,s){this.texture.type=s.type,this.texture.colorSpace=s.colorSpace,this.texture.generateMipmaps=s.generateMipmaps,this.texture.minFilter=s.minFilter,this.texture.magFilter=s.magFilter;const a={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},c=new BoxGeometry(5,5,5),d=new ShaderMaterial({name:"CubemapFromEquirect",uniforms:cloneUniforms(a.uniforms),vertexShader:a.vertexShader,fragmentShader:a.fragmentShader,side:BackSide,blending:NoBlending});d.uniforms.tEquirect.value=s;const b=new Mesh(c,d),_e=s.minFilter;return s.minFilter===LinearMipmapLinearFilter&&(s.minFilter=LinearFilter),new CubeCamera(1,10,this).update(e,b),s.minFilter=_e,b.geometry.dispose(),b.material.dispose(),this}clear(e,s,a,c){const d=e.getRenderTarget();for(let b=0;b<6;b++)e.setRenderTarget(this,b),e.clear(s,a,c);e.setRenderTarget(d)}}const _vector1=new Vector3,_vector2=new Vector3,_normalMatrix=new Matrix3;class Plane{constructor(e=new Vector3(1,0,0),s=0){this.isPlane=!0,this.normal=e,this.constant=s}set(e,s){return this.normal.copy(e),this.constant=s,this}setComponents(e,s,a,c){return this.normal.set(e,s,a),this.constant=c,this}setFromNormalAndCoplanarPoint(e,s){return this.normal.copy(e),this.constant=-s.dot(this.normal),this}setFromCoplanarPoints(e,s,a){const c=_vector1.subVectors(a,s).cross(_vector2.subVectors(e,s)).normalize();return this.setFromNormalAndCoplanarPoint(c,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,s){return s.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,s){const a=e.delta(_vector1),c=this.normal.dot(a);if(c===0)return this.distanceToPoint(e.start)===0?s.copy(e.start):null;const d=-(e.start.dot(this.normal)+this.constant)/c;return d<0||d>1?null:s.copy(e.start).addScaledVector(a,d)}intersectsLine(e){const s=this.distanceToPoint(e.start),a=this.distanceToPoint(e.end);return s<0&&a>0||a<0&&s>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,s){const a=s||_normalMatrix.getNormalMatrix(e),c=this.coplanarPoint(_vector1).applyMatrix4(e),d=this.normal.applyMatrix3(a).normalize();return this.constant=-c.dot(d),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const _sphere$5=new Sphere,_vector$7=new Vector3;class Frustum{constructor(e=new Plane,s=new Plane,a=new Plane,c=new Plane,d=new Plane,b=new Plane){this.planes=[e,s,a,c,d,b]}set(e,s,a,c,d,b){const _e=this.planes;return _e[0].copy(e),_e[1].copy(s),_e[2].copy(a),_e[3].copy(c),_e[4].copy(d),_e[5].copy(b),this}copy(e){const s=this.planes;for(let a=0;a<6;a++)s[a].copy(e.planes[a]);return this}setFromProjectionMatrix(e,s=WebGLCoordinateSystem){const a=this.planes,c=e.elements,d=c[0],b=c[1],_e=c[2],tt=c[3],nt=c[4],it=c[5],ot=c[6],at=c[7],ct=c[8],ut=c[9],ft=c[10],dt=c[11],lt=c[12],ht=c[13],mt=c[14],xt=c[15];if(a[0].setComponents(tt-d,at-nt,dt-ct,xt-lt).normalize(),a[1].setComponents(tt+d,at+nt,dt+ct,xt+lt).normalize(),a[2].setComponents(tt+b,at+it,dt+ut,xt+ht).normalize(),a[3].setComponents(tt-b,at-it,dt-ut,xt-ht).normalize(),a[4].setComponents(tt-_e,at-ot,dt-ft,xt-mt).normalize(),s===WebGLCoordinateSystem)a[5].setComponents(tt+_e,at+ot,dt+ft,xt+mt).normalize();else if(s===WebGPUCoordinateSystem)a[5].setComponents(_e,ot,ft,mt).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+s);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),_sphere$5.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const s=e.geometry;s.boundingSphere===null&&s.computeBoundingSphere(),_sphere$5.copy(s.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(_sphere$5)}intersectsSprite(e){return _sphere$5.center.set(0,0,0),_sphere$5.radius=.7071067811865476,_sphere$5.applyMatrix4(e.matrixWorld),this.intersectsSphere(_sphere$5)}intersectsSphere(e){const s=this.planes,a=e.center,c=-e.radius;for(let d=0;d<6;d++)if(s[d].distanceToPoint(a)<c)return!1;return!0}intersectsBox(e){const s=this.planes;for(let a=0;a<6;a++){const c=s[a];if(_vector$7.x=c.normal.x>0?e.max.x:e.min.x,_vector$7.y=c.normal.y>0?e.max.y:e.min.y,_vector$7.z=c.normal.z>0?e.max.z:e.min.z,c.distanceToPoint(_vector$7)<0)return!1}return!0}containsPoint(e){const s=this.planes;for(let a=0;a<6;a++)if(s[a].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function WebGLAnimation(){let o=null,e=!1,s=null,a=null;function c(d,b){s(d,b),a=o.requestAnimationFrame(c)}return{start:function(){e!==!0&&s!==null&&(a=o.requestAnimationFrame(c),e=!0)},stop:function(){o.cancelAnimationFrame(a),e=!1},setAnimationLoop:function(d){s=d},setContext:function(d){o=d}}}function WebGLAttributes(o){const e=new WeakMap;function s(_e,tt){const nt=_e.array,it=_e.usage,ot=nt.byteLength,at=o.createBuffer();o.bindBuffer(tt,at),o.bufferData(tt,nt,it),_e.onUploadCallback();let ct;if(nt instanceof Float32Array)ct=o.FLOAT;else if(nt instanceof Uint16Array)_e.isFloat16BufferAttribute?ct=o.HALF_FLOAT:ct=o.UNSIGNED_SHORT;else if(nt instanceof Int16Array)ct=o.SHORT;else if(nt instanceof Uint32Array)ct=o.UNSIGNED_INT;else if(nt instanceof Int32Array)ct=o.INT;else if(nt instanceof Int8Array)ct=o.BYTE;else if(nt instanceof Uint8Array)ct=o.UNSIGNED_BYTE;else if(nt instanceof Uint8ClampedArray)ct=o.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+nt);return{buffer:at,type:ct,bytesPerElement:nt.BYTES_PER_ELEMENT,version:_e.version,size:ot}}function a(_e,tt,nt){const it=tt.array,ot=tt.updateRanges;if(o.bindBuffer(nt,_e),ot.length===0)o.bufferSubData(nt,0,it);else{ot.sort((ct,ut)=>ct.start-ut.start);let at=0;for(let ct=1;ct<ot.length;ct++){const ut=ot[at],ft=ot[ct];ft.start<=ut.start+ut.count+1?ut.count=Math.max(ut.count,ft.start+ft.count-ut.start):(++at,ot[at]=ft)}ot.length=at+1;for(let ct=0,ut=ot.length;ct<ut;ct++){const ft=ot[ct];o.bufferSubData(nt,ft.start*it.BYTES_PER_ELEMENT,it,ft.start,ft.count)}tt.clearUpdateRanges()}tt.onUploadCallback()}function c(_e){return _e.isInterleavedBufferAttribute&&(_e=_e.data),e.get(_e)}function d(_e){_e.isInterleavedBufferAttribute&&(_e=_e.data);const tt=e.get(_e);tt&&(o.deleteBuffer(tt.buffer),e.delete(_e))}function b(_e,tt){if(_e.isInterleavedBufferAttribute&&(_e=_e.data),_e.isGLBufferAttribute){const it=e.get(_e);(!it||it.version<_e.version)&&e.set(_e,{buffer:_e.buffer,type:_e.type,bytesPerElement:_e.elementSize,version:_e.version});return}const nt=e.get(_e);if(nt===void 0)e.set(_e,s(_e,tt));else if(nt.version<_e.version){if(nt.size!==_e.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");a(nt.buffer,_e,tt),nt.version=_e.version}}return{get:c,remove:d,update:b}}class PlaneGeometry extends BufferGeometry{constructor(e=1,s=1,a=1,c=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:s,widthSegments:a,heightSegments:c};const d=e/2,b=s/2,_e=Math.floor(a),tt=Math.floor(c),nt=_e+1,it=tt+1,ot=e/_e,at=s/tt,ct=[],ut=[],ft=[],dt=[];for(let lt=0;lt<it;lt++){const ht=lt*at-b;for(let mt=0;mt<nt;mt++){const xt=mt*ot-d;ut.push(xt,-ht,0),ft.push(0,0,1),dt.push(mt/_e),dt.push(1-lt/tt)}}for(let lt=0;lt<tt;lt++)for(let ht=0;ht<_e;ht++){const mt=ht+nt*lt,xt=ht+nt*(lt+1),St=ht+1+nt*(lt+1),yt=ht+1+nt*lt;ct.push(mt,xt,yt),ct.push(xt,St,yt)}this.setIndex(ct),this.setAttribute("position",new Float32BufferAttribute(ut,3)),this.setAttribute("normal",new Float32BufferAttribute(ft,3)),this.setAttribute("uv",new Float32BufferAttribute(dt,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new PlaneGeometry(e.width,e.height,e.widthSegments,e.heightSegments)}}var alphahash_fragment=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,alphahash_pars_fragment=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,alphamap_fragment=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,alphamap_pars_fragment=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,alphatest_fragment=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,alphatest_pars_fragment=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,aomap_fragment=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,aomap_pars_fragment=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,batching_pars_vertex=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,batching_vertex=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,begin_vertex=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,beginnormal_vertex=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,bsdfs=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,iridescence_fragment=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,bumpmap_pars_fragment=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,clipping_planes_fragment=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,clipping_planes_pars_fragment=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,clipping_planes_pars_vertex=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,clipping_planes_vertex=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,color_fragment=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,color_pars_fragment=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,color_pars_vertex=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,color_vertex=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,common=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,cube_uv_reflection_fragment=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,defaultnormal_vertex=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,displacementmap_pars_vertex=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,displacementmap_vertex=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,emissivemap_fragment=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE
		emissiveColor = sRGBTransferEOTF( emissiveColor );
	#endif
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,emissivemap_pars_fragment=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,colorspace_fragment="gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment=`vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferEOTF( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,envmap_fragment=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,envmap_common_pars_fragment=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,envmap_pars_fragment=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,envmap_pars_vertex=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,envmap_vertex=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,fog_vertex=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,fog_pars_vertex=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,fog_fragment=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,fog_pars_fragment=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,gradientmap_pars_fragment=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,lightmap_pars_fragment=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,lights_lambert_fragment=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,lights_lambert_pars_fragment=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,lights_pars_begin=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,envmap_physical_pars_fragment=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,lights_toon_fragment=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,lights_toon_pars_fragment=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,lights_phong_fragment=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,lights_phong_pars_fragment=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,lights_physical_fragment=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,lights_physical_pars_fragment=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,lights_fragment_begin=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,lights_fragment_maps=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,lights_fragment_end=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,logdepthbuf_fragment=`#if defined( USE_LOGDEPTHBUF )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,logdepthbuf_pars_fragment=`#if defined( USE_LOGDEPTHBUF )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,logdepthbuf_pars_vertex=`#ifdef USE_LOGDEPTHBUF
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,logdepthbuf_vertex=`#ifdef USE_LOGDEPTHBUF
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,map_fragment=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,map_pars_fragment=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,map_particle_fragment=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,map_particle_pars_fragment=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,metalnessmap_fragment=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,metalnessmap_pars_fragment=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,morphinstance_vertex=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,morphcolor_vertex=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,morphnormal_vertex=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,morphtarget_pars_vertex=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,morphtarget_vertex=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,normal_fragment_begin=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,normal_fragment_maps=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,normal_pars_fragment=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,normal_pars_vertex=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,normal_vertex=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,normalmap_pars_fragment=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,clearcoat_normal_fragment_begin=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,clearcoat_normal_fragment_maps=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,clearcoat_pars_fragment=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,iridescence_pars_fragment=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,opaque_fragment=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,packing=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,premultiplied_alpha_fragment=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,project_vertex=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,dithering_fragment=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,dithering_pars_fragment=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,roughnessmap_fragment=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,roughnessmap_pars_fragment=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,shadowmap_pars_fragment=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
#endif`,shadowmap_pars_vertex=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,shadowmap_vertex=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,shadowmask_pars_fragment=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,skinbase_vertex=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,skinning_pars_vertex=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,skinning_vertex=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,skinnormal_vertex=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,specularmap_fragment=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,specularmap_pars_fragment=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,tonemapping_fragment=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,tonemapping_pars_fragment=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,transmission_fragment=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,transmission_pars_fragment=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
		
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
		
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		
		#else
		
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,uv_pars_fragment=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,uv_pars_vertex=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,uv_vertex=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,worldpos_vertex=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const vertex$h=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,fragment$h=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,vertex$g=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,fragment$g=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,vertex$f=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,fragment$f=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,vertex$e=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,fragment$e=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,vertex$d=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,fragment$d=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,vertex$c=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,fragment$c=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,vertex$b=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,fragment$b=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,vertex$a=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,fragment$a=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$9=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,fragment$9=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$8=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,fragment$8=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$7=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,fragment$7=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,vertex$6=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,fragment$6=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$5=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,fragment$5=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$4=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,fragment$4=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$3=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,fragment$3=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,vertex$2=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,fragment$2=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,vertex$1=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,fragment$1=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,ShaderChunk={alphahash_fragment,alphahash_pars_fragment,alphamap_fragment,alphamap_pars_fragment,alphatest_fragment,alphatest_pars_fragment,aomap_fragment,aomap_pars_fragment,batching_pars_vertex,batching_vertex,begin_vertex,beginnormal_vertex,bsdfs,iridescence_fragment,bumpmap_pars_fragment,clipping_planes_fragment,clipping_planes_pars_fragment,clipping_planes_pars_vertex,clipping_planes_vertex,color_fragment,color_pars_fragment,color_pars_vertex,color_vertex,common,cube_uv_reflection_fragment,defaultnormal_vertex,displacementmap_pars_vertex,displacementmap_vertex,emissivemap_fragment,emissivemap_pars_fragment,colorspace_fragment,colorspace_pars_fragment,envmap_fragment,envmap_common_pars_fragment,envmap_pars_fragment,envmap_pars_vertex,envmap_physical_pars_fragment,envmap_vertex,fog_vertex,fog_pars_vertex,fog_fragment,fog_pars_fragment,gradientmap_pars_fragment,lightmap_pars_fragment,lights_lambert_fragment,lights_lambert_pars_fragment,lights_pars_begin,lights_toon_fragment,lights_toon_pars_fragment,lights_phong_fragment,lights_phong_pars_fragment,lights_physical_fragment,lights_physical_pars_fragment,lights_fragment_begin,lights_fragment_maps,lights_fragment_end,logdepthbuf_fragment,logdepthbuf_pars_fragment,logdepthbuf_pars_vertex,logdepthbuf_vertex,map_fragment,map_pars_fragment,map_particle_fragment,map_particle_pars_fragment,metalnessmap_fragment,metalnessmap_pars_fragment,morphinstance_vertex,morphcolor_vertex,morphnormal_vertex,morphtarget_pars_vertex,morphtarget_vertex,normal_fragment_begin,normal_fragment_maps,normal_pars_fragment,normal_pars_vertex,normal_vertex,normalmap_pars_fragment,clearcoat_normal_fragment_begin,clearcoat_normal_fragment_maps,clearcoat_pars_fragment,iridescence_pars_fragment,opaque_fragment,packing,premultiplied_alpha_fragment,project_vertex,dithering_fragment,dithering_pars_fragment,roughnessmap_fragment,roughnessmap_pars_fragment,shadowmap_pars_fragment,shadowmap_pars_vertex,shadowmap_vertex,shadowmask_pars_fragment,skinbase_vertex,skinning_pars_vertex,skinning_vertex,skinnormal_vertex,specularmap_fragment,specularmap_pars_fragment,tonemapping_fragment,tonemapping_pars_fragment,transmission_fragment,transmission_pars_fragment,uv_pars_fragment,uv_pars_vertex,uv_vertex,worldpos_vertex,background_vert:vertex$h,background_frag:fragment$h,backgroundCube_vert:vertex$g,backgroundCube_frag:fragment$g,cube_vert:vertex$f,cube_frag:fragment$f,depth_vert:vertex$e,depth_frag:fragment$e,distanceRGBA_vert:vertex$d,distanceRGBA_frag:fragment$d,equirect_vert:vertex$c,equirect_frag:fragment$c,linedashed_vert:vertex$b,linedashed_frag:fragment$b,meshbasic_vert:vertex$a,meshbasic_frag:fragment$a,meshlambert_vert:vertex$9,meshlambert_frag:fragment$9,meshmatcap_vert:vertex$8,meshmatcap_frag:fragment$8,meshnormal_vert:vertex$7,meshnormal_frag:fragment$7,meshphong_vert:vertex$6,meshphong_frag:fragment$6,meshphysical_vert:vertex$5,meshphysical_frag:fragment$5,meshtoon_vert:vertex$4,meshtoon_frag:fragment$4,points_vert:vertex$3,points_frag:fragment$3,shadow_vert:vertex$2,shadow_frag:fragment$2,sprite_vert:vertex$1,sprite_frag:fragment$1},UniformsLib={common:{diffuse:{value:new Color(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Matrix3},alphaMap:{value:null},alphaMapTransform:{value:new Matrix3},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Matrix3}},envmap:{envMap:{value:null},envMapRotation:{value:new Matrix3},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Matrix3}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Matrix3}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Matrix3},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Matrix3},normalScale:{value:new Vector2(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Matrix3},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Matrix3}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Matrix3}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Matrix3}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Color(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Color(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Matrix3},alphaTest:{value:0},uvTransform:{value:new Matrix3}},sprite:{diffuse:{value:new Color(16777215)},opacity:{value:1},center:{value:new Vector2(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Matrix3},alphaMap:{value:null},alphaMapTransform:{value:new Matrix3},alphaTest:{value:0}}},ShaderLib={basic:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.specularmap,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.fog]),vertexShader:ShaderChunk.meshbasic_vert,fragmentShader:ShaderChunk.meshbasic_frag},lambert:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.specularmap,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color(0)}}]),vertexShader:ShaderChunk.meshlambert_vert,fragmentShader:ShaderChunk.meshlambert_frag},phong:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.specularmap,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color(0)},specular:{value:new Color(1118481)},shininess:{value:30}}]),vertexShader:ShaderChunk.meshphong_vert,fragmentShader:ShaderChunk.meshphong_frag},standard:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.roughnessmap,UniformsLib.metalnessmap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:ShaderChunk.meshphysical_vert,fragmentShader:ShaderChunk.meshphysical_frag},toon:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.gradientmap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color(0)}}]),vertexShader:ShaderChunk.meshtoon_vert,fragmentShader:ShaderChunk.meshtoon_frag},matcap:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.fog,{matcap:{value:null}}]),vertexShader:ShaderChunk.meshmatcap_vert,fragmentShader:ShaderChunk.meshmatcap_frag},points:{uniforms:mergeUniforms([UniformsLib.points,UniformsLib.fog]),vertexShader:ShaderChunk.points_vert,fragmentShader:ShaderChunk.points_frag},dashed:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:ShaderChunk.linedashed_vert,fragmentShader:ShaderChunk.linedashed_frag},depth:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.displacementmap]),vertexShader:ShaderChunk.depth_vert,fragmentShader:ShaderChunk.depth_frag},normal:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,{opacity:{value:1}}]),vertexShader:ShaderChunk.meshnormal_vert,fragmentShader:ShaderChunk.meshnormal_frag},sprite:{uniforms:mergeUniforms([UniformsLib.sprite,UniformsLib.fog]),vertexShader:ShaderChunk.sprite_vert,fragmentShader:ShaderChunk.sprite_frag},background:{uniforms:{uvTransform:{value:new Matrix3},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:ShaderChunk.background_vert,fragmentShader:ShaderChunk.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new Matrix3}},vertexShader:ShaderChunk.backgroundCube_vert,fragmentShader:ShaderChunk.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:ShaderChunk.cube_vert,fragmentShader:ShaderChunk.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:ShaderChunk.equirect_vert,fragmentShader:ShaderChunk.equirect_frag},distanceRGBA:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.displacementmap,{referencePosition:{value:new Vector3},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:ShaderChunk.distanceRGBA_vert,fragmentShader:ShaderChunk.distanceRGBA_frag},shadow:{uniforms:mergeUniforms([UniformsLib.lights,UniformsLib.fog,{color:{value:new Color(0)},opacity:{value:1}}]),vertexShader:ShaderChunk.shadow_vert,fragmentShader:ShaderChunk.shadow_frag}};ShaderLib.physical={uniforms:mergeUniforms([ShaderLib.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Matrix3},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Matrix3},clearcoatNormalScale:{value:new Vector2(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Matrix3},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Matrix3},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Matrix3},sheen:{value:0},sheenColor:{value:new Color(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Matrix3},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Matrix3},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Matrix3},transmissionSamplerSize:{value:new Vector2},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Matrix3},attenuationDistance:{value:0},attenuationColor:{value:new Color(0)},specularColor:{value:new Color(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Matrix3},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Matrix3},anisotropyVector:{value:new Vector2},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Matrix3}}]),vertexShader:ShaderChunk.meshphysical_vert,fragmentShader:ShaderChunk.meshphysical_frag};const _rgb={r:0,b:0,g:0},_e1$1=new Euler,_m1$1=new Matrix4;function WebGLBackground(o,e,s,a,c,d,b){const _e=new Color(0);let tt=d===!0?0:1,nt,it,ot=null,at=0,ct=null;function ut(ht){let mt=ht.isScene===!0?ht.background:null;return mt&&mt.isTexture&&(mt=(ht.backgroundBlurriness>0?s:e).get(mt)),mt}function ft(ht){let mt=!1;const xt=ut(ht);xt===null?lt(_e,tt):xt&&xt.isColor&&(lt(xt,1),mt=!0);const St=o.xr.getEnvironmentBlendMode();St==="additive"?a.buffers.color.setClear(0,0,0,1,b):St==="alpha-blend"&&a.buffers.color.setClear(0,0,0,0,b),(o.autoClear||mt)&&(a.buffers.depth.setTest(!0),a.buffers.depth.setMask(!0),a.buffers.color.setMask(!0),o.clear(o.autoClearColor,o.autoClearDepth,o.autoClearStencil))}function dt(ht,mt){const xt=ut(mt);xt&&(xt.isCubeTexture||xt.mapping===CubeUVReflectionMapping)?(it===void 0&&(it=new Mesh(new BoxGeometry(1,1,1),new ShaderMaterial({name:"BackgroundCubeMaterial",uniforms:cloneUniforms(ShaderLib.backgroundCube.uniforms),vertexShader:ShaderLib.backgroundCube.vertexShader,fragmentShader:ShaderLib.backgroundCube.fragmentShader,side:BackSide,depthTest:!1,depthWrite:!1,fog:!1})),it.geometry.deleteAttribute("normal"),it.geometry.deleteAttribute("uv"),it.onBeforeRender=function(St,yt,wt){this.matrixWorld.copyPosition(wt.matrixWorld)},Object.defineProperty(it.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),c.update(it)),_e1$1.copy(mt.backgroundRotation),_e1$1.x*=-1,_e1$1.y*=-1,_e1$1.z*=-1,xt.isCubeTexture&&xt.isRenderTargetTexture===!1&&(_e1$1.y*=-1,_e1$1.z*=-1),it.material.uniforms.envMap.value=xt,it.material.uniforms.flipEnvMap.value=xt.isCubeTexture&&xt.isRenderTargetTexture===!1?-1:1,it.material.uniforms.backgroundBlurriness.value=mt.backgroundBlurriness,it.material.uniforms.backgroundIntensity.value=mt.backgroundIntensity,it.material.uniforms.backgroundRotation.value.setFromMatrix4(_m1$1.makeRotationFromEuler(_e1$1)),it.material.toneMapped=ColorManagement.getTransfer(xt.colorSpace)!==SRGBTransfer,(ot!==xt||at!==xt.version||ct!==o.toneMapping)&&(it.material.needsUpdate=!0,ot=xt,at=xt.version,ct=o.toneMapping),it.layers.enableAll(),ht.unshift(it,it.geometry,it.material,0,0,null)):xt&&xt.isTexture&&(nt===void 0&&(nt=new Mesh(new PlaneGeometry(2,2),new ShaderMaterial({name:"BackgroundMaterial",uniforms:cloneUniforms(ShaderLib.background.uniforms),vertexShader:ShaderLib.background.vertexShader,fragmentShader:ShaderLib.background.fragmentShader,side:FrontSide,depthTest:!1,depthWrite:!1,fog:!1})),nt.geometry.deleteAttribute("normal"),Object.defineProperty(nt.material,"map",{get:function(){return this.uniforms.t2D.value}}),c.update(nt)),nt.material.uniforms.t2D.value=xt,nt.material.uniforms.backgroundIntensity.value=mt.backgroundIntensity,nt.material.toneMapped=ColorManagement.getTransfer(xt.colorSpace)!==SRGBTransfer,xt.matrixAutoUpdate===!0&&xt.updateMatrix(),nt.material.uniforms.uvTransform.value.copy(xt.matrix),(ot!==xt||at!==xt.version||ct!==o.toneMapping)&&(nt.material.needsUpdate=!0,ot=xt,at=xt.version,ct=o.toneMapping),nt.layers.enableAll(),ht.unshift(nt,nt.geometry,nt.material,0,0,null))}function lt(ht,mt){ht.getRGB(_rgb,getUnlitUniformColorSpace(o)),a.buffers.color.setClear(_rgb.r,_rgb.g,_rgb.b,mt,b)}return{getClearColor:function(){return _e},setClearColor:function(ht,mt=1){_e.set(ht),tt=mt,lt(_e,tt)},getClearAlpha:function(){return tt},setClearAlpha:function(ht){tt=ht,lt(_e,tt)},render:ft,addToRenderList:dt}}function WebGLBindingStates(o,e){const s=o.getParameter(o.MAX_VERTEX_ATTRIBS),a={},c=at(null);let d=c,b=!1;function _e(vt,Mt,jt,Lt,Nt){let kt=!1;const Ot=ot(Lt,jt,Mt);d!==Ot&&(d=Ot,nt(d.object)),kt=ct(vt,Lt,jt,Nt),kt&&ut(vt,Lt,jt,Nt),Nt!==null&&e.update(Nt,o.ELEMENT_ARRAY_BUFFER),(kt||b)&&(b=!1,xt(vt,Mt,jt,Lt),Nt!==null&&o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,e.get(Nt).buffer))}function tt(){return o.createVertexArray()}function nt(vt){return o.bindVertexArray(vt)}function it(vt){return o.deleteVertexArray(vt)}function ot(vt,Mt,jt){const Lt=jt.wireframe===!0;let Nt=a[vt.id];Nt===void 0&&(Nt={},a[vt.id]=Nt);let kt=Nt[Mt.id];kt===void 0&&(kt={},Nt[Mt.id]=kt);let Ot=kt[Lt];return Ot===void 0&&(Ot=at(tt()),kt[Lt]=Ot),Ot}function at(vt){const Mt=[],jt=[],Lt=[];for(let Nt=0;Nt<s;Nt++)Mt[Nt]=0,jt[Nt]=0,Lt[Nt]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:Mt,enabledAttributes:jt,attributeDivisors:Lt,object:vt,attributes:{},index:null}}function ct(vt,Mt,jt,Lt){const Nt=d.attributes,kt=Mt.attributes;let Ot=0;const Ht=jt.getAttributes();for(const Ct in Ht)if(Ht[Ct].location>=0){const Gt=Nt[Ct];let Pt=kt[Ct];if(Pt===void 0&&(Ct==="instanceMatrix"&&vt.instanceMatrix&&(Pt=vt.instanceMatrix),Ct==="instanceColor"&&vt.instanceColor&&(Pt=vt.instanceColor)),Gt===void 0||Gt.attribute!==Pt||Pt&&Gt.data!==Pt.data)return!0;Ot++}return d.attributesNum!==Ot||d.index!==Lt}function ut(vt,Mt,jt,Lt){const Nt={},kt=Mt.attributes;let Ot=0;const Ht=jt.getAttributes();for(const Ct in Ht)if(Ht[Ct].location>=0){let Gt=kt[Ct];Gt===void 0&&(Ct==="instanceMatrix"&&vt.instanceMatrix&&(Gt=vt.instanceMatrix),Ct==="instanceColor"&&vt.instanceColor&&(Gt=vt.instanceColor));const Pt={};Pt.attribute=Gt,Gt&&Gt.data&&(Pt.data=Gt.data),Nt[Ct]=Pt,Ot++}d.attributes=Nt,d.attributesNum=Ot,d.index=Lt}function ft(){const vt=d.newAttributes;for(let Mt=0,jt=vt.length;Mt<jt;Mt++)vt[Mt]=0}function dt(vt){lt(vt,0)}function lt(vt,Mt){const jt=d.newAttributes,Lt=d.enabledAttributes,Nt=d.attributeDivisors;jt[vt]=1,Lt[vt]===0&&(o.enableVertexAttribArray(vt),Lt[vt]=1),Nt[vt]!==Mt&&(o.vertexAttribDivisor(vt,Mt),Nt[vt]=Mt)}function ht(){const vt=d.newAttributes,Mt=d.enabledAttributes;for(let jt=0,Lt=Mt.length;jt<Lt;jt++)Mt[jt]!==vt[jt]&&(o.disableVertexAttribArray(jt),Mt[jt]=0)}function mt(vt,Mt,jt,Lt,Nt,kt,Ot){Ot===!0?o.vertexAttribIPointer(vt,Mt,jt,Nt,kt):o.vertexAttribPointer(vt,Mt,jt,Lt,Nt,kt)}function xt(vt,Mt,jt,Lt){ft();const Nt=Lt.attributes,kt=jt.getAttributes(),Ot=Mt.defaultAttributeValues;for(const Ht in kt){const Ct=kt[Ht];if(Ct.location>=0){let Ut=Nt[Ht];if(Ut===void 0&&(Ht==="instanceMatrix"&&vt.instanceMatrix&&(Ut=vt.instanceMatrix),Ht==="instanceColor"&&vt.instanceColor&&(Ut=vt.instanceColor)),Ut!==void 0){const Gt=Ut.normalized,Pt=Ut.itemSize,Wt=e.get(Ut);if(Wt===void 0)continue;const sn=Wt.buffer,Bt=Wt.type,tn=Wt.bytesPerElement,cn=Bt===o.INT||Bt===o.UNSIGNED_INT||Ut.gpuType===IntType;if(Ut.isInterleavedBufferAttribute){const vn=Ut.data,On=vn.stride,rr=Ut.offset;if(vn.isInstancedInterleavedBuffer){for(let Wn=0;Wn<Ct.locationSize;Wn++)lt(Ct.location+Wn,vn.meshPerAttribute);vt.isInstancedMesh!==!0&&Lt._maxInstanceCount===void 0&&(Lt._maxInstanceCount=vn.meshPerAttribute*vn.count)}else for(let Wn=0;Wn<Ct.locationSize;Wn++)dt(Ct.location+Wn);o.bindBuffer(o.ARRAY_BUFFER,sn);for(let Wn=0;Wn<Ct.locationSize;Wn++)mt(Ct.location+Wn,Pt/Ct.locationSize,Bt,Gt,On*tn,(rr+Pt/Ct.locationSize*Wn)*tn,cn)}else{if(Ut.isInstancedBufferAttribute){for(let vn=0;vn<Ct.locationSize;vn++)lt(Ct.location+vn,Ut.meshPerAttribute);vt.isInstancedMesh!==!0&&Lt._maxInstanceCount===void 0&&(Lt._maxInstanceCount=Ut.meshPerAttribute*Ut.count)}else for(let vn=0;vn<Ct.locationSize;vn++)dt(Ct.location+vn);o.bindBuffer(o.ARRAY_BUFFER,sn);for(let vn=0;vn<Ct.locationSize;vn++)mt(Ct.location+vn,Pt/Ct.locationSize,Bt,Gt,Pt*tn,Pt/Ct.locationSize*vn*tn,cn)}}else if(Ot!==void 0){const Gt=Ot[Ht];if(Gt!==void 0)switch(Gt.length){case 2:o.vertexAttrib2fv(Ct.location,Gt);break;case 3:o.vertexAttrib3fv(Ct.location,Gt);break;case 4:o.vertexAttrib4fv(Ct.location,Gt);break;default:o.vertexAttrib1fv(Ct.location,Gt)}}}}ht()}function St(){Et();for(const vt in a){const Mt=a[vt];for(const jt in Mt){const Lt=Mt[jt];for(const Nt in Lt)it(Lt[Nt].object),delete Lt[Nt];delete Mt[jt]}delete a[vt]}}function yt(vt){if(a[vt.id]===void 0)return;const Mt=a[vt.id];for(const jt in Mt){const Lt=Mt[jt];for(const Nt in Lt)it(Lt[Nt].object),delete Lt[Nt];delete Mt[jt]}delete a[vt.id]}function wt(vt){for(const Mt in a){const jt=a[Mt];if(jt[vt.id]===void 0)continue;const Lt=jt[vt.id];for(const Nt in Lt)it(Lt[Nt].object),delete Lt[Nt];delete jt[vt.id]}}function Et(){_t(),b=!0,d!==c&&(d=c,nt(d.object))}function _t(){c.geometry=null,c.program=null,c.wireframe=!1}return{setup:_e,reset:Et,resetDefaultState:_t,dispose:St,releaseStatesOfGeometry:yt,releaseStatesOfProgram:wt,initAttributes:ft,enableAttribute:dt,disableUnusedAttributes:ht}}function WebGLBufferRenderer(o,e,s){let a;function c(nt){a=nt}function d(nt,it){o.drawArrays(a,nt,it),s.update(it,a,1)}function b(nt,it,ot){ot!==0&&(o.drawArraysInstanced(a,nt,it,ot),s.update(it,a,ot))}function _e(nt,it,ot){if(ot===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(a,nt,0,it,0,ot);let ct=0;for(let ut=0;ut<ot;ut++)ct+=it[ut];s.update(ct,a,1)}function tt(nt,it,ot,at){if(ot===0)return;const ct=e.get("WEBGL_multi_draw");if(ct===null)for(let ut=0;ut<nt.length;ut++)b(nt[ut],it[ut],at[ut]);else{ct.multiDrawArraysInstancedWEBGL(a,nt,0,it,0,at,0,ot);let ut=0;for(let ft=0;ft<ot;ft++)ut+=it[ft]*at[ft];s.update(ut,a,1)}}this.setMode=c,this.render=d,this.renderInstances=b,this.renderMultiDraw=_e,this.renderMultiDrawInstances=tt}function WebGLCapabilities(o,e,s,a){let c;function d(){if(c!==void 0)return c;if(e.has("EXT_texture_filter_anisotropic")===!0){const wt=e.get("EXT_texture_filter_anisotropic");c=o.getParameter(wt.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else c=0;return c}function b(wt){return!(wt!==RGBAFormat&&a.convert(wt)!==o.getParameter(o.IMPLEMENTATION_COLOR_READ_FORMAT))}function _e(wt){const Et=wt===HalfFloatType&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(wt!==UnsignedByteType&&a.convert(wt)!==o.getParameter(o.IMPLEMENTATION_COLOR_READ_TYPE)&&wt!==FloatType&&!Et)}function tt(wt){if(wt==="highp"){if(o.getShaderPrecisionFormat(o.VERTEX_SHADER,o.HIGH_FLOAT).precision>0&&o.getShaderPrecisionFormat(o.FRAGMENT_SHADER,o.HIGH_FLOAT).precision>0)return"highp";wt="mediump"}return wt==="mediump"&&o.getShaderPrecisionFormat(o.VERTEX_SHADER,o.MEDIUM_FLOAT).precision>0&&o.getShaderPrecisionFormat(o.FRAGMENT_SHADER,o.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let nt=s.precision!==void 0?s.precision:"highp";const it=tt(nt);it!==nt&&(console.warn("THREE.WebGLRenderer:",nt,"not supported, using",it,"instead."),nt=it);const ot=s.logarithmicDepthBuffer===!0,at=s.reverseDepthBuffer===!0&&e.has("EXT_clip_control"),ct=o.getParameter(o.MAX_TEXTURE_IMAGE_UNITS),ut=o.getParameter(o.MAX_VERTEX_TEXTURE_IMAGE_UNITS),ft=o.getParameter(o.MAX_TEXTURE_SIZE),dt=o.getParameter(o.MAX_CUBE_MAP_TEXTURE_SIZE),lt=o.getParameter(o.MAX_VERTEX_ATTRIBS),ht=o.getParameter(o.MAX_VERTEX_UNIFORM_VECTORS),mt=o.getParameter(o.MAX_VARYING_VECTORS),xt=o.getParameter(o.MAX_FRAGMENT_UNIFORM_VECTORS),St=ut>0,yt=o.getParameter(o.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:d,getMaxPrecision:tt,textureFormatReadable:b,textureTypeReadable:_e,precision:nt,logarithmicDepthBuffer:ot,reverseDepthBuffer:at,maxTextures:ct,maxVertexTextures:ut,maxTextureSize:ft,maxCubemapSize:dt,maxAttributes:lt,maxVertexUniforms:ht,maxVaryings:mt,maxFragmentUniforms:xt,vertexTextures:St,maxSamples:yt}}function WebGLClipping(o){const e=this;let s=null,a=0,c=!1,d=!1;const b=new Plane,_e=new Matrix3,tt={value:null,needsUpdate:!1};this.uniform=tt,this.numPlanes=0,this.numIntersection=0,this.init=function(ot,at){const ct=ot.length!==0||at||a!==0||c;return c=at,a=ot.length,ct},this.beginShadows=function(){d=!0,it(null)},this.endShadows=function(){d=!1},this.setGlobalState=function(ot,at){s=it(ot,at,0)},this.setState=function(ot,at,ct){const ut=ot.clippingPlanes,ft=ot.clipIntersection,dt=ot.clipShadows,lt=o.get(ot);if(!c||ut===null||ut.length===0||d&&!dt)d?it(null):nt();else{const ht=d?0:a,mt=ht*4;let xt=lt.clippingState||null;tt.value=xt,xt=it(ut,at,mt,ct);for(let St=0;St!==mt;++St)xt[St]=s[St];lt.clippingState=xt,this.numIntersection=ft?this.numPlanes:0,this.numPlanes+=ht}};function nt(){tt.value!==s&&(tt.value=s,tt.needsUpdate=a>0),e.numPlanes=a,e.numIntersection=0}function it(ot,at,ct,ut){const ft=ot!==null?ot.length:0;let dt=null;if(ft!==0){if(dt=tt.value,ut!==!0||dt===null){const lt=ct+ft*4,ht=at.matrixWorldInverse;_e.getNormalMatrix(ht),(dt===null||dt.length<lt)&&(dt=new Float32Array(lt));for(let mt=0,xt=ct;mt!==ft;++mt,xt+=4)b.copy(ot[mt]).applyMatrix4(ht,_e),b.normal.toArray(dt,xt),dt[xt+3]=b.constant}tt.value=dt,tt.needsUpdate=!0}return e.numPlanes=ft,e.numIntersection=0,dt}}function WebGLCubeMaps(o){let e=new WeakMap;function s(b,_e){return _e===EquirectangularReflectionMapping?b.mapping=CubeReflectionMapping:_e===EquirectangularRefractionMapping&&(b.mapping=CubeRefractionMapping),b}function a(b){if(b&&b.isTexture){const _e=b.mapping;if(_e===EquirectangularReflectionMapping||_e===EquirectangularRefractionMapping)if(e.has(b)){const tt=e.get(b).texture;return s(tt,b.mapping)}else{const tt=b.image;if(tt&&tt.height>0){const nt=new WebGLCubeRenderTarget(tt.height);return nt.fromEquirectangularTexture(o,b),e.set(b,nt),b.addEventListener("dispose",c),s(nt.texture,b.mapping)}else return null}}return b}function c(b){const _e=b.target;_e.removeEventListener("dispose",c);const tt=e.get(_e);tt!==void 0&&(e.delete(_e),tt.dispose())}function d(){e=new WeakMap}return{get:a,dispose:d}}let OrthographicCamera$1=class extends Camera{constructor(e=-1,s=1,a=1,c=-1,d=.1,b=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=s,this.top=a,this.bottom=c,this.near=d,this.far=b,this.updateProjectionMatrix()}copy(e,s){return super.copy(e,s),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,s,a,c,d,b){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=s,this.view.offsetX=a,this.view.offsetY=c,this.view.width=d,this.view.height=b,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),s=(this.top-this.bottom)/(2*this.zoom),a=(this.right+this.left)/2,c=(this.top+this.bottom)/2;let d=a-e,b=a+e,_e=c+s,tt=c-s;if(this.view!==null&&this.view.enabled){const nt=(this.right-this.left)/this.view.fullWidth/this.zoom,it=(this.top-this.bottom)/this.view.fullHeight/this.zoom;d+=nt*this.view.offsetX,b=d+nt*this.view.width,_e-=it*this.view.offsetY,tt=_e-it*this.view.height}this.projectionMatrix.makeOrthographic(d,b,_e,tt,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const s=super.toJSON(e);return s.object.zoom=this.zoom,s.object.left=this.left,s.object.right=this.right,s.object.top=this.top,s.object.bottom=this.bottom,s.object.near=this.near,s.object.far=this.far,this.view!==null&&(s.object.view=Object.assign({},this.view)),s}};const LOD_MIN=4,EXTRA_LOD_SIGMA=[.125,.215,.35,.446,.526,.582],MAX_SAMPLES=20,_flatCamera=new OrthographicCamera$1,_clearColor=new Color;let _oldTarget=null,_oldActiveCubeFace=0,_oldActiveMipmapLevel=0,_oldXrEnabled=!1;const PHI=(1+Math.sqrt(5))/2,INV_PHI=1/PHI,_axisDirections=[new Vector3(-PHI,INV_PHI,0),new Vector3(PHI,INV_PHI,0),new Vector3(-INV_PHI,0,PHI),new Vector3(INV_PHI,0,PHI),new Vector3(0,PHI,-INV_PHI),new Vector3(0,PHI,INV_PHI),new Vector3(-1,1,-1),new Vector3(1,1,-1),new Vector3(-1,1,1),new Vector3(1,1,1)];class PMREMGenerator{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,s=0,a=.1,c=100){_oldTarget=this._renderer.getRenderTarget(),_oldActiveCubeFace=this._renderer.getActiveCubeFace(),_oldActiveMipmapLevel=this._renderer.getActiveMipmapLevel(),_oldXrEnabled=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(256);const d=this._allocateTargets();return d.depthBuffer=!0,this._sceneToCubeUV(e,a,c,d),s>0&&this._blur(d,0,0,s),this._applyPMREM(d),this._cleanup(d),d}fromEquirectangular(e,s=null){return this._fromTexture(e,s)}fromCubemap(e,s=null){return this._fromTexture(e,s)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=_getCubemapMaterial(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=_getEquirectMaterial(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(_oldTarget,_oldActiveCubeFace,_oldActiveMipmapLevel),this._renderer.xr.enabled=_oldXrEnabled,e.scissorTest=!1,_setViewport(e,0,0,e.width,e.height)}_fromTexture(e,s){e.mapping===CubeReflectionMapping||e.mapping===CubeRefractionMapping?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),_oldTarget=this._renderer.getRenderTarget(),_oldActiveCubeFace=this._renderer.getActiveCubeFace(),_oldActiveMipmapLevel=this._renderer.getActiveMipmapLevel(),_oldXrEnabled=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const a=s||this._allocateTargets();return this._textureToCubeUV(e,a),this._applyPMREM(a),this._cleanup(a),a}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),s=4*this._cubeSize,a={magFilter:LinearFilter,minFilter:LinearFilter,generateMipmaps:!1,type:HalfFloatType,format:RGBAFormat,colorSpace:LinearSRGBColorSpace$1,depthBuffer:!1},c=_createRenderTarget(e,s,a);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==s){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=_createRenderTarget(e,s,a);const{_lodMax:d}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=_createPlanes(d)),this._blurMaterial=_getBlurShader(d,e,s)}return c}_compileMaterial(e){const s=new Mesh(this._lodPlanes[0],e);this._renderer.compile(s,_flatCamera)}_sceneToCubeUV(e,s,a,c){const _e=new PerspectiveCamera(90,1,s,a),tt=[1,-1,1,1,1,1],nt=[1,1,1,-1,-1,-1],it=this._renderer,ot=it.autoClear,at=it.toneMapping;it.getClearColor(_clearColor),it.toneMapping=NoToneMapping,it.autoClear=!1;const ct=new MeshBasicMaterial({name:"PMREM.Background",side:BackSide,depthWrite:!1,depthTest:!1}),ut=new Mesh(new BoxGeometry,ct);let ft=!1;const dt=e.background;dt?dt.isColor&&(ct.color.copy(dt),e.background=null,ft=!0):(ct.color.copy(_clearColor),ft=!0);for(let lt=0;lt<6;lt++){const ht=lt%3;ht===0?(_e.up.set(0,tt[lt],0),_e.lookAt(nt[lt],0,0)):ht===1?(_e.up.set(0,0,tt[lt]),_e.lookAt(0,nt[lt],0)):(_e.up.set(0,tt[lt],0),_e.lookAt(0,0,nt[lt]));const mt=this._cubeSize;_setViewport(c,ht*mt,lt>2?mt:0,mt,mt),it.setRenderTarget(c),ft&&it.render(ut,_e),it.render(e,_e)}ut.geometry.dispose(),ut.material.dispose(),it.toneMapping=at,it.autoClear=ot,e.background=dt}_textureToCubeUV(e,s){const a=this._renderer,c=e.mapping===CubeReflectionMapping||e.mapping===CubeRefractionMapping;c?(this._cubemapMaterial===null&&(this._cubemapMaterial=_getCubemapMaterial()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=_getEquirectMaterial());const d=c?this._cubemapMaterial:this._equirectMaterial,b=new Mesh(this._lodPlanes[0],d),_e=d.uniforms;_e.envMap.value=e;const tt=this._cubeSize;_setViewport(s,0,0,3*tt,2*tt),a.setRenderTarget(s),a.render(b,_flatCamera)}_applyPMREM(e){const s=this._renderer,a=s.autoClear;s.autoClear=!1;const c=this._lodPlanes.length;for(let d=1;d<c;d++){const b=Math.sqrt(this._sigmas[d]*this._sigmas[d]-this._sigmas[d-1]*this._sigmas[d-1]),_e=_axisDirections[(c-d-1)%_axisDirections.length];this._blur(e,d-1,d,b,_e)}s.autoClear=a}_blur(e,s,a,c,d){const b=this._pingPongRenderTarget;this._halfBlur(e,b,s,a,c,"latitudinal",d),this._halfBlur(b,e,a,a,c,"longitudinal",d)}_halfBlur(e,s,a,c,d,b,_e){const tt=this._renderer,nt=this._blurMaterial;b!=="latitudinal"&&b!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const it=3,ot=new Mesh(this._lodPlanes[c],nt),at=nt.uniforms,ct=this._sizeLods[a]-1,ut=isFinite(d)?Math.PI/(2*ct):2*Math.PI/(2*MAX_SAMPLES-1),ft=d/ut,dt=isFinite(d)?1+Math.floor(it*ft):MAX_SAMPLES;dt>MAX_SAMPLES&&console.warn(`sigmaRadians, ${d}, is too large and will clip, as it requested ${dt} samples when the maximum is set to ${MAX_SAMPLES}`);const lt=[];let ht=0;for(let wt=0;wt<MAX_SAMPLES;++wt){const Et=wt/ft,_t=Math.exp(-Et*Et/2);lt.push(_t),wt===0?ht+=_t:wt<dt&&(ht+=2*_t)}for(let wt=0;wt<lt.length;wt++)lt[wt]=lt[wt]/ht;at.envMap.value=e.texture,at.samples.value=dt,at.weights.value=lt,at.latitudinal.value=b==="latitudinal",_e&&(at.poleAxis.value=_e);const{_lodMax:mt}=this;at.dTheta.value=ut,at.mipInt.value=mt-a;const xt=this._sizeLods[c],St=3*xt*(c>mt-LOD_MIN?c-mt+LOD_MIN:0),yt=4*(this._cubeSize-xt);_setViewport(s,St,yt,3*xt,2*xt),tt.setRenderTarget(s),tt.render(ot,_flatCamera)}}function _createPlanes(o){const e=[],s=[],a=[];let c=o;const d=o-LOD_MIN+1+EXTRA_LOD_SIGMA.length;for(let b=0;b<d;b++){const _e=Math.pow(2,c);s.push(_e);let tt=1/_e;b>o-LOD_MIN?tt=EXTRA_LOD_SIGMA[b-o+LOD_MIN-1]:b===0&&(tt=0),a.push(tt);const nt=1/(_e-2),it=-nt,ot=1+nt,at=[it,it,ot,it,ot,ot,it,it,ot,ot,it,ot],ct=6,ut=6,ft=3,dt=2,lt=1,ht=new Float32Array(ft*ut*ct),mt=new Float32Array(dt*ut*ct),xt=new Float32Array(lt*ut*ct);for(let yt=0;yt<ct;yt++){const wt=yt%3*2/3-1,Et=yt>2?0:-1,_t=[wt,Et,0,wt+2/3,Et,0,wt+2/3,Et+1,0,wt,Et,0,wt+2/3,Et+1,0,wt,Et+1,0];ht.set(_t,ft*ut*yt),mt.set(at,dt*ut*yt);const vt=[yt,yt,yt,yt,yt,yt];xt.set(vt,lt*ut*yt)}const St=new BufferGeometry;St.setAttribute("position",new BufferAttribute(ht,ft)),St.setAttribute("uv",new BufferAttribute(mt,dt)),St.setAttribute("faceIndex",new BufferAttribute(xt,lt)),e.push(St),c>LOD_MIN&&c--}return{lodPlanes:e,sizeLods:s,sigmas:a}}function _createRenderTarget(o,e,s){const a=new WebGLRenderTarget(o,e,s);return a.texture.mapping=CubeUVReflectionMapping,a.texture.name="PMREM.cubeUv",a.scissorTest=!0,a}function _setViewport(o,e,s,a,c){o.viewport.set(e,s,a,c),o.scissor.set(e,s,a,c)}function _getBlurShader(o,e,s){const a=new Float32Array(MAX_SAMPLES),c=new Vector3(0,1,0);return new ShaderMaterial({name:"SphericalGaussianBlur",defines:{n:MAX_SAMPLES,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/s,CUBEUV_MAX_MIP:`${o}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:a},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:c}},vertexShader:_getCommonVertexShader(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:NoBlending,depthTest:!1,depthWrite:!1})}function _getEquirectMaterial(){return new ShaderMaterial({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:_getCommonVertexShader(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:NoBlending,depthTest:!1,depthWrite:!1})}function _getCubemapMaterial(){return new ShaderMaterial({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:_getCommonVertexShader(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:NoBlending,depthTest:!1,depthWrite:!1})}function _getCommonVertexShader(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function WebGLCubeUVMaps(o){let e=new WeakMap,s=null;function a(_e){if(_e&&_e.isTexture){const tt=_e.mapping,nt=tt===EquirectangularReflectionMapping||tt===EquirectangularRefractionMapping,it=tt===CubeReflectionMapping||tt===CubeRefractionMapping;if(nt||it){let ot=e.get(_e);const at=ot!==void 0?ot.texture.pmremVersion:0;if(_e.isRenderTargetTexture&&_e.pmremVersion!==at)return s===null&&(s=new PMREMGenerator(o)),ot=nt?s.fromEquirectangular(_e,ot):s.fromCubemap(_e,ot),ot.texture.pmremVersion=_e.pmremVersion,e.set(_e,ot),ot.texture;if(ot!==void 0)return ot.texture;{const ct=_e.image;return nt&&ct&&ct.height>0||it&&ct&&c(ct)?(s===null&&(s=new PMREMGenerator(o)),ot=nt?s.fromEquirectangular(_e):s.fromCubemap(_e),ot.texture.pmremVersion=_e.pmremVersion,e.set(_e,ot),_e.addEventListener("dispose",d),ot.texture):null}}}return _e}function c(_e){let tt=0;const nt=6;for(let it=0;it<nt;it++)_e[it]!==void 0&&tt++;return tt===nt}function d(_e){const tt=_e.target;tt.removeEventListener("dispose",d);const nt=e.get(tt);nt!==void 0&&(e.delete(tt),nt.dispose())}function b(){e=new WeakMap,s!==null&&(s.dispose(),s=null)}return{get:a,dispose:b}}function WebGLExtensions(o){const e={};function s(a){if(e[a]!==void 0)return e[a];let c;switch(a){case"WEBGL_depth_texture":c=o.getExtension("WEBGL_depth_texture")||o.getExtension("MOZ_WEBGL_depth_texture")||o.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":c=o.getExtension("EXT_texture_filter_anisotropic")||o.getExtension("MOZ_EXT_texture_filter_anisotropic")||o.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":c=o.getExtension("WEBGL_compressed_texture_s3tc")||o.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||o.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":c=o.getExtension("WEBGL_compressed_texture_pvrtc")||o.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:c=o.getExtension(a)}return e[a]=c,c}return{has:function(a){return s(a)!==null},init:function(){s("EXT_color_buffer_float"),s("WEBGL_clip_cull_distance"),s("OES_texture_float_linear"),s("EXT_color_buffer_half_float"),s("WEBGL_multisampled_render_to_texture"),s("WEBGL_render_shared_exponent")},get:function(a){const c=s(a);return c===null&&warnOnce("THREE.WebGLRenderer: "+a+" extension not supported."),c}}}function WebGLGeometries(o,e,s,a){const c={},d=new WeakMap;function b(ot){const at=ot.target;at.index!==null&&e.remove(at.index);for(const ut in at.attributes)e.remove(at.attributes[ut]);for(const ut in at.morphAttributes){const ft=at.morphAttributes[ut];for(let dt=0,lt=ft.length;dt<lt;dt++)e.remove(ft[dt])}at.removeEventListener("dispose",b),delete c[at.id];const ct=d.get(at);ct&&(e.remove(ct),d.delete(at)),a.releaseStatesOfGeometry(at),at.isInstancedBufferGeometry===!0&&delete at._maxInstanceCount,s.memory.geometries--}function _e(ot,at){return c[at.id]===!0||(at.addEventListener("dispose",b),c[at.id]=!0,s.memory.geometries++),at}function tt(ot){const at=ot.attributes;for(const ut in at)e.update(at[ut],o.ARRAY_BUFFER);const ct=ot.morphAttributes;for(const ut in ct){const ft=ct[ut];for(let dt=0,lt=ft.length;dt<lt;dt++)e.update(ft[dt],o.ARRAY_BUFFER)}}function nt(ot){const at=[],ct=ot.index,ut=ot.attributes.position;let ft=0;if(ct!==null){const ht=ct.array;ft=ct.version;for(let mt=0,xt=ht.length;mt<xt;mt+=3){const St=ht[mt+0],yt=ht[mt+1],wt=ht[mt+2];at.push(St,yt,yt,wt,wt,St)}}else if(ut!==void 0){const ht=ut.array;ft=ut.version;for(let mt=0,xt=ht.length/3-1;mt<xt;mt+=3){const St=mt+0,yt=mt+1,wt=mt+2;at.push(St,yt,yt,wt,wt,St)}}else return;const dt=new(arrayNeedsUint32(at)?Uint32BufferAttribute:Uint16BufferAttribute)(at,1);dt.version=ft;const lt=d.get(ot);lt&&e.remove(lt),d.set(ot,dt)}function it(ot){const at=d.get(ot);if(at){const ct=ot.index;ct!==null&&at.version<ct.version&&nt(ot)}else nt(ot);return d.get(ot)}return{get:_e,update:tt,getWireframeAttribute:it}}function WebGLIndexedBufferRenderer(o,e,s){let a;function c(at){a=at}let d,b;function _e(at){d=at.type,b=at.bytesPerElement}function tt(at,ct){o.drawElements(a,ct,d,at*b),s.update(ct,a,1)}function nt(at,ct,ut){ut!==0&&(o.drawElementsInstanced(a,ct,d,at*b,ut),s.update(ct,a,ut))}function it(at,ct,ut){if(ut===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(a,ct,0,d,at,0,ut);let dt=0;for(let lt=0;lt<ut;lt++)dt+=ct[lt];s.update(dt,a,1)}function ot(at,ct,ut,ft){if(ut===0)return;const dt=e.get("WEBGL_multi_draw");if(dt===null)for(let lt=0;lt<at.length;lt++)nt(at[lt]/b,ct[lt],ft[lt]);else{dt.multiDrawElementsInstancedWEBGL(a,ct,0,d,at,0,ft,0,ut);let lt=0;for(let ht=0;ht<ut;ht++)lt+=ct[ht]*ft[ht];s.update(lt,a,1)}}this.setMode=c,this.setIndex=_e,this.render=tt,this.renderInstances=nt,this.renderMultiDraw=it,this.renderMultiDrawInstances=ot}function WebGLInfo(o){const e={geometries:0,textures:0},s={frame:0,calls:0,triangles:0,points:0,lines:0};function a(d,b,_e){switch(s.calls++,b){case o.TRIANGLES:s.triangles+=_e*(d/3);break;case o.LINES:s.lines+=_e*(d/2);break;case o.LINE_STRIP:s.lines+=_e*(d-1);break;case o.LINE_LOOP:s.lines+=_e*d;break;case o.POINTS:s.points+=_e*d;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",b);break}}function c(){s.calls=0,s.triangles=0,s.points=0,s.lines=0}return{memory:e,render:s,programs:null,autoReset:!0,reset:c,update:a}}function WebGLMorphtargets(o,e,s){const a=new WeakMap,c=new Vector4;function d(b,_e,tt){const nt=b.morphTargetInfluences,it=_e.morphAttributes.position||_e.morphAttributes.normal||_e.morphAttributes.color,ot=it!==void 0?it.length:0;let at=a.get(_e);if(at===void 0||at.count!==ot){let vt=function(){Et.dispose(),a.delete(_e),_e.removeEventListener("dispose",vt)};var ct=vt;at!==void 0&&at.texture.dispose();const ut=_e.morphAttributes.position!==void 0,ft=_e.morphAttributes.normal!==void 0,dt=_e.morphAttributes.color!==void 0,lt=_e.morphAttributes.position||[],ht=_e.morphAttributes.normal||[],mt=_e.morphAttributes.color||[];let xt=0;ut===!0&&(xt=1),ft===!0&&(xt=2),dt===!0&&(xt=3);let St=_e.attributes.position.count*xt,yt=1;St>e.maxTextureSize&&(yt=Math.ceil(St/e.maxTextureSize),St=e.maxTextureSize);const wt=new Float32Array(St*yt*4*ot),Et=new DataArrayTexture(wt,St,yt,ot);Et.type=FloatType,Et.needsUpdate=!0;const _t=xt*4;for(let Mt=0;Mt<ot;Mt++){const jt=lt[Mt],Lt=ht[Mt],Nt=mt[Mt],kt=St*yt*4*Mt;for(let Ot=0;Ot<jt.count;Ot++){const Ht=Ot*_t;ut===!0&&(c.fromBufferAttribute(jt,Ot),wt[kt+Ht+0]=c.x,wt[kt+Ht+1]=c.y,wt[kt+Ht+2]=c.z,wt[kt+Ht+3]=0),ft===!0&&(c.fromBufferAttribute(Lt,Ot),wt[kt+Ht+4]=c.x,wt[kt+Ht+5]=c.y,wt[kt+Ht+6]=c.z,wt[kt+Ht+7]=0),dt===!0&&(c.fromBufferAttribute(Nt,Ot),wt[kt+Ht+8]=c.x,wt[kt+Ht+9]=c.y,wt[kt+Ht+10]=c.z,wt[kt+Ht+11]=Nt.itemSize===4?c.w:1)}}at={count:ot,texture:Et,size:new Vector2(St,yt)},a.set(_e,at),_e.addEventListener("dispose",vt)}if(b.isInstancedMesh===!0&&b.morphTexture!==null)tt.getUniforms().setValue(o,"morphTexture",b.morphTexture,s);else{let ut=0;for(let dt=0;dt<nt.length;dt++)ut+=nt[dt];const ft=_e.morphTargetsRelative?1:1-ut;tt.getUniforms().setValue(o,"morphTargetBaseInfluence",ft),tt.getUniforms().setValue(o,"morphTargetInfluences",nt)}tt.getUniforms().setValue(o,"morphTargetsTexture",at.texture,s),tt.getUniforms().setValue(o,"morphTargetsTextureSize",at.size)}return{update:d}}function WebGLObjects(o,e,s,a){let c=new WeakMap;function d(tt){const nt=a.render.frame,it=tt.geometry,ot=e.get(tt,it);if(c.get(ot)!==nt&&(e.update(ot),c.set(ot,nt)),tt.isInstancedMesh&&(tt.hasEventListener("dispose",_e)===!1&&tt.addEventListener("dispose",_e),c.get(tt)!==nt&&(s.update(tt.instanceMatrix,o.ARRAY_BUFFER),tt.instanceColor!==null&&s.update(tt.instanceColor,o.ARRAY_BUFFER),c.set(tt,nt))),tt.isSkinnedMesh){const at=tt.skeleton;c.get(at)!==nt&&(at.update(),c.set(at,nt))}return ot}function b(){c=new WeakMap}function _e(tt){const nt=tt.target;nt.removeEventListener("dispose",_e),s.remove(nt.instanceMatrix),nt.instanceColor!==null&&s.remove(nt.instanceColor)}return{update:d,dispose:b}}class DepthTexture extends Texture{constructor(e,s,a,c,d,b,_e,tt,nt,it=DepthFormat){if(it!==DepthFormat&&it!==DepthStencilFormat)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");a===void 0&&it===DepthFormat&&(a=UnsignedIntType),a===void 0&&it===DepthStencilFormat&&(a=UnsignedInt248Type),super(null,c,d,b,_e,tt,it,a,nt),this.isDepthTexture=!0,this.image={width:e,height:s},this.magFilter=_e!==void 0?_e:NearestFilter,this.minFilter=tt!==void 0?tt:NearestFilter,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const s=super.toJSON(e);return this.compareFunction!==null&&(s.compareFunction=this.compareFunction),s}}const emptyTexture=new Texture,emptyShadowTexture=new DepthTexture(1,1),emptyArrayTexture=new DataArrayTexture,empty3dTexture=new Data3DTexture,emptyCubeTexture=new CubeTexture,arrayCacheF32=[],arrayCacheI32=[],mat4array=new Float32Array(16),mat3array=new Float32Array(9),mat2array=new Float32Array(4);function flatten(o,e,s){const a=o[0];if(a<=0||a>0)return o;const c=e*s;let d=arrayCacheF32[c];if(d===void 0&&(d=new Float32Array(c),arrayCacheF32[c]=d),e!==0){a.toArray(d,0);for(let b=1,_e=0;b!==e;++b)_e+=s,o[b].toArray(d,_e)}return d}function arraysEqual(o,e){if(o.length!==e.length)return!1;for(let s=0,a=o.length;s<a;s++)if(o[s]!==e[s])return!1;return!0}function copyArray(o,e){for(let s=0,a=e.length;s<a;s++)o[s]=e[s]}function allocTexUnits(o,e){let s=arrayCacheI32[e];s===void 0&&(s=new Int32Array(e),arrayCacheI32[e]=s);for(let a=0;a!==e;++a)s[a]=o.allocateTextureUnit();return s}function setValueV1f(o,e){const s=this.cache;s[0]!==e&&(o.uniform1f(this.addr,e),s[0]=e)}function setValueV2f(o,e){const s=this.cache;if(e.x!==void 0)(s[0]!==e.x||s[1]!==e.y)&&(o.uniform2f(this.addr,e.x,e.y),s[0]=e.x,s[1]=e.y);else{if(arraysEqual(s,e))return;o.uniform2fv(this.addr,e),copyArray(s,e)}}function setValueV3f(o,e){const s=this.cache;if(e.x!==void 0)(s[0]!==e.x||s[1]!==e.y||s[2]!==e.z)&&(o.uniform3f(this.addr,e.x,e.y,e.z),s[0]=e.x,s[1]=e.y,s[2]=e.z);else if(e.r!==void 0)(s[0]!==e.r||s[1]!==e.g||s[2]!==e.b)&&(o.uniform3f(this.addr,e.r,e.g,e.b),s[0]=e.r,s[1]=e.g,s[2]=e.b);else{if(arraysEqual(s,e))return;o.uniform3fv(this.addr,e),copyArray(s,e)}}function setValueV4f(o,e){const s=this.cache;if(e.x!==void 0)(s[0]!==e.x||s[1]!==e.y||s[2]!==e.z||s[3]!==e.w)&&(o.uniform4f(this.addr,e.x,e.y,e.z,e.w),s[0]=e.x,s[1]=e.y,s[2]=e.z,s[3]=e.w);else{if(arraysEqual(s,e))return;o.uniform4fv(this.addr,e),copyArray(s,e)}}function setValueM2(o,e){const s=this.cache,a=e.elements;if(a===void 0){if(arraysEqual(s,e))return;o.uniformMatrix2fv(this.addr,!1,e),copyArray(s,e)}else{if(arraysEqual(s,a))return;mat2array.set(a),o.uniformMatrix2fv(this.addr,!1,mat2array),copyArray(s,a)}}function setValueM3(o,e){const s=this.cache,a=e.elements;if(a===void 0){if(arraysEqual(s,e))return;o.uniformMatrix3fv(this.addr,!1,e),copyArray(s,e)}else{if(arraysEqual(s,a))return;mat3array.set(a),o.uniformMatrix3fv(this.addr,!1,mat3array),copyArray(s,a)}}function setValueM4(o,e){const s=this.cache,a=e.elements;if(a===void 0){if(arraysEqual(s,e))return;o.uniformMatrix4fv(this.addr,!1,e),copyArray(s,e)}else{if(arraysEqual(s,a))return;mat4array.set(a),o.uniformMatrix4fv(this.addr,!1,mat4array),copyArray(s,a)}}function setValueV1i(o,e){const s=this.cache;s[0]!==e&&(o.uniform1i(this.addr,e),s[0]=e)}function setValueV2i(o,e){const s=this.cache;if(e.x!==void 0)(s[0]!==e.x||s[1]!==e.y)&&(o.uniform2i(this.addr,e.x,e.y),s[0]=e.x,s[1]=e.y);else{if(arraysEqual(s,e))return;o.uniform2iv(this.addr,e),copyArray(s,e)}}function setValueV3i(o,e){const s=this.cache;if(e.x!==void 0)(s[0]!==e.x||s[1]!==e.y||s[2]!==e.z)&&(o.uniform3i(this.addr,e.x,e.y,e.z),s[0]=e.x,s[1]=e.y,s[2]=e.z);else{if(arraysEqual(s,e))return;o.uniform3iv(this.addr,e),copyArray(s,e)}}function setValueV4i(o,e){const s=this.cache;if(e.x!==void 0)(s[0]!==e.x||s[1]!==e.y||s[2]!==e.z||s[3]!==e.w)&&(o.uniform4i(this.addr,e.x,e.y,e.z,e.w),s[0]=e.x,s[1]=e.y,s[2]=e.z,s[3]=e.w);else{if(arraysEqual(s,e))return;o.uniform4iv(this.addr,e),copyArray(s,e)}}function setValueV1ui(o,e){const s=this.cache;s[0]!==e&&(o.uniform1ui(this.addr,e),s[0]=e)}function setValueV2ui(o,e){const s=this.cache;if(e.x!==void 0)(s[0]!==e.x||s[1]!==e.y)&&(o.uniform2ui(this.addr,e.x,e.y),s[0]=e.x,s[1]=e.y);else{if(arraysEqual(s,e))return;o.uniform2uiv(this.addr,e),copyArray(s,e)}}function setValueV3ui(o,e){const s=this.cache;if(e.x!==void 0)(s[0]!==e.x||s[1]!==e.y||s[2]!==e.z)&&(o.uniform3ui(this.addr,e.x,e.y,e.z),s[0]=e.x,s[1]=e.y,s[2]=e.z);else{if(arraysEqual(s,e))return;o.uniform3uiv(this.addr,e),copyArray(s,e)}}function setValueV4ui(o,e){const s=this.cache;if(e.x!==void 0)(s[0]!==e.x||s[1]!==e.y||s[2]!==e.z||s[3]!==e.w)&&(o.uniform4ui(this.addr,e.x,e.y,e.z,e.w),s[0]=e.x,s[1]=e.y,s[2]=e.z,s[3]=e.w);else{if(arraysEqual(s,e))return;o.uniform4uiv(this.addr,e),copyArray(s,e)}}function setValueT1(o,e,s){const a=this.cache,c=s.allocateTextureUnit();a[0]!==c&&(o.uniform1i(this.addr,c),a[0]=c);let d;this.type===o.SAMPLER_2D_SHADOW?(emptyShadowTexture.compareFunction=LessEqualCompare,d=emptyShadowTexture):d=emptyTexture,s.setTexture2D(e||d,c)}function setValueT3D1(o,e,s){const a=this.cache,c=s.allocateTextureUnit();a[0]!==c&&(o.uniform1i(this.addr,c),a[0]=c),s.setTexture3D(e||empty3dTexture,c)}function setValueT6(o,e,s){const a=this.cache,c=s.allocateTextureUnit();a[0]!==c&&(o.uniform1i(this.addr,c),a[0]=c),s.setTextureCube(e||emptyCubeTexture,c)}function setValueT2DArray1(o,e,s){const a=this.cache,c=s.allocateTextureUnit();a[0]!==c&&(o.uniform1i(this.addr,c),a[0]=c),s.setTexture2DArray(e||emptyArrayTexture,c)}function getSingularSetter(o){switch(o){case 5126:return setValueV1f;case 35664:return setValueV2f;case 35665:return setValueV3f;case 35666:return setValueV4f;case 35674:return setValueM2;case 35675:return setValueM3;case 35676:return setValueM4;case 5124:case 35670:return setValueV1i;case 35667:case 35671:return setValueV2i;case 35668:case 35672:return setValueV3i;case 35669:case 35673:return setValueV4i;case 5125:return setValueV1ui;case 36294:return setValueV2ui;case 36295:return setValueV3ui;case 36296:return setValueV4ui;case 35678:case 36198:case 36298:case 36306:case 35682:return setValueT1;case 35679:case 36299:case 36307:return setValueT3D1;case 35680:case 36300:case 36308:case 36293:return setValueT6;case 36289:case 36303:case 36311:case 36292:return setValueT2DArray1}}function setValueV1fArray(o,e){o.uniform1fv(this.addr,e)}function setValueV2fArray(o,e){const s=flatten(e,this.size,2);o.uniform2fv(this.addr,s)}function setValueV3fArray(o,e){const s=flatten(e,this.size,3);o.uniform3fv(this.addr,s)}function setValueV4fArray(o,e){const s=flatten(e,this.size,4);o.uniform4fv(this.addr,s)}function setValueM2Array(o,e){const s=flatten(e,this.size,4);o.uniformMatrix2fv(this.addr,!1,s)}function setValueM3Array(o,e){const s=flatten(e,this.size,9);o.uniformMatrix3fv(this.addr,!1,s)}function setValueM4Array(o,e){const s=flatten(e,this.size,16);o.uniformMatrix4fv(this.addr,!1,s)}function setValueV1iArray(o,e){o.uniform1iv(this.addr,e)}function setValueV2iArray(o,e){o.uniform2iv(this.addr,e)}function setValueV3iArray(o,e){o.uniform3iv(this.addr,e)}function setValueV4iArray(o,e){o.uniform4iv(this.addr,e)}function setValueV1uiArray(o,e){o.uniform1uiv(this.addr,e)}function setValueV2uiArray(o,e){o.uniform2uiv(this.addr,e)}function setValueV3uiArray(o,e){o.uniform3uiv(this.addr,e)}function setValueV4uiArray(o,e){o.uniform4uiv(this.addr,e)}function setValueT1Array(o,e,s){const a=this.cache,c=e.length,d=allocTexUnits(s,c);arraysEqual(a,d)||(o.uniform1iv(this.addr,d),copyArray(a,d));for(let b=0;b!==c;++b)s.setTexture2D(e[b]||emptyTexture,d[b])}function setValueT3DArray(o,e,s){const a=this.cache,c=e.length,d=allocTexUnits(s,c);arraysEqual(a,d)||(o.uniform1iv(this.addr,d),copyArray(a,d));for(let b=0;b!==c;++b)s.setTexture3D(e[b]||empty3dTexture,d[b])}function setValueT6Array(o,e,s){const a=this.cache,c=e.length,d=allocTexUnits(s,c);arraysEqual(a,d)||(o.uniform1iv(this.addr,d),copyArray(a,d));for(let b=0;b!==c;++b)s.setTextureCube(e[b]||emptyCubeTexture,d[b])}function setValueT2DArrayArray(o,e,s){const a=this.cache,c=e.length,d=allocTexUnits(s,c);arraysEqual(a,d)||(o.uniform1iv(this.addr,d),copyArray(a,d));for(let b=0;b!==c;++b)s.setTexture2DArray(e[b]||emptyArrayTexture,d[b])}function getPureArraySetter(o){switch(o){case 5126:return setValueV1fArray;case 35664:return setValueV2fArray;case 35665:return setValueV3fArray;case 35666:return setValueV4fArray;case 35674:return setValueM2Array;case 35675:return setValueM3Array;case 35676:return setValueM4Array;case 5124:case 35670:return setValueV1iArray;case 35667:case 35671:return setValueV2iArray;case 35668:case 35672:return setValueV3iArray;case 35669:case 35673:return setValueV4iArray;case 5125:return setValueV1uiArray;case 36294:return setValueV2uiArray;case 36295:return setValueV3uiArray;case 36296:return setValueV4uiArray;case 35678:case 36198:case 36298:case 36306:case 35682:return setValueT1Array;case 35679:case 36299:case 36307:return setValueT3DArray;case 35680:case 36300:case 36308:case 36293:return setValueT6Array;case 36289:case 36303:case 36311:case 36292:return setValueT2DArrayArray}}class SingleUniform{constructor(e,s,a){this.id=e,this.addr=a,this.cache=[],this.type=s.type,this.setValue=getSingularSetter(s.type)}}class PureArrayUniform{constructor(e,s,a){this.id=e,this.addr=a,this.cache=[],this.type=s.type,this.size=s.size,this.setValue=getPureArraySetter(s.type)}}class StructuredUniform{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,s,a){const c=this.seq;for(let d=0,b=c.length;d!==b;++d){const _e=c[d];_e.setValue(e,s[_e.id],a)}}}const RePathPart=/(\w+)(\])?(\[|\.)?/g;function addUniform(o,e){o.seq.push(e),o.map[e.id]=e}function parseUniform(o,e,s){const a=o.name,c=a.length;for(RePathPart.lastIndex=0;;){const d=RePathPart.exec(a),b=RePathPart.lastIndex;let _e=d[1];const tt=d[2]==="]",nt=d[3];if(tt&&(_e=_e|0),nt===void 0||nt==="["&&b+2===c){addUniform(s,nt===void 0?new SingleUniform(_e,o,e):new PureArrayUniform(_e,o,e));break}else{let ot=s.map[_e];ot===void 0&&(ot=new StructuredUniform(_e),addUniform(s,ot)),s=ot}}}class WebGLUniforms{constructor(e,s){this.seq=[],this.map={};const a=e.getProgramParameter(s,e.ACTIVE_UNIFORMS);for(let c=0;c<a;++c){const d=e.getActiveUniform(s,c),b=e.getUniformLocation(s,d.name);parseUniform(d,b,this)}}setValue(e,s,a,c){const d=this.map[s];d!==void 0&&d.setValue(e,a,c)}setOptional(e,s,a){const c=s[a];c!==void 0&&this.setValue(e,a,c)}static upload(e,s,a,c){for(let d=0,b=s.length;d!==b;++d){const _e=s[d],tt=a[_e.id];tt.needsUpdate!==!1&&_e.setValue(e,tt.value,c)}}static seqWithValue(e,s){const a=[];for(let c=0,d=e.length;c!==d;++c){const b=e[c];b.id in s&&a.push(b)}return a}}function WebGLShader(o,e,s){const a=o.createShader(e);return o.shaderSource(a,s),o.compileShader(a),a}const COMPLETION_STATUS_KHR=37297;let programIdCount=0;function handleSource(o,e){const s=o.split(`
`),a=[],c=Math.max(e-6,0),d=Math.min(e+6,s.length);for(let b=c;b<d;b++){const _e=b+1;a.push(`${_e===e?">":" "} ${_e}: ${s[b]}`)}return a.join(`
`)}const _m0=new Matrix3;function getEncodingComponents(o){ColorManagement._getMatrix(_m0,ColorManagement.workingColorSpace,o);const e=`mat3( ${_m0.elements.map(s=>s.toFixed(4))} )`;switch(ColorManagement.getTransfer(o)){case LinearTransfer:return[e,"LinearTransferOETF"];case SRGBTransfer:return[e,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space: ",o),[e,"LinearTransferOETF"]}}function getShaderErrors(o,e,s){const a=o.getShaderParameter(e,o.COMPILE_STATUS),c=o.getShaderInfoLog(e).trim();if(a&&c==="")return"";const d=/ERROR: 0:(\d+)/.exec(c);if(d){const b=parseInt(d[1]);return s.toUpperCase()+`

`+c+`

`+handleSource(o.getShaderSource(e),b)}else return c}function getTexelEncodingFunction(o,e){const s=getEncodingComponents(e);return[`vec4 ${o}( vec4 value ) {`,`	return ${s[1]}( vec4( value.rgb * ${s[0]}, value.a ) );`,"}"].join(`
`)}function getToneMappingFunction(o,e){let s;switch(e){case LinearToneMapping:s="Linear";break;case ReinhardToneMapping:s="Reinhard";break;case CineonToneMapping:s="Cineon";break;case ACESFilmicToneMapping:s="ACESFilmic";break;case AgXToneMapping:s="AgX";break;case NeutralToneMapping:s="Neutral";break;case CustomToneMapping:s="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),s="Linear"}return"vec3 "+o+"( vec3 color ) { return "+s+"ToneMapping( color ); }"}const _v0$1=new Vector3;function getLuminanceFunction(){ColorManagement.getLuminanceCoefficients(_v0$1);const o=_v0$1.x.toFixed(4),e=_v0$1.y.toFixed(4),s=_v0$1.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${o}, ${e}, ${s} );`,"	return dot( weights, rgb );","}"].join(`
`)}function generateVertexExtensions(o){return[o.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",o.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(filterEmptyLine).join(`
`)}function generateDefines(o){const e=[];for(const s in o){const a=o[s];a!==!1&&e.push("#define "+s+" "+a)}return e.join(`
`)}function fetchAttributeLocations(o,e){const s={},a=o.getProgramParameter(e,o.ACTIVE_ATTRIBUTES);for(let c=0;c<a;c++){const d=o.getActiveAttrib(e,c),b=d.name;let _e=1;d.type===o.FLOAT_MAT2&&(_e=2),d.type===o.FLOAT_MAT3&&(_e=3),d.type===o.FLOAT_MAT4&&(_e=4),s[b]={type:d.type,location:o.getAttribLocation(e,b),locationSize:_e}}return s}function filterEmptyLine(o){return o!==""}function replaceLightNums(o,e){const s=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return o.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,s).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function replaceClippingPlaneNums(o,e){return o.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const includePattern=/^[ \t]*#include +<([\w\d./]+)>/gm;function resolveIncludes(o){return o.replace(includePattern,includeReplacer)}const shaderChunkMap=new Map;function includeReplacer(o,e){let s=ShaderChunk[e];if(s===void 0){const a=shaderChunkMap.get(e);if(a!==void 0)s=ShaderChunk[a],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,a);else throw new Error("Can not resolve #include <"+e+">")}return resolveIncludes(s)}const unrollLoopPattern=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function unrollLoops(o){return o.replace(unrollLoopPattern,loopReplacer)}function loopReplacer(o,e,s,a){let c="";for(let d=parseInt(e);d<parseInt(s);d++)c+=a.replace(/\[\s*i\s*\]/g,"[ "+d+" ]").replace(/UNROLLED_LOOP_INDEX/g,d);return c}function generatePrecision(o){let e=`precision ${o.precision} float;
	precision ${o.precision} int;
	precision ${o.precision} sampler2D;
	precision ${o.precision} samplerCube;
	precision ${o.precision} sampler3D;
	precision ${o.precision} sampler2DArray;
	precision ${o.precision} sampler2DShadow;
	precision ${o.precision} samplerCubeShadow;
	precision ${o.precision} sampler2DArrayShadow;
	precision ${o.precision} isampler2D;
	precision ${o.precision} isampler3D;
	precision ${o.precision} isamplerCube;
	precision ${o.precision} isampler2DArray;
	precision ${o.precision} usampler2D;
	precision ${o.precision} usampler3D;
	precision ${o.precision} usamplerCube;
	precision ${o.precision} usampler2DArray;
	`;return o.precision==="highp"?e+=`
#define HIGH_PRECISION`:o.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:o.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function generateShadowMapTypeDefine(o){let e="SHADOWMAP_TYPE_BASIC";return o.shadowMapType===PCFShadowMap?e="SHADOWMAP_TYPE_PCF":o.shadowMapType===PCFSoftShadowMap?e="SHADOWMAP_TYPE_PCF_SOFT":o.shadowMapType===VSMShadowMap&&(e="SHADOWMAP_TYPE_VSM"),e}function generateEnvMapTypeDefine(o){let e="ENVMAP_TYPE_CUBE";if(o.envMap)switch(o.envMapMode){case CubeReflectionMapping:case CubeRefractionMapping:e="ENVMAP_TYPE_CUBE";break;case CubeUVReflectionMapping:e="ENVMAP_TYPE_CUBE_UV";break}return e}function generateEnvMapModeDefine(o){let e="ENVMAP_MODE_REFLECTION";if(o.envMap)switch(o.envMapMode){case CubeRefractionMapping:e="ENVMAP_MODE_REFRACTION";break}return e}function generateEnvMapBlendingDefine(o){let e="ENVMAP_BLENDING_NONE";if(o.envMap)switch(o.combine){case MultiplyOperation:e="ENVMAP_BLENDING_MULTIPLY";break;case MixOperation:e="ENVMAP_BLENDING_MIX";break;case AddOperation:e="ENVMAP_BLENDING_ADD";break}return e}function generateCubeUVSize(o){const e=o.envMapCubeUVHeight;if(e===null)return null;const s=Math.log2(e)-2,a=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,s),7*16)),texelHeight:a,maxMip:s}}function WebGLProgram(o,e,s,a){const c=o.getContext(),d=s.defines;let b=s.vertexShader,_e=s.fragmentShader;const tt=generateShadowMapTypeDefine(s),nt=generateEnvMapTypeDefine(s),it=generateEnvMapModeDefine(s),ot=generateEnvMapBlendingDefine(s),at=generateCubeUVSize(s),ct=generateVertexExtensions(s),ut=generateDefines(d),ft=c.createProgram();let dt,lt,ht=s.glslVersion?"#version "+s.glslVersion+`
`:"";s.isRawShaderMaterial?(dt=["#define SHADER_TYPE "+s.shaderType,"#define SHADER_NAME "+s.shaderName,ut].filter(filterEmptyLine).join(`
`),dt.length>0&&(dt+=`
`),lt=["#define SHADER_TYPE "+s.shaderType,"#define SHADER_NAME "+s.shaderName,ut].filter(filterEmptyLine).join(`
`),lt.length>0&&(lt+=`
`)):(dt=[generatePrecision(s),"#define SHADER_TYPE "+s.shaderType,"#define SHADER_NAME "+s.shaderName,ut,s.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",s.batching?"#define USE_BATCHING":"",s.batchingColor?"#define USE_BATCHING_COLOR":"",s.instancing?"#define USE_INSTANCING":"",s.instancingColor?"#define USE_INSTANCING_COLOR":"",s.instancingMorph?"#define USE_INSTANCING_MORPH":"",s.useFog&&s.fog?"#define USE_FOG":"",s.useFog&&s.fogExp2?"#define FOG_EXP2":"",s.map?"#define USE_MAP":"",s.envMap?"#define USE_ENVMAP":"",s.envMap?"#define "+it:"",s.lightMap?"#define USE_LIGHTMAP":"",s.aoMap?"#define USE_AOMAP":"",s.bumpMap?"#define USE_BUMPMAP":"",s.normalMap?"#define USE_NORMALMAP":"",s.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",s.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",s.displacementMap?"#define USE_DISPLACEMENTMAP":"",s.emissiveMap?"#define USE_EMISSIVEMAP":"",s.anisotropy?"#define USE_ANISOTROPY":"",s.anisotropyMap?"#define USE_ANISOTROPYMAP":"",s.clearcoatMap?"#define USE_CLEARCOATMAP":"",s.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",s.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",s.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",s.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",s.specularMap?"#define USE_SPECULARMAP":"",s.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",s.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",s.roughnessMap?"#define USE_ROUGHNESSMAP":"",s.metalnessMap?"#define USE_METALNESSMAP":"",s.alphaMap?"#define USE_ALPHAMAP":"",s.alphaHash?"#define USE_ALPHAHASH":"",s.transmission?"#define USE_TRANSMISSION":"",s.transmissionMap?"#define USE_TRANSMISSIONMAP":"",s.thicknessMap?"#define USE_THICKNESSMAP":"",s.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",s.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",s.mapUv?"#define MAP_UV "+s.mapUv:"",s.alphaMapUv?"#define ALPHAMAP_UV "+s.alphaMapUv:"",s.lightMapUv?"#define LIGHTMAP_UV "+s.lightMapUv:"",s.aoMapUv?"#define AOMAP_UV "+s.aoMapUv:"",s.emissiveMapUv?"#define EMISSIVEMAP_UV "+s.emissiveMapUv:"",s.bumpMapUv?"#define BUMPMAP_UV "+s.bumpMapUv:"",s.normalMapUv?"#define NORMALMAP_UV "+s.normalMapUv:"",s.displacementMapUv?"#define DISPLACEMENTMAP_UV "+s.displacementMapUv:"",s.metalnessMapUv?"#define METALNESSMAP_UV "+s.metalnessMapUv:"",s.roughnessMapUv?"#define ROUGHNESSMAP_UV "+s.roughnessMapUv:"",s.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+s.anisotropyMapUv:"",s.clearcoatMapUv?"#define CLEARCOATMAP_UV "+s.clearcoatMapUv:"",s.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+s.clearcoatNormalMapUv:"",s.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+s.clearcoatRoughnessMapUv:"",s.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+s.iridescenceMapUv:"",s.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+s.iridescenceThicknessMapUv:"",s.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+s.sheenColorMapUv:"",s.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+s.sheenRoughnessMapUv:"",s.specularMapUv?"#define SPECULARMAP_UV "+s.specularMapUv:"",s.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+s.specularColorMapUv:"",s.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+s.specularIntensityMapUv:"",s.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+s.transmissionMapUv:"",s.thicknessMapUv?"#define THICKNESSMAP_UV "+s.thicknessMapUv:"",s.vertexTangents&&s.flatShading===!1?"#define USE_TANGENT":"",s.vertexColors?"#define USE_COLOR":"",s.vertexAlphas?"#define USE_COLOR_ALPHA":"",s.vertexUv1s?"#define USE_UV1":"",s.vertexUv2s?"#define USE_UV2":"",s.vertexUv3s?"#define USE_UV3":"",s.pointsUvs?"#define USE_POINTS_UV":"",s.flatShading?"#define FLAT_SHADED":"",s.skinning?"#define USE_SKINNING":"",s.morphTargets?"#define USE_MORPHTARGETS":"",s.morphNormals&&s.flatShading===!1?"#define USE_MORPHNORMALS":"",s.morphColors?"#define USE_MORPHCOLORS":"",s.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+s.morphTextureStride:"",s.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+s.morphTargetsCount:"",s.doubleSided?"#define DOUBLE_SIDED":"",s.flipSided?"#define FLIP_SIDED":"",s.shadowMapEnabled?"#define USE_SHADOWMAP":"",s.shadowMapEnabled?"#define "+tt:"",s.sizeAttenuation?"#define USE_SIZEATTENUATION":"",s.numLightProbes>0?"#define USE_LIGHT_PROBES":"",s.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",s.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(filterEmptyLine).join(`
`),lt=[generatePrecision(s),"#define SHADER_TYPE "+s.shaderType,"#define SHADER_NAME "+s.shaderName,ut,s.useFog&&s.fog?"#define USE_FOG":"",s.useFog&&s.fogExp2?"#define FOG_EXP2":"",s.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",s.map?"#define USE_MAP":"",s.matcap?"#define USE_MATCAP":"",s.envMap?"#define USE_ENVMAP":"",s.envMap?"#define "+nt:"",s.envMap?"#define "+it:"",s.envMap?"#define "+ot:"",at?"#define CUBEUV_TEXEL_WIDTH "+at.texelWidth:"",at?"#define CUBEUV_TEXEL_HEIGHT "+at.texelHeight:"",at?"#define CUBEUV_MAX_MIP "+at.maxMip+".0":"",s.lightMap?"#define USE_LIGHTMAP":"",s.aoMap?"#define USE_AOMAP":"",s.bumpMap?"#define USE_BUMPMAP":"",s.normalMap?"#define USE_NORMALMAP":"",s.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",s.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",s.emissiveMap?"#define USE_EMISSIVEMAP":"",s.anisotropy?"#define USE_ANISOTROPY":"",s.anisotropyMap?"#define USE_ANISOTROPYMAP":"",s.clearcoat?"#define USE_CLEARCOAT":"",s.clearcoatMap?"#define USE_CLEARCOATMAP":"",s.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",s.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",s.dispersion?"#define USE_DISPERSION":"",s.iridescence?"#define USE_IRIDESCENCE":"",s.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",s.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",s.specularMap?"#define USE_SPECULARMAP":"",s.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",s.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",s.roughnessMap?"#define USE_ROUGHNESSMAP":"",s.metalnessMap?"#define USE_METALNESSMAP":"",s.alphaMap?"#define USE_ALPHAMAP":"",s.alphaTest?"#define USE_ALPHATEST":"",s.alphaHash?"#define USE_ALPHAHASH":"",s.sheen?"#define USE_SHEEN":"",s.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",s.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",s.transmission?"#define USE_TRANSMISSION":"",s.transmissionMap?"#define USE_TRANSMISSIONMAP":"",s.thicknessMap?"#define USE_THICKNESSMAP":"",s.vertexTangents&&s.flatShading===!1?"#define USE_TANGENT":"",s.vertexColors||s.instancingColor||s.batchingColor?"#define USE_COLOR":"",s.vertexAlphas?"#define USE_COLOR_ALPHA":"",s.vertexUv1s?"#define USE_UV1":"",s.vertexUv2s?"#define USE_UV2":"",s.vertexUv3s?"#define USE_UV3":"",s.pointsUvs?"#define USE_POINTS_UV":"",s.gradientMap?"#define USE_GRADIENTMAP":"",s.flatShading?"#define FLAT_SHADED":"",s.doubleSided?"#define DOUBLE_SIDED":"",s.flipSided?"#define FLIP_SIDED":"",s.shadowMapEnabled?"#define USE_SHADOWMAP":"",s.shadowMapEnabled?"#define "+tt:"",s.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",s.numLightProbes>0?"#define USE_LIGHT_PROBES":"",s.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",s.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",s.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",s.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",s.toneMapping!==NoToneMapping?"#define TONE_MAPPING":"",s.toneMapping!==NoToneMapping?ShaderChunk.tonemapping_pars_fragment:"",s.toneMapping!==NoToneMapping?getToneMappingFunction("toneMapping",s.toneMapping):"",s.dithering?"#define DITHERING":"",s.opaque?"#define OPAQUE":"",ShaderChunk.colorspace_pars_fragment,getTexelEncodingFunction("linearToOutputTexel",s.outputColorSpace),getLuminanceFunction(),s.useDepthPacking?"#define DEPTH_PACKING "+s.depthPacking:"",`
`].filter(filterEmptyLine).join(`
`)),b=resolveIncludes(b),b=replaceLightNums(b,s),b=replaceClippingPlaneNums(b,s),_e=resolveIncludes(_e),_e=replaceLightNums(_e,s),_e=replaceClippingPlaneNums(_e,s),b=unrollLoops(b),_e=unrollLoops(_e),s.isRawShaderMaterial!==!0&&(ht=`#version 300 es
`,dt=[ct,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+dt,lt=["#define varying in",s.glslVersion===GLSL3?"":"layout(location = 0) out highp vec4 pc_fragColor;",s.glslVersion===GLSL3?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+lt);const mt=ht+dt+b,xt=ht+lt+_e,St=WebGLShader(c,c.VERTEX_SHADER,mt),yt=WebGLShader(c,c.FRAGMENT_SHADER,xt);c.attachShader(ft,St),c.attachShader(ft,yt),s.index0AttributeName!==void 0?c.bindAttribLocation(ft,0,s.index0AttributeName):s.morphTargets===!0&&c.bindAttribLocation(ft,0,"position"),c.linkProgram(ft);function wt(Mt){if(o.debug.checkShaderErrors){const jt=c.getProgramInfoLog(ft).trim(),Lt=c.getShaderInfoLog(St).trim(),Nt=c.getShaderInfoLog(yt).trim();let kt=!0,Ot=!0;if(c.getProgramParameter(ft,c.LINK_STATUS)===!1)if(kt=!1,typeof o.debug.onShaderError=="function")o.debug.onShaderError(c,ft,St,yt);else{const Ht=getShaderErrors(c,St,"vertex"),Ct=getShaderErrors(c,yt,"fragment");console.error("THREE.WebGLProgram: Shader Error "+c.getError()+" - VALIDATE_STATUS "+c.getProgramParameter(ft,c.VALIDATE_STATUS)+`

Material Name: `+Mt.name+`
Material Type: `+Mt.type+`

Program Info Log: `+jt+`
`+Ht+`
`+Ct)}else jt!==""?console.warn("THREE.WebGLProgram: Program Info Log:",jt):(Lt===""||Nt==="")&&(Ot=!1);Ot&&(Mt.diagnostics={runnable:kt,programLog:jt,vertexShader:{log:Lt,prefix:dt},fragmentShader:{log:Nt,prefix:lt}})}c.deleteShader(St),c.deleteShader(yt),Et=new WebGLUniforms(c,ft),_t=fetchAttributeLocations(c,ft)}let Et;this.getUniforms=function(){return Et===void 0&&wt(this),Et};let _t;this.getAttributes=function(){return _t===void 0&&wt(this),_t};let vt=s.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return vt===!1&&(vt=c.getProgramParameter(ft,COMPLETION_STATUS_KHR)),vt},this.destroy=function(){a.releaseStatesOfProgram(this),c.deleteProgram(ft),this.program=void 0},this.type=s.shaderType,this.name=s.shaderName,this.id=programIdCount++,this.cacheKey=e,this.usedTimes=1,this.program=ft,this.vertexShader=St,this.fragmentShader=yt,this}let _id$1=0;class WebGLShaderCache{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const s=e.vertexShader,a=e.fragmentShader,c=this._getShaderStage(s),d=this._getShaderStage(a),b=this._getShaderCacheForMaterial(e);return b.has(c)===!1&&(b.add(c),c.usedTimes++),b.has(d)===!1&&(b.add(d),d.usedTimes++),this}remove(e){const s=this.materialCache.get(e);for(const a of s)a.usedTimes--,a.usedTimes===0&&this.shaderCache.delete(a.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const s=this.materialCache;let a=s.get(e);return a===void 0&&(a=new Set,s.set(e,a)),a}_getShaderStage(e){const s=this.shaderCache;let a=s.get(e);return a===void 0&&(a=new WebGLShaderStage(e),s.set(e,a)),a}}class WebGLShaderStage{constructor(e){this.id=_id$1++,this.code=e,this.usedTimes=0}}function WebGLPrograms(o,e,s,a,c,d,b){const _e=new Layers,tt=new WebGLShaderCache,nt=new Set,it=[],ot=c.logarithmicDepthBuffer,at=c.vertexTextures;let ct=c.precision;const ut={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function ft(_t){return nt.add(_t),_t===0?"uv":`uv${_t}`}function dt(_t,vt,Mt,jt,Lt){const Nt=jt.fog,kt=Lt.geometry,Ot=_t.isMeshStandardMaterial?jt.environment:null,Ht=(_t.isMeshStandardMaterial?s:e).get(_t.envMap||Ot),Ct=Ht&&Ht.mapping===CubeUVReflectionMapping?Ht.image.height:null,Ut=ut[_t.type];_t.precision!==null&&(ct=c.getMaxPrecision(_t.precision),ct!==_t.precision&&console.warn("THREE.WebGLProgram.getParameters:",_t.precision,"not supported, using",ct,"instead."));const Gt=kt.morphAttributes.position||kt.morphAttributes.normal||kt.morphAttributes.color,Pt=Gt!==void 0?Gt.length:0;let Wt=0;kt.morphAttributes.position!==void 0&&(Wt=1),kt.morphAttributes.normal!==void 0&&(Wt=2),kt.morphAttributes.color!==void 0&&(Wt=3);let sn,Bt,tn,cn;if(Ut){const yr=ShaderLib[Ut];sn=yr.vertexShader,Bt=yr.fragmentShader}else sn=_t.vertexShader,Bt=_t.fragmentShader,tt.update(_t),tn=tt.getVertexShaderID(_t),cn=tt.getFragmentShaderID(_t);const vn=o.getRenderTarget(),On=o.state.buffers.depth.getReversed(),rr=Lt.isInstancedMesh===!0,Wn=Lt.isBatchedMesh===!0,Bn=!!_t.map,gn=!!_t.matcap,bn=!!Ht,Kt=!!_t.aoMap,Jn=!!_t.lightMap,Cn=!!_t.bumpMap,kn=!!_t.normalMap,Nn=!!_t.displacementMap,ir=!!_t.emissiveMap,Un=!!_t.metalnessMap,zt=!!_t.roughnessMap,It=_t.anisotropy>0,on=_t.clearcoat>0,xn=_t.dispersion>0,wn=_t.iridescence>0,En=_t.sheen>0,Hn=_t.transmission>0,Fn=It&&!!_t.anisotropyMap,zn=on&&!!_t.clearcoatMap,xr=on&&!!_t.clearcoatNormalMap,Tn=on&&!!_t.clearcoatRoughnessMap,Qn=wn&&!!_t.iridescenceMap,sr=wn&&!!_t.iridescenceThicknessMap,er=En&&!!_t.sheenColorMap,Xn=En&&!!_t.sheenRoughnessMap,qt=!!_t.specularMap,fn=!!_t.specularColorMap,jn=!!_t.specularIntensityMap,Qt=Hn&&!!_t.transmissionMap,an=Hn&&!!_t.thicknessMap,hn=!!_t.gradientMap,_n=!!_t.alphaMap,Vn=_t.alphaTest>0,Gn=!!_t.alphaHash,ur=!!_t.extensions;let Mr=NoToneMapping;_t.toneMapped&&(vn===null||vn.isXRRenderTarget===!0)&&(Mr=o.toneMapping);const Ir={shaderID:Ut,shaderType:_t.type,shaderName:_t.name,vertexShader:sn,fragmentShader:Bt,defines:_t.defines,customVertexShaderID:tn,customFragmentShaderID:cn,isRawShaderMaterial:_t.isRawShaderMaterial===!0,glslVersion:_t.glslVersion,precision:ct,batching:Wn,batchingColor:Wn&&Lt._colorsTexture!==null,instancing:rr,instancingColor:rr&&Lt.instanceColor!==null,instancingMorph:rr&&Lt.morphTexture!==null,supportsVertexTextures:at,outputColorSpace:vn===null?o.outputColorSpace:vn.isXRRenderTarget===!0?vn.texture.colorSpace:LinearSRGBColorSpace$1,alphaToCoverage:!!_t.alphaToCoverage,map:Bn,matcap:gn,envMap:bn,envMapMode:bn&&Ht.mapping,envMapCubeUVHeight:Ct,aoMap:Kt,lightMap:Jn,bumpMap:Cn,normalMap:kn,displacementMap:at&&Nn,emissiveMap:ir,normalMapObjectSpace:kn&&_t.normalMapType===ObjectSpaceNormalMap,normalMapTangentSpace:kn&&_t.normalMapType===TangentSpaceNormalMap,metalnessMap:Un,roughnessMap:zt,anisotropy:It,anisotropyMap:Fn,clearcoat:on,clearcoatMap:zn,clearcoatNormalMap:xr,clearcoatRoughnessMap:Tn,dispersion:xn,iridescence:wn,iridescenceMap:Qn,iridescenceThicknessMap:sr,sheen:En,sheenColorMap:er,sheenRoughnessMap:Xn,specularMap:qt,specularColorMap:fn,specularIntensityMap:jn,transmission:Hn,transmissionMap:Qt,thicknessMap:an,gradientMap:hn,opaque:_t.transparent===!1&&_t.blending===NormalBlending&&_t.alphaToCoverage===!1,alphaMap:_n,alphaTest:Vn,alphaHash:Gn,combine:_t.combine,mapUv:Bn&&ft(_t.map.channel),aoMapUv:Kt&&ft(_t.aoMap.channel),lightMapUv:Jn&&ft(_t.lightMap.channel),bumpMapUv:Cn&&ft(_t.bumpMap.channel),normalMapUv:kn&&ft(_t.normalMap.channel),displacementMapUv:Nn&&ft(_t.displacementMap.channel),emissiveMapUv:ir&&ft(_t.emissiveMap.channel),metalnessMapUv:Un&&ft(_t.metalnessMap.channel),roughnessMapUv:zt&&ft(_t.roughnessMap.channel),anisotropyMapUv:Fn&&ft(_t.anisotropyMap.channel),clearcoatMapUv:zn&&ft(_t.clearcoatMap.channel),clearcoatNormalMapUv:xr&&ft(_t.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:Tn&&ft(_t.clearcoatRoughnessMap.channel),iridescenceMapUv:Qn&&ft(_t.iridescenceMap.channel),iridescenceThicknessMapUv:sr&&ft(_t.iridescenceThicknessMap.channel),sheenColorMapUv:er&&ft(_t.sheenColorMap.channel),sheenRoughnessMapUv:Xn&&ft(_t.sheenRoughnessMap.channel),specularMapUv:qt&&ft(_t.specularMap.channel),specularColorMapUv:fn&&ft(_t.specularColorMap.channel),specularIntensityMapUv:jn&&ft(_t.specularIntensityMap.channel),transmissionMapUv:Qt&&ft(_t.transmissionMap.channel),thicknessMapUv:an&&ft(_t.thicknessMap.channel),alphaMapUv:_n&&ft(_t.alphaMap.channel),vertexTangents:!!kt.attributes.tangent&&(kn||It),vertexColors:_t.vertexColors,vertexAlphas:_t.vertexColors===!0&&!!kt.attributes.color&&kt.attributes.color.itemSize===4,pointsUvs:Lt.isPoints===!0&&!!kt.attributes.uv&&(Bn||_n),fog:!!Nt,useFog:_t.fog===!0,fogExp2:!!Nt&&Nt.isFogExp2,flatShading:_t.flatShading===!0,sizeAttenuation:_t.sizeAttenuation===!0,logarithmicDepthBuffer:ot,reverseDepthBuffer:On,skinning:Lt.isSkinnedMesh===!0,morphTargets:kt.morphAttributes.position!==void 0,morphNormals:kt.morphAttributes.normal!==void 0,morphColors:kt.morphAttributes.color!==void 0,morphTargetsCount:Pt,morphTextureStride:Wt,numDirLights:vt.directional.length,numPointLights:vt.point.length,numSpotLights:vt.spot.length,numSpotLightMaps:vt.spotLightMap.length,numRectAreaLights:vt.rectArea.length,numHemiLights:vt.hemi.length,numDirLightShadows:vt.directionalShadowMap.length,numPointLightShadows:vt.pointShadowMap.length,numSpotLightShadows:vt.spotShadowMap.length,numSpotLightShadowsWithMaps:vt.numSpotLightShadowsWithMaps,numLightProbes:vt.numLightProbes,numClippingPlanes:b.numPlanes,numClipIntersection:b.numIntersection,dithering:_t.dithering,shadowMapEnabled:o.shadowMap.enabled&&Mt.length>0,shadowMapType:o.shadowMap.type,toneMapping:Mr,decodeVideoTexture:Bn&&_t.map.isVideoTexture===!0&&ColorManagement.getTransfer(_t.map.colorSpace)===SRGBTransfer,decodeVideoTextureEmissive:ir&&_t.emissiveMap.isVideoTexture===!0&&ColorManagement.getTransfer(_t.emissiveMap.colorSpace)===SRGBTransfer,premultipliedAlpha:_t.premultipliedAlpha,doubleSided:_t.side===DoubleSide,flipSided:_t.side===BackSide,useDepthPacking:_t.depthPacking>=0,depthPacking:_t.depthPacking||0,index0AttributeName:_t.index0AttributeName,extensionClipCullDistance:ur&&_t.extensions.clipCullDistance===!0&&a.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(ur&&_t.extensions.multiDraw===!0||Wn)&&a.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:a.has("KHR_parallel_shader_compile"),customProgramCacheKey:_t.customProgramCacheKey()};return Ir.vertexUv1s=nt.has(1),Ir.vertexUv2s=nt.has(2),Ir.vertexUv3s=nt.has(3),nt.clear(),Ir}function lt(_t){const vt=[];if(_t.shaderID?vt.push(_t.shaderID):(vt.push(_t.customVertexShaderID),vt.push(_t.customFragmentShaderID)),_t.defines!==void 0)for(const Mt in _t.defines)vt.push(Mt),vt.push(_t.defines[Mt]);return _t.isRawShaderMaterial===!1&&(ht(vt,_t),mt(vt,_t),vt.push(o.outputColorSpace)),vt.push(_t.customProgramCacheKey),vt.join()}function ht(_t,vt){_t.push(vt.precision),_t.push(vt.outputColorSpace),_t.push(vt.envMapMode),_t.push(vt.envMapCubeUVHeight),_t.push(vt.mapUv),_t.push(vt.alphaMapUv),_t.push(vt.lightMapUv),_t.push(vt.aoMapUv),_t.push(vt.bumpMapUv),_t.push(vt.normalMapUv),_t.push(vt.displacementMapUv),_t.push(vt.emissiveMapUv),_t.push(vt.metalnessMapUv),_t.push(vt.roughnessMapUv),_t.push(vt.anisotropyMapUv),_t.push(vt.clearcoatMapUv),_t.push(vt.clearcoatNormalMapUv),_t.push(vt.clearcoatRoughnessMapUv),_t.push(vt.iridescenceMapUv),_t.push(vt.iridescenceThicknessMapUv),_t.push(vt.sheenColorMapUv),_t.push(vt.sheenRoughnessMapUv),_t.push(vt.specularMapUv),_t.push(vt.specularColorMapUv),_t.push(vt.specularIntensityMapUv),_t.push(vt.transmissionMapUv),_t.push(vt.thicknessMapUv),_t.push(vt.combine),_t.push(vt.fogExp2),_t.push(vt.sizeAttenuation),_t.push(vt.morphTargetsCount),_t.push(vt.morphAttributeCount),_t.push(vt.numDirLights),_t.push(vt.numPointLights),_t.push(vt.numSpotLights),_t.push(vt.numSpotLightMaps),_t.push(vt.numHemiLights),_t.push(vt.numRectAreaLights),_t.push(vt.numDirLightShadows),_t.push(vt.numPointLightShadows),_t.push(vt.numSpotLightShadows),_t.push(vt.numSpotLightShadowsWithMaps),_t.push(vt.numLightProbes),_t.push(vt.shadowMapType),_t.push(vt.toneMapping),_t.push(vt.numClippingPlanes),_t.push(vt.numClipIntersection),_t.push(vt.depthPacking)}function mt(_t,vt){_e.disableAll(),vt.supportsVertexTextures&&_e.enable(0),vt.instancing&&_e.enable(1),vt.instancingColor&&_e.enable(2),vt.instancingMorph&&_e.enable(3),vt.matcap&&_e.enable(4),vt.envMap&&_e.enable(5),vt.normalMapObjectSpace&&_e.enable(6),vt.normalMapTangentSpace&&_e.enable(7),vt.clearcoat&&_e.enable(8),vt.iridescence&&_e.enable(9),vt.alphaTest&&_e.enable(10),vt.vertexColors&&_e.enable(11),vt.vertexAlphas&&_e.enable(12),vt.vertexUv1s&&_e.enable(13),vt.vertexUv2s&&_e.enable(14),vt.vertexUv3s&&_e.enable(15),vt.vertexTangents&&_e.enable(16),vt.anisotropy&&_e.enable(17),vt.alphaHash&&_e.enable(18),vt.batching&&_e.enable(19),vt.dispersion&&_e.enable(20),vt.batchingColor&&_e.enable(21),_t.push(_e.mask),_e.disableAll(),vt.fog&&_e.enable(0),vt.useFog&&_e.enable(1),vt.flatShading&&_e.enable(2),vt.logarithmicDepthBuffer&&_e.enable(3),vt.reverseDepthBuffer&&_e.enable(4),vt.skinning&&_e.enable(5),vt.morphTargets&&_e.enable(6),vt.morphNormals&&_e.enable(7),vt.morphColors&&_e.enable(8),vt.premultipliedAlpha&&_e.enable(9),vt.shadowMapEnabled&&_e.enable(10),vt.doubleSided&&_e.enable(11),vt.flipSided&&_e.enable(12),vt.useDepthPacking&&_e.enable(13),vt.dithering&&_e.enable(14),vt.transmission&&_e.enable(15),vt.sheen&&_e.enable(16),vt.opaque&&_e.enable(17),vt.pointsUvs&&_e.enable(18),vt.decodeVideoTexture&&_e.enable(19),vt.decodeVideoTextureEmissive&&_e.enable(20),vt.alphaToCoverage&&_e.enable(21),_t.push(_e.mask)}function xt(_t){const vt=ut[_t.type];let Mt;if(vt){const jt=ShaderLib[vt];Mt=UniformsUtils.clone(jt.uniforms)}else Mt=_t.uniforms;return Mt}function St(_t,vt){let Mt;for(let jt=0,Lt=it.length;jt<Lt;jt++){const Nt=it[jt];if(Nt.cacheKey===vt){Mt=Nt,++Mt.usedTimes;break}}return Mt===void 0&&(Mt=new WebGLProgram(o,vt,_t,d),it.push(Mt)),Mt}function yt(_t){if(--_t.usedTimes===0){const vt=it.indexOf(_t);it[vt]=it[it.length-1],it.pop(),_t.destroy()}}function wt(_t){tt.remove(_t)}function Et(){tt.dispose()}return{getParameters:dt,getProgramCacheKey:lt,getUniforms:xt,acquireProgram:St,releaseProgram:yt,releaseShaderCache:wt,programs:it,dispose:Et}}function WebGLProperties(){let o=new WeakMap;function e(b){return o.has(b)}function s(b){let _e=o.get(b);return _e===void 0&&(_e={},o.set(b,_e)),_e}function a(b){o.delete(b)}function c(b,_e,tt){o.get(b)[_e]=tt}function d(){o=new WeakMap}return{has:e,get:s,remove:a,update:c,dispose:d}}function painterSortStable(o,e){return o.groupOrder!==e.groupOrder?o.groupOrder-e.groupOrder:o.renderOrder!==e.renderOrder?o.renderOrder-e.renderOrder:o.material.id!==e.material.id?o.material.id-e.material.id:o.z!==e.z?o.z-e.z:o.id-e.id}function reversePainterSortStable(o,e){return o.groupOrder!==e.groupOrder?o.groupOrder-e.groupOrder:o.renderOrder!==e.renderOrder?o.renderOrder-e.renderOrder:o.z!==e.z?e.z-o.z:o.id-e.id}function WebGLRenderList(){const o=[];let e=0;const s=[],a=[],c=[];function d(){e=0,s.length=0,a.length=0,c.length=0}function b(ot,at,ct,ut,ft,dt){let lt=o[e];return lt===void 0?(lt={id:ot.id,object:ot,geometry:at,material:ct,groupOrder:ut,renderOrder:ot.renderOrder,z:ft,group:dt},o[e]=lt):(lt.id=ot.id,lt.object=ot,lt.geometry=at,lt.material=ct,lt.groupOrder=ut,lt.renderOrder=ot.renderOrder,lt.z=ft,lt.group=dt),e++,lt}function _e(ot,at,ct,ut,ft,dt){const lt=b(ot,at,ct,ut,ft,dt);ct.transmission>0?a.push(lt):ct.transparent===!0?c.push(lt):s.push(lt)}function tt(ot,at,ct,ut,ft,dt){const lt=b(ot,at,ct,ut,ft,dt);ct.transmission>0?a.unshift(lt):ct.transparent===!0?c.unshift(lt):s.unshift(lt)}function nt(ot,at){s.length>1&&s.sort(ot||painterSortStable),a.length>1&&a.sort(at||reversePainterSortStable),c.length>1&&c.sort(at||reversePainterSortStable)}function it(){for(let ot=e,at=o.length;ot<at;ot++){const ct=o[ot];if(ct.id===null)break;ct.id=null,ct.object=null,ct.geometry=null,ct.material=null,ct.group=null}}return{opaque:s,transmissive:a,transparent:c,init:d,push:_e,unshift:tt,finish:it,sort:nt}}function WebGLRenderLists(){let o=new WeakMap;function e(a,c){const d=o.get(a);let b;return d===void 0?(b=new WebGLRenderList,o.set(a,[b])):c>=d.length?(b=new WebGLRenderList,d.push(b)):b=d[c],b}function s(){o=new WeakMap}return{get:e,dispose:s}}function UniformsCache(){const o={};return{get:function(e){if(o[e.id]!==void 0)return o[e.id];let s;switch(e.type){case"DirectionalLight":s={direction:new Vector3,color:new Color};break;case"SpotLight":s={position:new Vector3,direction:new Vector3,color:new Color,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":s={position:new Vector3,color:new Color,distance:0,decay:0};break;case"HemisphereLight":s={direction:new Vector3,skyColor:new Color,groundColor:new Color};break;case"RectAreaLight":s={color:new Color,position:new Vector3,halfWidth:new Vector3,halfHeight:new Vector3};break}return o[e.id]=s,s}}}function ShadowUniformsCache(){const o={};return{get:function(e){if(o[e.id]!==void 0)return o[e.id];let s;switch(e.type){case"DirectionalLight":s={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Vector2};break;case"SpotLight":s={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Vector2};break;case"PointLight":s={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Vector2,shadowCameraNear:1,shadowCameraFar:1e3};break}return o[e.id]=s,s}}}let nextVersion=0;function shadowCastingAndTexturingLightsFirst(o,e){return(e.castShadow?2:0)-(o.castShadow?2:0)+(e.map?1:0)-(o.map?1:0)}function WebGLLights(o){const e=new UniformsCache,s=ShadowUniformsCache(),a={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let nt=0;nt<9;nt++)a.probe.push(new Vector3);const c=new Vector3,d=new Matrix4,b=new Matrix4;function _e(nt){let it=0,ot=0,at=0;for(let _t=0;_t<9;_t++)a.probe[_t].set(0,0,0);let ct=0,ut=0,ft=0,dt=0,lt=0,ht=0,mt=0,xt=0,St=0,yt=0,wt=0;nt.sort(shadowCastingAndTexturingLightsFirst);for(let _t=0,vt=nt.length;_t<vt;_t++){const Mt=nt[_t],jt=Mt.color,Lt=Mt.intensity,Nt=Mt.distance,kt=Mt.shadow&&Mt.shadow.map?Mt.shadow.map.texture:null;if(Mt.isAmbientLight)it+=jt.r*Lt,ot+=jt.g*Lt,at+=jt.b*Lt;else if(Mt.isLightProbe){for(let Ot=0;Ot<9;Ot++)a.probe[Ot].addScaledVector(Mt.sh.coefficients[Ot],Lt);wt++}else if(Mt.isDirectionalLight){const Ot=e.get(Mt);if(Ot.color.copy(Mt.color).multiplyScalar(Mt.intensity),Mt.castShadow){const Ht=Mt.shadow,Ct=s.get(Mt);Ct.shadowIntensity=Ht.intensity,Ct.shadowBias=Ht.bias,Ct.shadowNormalBias=Ht.normalBias,Ct.shadowRadius=Ht.radius,Ct.shadowMapSize=Ht.mapSize,a.directionalShadow[ct]=Ct,a.directionalShadowMap[ct]=kt,a.directionalShadowMatrix[ct]=Mt.shadow.matrix,ht++}a.directional[ct]=Ot,ct++}else if(Mt.isSpotLight){const Ot=e.get(Mt);Ot.position.setFromMatrixPosition(Mt.matrixWorld),Ot.color.copy(jt).multiplyScalar(Lt),Ot.distance=Nt,Ot.coneCos=Math.cos(Mt.angle),Ot.penumbraCos=Math.cos(Mt.angle*(1-Mt.penumbra)),Ot.decay=Mt.decay,a.spot[ft]=Ot;const Ht=Mt.shadow;if(Mt.map&&(a.spotLightMap[St]=Mt.map,St++,Ht.updateMatrices(Mt),Mt.castShadow&&yt++),a.spotLightMatrix[ft]=Ht.matrix,Mt.castShadow){const Ct=s.get(Mt);Ct.shadowIntensity=Ht.intensity,Ct.shadowBias=Ht.bias,Ct.shadowNormalBias=Ht.normalBias,Ct.shadowRadius=Ht.radius,Ct.shadowMapSize=Ht.mapSize,a.spotShadow[ft]=Ct,a.spotShadowMap[ft]=kt,xt++}ft++}else if(Mt.isRectAreaLight){const Ot=e.get(Mt);Ot.color.copy(jt).multiplyScalar(Lt),Ot.halfWidth.set(Mt.width*.5,0,0),Ot.halfHeight.set(0,Mt.height*.5,0),a.rectArea[dt]=Ot,dt++}else if(Mt.isPointLight){const Ot=e.get(Mt);if(Ot.color.copy(Mt.color).multiplyScalar(Mt.intensity),Ot.distance=Mt.distance,Ot.decay=Mt.decay,Mt.castShadow){const Ht=Mt.shadow,Ct=s.get(Mt);Ct.shadowIntensity=Ht.intensity,Ct.shadowBias=Ht.bias,Ct.shadowNormalBias=Ht.normalBias,Ct.shadowRadius=Ht.radius,Ct.shadowMapSize=Ht.mapSize,Ct.shadowCameraNear=Ht.camera.near,Ct.shadowCameraFar=Ht.camera.far,a.pointShadow[ut]=Ct,a.pointShadowMap[ut]=kt,a.pointShadowMatrix[ut]=Mt.shadow.matrix,mt++}a.point[ut]=Ot,ut++}else if(Mt.isHemisphereLight){const Ot=e.get(Mt);Ot.skyColor.copy(Mt.color).multiplyScalar(Lt),Ot.groundColor.copy(Mt.groundColor).multiplyScalar(Lt),a.hemi[lt]=Ot,lt++}}dt>0&&(o.has("OES_texture_float_linear")===!0?(a.rectAreaLTC1=UniformsLib.LTC_FLOAT_1,a.rectAreaLTC2=UniformsLib.LTC_FLOAT_2):(a.rectAreaLTC1=UniformsLib.LTC_HALF_1,a.rectAreaLTC2=UniformsLib.LTC_HALF_2)),a.ambient[0]=it,a.ambient[1]=ot,a.ambient[2]=at;const Et=a.hash;(Et.directionalLength!==ct||Et.pointLength!==ut||Et.spotLength!==ft||Et.rectAreaLength!==dt||Et.hemiLength!==lt||Et.numDirectionalShadows!==ht||Et.numPointShadows!==mt||Et.numSpotShadows!==xt||Et.numSpotMaps!==St||Et.numLightProbes!==wt)&&(a.directional.length=ct,a.spot.length=ft,a.rectArea.length=dt,a.point.length=ut,a.hemi.length=lt,a.directionalShadow.length=ht,a.directionalShadowMap.length=ht,a.pointShadow.length=mt,a.pointShadowMap.length=mt,a.spotShadow.length=xt,a.spotShadowMap.length=xt,a.directionalShadowMatrix.length=ht,a.pointShadowMatrix.length=mt,a.spotLightMatrix.length=xt+St-yt,a.spotLightMap.length=St,a.numSpotLightShadowsWithMaps=yt,a.numLightProbes=wt,Et.directionalLength=ct,Et.pointLength=ut,Et.spotLength=ft,Et.rectAreaLength=dt,Et.hemiLength=lt,Et.numDirectionalShadows=ht,Et.numPointShadows=mt,Et.numSpotShadows=xt,Et.numSpotMaps=St,Et.numLightProbes=wt,a.version=nextVersion++)}function tt(nt,it){let ot=0,at=0,ct=0,ut=0,ft=0;const dt=it.matrixWorldInverse;for(let lt=0,ht=nt.length;lt<ht;lt++){const mt=nt[lt];if(mt.isDirectionalLight){const xt=a.directional[ot];xt.direction.setFromMatrixPosition(mt.matrixWorld),c.setFromMatrixPosition(mt.target.matrixWorld),xt.direction.sub(c),xt.direction.transformDirection(dt),ot++}else if(mt.isSpotLight){const xt=a.spot[ct];xt.position.setFromMatrixPosition(mt.matrixWorld),xt.position.applyMatrix4(dt),xt.direction.setFromMatrixPosition(mt.matrixWorld),c.setFromMatrixPosition(mt.target.matrixWorld),xt.direction.sub(c),xt.direction.transformDirection(dt),ct++}else if(mt.isRectAreaLight){const xt=a.rectArea[ut];xt.position.setFromMatrixPosition(mt.matrixWorld),xt.position.applyMatrix4(dt),b.identity(),d.copy(mt.matrixWorld),d.premultiply(dt),b.extractRotation(d),xt.halfWidth.set(mt.width*.5,0,0),xt.halfHeight.set(0,mt.height*.5,0),xt.halfWidth.applyMatrix4(b),xt.halfHeight.applyMatrix4(b),ut++}else if(mt.isPointLight){const xt=a.point[at];xt.position.setFromMatrixPosition(mt.matrixWorld),xt.position.applyMatrix4(dt),at++}else if(mt.isHemisphereLight){const xt=a.hemi[ft];xt.direction.setFromMatrixPosition(mt.matrixWorld),xt.direction.transformDirection(dt),ft++}}}return{setup:_e,setupView:tt,state:a}}function WebGLRenderState(o){const e=new WebGLLights(o),s=[],a=[];function c(it){nt.camera=it,s.length=0,a.length=0}function d(it){s.push(it)}function b(it){a.push(it)}function _e(){e.setup(s)}function tt(it){e.setupView(s,it)}const nt={lightsArray:s,shadowsArray:a,camera:null,lights:e,transmissionRenderTarget:{}};return{init:c,state:nt,setupLights:_e,setupLightsView:tt,pushLight:d,pushShadow:b}}function WebGLRenderStates(o){let e=new WeakMap;function s(c,d=0){const b=e.get(c);let _e;return b===void 0?(_e=new WebGLRenderState(o),e.set(c,[_e])):d>=b.length?(_e=new WebGLRenderState(o),b.push(_e)):_e=b[d],_e}function a(){e=new WeakMap}return{get:s,dispose:a}}class MeshDepthMaterial extends Material{static get type(){return"MeshDepthMaterial"}constructor(e){super(),this.isMeshDepthMaterial=!0,this.depthPacking=BasicDepthPacking,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class MeshDistanceMaterial extends Material{static get type(){return"MeshDistanceMaterial"}constructor(e){super(),this.isMeshDistanceMaterial=!0,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const vertex=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,fragment=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function WebGLShadowMap(o,e,s){let a=new Frustum;const c=new Vector2,d=new Vector2,b=new Vector4,_e=new MeshDepthMaterial({depthPacking:RGBADepthPacking}),tt=new MeshDistanceMaterial,nt={},it=s.maxTextureSize,ot={[FrontSide]:BackSide,[BackSide]:FrontSide,[DoubleSide]:DoubleSide},at=new ShaderMaterial({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Vector2},radius:{value:4}},vertexShader:vertex,fragmentShader:fragment}),ct=at.clone();ct.defines.HORIZONTAL_PASS=1;const ut=new BufferGeometry;ut.setAttribute("position",new BufferAttribute(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const ft=new Mesh(ut,at),dt=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=PCFShadowMap;let lt=this.type;this.render=function(yt,wt,Et){if(dt.enabled===!1||dt.autoUpdate===!1&&dt.needsUpdate===!1||yt.length===0)return;const _t=o.getRenderTarget(),vt=o.getActiveCubeFace(),Mt=o.getActiveMipmapLevel(),jt=o.state;jt.setBlending(NoBlending),jt.buffers.color.setClear(1,1,1,1),jt.buffers.depth.setTest(!0),jt.setScissorTest(!1);const Lt=lt!==VSMShadowMap&&this.type===VSMShadowMap,Nt=lt===VSMShadowMap&&this.type!==VSMShadowMap;for(let kt=0,Ot=yt.length;kt<Ot;kt++){const Ht=yt[kt],Ct=Ht.shadow;if(Ct===void 0){console.warn("THREE.WebGLShadowMap:",Ht,"has no shadow.");continue}if(Ct.autoUpdate===!1&&Ct.needsUpdate===!1)continue;c.copy(Ct.mapSize);const Ut=Ct.getFrameExtents();if(c.multiply(Ut),d.copy(Ct.mapSize),(c.x>it||c.y>it)&&(c.x>it&&(d.x=Math.floor(it/Ut.x),c.x=d.x*Ut.x,Ct.mapSize.x=d.x),c.y>it&&(d.y=Math.floor(it/Ut.y),c.y=d.y*Ut.y,Ct.mapSize.y=d.y)),Ct.map===null||Lt===!0||Nt===!0){const Pt=this.type!==VSMShadowMap?{minFilter:NearestFilter,magFilter:NearestFilter}:{};Ct.map!==null&&Ct.map.dispose(),Ct.map=new WebGLRenderTarget(c.x,c.y,Pt),Ct.map.texture.name=Ht.name+".shadowMap",Ct.camera.updateProjectionMatrix()}o.setRenderTarget(Ct.map),o.clear();const Gt=Ct.getViewportCount();for(let Pt=0;Pt<Gt;Pt++){const Wt=Ct.getViewport(Pt);b.set(d.x*Wt.x,d.y*Wt.y,d.x*Wt.z,d.y*Wt.w),jt.viewport(b),Ct.updateMatrices(Ht,Pt),a=Ct.getFrustum(),xt(wt,Et,Ct.camera,Ht,this.type)}Ct.isPointLightShadow!==!0&&this.type===VSMShadowMap&&ht(Ct,Et),Ct.needsUpdate=!1}lt=this.type,dt.needsUpdate=!1,o.setRenderTarget(_t,vt,Mt)};function ht(yt,wt){const Et=e.update(ft);at.defines.VSM_SAMPLES!==yt.blurSamples&&(at.defines.VSM_SAMPLES=yt.blurSamples,ct.defines.VSM_SAMPLES=yt.blurSamples,at.needsUpdate=!0,ct.needsUpdate=!0),yt.mapPass===null&&(yt.mapPass=new WebGLRenderTarget(c.x,c.y)),at.uniforms.shadow_pass.value=yt.map.texture,at.uniforms.resolution.value=yt.mapSize,at.uniforms.radius.value=yt.radius,o.setRenderTarget(yt.mapPass),o.clear(),o.renderBufferDirect(wt,null,Et,at,ft,null),ct.uniforms.shadow_pass.value=yt.mapPass.texture,ct.uniforms.resolution.value=yt.mapSize,ct.uniforms.radius.value=yt.radius,o.setRenderTarget(yt.map),o.clear(),o.renderBufferDirect(wt,null,Et,ct,ft,null)}function mt(yt,wt,Et,_t){let vt=null;const Mt=Et.isPointLight===!0?yt.customDistanceMaterial:yt.customDepthMaterial;if(Mt!==void 0)vt=Mt;else if(vt=Et.isPointLight===!0?tt:_e,o.localClippingEnabled&&wt.clipShadows===!0&&Array.isArray(wt.clippingPlanes)&&wt.clippingPlanes.length!==0||wt.displacementMap&&wt.displacementScale!==0||wt.alphaMap&&wt.alphaTest>0||wt.map&&wt.alphaTest>0){const jt=vt.uuid,Lt=wt.uuid;let Nt=nt[jt];Nt===void 0&&(Nt={},nt[jt]=Nt);let kt=Nt[Lt];kt===void 0&&(kt=vt.clone(),Nt[Lt]=kt,wt.addEventListener("dispose",St)),vt=kt}if(vt.visible=wt.visible,vt.wireframe=wt.wireframe,_t===VSMShadowMap?vt.side=wt.shadowSide!==null?wt.shadowSide:wt.side:vt.side=wt.shadowSide!==null?wt.shadowSide:ot[wt.side],vt.alphaMap=wt.alphaMap,vt.alphaTest=wt.alphaTest,vt.map=wt.map,vt.clipShadows=wt.clipShadows,vt.clippingPlanes=wt.clippingPlanes,vt.clipIntersection=wt.clipIntersection,vt.displacementMap=wt.displacementMap,vt.displacementScale=wt.displacementScale,vt.displacementBias=wt.displacementBias,vt.wireframeLinewidth=wt.wireframeLinewidth,vt.linewidth=wt.linewidth,Et.isPointLight===!0&&vt.isMeshDistanceMaterial===!0){const jt=o.properties.get(vt);jt.light=Et}return vt}function xt(yt,wt,Et,_t,vt){if(yt.visible===!1)return;if(yt.layers.test(wt.layers)&&(yt.isMesh||yt.isLine||yt.isPoints)&&(yt.castShadow||yt.receiveShadow&&vt===VSMShadowMap)&&(!yt.frustumCulled||a.intersectsObject(yt))){yt.modelViewMatrix.multiplyMatrices(Et.matrixWorldInverse,yt.matrixWorld);const Lt=e.update(yt),Nt=yt.material;if(Array.isArray(Nt)){const kt=Lt.groups;for(let Ot=0,Ht=kt.length;Ot<Ht;Ot++){const Ct=kt[Ot],Ut=Nt[Ct.materialIndex];if(Ut&&Ut.visible){const Gt=mt(yt,Ut,_t,vt);yt.onBeforeShadow(o,yt,wt,Et,Lt,Gt,Ct),o.renderBufferDirect(Et,null,Lt,Gt,yt,Ct),yt.onAfterShadow(o,yt,wt,Et,Lt,Gt,Ct)}}}else if(Nt.visible){const kt=mt(yt,Nt,_t,vt);yt.onBeforeShadow(o,yt,wt,Et,Lt,kt,null),o.renderBufferDirect(Et,null,Lt,kt,yt,null),yt.onAfterShadow(o,yt,wt,Et,Lt,kt,null)}}const jt=yt.children;for(let Lt=0,Nt=jt.length;Lt<Nt;Lt++)xt(jt[Lt],wt,Et,_t,vt)}function St(yt){yt.target.removeEventListener("dispose",St);for(const Et in nt){const _t=nt[Et],vt=yt.target.uuid;vt in _t&&(_t[vt].dispose(),delete _t[vt])}}}const reversedFuncs={[NeverDepth]:AlwaysDepth,[LessDepth]:GreaterDepth,[EqualDepth]:NotEqualDepth,[LessEqualDepth]:GreaterEqualDepth,[AlwaysDepth]:NeverDepth,[GreaterDepth]:LessDepth,[NotEqualDepth]:EqualDepth,[GreaterEqualDepth]:LessEqualDepth};function WebGLState(o,e){function s(){let Qt=!1;const an=new Vector4;let hn=null;const _n=new Vector4(0,0,0,0);return{setMask:function(Vn){hn!==Vn&&!Qt&&(o.colorMask(Vn,Vn,Vn,Vn),hn=Vn)},setLocked:function(Vn){Qt=Vn},setClear:function(Vn,Gn,ur,Mr,Ir){Ir===!0&&(Vn*=Mr,Gn*=Mr,ur*=Mr),an.set(Vn,Gn,ur,Mr),_n.equals(an)===!1&&(o.clearColor(Vn,Gn,ur,Mr),_n.copy(an))},reset:function(){Qt=!1,hn=null,_n.set(-1,0,0,0)}}}function a(){let Qt=!1,an=!1,hn=null,_n=null,Vn=null;return{setReversed:function(Gn){if(an!==Gn){const ur=e.get("EXT_clip_control");an?ur.clipControlEXT(ur.LOWER_LEFT_EXT,ur.ZERO_TO_ONE_EXT):ur.clipControlEXT(ur.LOWER_LEFT_EXT,ur.NEGATIVE_ONE_TO_ONE_EXT);const Mr=Vn;Vn=null,this.setClear(Mr)}an=Gn},getReversed:function(){return an},setTest:function(Gn){Gn?vn(o.DEPTH_TEST):On(o.DEPTH_TEST)},setMask:function(Gn){hn!==Gn&&!Qt&&(o.depthMask(Gn),hn=Gn)},setFunc:function(Gn){if(an&&(Gn=reversedFuncs[Gn]),_n!==Gn){switch(Gn){case NeverDepth:o.depthFunc(o.NEVER);break;case AlwaysDepth:o.depthFunc(o.ALWAYS);break;case LessDepth:o.depthFunc(o.LESS);break;case LessEqualDepth:o.depthFunc(o.LEQUAL);break;case EqualDepth:o.depthFunc(o.EQUAL);break;case GreaterEqualDepth:o.depthFunc(o.GEQUAL);break;case GreaterDepth:o.depthFunc(o.GREATER);break;case NotEqualDepth:o.depthFunc(o.NOTEQUAL);break;default:o.depthFunc(o.LEQUAL)}_n=Gn}},setLocked:function(Gn){Qt=Gn},setClear:function(Gn){Vn!==Gn&&(an&&(Gn=1-Gn),o.clearDepth(Gn),Vn=Gn)},reset:function(){Qt=!1,hn=null,_n=null,Vn=null,an=!1}}}function c(){let Qt=!1,an=null,hn=null,_n=null,Vn=null,Gn=null,ur=null,Mr=null,Ir=null;return{setTest:function(yr){Qt||(yr?vn(o.STENCIL_TEST):On(o.STENCIL_TEST))},setMask:function(yr){an!==yr&&!Qt&&(o.stencilMask(yr),an=yr)},setFunc:function(yr,Or,Wr){(hn!==yr||_n!==Or||Vn!==Wr)&&(o.stencilFunc(yr,Or,Wr),hn=yr,_n=Or,Vn=Wr)},setOp:function(yr,Or,Wr){(Gn!==yr||ur!==Or||Mr!==Wr)&&(o.stencilOp(yr,Or,Wr),Gn=yr,ur=Or,Mr=Wr)},setLocked:function(yr){Qt=yr},setClear:function(yr){Ir!==yr&&(o.clearStencil(yr),Ir=yr)},reset:function(){Qt=!1,an=null,hn=null,_n=null,Vn=null,Gn=null,ur=null,Mr=null,Ir=null}}}const d=new s,b=new a,_e=new c,tt=new WeakMap,nt=new WeakMap;let it={},ot={},at=new WeakMap,ct=[],ut=null,ft=!1,dt=null,lt=null,ht=null,mt=null,xt=null,St=null,yt=null,wt=new Color(0,0,0),Et=0,_t=!1,vt=null,Mt=null,jt=null,Lt=null,Nt=null;const kt=o.getParameter(o.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let Ot=!1,Ht=0;const Ct=o.getParameter(o.VERSION);Ct.indexOf("WebGL")!==-1?(Ht=parseFloat(/^WebGL (\d)/.exec(Ct)[1]),Ot=Ht>=1):Ct.indexOf("OpenGL ES")!==-1&&(Ht=parseFloat(/^OpenGL ES (\d)/.exec(Ct)[1]),Ot=Ht>=2);let Ut=null,Gt={};const Pt=o.getParameter(o.SCISSOR_BOX),Wt=o.getParameter(o.VIEWPORT),sn=new Vector4().fromArray(Pt),Bt=new Vector4().fromArray(Wt);function tn(Qt,an,hn,_n){const Vn=new Uint8Array(4),Gn=o.createTexture();o.bindTexture(Qt,Gn),o.texParameteri(Qt,o.TEXTURE_MIN_FILTER,o.NEAREST),o.texParameteri(Qt,o.TEXTURE_MAG_FILTER,o.NEAREST);for(let ur=0;ur<hn;ur++)Qt===o.TEXTURE_3D||Qt===o.TEXTURE_2D_ARRAY?o.texImage3D(an,0,o.RGBA,1,1,_n,0,o.RGBA,o.UNSIGNED_BYTE,Vn):o.texImage2D(an+ur,0,o.RGBA,1,1,0,o.RGBA,o.UNSIGNED_BYTE,Vn);return Gn}const cn={};cn[o.TEXTURE_2D]=tn(o.TEXTURE_2D,o.TEXTURE_2D,1),cn[o.TEXTURE_CUBE_MAP]=tn(o.TEXTURE_CUBE_MAP,o.TEXTURE_CUBE_MAP_POSITIVE_X,6),cn[o.TEXTURE_2D_ARRAY]=tn(o.TEXTURE_2D_ARRAY,o.TEXTURE_2D_ARRAY,1,1),cn[o.TEXTURE_3D]=tn(o.TEXTURE_3D,o.TEXTURE_3D,1,1),d.setClear(0,0,0,1),b.setClear(1),_e.setClear(0),vn(o.DEPTH_TEST),b.setFunc(LessEqualDepth),Cn(!1),kn(CullFaceBack),vn(o.CULL_FACE),Kt(NoBlending);function vn(Qt){it[Qt]!==!0&&(o.enable(Qt),it[Qt]=!0)}function On(Qt){it[Qt]!==!1&&(o.disable(Qt),it[Qt]=!1)}function rr(Qt,an){return ot[Qt]!==an?(o.bindFramebuffer(Qt,an),ot[Qt]=an,Qt===o.DRAW_FRAMEBUFFER&&(ot[o.FRAMEBUFFER]=an),Qt===o.FRAMEBUFFER&&(ot[o.DRAW_FRAMEBUFFER]=an),!0):!1}function Wn(Qt,an){let hn=ct,_n=!1;if(Qt){hn=at.get(an),hn===void 0&&(hn=[],at.set(an,hn));const Vn=Qt.textures;if(hn.length!==Vn.length||hn[0]!==o.COLOR_ATTACHMENT0){for(let Gn=0,ur=Vn.length;Gn<ur;Gn++)hn[Gn]=o.COLOR_ATTACHMENT0+Gn;hn.length=Vn.length,_n=!0}}else hn[0]!==o.BACK&&(hn[0]=o.BACK,_n=!0);_n&&o.drawBuffers(hn)}function Bn(Qt){return ut!==Qt?(o.useProgram(Qt),ut=Qt,!0):!1}const gn={[AddEquation]:o.FUNC_ADD,[SubtractEquation]:o.FUNC_SUBTRACT,[ReverseSubtractEquation]:o.FUNC_REVERSE_SUBTRACT};gn[MinEquation]=o.MIN,gn[MaxEquation]=o.MAX;const bn={[ZeroFactor]:o.ZERO,[OneFactor]:o.ONE,[SrcColorFactor]:o.SRC_COLOR,[SrcAlphaFactor]:o.SRC_ALPHA,[SrcAlphaSaturateFactor]:o.SRC_ALPHA_SATURATE,[DstColorFactor]:o.DST_COLOR,[DstAlphaFactor]:o.DST_ALPHA,[OneMinusSrcColorFactor]:o.ONE_MINUS_SRC_COLOR,[OneMinusSrcAlphaFactor]:o.ONE_MINUS_SRC_ALPHA,[OneMinusDstColorFactor]:o.ONE_MINUS_DST_COLOR,[OneMinusDstAlphaFactor]:o.ONE_MINUS_DST_ALPHA,[ConstantColorFactor]:o.CONSTANT_COLOR,[OneMinusConstantColorFactor]:o.ONE_MINUS_CONSTANT_COLOR,[ConstantAlphaFactor]:o.CONSTANT_ALPHA,[OneMinusConstantAlphaFactor]:o.ONE_MINUS_CONSTANT_ALPHA};function Kt(Qt,an,hn,_n,Vn,Gn,ur,Mr,Ir,yr){if(Qt===NoBlending){ft===!0&&(On(o.BLEND),ft=!1);return}if(ft===!1&&(vn(o.BLEND),ft=!0),Qt!==CustomBlending){if(Qt!==dt||yr!==_t){if((lt!==AddEquation||xt!==AddEquation)&&(o.blendEquation(o.FUNC_ADD),lt=AddEquation,xt=AddEquation),yr)switch(Qt){case NormalBlending:o.blendFuncSeparate(o.ONE,o.ONE_MINUS_SRC_ALPHA,o.ONE,o.ONE_MINUS_SRC_ALPHA);break;case AdditiveBlending:o.blendFunc(o.ONE,o.ONE);break;case SubtractiveBlending:o.blendFuncSeparate(o.ZERO,o.ONE_MINUS_SRC_COLOR,o.ZERO,o.ONE);break;case MultiplyBlending:o.blendFuncSeparate(o.ZERO,o.SRC_COLOR,o.ZERO,o.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",Qt);break}else switch(Qt){case NormalBlending:o.blendFuncSeparate(o.SRC_ALPHA,o.ONE_MINUS_SRC_ALPHA,o.ONE,o.ONE_MINUS_SRC_ALPHA);break;case AdditiveBlending:o.blendFunc(o.SRC_ALPHA,o.ONE);break;case SubtractiveBlending:o.blendFuncSeparate(o.ZERO,o.ONE_MINUS_SRC_COLOR,o.ZERO,o.ONE);break;case MultiplyBlending:o.blendFunc(o.ZERO,o.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",Qt);break}ht=null,mt=null,St=null,yt=null,wt.set(0,0,0),Et=0,dt=Qt,_t=yr}return}Vn=Vn||an,Gn=Gn||hn,ur=ur||_n,(an!==lt||Vn!==xt)&&(o.blendEquationSeparate(gn[an],gn[Vn]),lt=an,xt=Vn),(hn!==ht||_n!==mt||Gn!==St||ur!==yt)&&(o.blendFuncSeparate(bn[hn],bn[_n],bn[Gn],bn[ur]),ht=hn,mt=_n,St=Gn,yt=ur),(Mr.equals(wt)===!1||Ir!==Et)&&(o.blendColor(Mr.r,Mr.g,Mr.b,Ir),wt.copy(Mr),Et=Ir),dt=Qt,_t=!1}function Jn(Qt,an){Qt.side===DoubleSide?On(o.CULL_FACE):vn(o.CULL_FACE);let hn=Qt.side===BackSide;an&&(hn=!hn),Cn(hn),Qt.blending===NormalBlending&&Qt.transparent===!1?Kt(NoBlending):Kt(Qt.blending,Qt.blendEquation,Qt.blendSrc,Qt.blendDst,Qt.blendEquationAlpha,Qt.blendSrcAlpha,Qt.blendDstAlpha,Qt.blendColor,Qt.blendAlpha,Qt.premultipliedAlpha),b.setFunc(Qt.depthFunc),b.setTest(Qt.depthTest),b.setMask(Qt.depthWrite),d.setMask(Qt.colorWrite);const _n=Qt.stencilWrite;_e.setTest(_n),_n&&(_e.setMask(Qt.stencilWriteMask),_e.setFunc(Qt.stencilFunc,Qt.stencilRef,Qt.stencilFuncMask),_e.setOp(Qt.stencilFail,Qt.stencilZFail,Qt.stencilZPass)),ir(Qt.polygonOffset,Qt.polygonOffsetFactor,Qt.polygonOffsetUnits),Qt.alphaToCoverage===!0?vn(o.SAMPLE_ALPHA_TO_COVERAGE):On(o.SAMPLE_ALPHA_TO_COVERAGE)}function Cn(Qt){vt!==Qt&&(Qt?o.frontFace(o.CW):o.frontFace(o.CCW),vt=Qt)}function kn(Qt){Qt!==CullFaceNone?(vn(o.CULL_FACE),Qt!==Mt&&(Qt===CullFaceBack?o.cullFace(o.BACK):Qt===CullFaceFront?o.cullFace(o.FRONT):o.cullFace(o.FRONT_AND_BACK))):On(o.CULL_FACE),Mt=Qt}function Nn(Qt){Qt!==jt&&(Ot&&o.lineWidth(Qt),jt=Qt)}function ir(Qt,an,hn){Qt?(vn(o.POLYGON_OFFSET_FILL),(Lt!==an||Nt!==hn)&&(o.polygonOffset(an,hn),Lt=an,Nt=hn)):On(o.POLYGON_OFFSET_FILL)}function Un(Qt){Qt?vn(o.SCISSOR_TEST):On(o.SCISSOR_TEST)}function zt(Qt){Qt===void 0&&(Qt=o.TEXTURE0+kt-1),Ut!==Qt&&(o.activeTexture(Qt),Ut=Qt)}function It(Qt,an,hn){hn===void 0&&(Ut===null?hn=o.TEXTURE0+kt-1:hn=Ut);let _n=Gt[hn];_n===void 0&&(_n={type:void 0,texture:void 0},Gt[hn]=_n),(_n.type!==Qt||_n.texture!==an)&&(Ut!==hn&&(o.activeTexture(hn),Ut=hn),o.bindTexture(Qt,an||cn[Qt]),_n.type=Qt,_n.texture=an)}function on(){const Qt=Gt[Ut];Qt!==void 0&&Qt.type!==void 0&&(o.bindTexture(Qt.type,null),Qt.type=void 0,Qt.texture=void 0)}function xn(){try{o.compressedTexImage2D.apply(o,arguments)}catch(Qt){console.error("THREE.WebGLState:",Qt)}}function wn(){try{o.compressedTexImage3D.apply(o,arguments)}catch(Qt){console.error("THREE.WebGLState:",Qt)}}function En(){try{o.texSubImage2D.apply(o,arguments)}catch(Qt){console.error("THREE.WebGLState:",Qt)}}function Hn(){try{o.texSubImage3D.apply(o,arguments)}catch(Qt){console.error("THREE.WebGLState:",Qt)}}function Fn(){try{o.compressedTexSubImage2D.apply(o,arguments)}catch(Qt){console.error("THREE.WebGLState:",Qt)}}function zn(){try{o.compressedTexSubImage3D.apply(o,arguments)}catch(Qt){console.error("THREE.WebGLState:",Qt)}}function xr(){try{o.texStorage2D.apply(o,arguments)}catch(Qt){console.error("THREE.WebGLState:",Qt)}}function Tn(){try{o.texStorage3D.apply(o,arguments)}catch(Qt){console.error("THREE.WebGLState:",Qt)}}function Qn(){try{o.texImage2D.apply(o,arguments)}catch(Qt){console.error("THREE.WebGLState:",Qt)}}function sr(){try{o.texImage3D.apply(o,arguments)}catch(Qt){console.error("THREE.WebGLState:",Qt)}}function er(Qt){sn.equals(Qt)===!1&&(o.scissor(Qt.x,Qt.y,Qt.z,Qt.w),sn.copy(Qt))}function Xn(Qt){Bt.equals(Qt)===!1&&(o.viewport(Qt.x,Qt.y,Qt.z,Qt.w),Bt.copy(Qt))}function qt(Qt,an){let hn=nt.get(an);hn===void 0&&(hn=new WeakMap,nt.set(an,hn));let _n=hn.get(Qt);_n===void 0&&(_n=o.getUniformBlockIndex(an,Qt.name),hn.set(Qt,_n))}function fn(Qt,an){const _n=nt.get(an).get(Qt);tt.get(an)!==_n&&(o.uniformBlockBinding(an,_n,Qt.__bindingPointIndex),tt.set(an,_n))}function jn(){o.disable(o.BLEND),o.disable(o.CULL_FACE),o.disable(o.DEPTH_TEST),o.disable(o.POLYGON_OFFSET_FILL),o.disable(o.SCISSOR_TEST),o.disable(o.STENCIL_TEST),o.disable(o.SAMPLE_ALPHA_TO_COVERAGE),o.blendEquation(o.FUNC_ADD),o.blendFunc(o.ONE,o.ZERO),o.blendFuncSeparate(o.ONE,o.ZERO,o.ONE,o.ZERO),o.blendColor(0,0,0,0),o.colorMask(!0,!0,!0,!0),o.clearColor(0,0,0,0),o.depthMask(!0),o.depthFunc(o.LESS),b.setReversed(!1),o.clearDepth(1),o.stencilMask(4294967295),o.stencilFunc(o.ALWAYS,0,4294967295),o.stencilOp(o.KEEP,o.KEEP,o.KEEP),o.clearStencil(0),o.cullFace(o.BACK),o.frontFace(o.CCW),o.polygonOffset(0,0),o.activeTexture(o.TEXTURE0),o.bindFramebuffer(o.FRAMEBUFFER,null),o.bindFramebuffer(o.DRAW_FRAMEBUFFER,null),o.bindFramebuffer(o.READ_FRAMEBUFFER,null),o.useProgram(null),o.lineWidth(1),o.scissor(0,0,o.canvas.width,o.canvas.height),o.viewport(0,0,o.canvas.width,o.canvas.height),it={},Ut=null,Gt={},ot={},at=new WeakMap,ct=[],ut=null,ft=!1,dt=null,lt=null,ht=null,mt=null,xt=null,St=null,yt=null,wt=new Color(0,0,0),Et=0,_t=!1,vt=null,Mt=null,jt=null,Lt=null,Nt=null,sn.set(0,0,o.canvas.width,o.canvas.height),Bt.set(0,0,o.canvas.width,o.canvas.height),d.reset(),b.reset(),_e.reset()}return{buffers:{color:d,depth:b,stencil:_e},enable:vn,disable:On,bindFramebuffer:rr,drawBuffers:Wn,useProgram:Bn,setBlending:Kt,setMaterial:Jn,setFlipSided:Cn,setCullFace:kn,setLineWidth:Nn,setPolygonOffset:ir,setScissorTest:Un,activeTexture:zt,bindTexture:It,unbindTexture:on,compressedTexImage2D:xn,compressedTexImage3D:wn,texImage2D:Qn,texImage3D:sr,updateUBOMapping:qt,uniformBlockBinding:fn,texStorage2D:xr,texStorage3D:Tn,texSubImage2D:En,texSubImage3D:Hn,compressedTexSubImage2D:Fn,compressedTexSubImage3D:zn,scissor:er,viewport:Xn,reset:jn}}function contain(o,e){const s=o.image&&o.image.width?o.image.width/o.image.height:1;return s>e?(o.repeat.x=1,o.repeat.y=s/e,o.offset.x=0,o.offset.y=(1-o.repeat.y)/2):(o.repeat.x=e/s,o.repeat.y=1,o.offset.x=(1-o.repeat.x)/2,o.offset.y=0),o}function cover(o,e){const s=o.image&&o.image.width?o.image.width/o.image.height:1;return s>e?(o.repeat.x=e/s,o.repeat.y=1,o.offset.x=(1-o.repeat.x)/2,o.offset.y=0):(o.repeat.x=1,o.repeat.y=s/e,o.offset.x=0,o.offset.y=(1-o.repeat.y)/2),o}function fill(o){return o.repeat.x=1,o.repeat.y=1,o.offset.x=0,o.offset.y=0,o}function getByteLength(o,e,s,a){const c=getTextureTypeByteLength(a);switch(s){case AlphaFormat:return o*e;case LuminanceFormat:return o*e;case LuminanceAlphaFormat:return o*e*2;case RedFormat:return o*e/c.components*c.byteLength;case RedIntegerFormat:return o*e/c.components*c.byteLength;case RGFormat:return o*e*2/c.components*c.byteLength;case RGIntegerFormat:return o*e*2/c.components*c.byteLength;case RGBFormat:return o*e*3/c.components*c.byteLength;case RGBAFormat:return o*e*4/c.components*c.byteLength;case RGBAIntegerFormat:return o*e*4/c.components*c.byteLength;case RGB_S3TC_DXT1_Format:case RGBA_S3TC_DXT1_Format:return Math.floor((o+3)/4)*Math.floor((e+3)/4)*8;case RGBA_S3TC_DXT3_Format:case RGBA_S3TC_DXT5_Format:return Math.floor((o+3)/4)*Math.floor((e+3)/4)*16;case RGB_PVRTC_2BPPV1_Format:case RGBA_PVRTC_2BPPV1_Format:return Math.max(o,16)*Math.max(e,8)/4;case RGB_PVRTC_4BPPV1_Format:case RGBA_PVRTC_4BPPV1_Format:return Math.max(o,8)*Math.max(e,8)/2;case RGB_ETC1_Format:case RGB_ETC2_Format:return Math.floor((o+3)/4)*Math.floor((e+3)/4)*8;case RGBA_ETC2_EAC_Format:return Math.floor((o+3)/4)*Math.floor((e+3)/4)*16;case RGBA_ASTC_4x4_Format:return Math.floor((o+3)/4)*Math.floor((e+3)/4)*16;case RGBA_ASTC_5x4_Format:return Math.floor((o+4)/5)*Math.floor((e+3)/4)*16;case RGBA_ASTC_5x5_Format:return Math.floor((o+4)/5)*Math.floor((e+4)/5)*16;case RGBA_ASTC_6x5_Format:return Math.floor((o+5)/6)*Math.floor((e+4)/5)*16;case RGBA_ASTC_6x6_Format:return Math.floor((o+5)/6)*Math.floor((e+5)/6)*16;case RGBA_ASTC_8x5_Format:return Math.floor((o+7)/8)*Math.floor((e+4)/5)*16;case RGBA_ASTC_8x6_Format:return Math.floor((o+7)/8)*Math.floor((e+5)/6)*16;case RGBA_ASTC_8x8_Format:return Math.floor((o+7)/8)*Math.floor((e+7)/8)*16;case RGBA_ASTC_10x5_Format:return Math.floor((o+9)/10)*Math.floor((e+4)/5)*16;case RGBA_ASTC_10x6_Format:return Math.floor((o+9)/10)*Math.floor((e+5)/6)*16;case RGBA_ASTC_10x8_Format:return Math.floor((o+9)/10)*Math.floor((e+7)/8)*16;case RGBA_ASTC_10x10_Format:return Math.floor((o+9)/10)*Math.floor((e+9)/10)*16;case RGBA_ASTC_12x10_Format:return Math.floor((o+11)/12)*Math.floor((e+9)/10)*16;case RGBA_ASTC_12x12_Format:return Math.floor((o+11)/12)*Math.floor((e+11)/12)*16;case RGBA_BPTC_Format:case RGB_BPTC_SIGNED_Format:case RGB_BPTC_UNSIGNED_Format:return Math.ceil(o/4)*Math.ceil(e/4)*16;case RED_RGTC1_Format:case SIGNED_RED_RGTC1_Format:return Math.ceil(o/4)*Math.ceil(e/4)*8;case RED_GREEN_RGTC2_Format:case SIGNED_RED_GREEN_RGTC2_Format:return Math.ceil(o/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${s} format.`)}function getTextureTypeByteLength(o){switch(o){case UnsignedByteType:case ByteType:return{byteLength:1,components:1};case UnsignedShortType:case ShortType:case HalfFloatType:return{byteLength:2,components:1};case UnsignedShort4444Type:case UnsignedShort5551Type:return{byteLength:2,components:4};case UnsignedIntType:case IntType:case FloatType:return{byteLength:4,components:1};case UnsignedInt5999Type:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${o}.`)}const TextureUtils={contain,cover,fill,getByteLength};function WebGLTextures(o,e,s,a,c,d,b){const _e=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,tt=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),nt=new Vector2,it=new WeakMap;let ot;const at=new WeakMap;let ct=!1;try{ct=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function ut(zt,It){return ct?new OffscreenCanvas(zt,It):createElementNS("canvas")}function ft(zt,It,on){let xn=1;const wn=Un(zt);if((wn.width>on||wn.height>on)&&(xn=on/Math.max(wn.width,wn.height)),xn<1)if(typeof HTMLImageElement<"u"&&zt instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&zt instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&zt instanceof ImageBitmap||typeof VideoFrame<"u"&&zt instanceof VideoFrame){const En=Math.floor(xn*wn.width),Hn=Math.floor(xn*wn.height);ot===void 0&&(ot=ut(En,Hn));const Fn=It?ut(En,Hn):ot;return Fn.width=En,Fn.height=Hn,Fn.getContext("2d").drawImage(zt,0,0,En,Hn),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+wn.width+"x"+wn.height+") to ("+En+"x"+Hn+")."),Fn}else return"data"in zt&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+wn.width+"x"+wn.height+")."),zt;return zt}function dt(zt){return zt.generateMipmaps}function lt(zt){o.generateMipmap(zt)}function ht(zt){return zt.isWebGLCubeRenderTarget?o.TEXTURE_CUBE_MAP:zt.isWebGL3DRenderTarget?o.TEXTURE_3D:zt.isWebGLArrayRenderTarget||zt.isCompressedArrayTexture?o.TEXTURE_2D_ARRAY:o.TEXTURE_2D}function mt(zt,It,on,xn,wn=!1){if(zt!==null){if(o[zt]!==void 0)return o[zt];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+zt+"'")}let En=It;if(It===o.RED&&(on===o.FLOAT&&(En=o.R32F),on===o.HALF_FLOAT&&(En=o.R16F),on===o.UNSIGNED_BYTE&&(En=o.R8)),It===o.RED_INTEGER&&(on===o.UNSIGNED_BYTE&&(En=o.R8UI),on===o.UNSIGNED_SHORT&&(En=o.R16UI),on===o.UNSIGNED_INT&&(En=o.R32UI),on===o.BYTE&&(En=o.R8I),on===o.SHORT&&(En=o.R16I),on===o.INT&&(En=o.R32I)),It===o.RG&&(on===o.FLOAT&&(En=o.RG32F),on===o.HALF_FLOAT&&(En=o.RG16F),on===o.UNSIGNED_BYTE&&(En=o.RG8)),It===o.RG_INTEGER&&(on===o.UNSIGNED_BYTE&&(En=o.RG8UI),on===o.UNSIGNED_SHORT&&(En=o.RG16UI),on===o.UNSIGNED_INT&&(En=o.RG32UI),on===o.BYTE&&(En=o.RG8I),on===o.SHORT&&(En=o.RG16I),on===o.INT&&(En=o.RG32I)),It===o.RGB_INTEGER&&(on===o.UNSIGNED_BYTE&&(En=o.RGB8UI),on===o.UNSIGNED_SHORT&&(En=o.RGB16UI),on===o.UNSIGNED_INT&&(En=o.RGB32UI),on===o.BYTE&&(En=o.RGB8I),on===o.SHORT&&(En=o.RGB16I),on===o.INT&&(En=o.RGB32I)),It===o.RGBA_INTEGER&&(on===o.UNSIGNED_BYTE&&(En=o.RGBA8UI),on===o.UNSIGNED_SHORT&&(En=o.RGBA16UI),on===o.UNSIGNED_INT&&(En=o.RGBA32UI),on===o.BYTE&&(En=o.RGBA8I),on===o.SHORT&&(En=o.RGBA16I),on===o.INT&&(En=o.RGBA32I)),It===o.RGB&&on===o.UNSIGNED_INT_5_9_9_9_REV&&(En=o.RGB9_E5),It===o.RGBA){const Hn=wn?LinearTransfer:ColorManagement.getTransfer(xn);on===o.FLOAT&&(En=o.RGBA32F),on===o.HALF_FLOAT&&(En=o.RGBA16F),on===o.UNSIGNED_BYTE&&(En=Hn===SRGBTransfer?o.SRGB8_ALPHA8:o.RGBA8),on===o.UNSIGNED_SHORT_4_4_4_4&&(En=o.RGBA4),on===o.UNSIGNED_SHORT_5_5_5_1&&(En=o.RGB5_A1)}return(En===o.R16F||En===o.R32F||En===o.RG16F||En===o.RG32F||En===o.RGBA16F||En===o.RGBA32F)&&e.get("EXT_color_buffer_float"),En}function xt(zt,It){let on;return zt?It===null||It===UnsignedIntType||It===UnsignedInt248Type?on=o.DEPTH24_STENCIL8:It===FloatType?on=o.DEPTH32F_STENCIL8:It===UnsignedShortType&&(on=o.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):It===null||It===UnsignedIntType||It===UnsignedInt248Type?on=o.DEPTH_COMPONENT24:It===FloatType?on=o.DEPTH_COMPONENT32F:It===UnsignedShortType&&(on=o.DEPTH_COMPONENT16),on}function St(zt,It){return dt(zt)===!0||zt.isFramebufferTexture&&zt.minFilter!==NearestFilter&&zt.minFilter!==LinearFilter?Math.log2(Math.max(It.width,It.height))+1:zt.mipmaps!==void 0&&zt.mipmaps.length>0?zt.mipmaps.length:zt.isCompressedTexture&&Array.isArray(zt.image)?It.mipmaps.length:1}function yt(zt){const It=zt.target;It.removeEventListener("dispose",yt),Et(It),It.isVideoTexture&&it.delete(It)}function wt(zt){const It=zt.target;It.removeEventListener("dispose",wt),vt(It)}function Et(zt){const It=a.get(zt);if(It.__webglInit===void 0)return;const on=zt.source,xn=at.get(on);if(xn){const wn=xn[It.__cacheKey];wn.usedTimes--,wn.usedTimes===0&&_t(zt),Object.keys(xn).length===0&&at.delete(on)}a.remove(zt)}function _t(zt){const It=a.get(zt);o.deleteTexture(It.__webglTexture);const on=zt.source,xn=at.get(on);delete xn[It.__cacheKey],b.memory.textures--}function vt(zt){const It=a.get(zt);if(zt.depthTexture&&(zt.depthTexture.dispose(),a.remove(zt.depthTexture)),zt.isWebGLCubeRenderTarget)for(let xn=0;xn<6;xn++){if(Array.isArray(It.__webglFramebuffer[xn]))for(let wn=0;wn<It.__webglFramebuffer[xn].length;wn++)o.deleteFramebuffer(It.__webglFramebuffer[xn][wn]);else o.deleteFramebuffer(It.__webglFramebuffer[xn]);It.__webglDepthbuffer&&o.deleteRenderbuffer(It.__webglDepthbuffer[xn])}else{if(Array.isArray(It.__webglFramebuffer))for(let xn=0;xn<It.__webglFramebuffer.length;xn++)o.deleteFramebuffer(It.__webglFramebuffer[xn]);else o.deleteFramebuffer(It.__webglFramebuffer);if(It.__webglDepthbuffer&&o.deleteRenderbuffer(It.__webglDepthbuffer),It.__webglMultisampledFramebuffer&&o.deleteFramebuffer(It.__webglMultisampledFramebuffer),It.__webglColorRenderbuffer)for(let xn=0;xn<It.__webglColorRenderbuffer.length;xn++)It.__webglColorRenderbuffer[xn]&&o.deleteRenderbuffer(It.__webglColorRenderbuffer[xn]);It.__webglDepthRenderbuffer&&o.deleteRenderbuffer(It.__webglDepthRenderbuffer)}const on=zt.textures;for(let xn=0,wn=on.length;xn<wn;xn++){const En=a.get(on[xn]);En.__webglTexture&&(o.deleteTexture(En.__webglTexture),b.memory.textures--),a.remove(on[xn])}a.remove(zt)}let Mt=0;function jt(){Mt=0}function Lt(){const zt=Mt;return zt>=c.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+zt+" texture units while this GPU supports only "+c.maxTextures),Mt+=1,zt}function Nt(zt){const It=[];return It.push(zt.wrapS),It.push(zt.wrapT),It.push(zt.wrapR||0),It.push(zt.magFilter),It.push(zt.minFilter),It.push(zt.anisotropy),It.push(zt.internalFormat),It.push(zt.format),It.push(zt.type),It.push(zt.generateMipmaps),It.push(zt.premultiplyAlpha),It.push(zt.flipY),It.push(zt.unpackAlignment),It.push(zt.colorSpace),It.join()}function kt(zt,It){const on=a.get(zt);if(zt.isVideoTexture&&Nn(zt),zt.isRenderTargetTexture===!1&&zt.version>0&&on.__version!==zt.version){const xn=zt.image;if(xn===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(xn.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{Bt(on,zt,It);return}}s.bindTexture(o.TEXTURE_2D,on.__webglTexture,o.TEXTURE0+It)}function Ot(zt,It){const on=a.get(zt);if(zt.version>0&&on.__version!==zt.version){Bt(on,zt,It);return}s.bindTexture(o.TEXTURE_2D_ARRAY,on.__webglTexture,o.TEXTURE0+It)}function Ht(zt,It){const on=a.get(zt);if(zt.version>0&&on.__version!==zt.version){Bt(on,zt,It);return}s.bindTexture(o.TEXTURE_3D,on.__webglTexture,o.TEXTURE0+It)}function Ct(zt,It){const on=a.get(zt);if(zt.version>0&&on.__version!==zt.version){tn(on,zt,It);return}s.bindTexture(o.TEXTURE_CUBE_MAP,on.__webglTexture,o.TEXTURE0+It)}const Ut={[RepeatWrapping]:o.REPEAT,[ClampToEdgeWrapping]:o.CLAMP_TO_EDGE,[MirroredRepeatWrapping]:o.MIRRORED_REPEAT},Gt={[NearestFilter]:o.NEAREST,[NearestMipmapNearestFilter]:o.NEAREST_MIPMAP_NEAREST,[NearestMipmapLinearFilter]:o.NEAREST_MIPMAP_LINEAR,[LinearFilter]:o.LINEAR,[LinearMipmapNearestFilter]:o.LINEAR_MIPMAP_NEAREST,[LinearMipmapLinearFilter]:o.LINEAR_MIPMAP_LINEAR},Pt={[NeverCompare]:o.NEVER,[AlwaysCompare]:o.ALWAYS,[LessCompare]:o.LESS,[LessEqualCompare]:o.LEQUAL,[EqualCompare]:o.EQUAL,[GreaterEqualCompare]:o.GEQUAL,[GreaterCompare]:o.GREATER,[NotEqualCompare]:o.NOTEQUAL};function Wt(zt,It){if(It.type===FloatType&&e.has("OES_texture_float_linear")===!1&&(It.magFilter===LinearFilter||It.magFilter===LinearMipmapNearestFilter||It.magFilter===NearestMipmapLinearFilter||It.magFilter===LinearMipmapLinearFilter||It.minFilter===LinearFilter||It.minFilter===LinearMipmapNearestFilter||It.minFilter===NearestMipmapLinearFilter||It.minFilter===LinearMipmapLinearFilter)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),o.texParameteri(zt,o.TEXTURE_WRAP_S,Ut[It.wrapS]),o.texParameteri(zt,o.TEXTURE_WRAP_T,Ut[It.wrapT]),(zt===o.TEXTURE_3D||zt===o.TEXTURE_2D_ARRAY)&&o.texParameteri(zt,o.TEXTURE_WRAP_R,Ut[It.wrapR]),o.texParameteri(zt,o.TEXTURE_MAG_FILTER,Gt[It.magFilter]),o.texParameteri(zt,o.TEXTURE_MIN_FILTER,Gt[It.minFilter]),It.compareFunction&&(o.texParameteri(zt,o.TEXTURE_COMPARE_MODE,o.COMPARE_REF_TO_TEXTURE),o.texParameteri(zt,o.TEXTURE_COMPARE_FUNC,Pt[It.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(It.magFilter===NearestFilter||It.minFilter!==NearestMipmapLinearFilter&&It.minFilter!==LinearMipmapLinearFilter||It.type===FloatType&&e.has("OES_texture_float_linear")===!1)return;if(It.anisotropy>1||a.get(It).__currentAnisotropy){const on=e.get("EXT_texture_filter_anisotropic");o.texParameterf(zt,on.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(It.anisotropy,c.getMaxAnisotropy())),a.get(It).__currentAnisotropy=It.anisotropy}}}function sn(zt,It){let on=!1;zt.__webglInit===void 0&&(zt.__webglInit=!0,It.addEventListener("dispose",yt));const xn=It.source;let wn=at.get(xn);wn===void 0&&(wn={},at.set(xn,wn));const En=Nt(It);if(En!==zt.__cacheKey){wn[En]===void 0&&(wn[En]={texture:o.createTexture(),usedTimes:0},b.memory.textures++,on=!0),wn[En].usedTimes++;const Hn=wn[zt.__cacheKey];Hn!==void 0&&(wn[zt.__cacheKey].usedTimes--,Hn.usedTimes===0&&_t(It)),zt.__cacheKey=En,zt.__webglTexture=wn[En].texture}return on}function Bt(zt,It,on){let xn=o.TEXTURE_2D;(It.isDataArrayTexture||It.isCompressedArrayTexture)&&(xn=o.TEXTURE_2D_ARRAY),It.isData3DTexture&&(xn=o.TEXTURE_3D);const wn=sn(zt,It),En=It.source;s.bindTexture(xn,zt.__webglTexture,o.TEXTURE0+on);const Hn=a.get(En);if(En.version!==Hn.__version||wn===!0){s.activeTexture(o.TEXTURE0+on);const Fn=ColorManagement.getPrimaries(ColorManagement.workingColorSpace),zn=It.colorSpace===NoColorSpace?null:ColorManagement.getPrimaries(It.colorSpace),xr=It.colorSpace===NoColorSpace||Fn===zn?o.NONE:o.BROWSER_DEFAULT_WEBGL;o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,It.flipY),o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,It.premultiplyAlpha),o.pixelStorei(o.UNPACK_ALIGNMENT,It.unpackAlignment),o.pixelStorei(o.UNPACK_COLORSPACE_CONVERSION_WEBGL,xr);let Tn=ft(It.image,!1,c.maxTextureSize);Tn=ir(It,Tn);const Qn=d.convert(It.format,It.colorSpace),sr=d.convert(It.type);let er=mt(It.internalFormat,Qn,sr,It.colorSpace,It.isVideoTexture);Wt(xn,It);let Xn;const qt=It.mipmaps,fn=It.isVideoTexture!==!0,jn=Hn.__version===void 0||wn===!0,Qt=En.dataReady,an=St(It,Tn);if(It.isDepthTexture)er=xt(It.format===DepthStencilFormat,It.type),jn&&(fn?s.texStorage2D(o.TEXTURE_2D,1,er,Tn.width,Tn.height):s.texImage2D(o.TEXTURE_2D,0,er,Tn.width,Tn.height,0,Qn,sr,null));else if(It.isDataTexture)if(qt.length>0){fn&&jn&&s.texStorage2D(o.TEXTURE_2D,an,er,qt[0].width,qt[0].height);for(let hn=0,_n=qt.length;hn<_n;hn++)Xn=qt[hn],fn?Qt&&s.texSubImage2D(o.TEXTURE_2D,hn,0,0,Xn.width,Xn.height,Qn,sr,Xn.data):s.texImage2D(o.TEXTURE_2D,hn,er,Xn.width,Xn.height,0,Qn,sr,Xn.data);It.generateMipmaps=!1}else fn?(jn&&s.texStorage2D(o.TEXTURE_2D,an,er,Tn.width,Tn.height),Qt&&s.texSubImage2D(o.TEXTURE_2D,0,0,0,Tn.width,Tn.height,Qn,sr,Tn.data)):s.texImage2D(o.TEXTURE_2D,0,er,Tn.width,Tn.height,0,Qn,sr,Tn.data);else if(It.isCompressedTexture)if(It.isCompressedArrayTexture){fn&&jn&&s.texStorage3D(o.TEXTURE_2D_ARRAY,an,er,qt[0].width,qt[0].height,Tn.depth);for(let hn=0,_n=qt.length;hn<_n;hn++)if(Xn=qt[hn],It.format!==RGBAFormat)if(Qn!==null)if(fn){if(Qt)if(It.layerUpdates.size>0){const Vn=getByteLength(Xn.width,Xn.height,It.format,It.type);for(const Gn of It.layerUpdates){const ur=Xn.data.subarray(Gn*Vn/Xn.data.BYTES_PER_ELEMENT,(Gn+1)*Vn/Xn.data.BYTES_PER_ELEMENT);s.compressedTexSubImage3D(o.TEXTURE_2D_ARRAY,hn,0,0,Gn,Xn.width,Xn.height,1,Qn,ur)}It.clearLayerUpdates()}else s.compressedTexSubImage3D(o.TEXTURE_2D_ARRAY,hn,0,0,0,Xn.width,Xn.height,Tn.depth,Qn,Xn.data)}else s.compressedTexImage3D(o.TEXTURE_2D_ARRAY,hn,er,Xn.width,Xn.height,Tn.depth,0,Xn.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else fn?Qt&&s.texSubImage3D(o.TEXTURE_2D_ARRAY,hn,0,0,0,Xn.width,Xn.height,Tn.depth,Qn,sr,Xn.data):s.texImage3D(o.TEXTURE_2D_ARRAY,hn,er,Xn.width,Xn.height,Tn.depth,0,Qn,sr,Xn.data)}else{fn&&jn&&s.texStorage2D(o.TEXTURE_2D,an,er,qt[0].width,qt[0].height);for(let hn=0,_n=qt.length;hn<_n;hn++)Xn=qt[hn],It.format!==RGBAFormat?Qn!==null?fn?Qt&&s.compressedTexSubImage2D(o.TEXTURE_2D,hn,0,0,Xn.width,Xn.height,Qn,Xn.data):s.compressedTexImage2D(o.TEXTURE_2D,hn,er,Xn.width,Xn.height,0,Xn.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):fn?Qt&&s.texSubImage2D(o.TEXTURE_2D,hn,0,0,Xn.width,Xn.height,Qn,sr,Xn.data):s.texImage2D(o.TEXTURE_2D,hn,er,Xn.width,Xn.height,0,Qn,sr,Xn.data)}else if(It.isDataArrayTexture)if(fn){if(jn&&s.texStorage3D(o.TEXTURE_2D_ARRAY,an,er,Tn.width,Tn.height,Tn.depth),Qt)if(It.layerUpdates.size>0){const hn=getByteLength(Tn.width,Tn.height,It.format,It.type);for(const _n of It.layerUpdates){const Vn=Tn.data.subarray(_n*hn/Tn.data.BYTES_PER_ELEMENT,(_n+1)*hn/Tn.data.BYTES_PER_ELEMENT);s.texSubImage3D(o.TEXTURE_2D_ARRAY,0,0,0,_n,Tn.width,Tn.height,1,Qn,sr,Vn)}It.clearLayerUpdates()}else s.texSubImage3D(o.TEXTURE_2D_ARRAY,0,0,0,0,Tn.width,Tn.height,Tn.depth,Qn,sr,Tn.data)}else s.texImage3D(o.TEXTURE_2D_ARRAY,0,er,Tn.width,Tn.height,Tn.depth,0,Qn,sr,Tn.data);else if(It.isData3DTexture)fn?(jn&&s.texStorage3D(o.TEXTURE_3D,an,er,Tn.width,Tn.height,Tn.depth),Qt&&s.texSubImage3D(o.TEXTURE_3D,0,0,0,0,Tn.width,Tn.height,Tn.depth,Qn,sr,Tn.data)):s.texImage3D(o.TEXTURE_3D,0,er,Tn.width,Tn.height,Tn.depth,0,Qn,sr,Tn.data);else if(It.isFramebufferTexture){if(jn)if(fn)s.texStorage2D(o.TEXTURE_2D,an,er,Tn.width,Tn.height);else{let hn=Tn.width,_n=Tn.height;for(let Vn=0;Vn<an;Vn++)s.texImage2D(o.TEXTURE_2D,Vn,er,hn,_n,0,Qn,sr,null),hn>>=1,_n>>=1}}else if(qt.length>0){if(fn&&jn){const hn=Un(qt[0]);s.texStorage2D(o.TEXTURE_2D,an,er,hn.width,hn.height)}for(let hn=0,_n=qt.length;hn<_n;hn++)Xn=qt[hn],fn?Qt&&s.texSubImage2D(o.TEXTURE_2D,hn,0,0,Qn,sr,Xn):s.texImage2D(o.TEXTURE_2D,hn,er,Qn,sr,Xn);It.generateMipmaps=!1}else if(fn){if(jn){const hn=Un(Tn);s.texStorage2D(o.TEXTURE_2D,an,er,hn.width,hn.height)}Qt&&s.texSubImage2D(o.TEXTURE_2D,0,0,0,Qn,sr,Tn)}else s.texImage2D(o.TEXTURE_2D,0,er,Qn,sr,Tn);dt(It)&&lt(xn),Hn.__version=En.version,It.onUpdate&&It.onUpdate(It)}zt.__version=It.version}function tn(zt,It,on){if(It.image.length!==6)return;const xn=sn(zt,It),wn=It.source;s.bindTexture(o.TEXTURE_CUBE_MAP,zt.__webglTexture,o.TEXTURE0+on);const En=a.get(wn);if(wn.version!==En.__version||xn===!0){s.activeTexture(o.TEXTURE0+on);const Hn=ColorManagement.getPrimaries(ColorManagement.workingColorSpace),Fn=It.colorSpace===NoColorSpace?null:ColorManagement.getPrimaries(It.colorSpace),zn=It.colorSpace===NoColorSpace||Hn===Fn?o.NONE:o.BROWSER_DEFAULT_WEBGL;o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,It.flipY),o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,It.premultiplyAlpha),o.pixelStorei(o.UNPACK_ALIGNMENT,It.unpackAlignment),o.pixelStorei(o.UNPACK_COLORSPACE_CONVERSION_WEBGL,zn);const xr=It.isCompressedTexture||It.image[0].isCompressedTexture,Tn=It.image[0]&&It.image[0].isDataTexture,Qn=[];for(let _n=0;_n<6;_n++)!xr&&!Tn?Qn[_n]=ft(It.image[_n],!0,c.maxCubemapSize):Qn[_n]=Tn?It.image[_n].image:It.image[_n],Qn[_n]=ir(It,Qn[_n]);const sr=Qn[0],er=d.convert(It.format,It.colorSpace),Xn=d.convert(It.type),qt=mt(It.internalFormat,er,Xn,It.colorSpace),fn=It.isVideoTexture!==!0,jn=En.__version===void 0||xn===!0,Qt=wn.dataReady;let an=St(It,sr);Wt(o.TEXTURE_CUBE_MAP,It);let hn;if(xr){fn&&jn&&s.texStorage2D(o.TEXTURE_CUBE_MAP,an,qt,sr.width,sr.height);for(let _n=0;_n<6;_n++){hn=Qn[_n].mipmaps;for(let Vn=0;Vn<hn.length;Vn++){const Gn=hn[Vn];It.format!==RGBAFormat?er!==null?fn?Qt&&s.compressedTexSubImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+_n,Vn,0,0,Gn.width,Gn.height,er,Gn.data):s.compressedTexImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+_n,Vn,qt,Gn.width,Gn.height,0,Gn.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):fn?Qt&&s.texSubImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+_n,Vn,0,0,Gn.width,Gn.height,er,Xn,Gn.data):s.texImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+_n,Vn,qt,Gn.width,Gn.height,0,er,Xn,Gn.data)}}}else{if(hn=It.mipmaps,fn&&jn){hn.length>0&&an++;const _n=Un(Qn[0]);s.texStorage2D(o.TEXTURE_CUBE_MAP,an,qt,_n.width,_n.height)}for(let _n=0;_n<6;_n++)if(Tn){fn?Qt&&s.texSubImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+_n,0,0,0,Qn[_n].width,Qn[_n].height,er,Xn,Qn[_n].data):s.texImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+_n,0,qt,Qn[_n].width,Qn[_n].height,0,er,Xn,Qn[_n].data);for(let Vn=0;Vn<hn.length;Vn++){const ur=hn[Vn].image[_n].image;fn?Qt&&s.texSubImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+_n,Vn+1,0,0,ur.width,ur.height,er,Xn,ur.data):s.texImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+_n,Vn+1,qt,ur.width,ur.height,0,er,Xn,ur.data)}}else{fn?Qt&&s.texSubImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+_n,0,0,0,er,Xn,Qn[_n]):s.texImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+_n,0,qt,er,Xn,Qn[_n]);for(let Vn=0;Vn<hn.length;Vn++){const Gn=hn[Vn];fn?Qt&&s.texSubImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+_n,Vn+1,0,0,er,Xn,Gn.image[_n]):s.texImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+_n,Vn+1,qt,er,Xn,Gn.image[_n])}}}dt(It)&&lt(o.TEXTURE_CUBE_MAP),En.__version=wn.version,It.onUpdate&&It.onUpdate(It)}zt.__version=It.version}function cn(zt,It,on,xn,wn,En){const Hn=d.convert(on.format,on.colorSpace),Fn=d.convert(on.type),zn=mt(on.internalFormat,Hn,Fn,on.colorSpace),xr=a.get(It),Tn=a.get(on);if(Tn.__renderTarget=It,!xr.__hasExternalTextures){const Qn=Math.max(1,It.width>>En),sr=Math.max(1,It.height>>En);wn===o.TEXTURE_3D||wn===o.TEXTURE_2D_ARRAY?s.texImage3D(wn,En,zn,Qn,sr,It.depth,0,Hn,Fn,null):s.texImage2D(wn,En,zn,Qn,sr,0,Hn,Fn,null)}s.bindFramebuffer(o.FRAMEBUFFER,zt),kn(It)?_e.framebufferTexture2DMultisampleEXT(o.FRAMEBUFFER,xn,wn,Tn.__webglTexture,0,Cn(It)):(wn===o.TEXTURE_2D||wn>=o.TEXTURE_CUBE_MAP_POSITIVE_X&&wn<=o.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&o.framebufferTexture2D(o.FRAMEBUFFER,xn,wn,Tn.__webglTexture,En),s.bindFramebuffer(o.FRAMEBUFFER,null)}function vn(zt,It,on){if(o.bindRenderbuffer(o.RENDERBUFFER,zt),It.depthBuffer){const xn=It.depthTexture,wn=xn&&xn.isDepthTexture?xn.type:null,En=xt(It.stencilBuffer,wn),Hn=It.stencilBuffer?o.DEPTH_STENCIL_ATTACHMENT:o.DEPTH_ATTACHMENT,Fn=Cn(It);kn(It)?_e.renderbufferStorageMultisampleEXT(o.RENDERBUFFER,Fn,En,It.width,It.height):on?o.renderbufferStorageMultisample(o.RENDERBUFFER,Fn,En,It.width,It.height):o.renderbufferStorage(o.RENDERBUFFER,En,It.width,It.height),o.framebufferRenderbuffer(o.FRAMEBUFFER,Hn,o.RENDERBUFFER,zt)}else{const xn=It.textures;for(let wn=0;wn<xn.length;wn++){const En=xn[wn],Hn=d.convert(En.format,En.colorSpace),Fn=d.convert(En.type),zn=mt(En.internalFormat,Hn,Fn,En.colorSpace),xr=Cn(It);on&&kn(It)===!1?o.renderbufferStorageMultisample(o.RENDERBUFFER,xr,zn,It.width,It.height):kn(It)?_e.renderbufferStorageMultisampleEXT(o.RENDERBUFFER,xr,zn,It.width,It.height):o.renderbufferStorage(o.RENDERBUFFER,zn,It.width,It.height)}}o.bindRenderbuffer(o.RENDERBUFFER,null)}function On(zt,It){if(It&&It.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(s.bindFramebuffer(o.FRAMEBUFFER,zt),!(It.depthTexture&&It.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const xn=a.get(It.depthTexture);xn.__renderTarget=It,(!xn.__webglTexture||It.depthTexture.image.width!==It.width||It.depthTexture.image.height!==It.height)&&(It.depthTexture.image.width=It.width,It.depthTexture.image.height=It.height,It.depthTexture.needsUpdate=!0),kt(It.depthTexture,0);const wn=xn.__webglTexture,En=Cn(It);if(It.depthTexture.format===DepthFormat)kn(It)?_e.framebufferTexture2DMultisampleEXT(o.FRAMEBUFFER,o.DEPTH_ATTACHMENT,o.TEXTURE_2D,wn,0,En):o.framebufferTexture2D(o.FRAMEBUFFER,o.DEPTH_ATTACHMENT,o.TEXTURE_2D,wn,0);else if(It.depthTexture.format===DepthStencilFormat)kn(It)?_e.framebufferTexture2DMultisampleEXT(o.FRAMEBUFFER,o.DEPTH_STENCIL_ATTACHMENT,o.TEXTURE_2D,wn,0,En):o.framebufferTexture2D(o.FRAMEBUFFER,o.DEPTH_STENCIL_ATTACHMENT,o.TEXTURE_2D,wn,0);else throw new Error("Unknown depthTexture format")}function rr(zt){const It=a.get(zt),on=zt.isWebGLCubeRenderTarget===!0;if(It.__boundDepthTexture!==zt.depthTexture){const xn=zt.depthTexture;if(It.__depthDisposeCallback&&It.__depthDisposeCallback(),xn){const wn=()=>{delete It.__boundDepthTexture,delete It.__depthDisposeCallback,xn.removeEventListener("dispose",wn)};xn.addEventListener("dispose",wn),It.__depthDisposeCallback=wn}It.__boundDepthTexture=xn}if(zt.depthTexture&&!It.__autoAllocateDepthBuffer){if(on)throw new Error("target.depthTexture not supported in Cube render targets");On(It.__webglFramebuffer,zt)}else if(on){It.__webglDepthbuffer=[];for(let xn=0;xn<6;xn++)if(s.bindFramebuffer(o.FRAMEBUFFER,It.__webglFramebuffer[xn]),It.__webglDepthbuffer[xn]===void 0)It.__webglDepthbuffer[xn]=o.createRenderbuffer(),vn(It.__webglDepthbuffer[xn],zt,!1);else{const wn=zt.stencilBuffer?o.DEPTH_STENCIL_ATTACHMENT:o.DEPTH_ATTACHMENT,En=It.__webglDepthbuffer[xn];o.bindRenderbuffer(o.RENDERBUFFER,En),o.framebufferRenderbuffer(o.FRAMEBUFFER,wn,o.RENDERBUFFER,En)}}else if(s.bindFramebuffer(o.FRAMEBUFFER,It.__webglFramebuffer),It.__webglDepthbuffer===void 0)It.__webglDepthbuffer=o.createRenderbuffer(),vn(It.__webglDepthbuffer,zt,!1);else{const xn=zt.stencilBuffer?o.DEPTH_STENCIL_ATTACHMENT:o.DEPTH_ATTACHMENT,wn=It.__webglDepthbuffer;o.bindRenderbuffer(o.RENDERBUFFER,wn),o.framebufferRenderbuffer(o.FRAMEBUFFER,xn,o.RENDERBUFFER,wn)}s.bindFramebuffer(o.FRAMEBUFFER,null)}function Wn(zt,It,on){const xn=a.get(zt);It!==void 0&&cn(xn.__webglFramebuffer,zt,zt.texture,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,0),on!==void 0&&rr(zt)}function Bn(zt){const It=zt.texture,on=a.get(zt),xn=a.get(It);zt.addEventListener("dispose",wt);const wn=zt.textures,En=zt.isWebGLCubeRenderTarget===!0,Hn=wn.length>1;if(Hn||(xn.__webglTexture===void 0&&(xn.__webglTexture=o.createTexture()),xn.__version=It.version,b.memory.textures++),En){on.__webglFramebuffer=[];for(let Fn=0;Fn<6;Fn++)if(It.mipmaps&&It.mipmaps.length>0){on.__webglFramebuffer[Fn]=[];for(let zn=0;zn<It.mipmaps.length;zn++)on.__webglFramebuffer[Fn][zn]=o.createFramebuffer()}else on.__webglFramebuffer[Fn]=o.createFramebuffer()}else{if(It.mipmaps&&It.mipmaps.length>0){on.__webglFramebuffer=[];for(let Fn=0;Fn<It.mipmaps.length;Fn++)on.__webglFramebuffer[Fn]=o.createFramebuffer()}else on.__webglFramebuffer=o.createFramebuffer();if(Hn)for(let Fn=0,zn=wn.length;Fn<zn;Fn++){const xr=a.get(wn[Fn]);xr.__webglTexture===void 0&&(xr.__webglTexture=o.createTexture(),b.memory.textures++)}if(zt.samples>0&&kn(zt)===!1){on.__webglMultisampledFramebuffer=o.createFramebuffer(),on.__webglColorRenderbuffer=[],s.bindFramebuffer(o.FRAMEBUFFER,on.__webglMultisampledFramebuffer);for(let Fn=0;Fn<wn.length;Fn++){const zn=wn[Fn];on.__webglColorRenderbuffer[Fn]=o.createRenderbuffer(),o.bindRenderbuffer(o.RENDERBUFFER,on.__webglColorRenderbuffer[Fn]);const xr=d.convert(zn.format,zn.colorSpace),Tn=d.convert(zn.type),Qn=mt(zn.internalFormat,xr,Tn,zn.colorSpace,zt.isXRRenderTarget===!0),sr=Cn(zt);o.renderbufferStorageMultisample(o.RENDERBUFFER,sr,Qn,zt.width,zt.height),o.framebufferRenderbuffer(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0+Fn,o.RENDERBUFFER,on.__webglColorRenderbuffer[Fn])}o.bindRenderbuffer(o.RENDERBUFFER,null),zt.depthBuffer&&(on.__webglDepthRenderbuffer=o.createRenderbuffer(),vn(on.__webglDepthRenderbuffer,zt,!0)),s.bindFramebuffer(o.FRAMEBUFFER,null)}}if(En){s.bindTexture(o.TEXTURE_CUBE_MAP,xn.__webglTexture),Wt(o.TEXTURE_CUBE_MAP,It);for(let Fn=0;Fn<6;Fn++)if(It.mipmaps&&It.mipmaps.length>0)for(let zn=0;zn<It.mipmaps.length;zn++)cn(on.__webglFramebuffer[Fn][zn],zt,It,o.COLOR_ATTACHMENT0,o.TEXTURE_CUBE_MAP_POSITIVE_X+Fn,zn);else cn(on.__webglFramebuffer[Fn],zt,It,o.COLOR_ATTACHMENT0,o.TEXTURE_CUBE_MAP_POSITIVE_X+Fn,0);dt(It)&&lt(o.TEXTURE_CUBE_MAP),s.unbindTexture()}else if(Hn){for(let Fn=0,zn=wn.length;Fn<zn;Fn++){const xr=wn[Fn],Tn=a.get(xr);s.bindTexture(o.TEXTURE_2D,Tn.__webglTexture),Wt(o.TEXTURE_2D,xr),cn(on.__webglFramebuffer,zt,xr,o.COLOR_ATTACHMENT0+Fn,o.TEXTURE_2D,0),dt(xr)&&lt(o.TEXTURE_2D)}s.unbindTexture()}else{let Fn=o.TEXTURE_2D;if((zt.isWebGL3DRenderTarget||zt.isWebGLArrayRenderTarget)&&(Fn=zt.isWebGL3DRenderTarget?o.TEXTURE_3D:o.TEXTURE_2D_ARRAY),s.bindTexture(Fn,xn.__webglTexture),Wt(Fn,It),It.mipmaps&&It.mipmaps.length>0)for(let zn=0;zn<It.mipmaps.length;zn++)cn(on.__webglFramebuffer[zn],zt,It,o.COLOR_ATTACHMENT0,Fn,zn);else cn(on.__webglFramebuffer,zt,It,o.COLOR_ATTACHMENT0,Fn,0);dt(It)&&lt(Fn),s.unbindTexture()}zt.depthBuffer&&rr(zt)}function gn(zt){const It=zt.textures;for(let on=0,xn=It.length;on<xn;on++){const wn=It[on];if(dt(wn)){const En=ht(zt),Hn=a.get(wn).__webglTexture;s.bindTexture(En,Hn),lt(En),s.unbindTexture()}}}const bn=[],Kt=[];function Jn(zt){if(zt.samples>0){if(kn(zt)===!1){const It=zt.textures,on=zt.width,xn=zt.height;let wn=o.COLOR_BUFFER_BIT;const En=zt.stencilBuffer?o.DEPTH_STENCIL_ATTACHMENT:o.DEPTH_ATTACHMENT,Hn=a.get(zt),Fn=It.length>1;if(Fn)for(let zn=0;zn<It.length;zn++)s.bindFramebuffer(o.FRAMEBUFFER,Hn.__webglMultisampledFramebuffer),o.framebufferRenderbuffer(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0+zn,o.RENDERBUFFER,null),s.bindFramebuffer(o.FRAMEBUFFER,Hn.__webglFramebuffer),o.framebufferTexture2D(o.DRAW_FRAMEBUFFER,o.COLOR_ATTACHMENT0+zn,o.TEXTURE_2D,null,0);s.bindFramebuffer(o.READ_FRAMEBUFFER,Hn.__webglMultisampledFramebuffer),s.bindFramebuffer(o.DRAW_FRAMEBUFFER,Hn.__webglFramebuffer);for(let zn=0;zn<It.length;zn++){if(zt.resolveDepthBuffer&&(zt.depthBuffer&&(wn|=o.DEPTH_BUFFER_BIT),zt.stencilBuffer&&zt.resolveStencilBuffer&&(wn|=o.STENCIL_BUFFER_BIT)),Fn){o.framebufferRenderbuffer(o.READ_FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.RENDERBUFFER,Hn.__webglColorRenderbuffer[zn]);const xr=a.get(It[zn]).__webglTexture;o.framebufferTexture2D(o.DRAW_FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,xr,0)}o.blitFramebuffer(0,0,on,xn,0,0,on,xn,wn,o.NEAREST),tt===!0&&(bn.length=0,Kt.length=0,bn.push(o.COLOR_ATTACHMENT0+zn),zt.depthBuffer&&zt.resolveDepthBuffer===!1&&(bn.push(En),Kt.push(En),o.invalidateFramebuffer(o.DRAW_FRAMEBUFFER,Kt)),o.invalidateFramebuffer(o.READ_FRAMEBUFFER,bn))}if(s.bindFramebuffer(o.READ_FRAMEBUFFER,null),s.bindFramebuffer(o.DRAW_FRAMEBUFFER,null),Fn)for(let zn=0;zn<It.length;zn++){s.bindFramebuffer(o.FRAMEBUFFER,Hn.__webglMultisampledFramebuffer),o.framebufferRenderbuffer(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0+zn,o.RENDERBUFFER,Hn.__webglColorRenderbuffer[zn]);const xr=a.get(It[zn]).__webglTexture;s.bindFramebuffer(o.FRAMEBUFFER,Hn.__webglFramebuffer),o.framebufferTexture2D(o.DRAW_FRAMEBUFFER,o.COLOR_ATTACHMENT0+zn,o.TEXTURE_2D,xr,0)}s.bindFramebuffer(o.DRAW_FRAMEBUFFER,Hn.__webglMultisampledFramebuffer)}else if(zt.depthBuffer&&zt.resolveDepthBuffer===!1&&tt){const It=zt.stencilBuffer?o.DEPTH_STENCIL_ATTACHMENT:o.DEPTH_ATTACHMENT;o.invalidateFramebuffer(o.DRAW_FRAMEBUFFER,[It])}}}function Cn(zt){return Math.min(c.maxSamples,zt.samples)}function kn(zt){const It=a.get(zt);return zt.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&It.__useRenderToTexture!==!1}function Nn(zt){const It=b.render.frame;it.get(zt)!==It&&(it.set(zt,It),zt.update())}function ir(zt,It){const on=zt.colorSpace,xn=zt.format,wn=zt.type;return zt.isCompressedTexture===!0||zt.isVideoTexture===!0||on!==LinearSRGBColorSpace$1&&on!==NoColorSpace&&(ColorManagement.getTransfer(on)===SRGBTransfer?(xn!==RGBAFormat||wn!==UnsignedByteType)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",on)),It}function Un(zt){return typeof HTMLImageElement<"u"&&zt instanceof HTMLImageElement?(nt.width=zt.naturalWidth||zt.width,nt.height=zt.naturalHeight||zt.height):typeof VideoFrame<"u"&&zt instanceof VideoFrame?(nt.width=zt.displayWidth,nt.height=zt.displayHeight):(nt.width=zt.width,nt.height=zt.height),nt}this.allocateTextureUnit=Lt,this.resetTextureUnits=jt,this.setTexture2D=kt,this.setTexture2DArray=Ot,this.setTexture3D=Ht,this.setTextureCube=Ct,this.rebindTextures=Wn,this.setupRenderTarget=Bn,this.updateRenderTargetMipmap=gn,this.updateMultisampleRenderTarget=Jn,this.setupDepthRenderbuffer=rr,this.setupFrameBufferTexture=cn,this.useMultisampledRTT=kn}function WebGLUtils(o,e){function s(a,c=NoColorSpace){let d;const b=ColorManagement.getTransfer(c);if(a===UnsignedByteType)return o.UNSIGNED_BYTE;if(a===UnsignedShort4444Type)return o.UNSIGNED_SHORT_4_4_4_4;if(a===UnsignedShort5551Type)return o.UNSIGNED_SHORT_5_5_5_1;if(a===UnsignedInt5999Type)return o.UNSIGNED_INT_5_9_9_9_REV;if(a===ByteType)return o.BYTE;if(a===ShortType)return o.SHORT;if(a===UnsignedShortType)return o.UNSIGNED_SHORT;if(a===IntType)return o.INT;if(a===UnsignedIntType)return o.UNSIGNED_INT;if(a===FloatType)return o.FLOAT;if(a===HalfFloatType)return o.HALF_FLOAT;if(a===AlphaFormat)return o.ALPHA;if(a===RGBFormat)return o.RGB;if(a===RGBAFormat)return o.RGBA;if(a===LuminanceFormat)return o.LUMINANCE;if(a===LuminanceAlphaFormat)return o.LUMINANCE_ALPHA;if(a===DepthFormat)return o.DEPTH_COMPONENT;if(a===DepthStencilFormat)return o.DEPTH_STENCIL;if(a===RedFormat)return o.RED;if(a===RedIntegerFormat)return o.RED_INTEGER;if(a===RGFormat)return o.RG;if(a===RGIntegerFormat)return o.RG_INTEGER;if(a===RGBAIntegerFormat)return o.RGBA_INTEGER;if(a===RGB_S3TC_DXT1_Format||a===RGBA_S3TC_DXT1_Format||a===RGBA_S3TC_DXT3_Format||a===RGBA_S3TC_DXT5_Format)if(b===SRGBTransfer)if(d=e.get("WEBGL_compressed_texture_s3tc_srgb"),d!==null){if(a===RGB_S3TC_DXT1_Format)return d.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(a===RGBA_S3TC_DXT1_Format)return d.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(a===RGBA_S3TC_DXT3_Format)return d.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(a===RGBA_S3TC_DXT5_Format)return d.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(d=e.get("WEBGL_compressed_texture_s3tc"),d!==null){if(a===RGB_S3TC_DXT1_Format)return d.COMPRESSED_RGB_S3TC_DXT1_EXT;if(a===RGBA_S3TC_DXT1_Format)return d.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(a===RGBA_S3TC_DXT3_Format)return d.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(a===RGBA_S3TC_DXT5_Format)return d.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(a===RGB_PVRTC_4BPPV1_Format||a===RGB_PVRTC_2BPPV1_Format||a===RGBA_PVRTC_4BPPV1_Format||a===RGBA_PVRTC_2BPPV1_Format)if(d=e.get("WEBGL_compressed_texture_pvrtc"),d!==null){if(a===RGB_PVRTC_4BPPV1_Format)return d.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(a===RGB_PVRTC_2BPPV1_Format)return d.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(a===RGBA_PVRTC_4BPPV1_Format)return d.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(a===RGBA_PVRTC_2BPPV1_Format)return d.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(a===RGB_ETC1_Format||a===RGB_ETC2_Format||a===RGBA_ETC2_EAC_Format)if(d=e.get("WEBGL_compressed_texture_etc"),d!==null){if(a===RGB_ETC1_Format||a===RGB_ETC2_Format)return b===SRGBTransfer?d.COMPRESSED_SRGB8_ETC2:d.COMPRESSED_RGB8_ETC2;if(a===RGBA_ETC2_EAC_Format)return b===SRGBTransfer?d.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:d.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(a===RGBA_ASTC_4x4_Format||a===RGBA_ASTC_5x4_Format||a===RGBA_ASTC_5x5_Format||a===RGBA_ASTC_6x5_Format||a===RGBA_ASTC_6x6_Format||a===RGBA_ASTC_8x5_Format||a===RGBA_ASTC_8x6_Format||a===RGBA_ASTC_8x8_Format||a===RGBA_ASTC_10x5_Format||a===RGBA_ASTC_10x6_Format||a===RGBA_ASTC_10x8_Format||a===RGBA_ASTC_10x10_Format||a===RGBA_ASTC_12x10_Format||a===RGBA_ASTC_12x12_Format)if(d=e.get("WEBGL_compressed_texture_astc"),d!==null){if(a===RGBA_ASTC_4x4_Format)return b===SRGBTransfer?d.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:d.COMPRESSED_RGBA_ASTC_4x4_KHR;if(a===RGBA_ASTC_5x4_Format)return b===SRGBTransfer?d.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:d.COMPRESSED_RGBA_ASTC_5x4_KHR;if(a===RGBA_ASTC_5x5_Format)return b===SRGBTransfer?d.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:d.COMPRESSED_RGBA_ASTC_5x5_KHR;if(a===RGBA_ASTC_6x5_Format)return b===SRGBTransfer?d.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:d.COMPRESSED_RGBA_ASTC_6x5_KHR;if(a===RGBA_ASTC_6x6_Format)return b===SRGBTransfer?d.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:d.COMPRESSED_RGBA_ASTC_6x6_KHR;if(a===RGBA_ASTC_8x5_Format)return b===SRGBTransfer?d.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:d.COMPRESSED_RGBA_ASTC_8x5_KHR;if(a===RGBA_ASTC_8x6_Format)return b===SRGBTransfer?d.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:d.COMPRESSED_RGBA_ASTC_8x6_KHR;if(a===RGBA_ASTC_8x8_Format)return b===SRGBTransfer?d.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:d.COMPRESSED_RGBA_ASTC_8x8_KHR;if(a===RGBA_ASTC_10x5_Format)return b===SRGBTransfer?d.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:d.COMPRESSED_RGBA_ASTC_10x5_KHR;if(a===RGBA_ASTC_10x6_Format)return b===SRGBTransfer?d.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:d.COMPRESSED_RGBA_ASTC_10x6_KHR;if(a===RGBA_ASTC_10x8_Format)return b===SRGBTransfer?d.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:d.COMPRESSED_RGBA_ASTC_10x8_KHR;if(a===RGBA_ASTC_10x10_Format)return b===SRGBTransfer?d.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:d.COMPRESSED_RGBA_ASTC_10x10_KHR;if(a===RGBA_ASTC_12x10_Format)return b===SRGBTransfer?d.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:d.COMPRESSED_RGBA_ASTC_12x10_KHR;if(a===RGBA_ASTC_12x12_Format)return b===SRGBTransfer?d.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:d.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(a===RGBA_BPTC_Format||a===RGB_BPTC_SIGNED_Format||a===RGB_BPTC_UNSIGNED_Format)if(d=e.get("EXT_texture_compression_bptc"),d!==null){if(a===RGBA_BPTC_Format)return b===SRGBTransfer?d.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:d.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(a===RGB_BPTC_SIGNED_Format)return d.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(a===RGB_BPTC_UNSIGNED_Format)return d.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(a===RED_RGTC1_Format||a===SIGNED_RED_RGTC1_Format||a===RED_GREEN_RGTC2_Format||a===SIGNED_RED_GREEN_RGTC2_Format)if(d=e.get("EXT_texture_compression_rgtc"),d!==null){if(a===RGBA_BPTC_Format)return d.COMPRESSED_RED_RGTC1_EXT;if(a===SIGNED_RED_RGTC1_Format)return d.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(a===RED_GREEN_RGTC2_Format)return d.COMPRESSED_RED_GREEN_RGTC2_EXT;if(a===SIGNED_RED_GREEN_RGTC2_Format)return d.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return a===UnsignedInt248Type?o.UNSIGNED_INT_24_8:o[a]!==void 0?o[a]:null}return{convert:s}}class ArrayCamera extends PerspectiveCamera{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class Group extends Object3D{constructor(){super(),this.isGroup=!0,this.type="Group"}}const _moveEvent={type:"move"};class WebXRController{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Group,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Group,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Vector3,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Vector3),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Group,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Vector3,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Vector3),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const s=this._hand;if(s)for(const a of e.hand.values())this._getHandJoint(s,a)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,s,a){let c=null,d=null,b=null;const _e=this._targetRay,tt=this._grip,nt=this._hand;if(e&&s.session.visibilityState!=="visible-blurred"){if(nt&&e.hand){b=!0;for(const ft of e.hand.values()){const dt=s.getJointPose(ft,a),lt=this._getHandJoint(nt,ft);dt!==null&&(lt.matrix.fromArray(dt.transform.matrix),lt.matrix.decompose(lt.position,lt.rotation,lt.scale),lt.matrixWorldNeedsUpdate=!0,lt.jointRadius=dt.radius),lt.visible=dt!==null}const it=nt.joints["index-finger-tip"],ot=nt.joints["thumb-tip"],at=it.position.distanceTo(ot.position),ct=.02,ut=.005;nt.inputState.pinching&&at>ct+ut?(nt.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!nt.inputState.pinching&&at<=ct-ut&&(nt.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else tt!==null&&e.gripSpace&&(d=s.getPose(e.gripSpace,a),d!==null&&(tt.matrix.fromArray(d.transform.matrix),tt.matrix.decompose(tt.position,tt.rotation,tt.scale),tt.matrixWorldNeedsUpdate=!0,d.linearVelocity?(tt.hasLinearVelocity=!0,tt.linearVelocity.copy(d.linearVelocity)):tt.hasLinearVelocity=!1,d.angularVelocity?(tt.hasAngularVelocity=!0,tt.angularVelocity.copy(d.angularVelocity)):tt.hasAngularVelocity=!1));_e!==null&&(c=s.getPose(e.targetRaySpace,a),c===null&&d!==null&&(c=d),c!==null&&(_e.matrix.fromArray(c.transform.matrix),_e.matrix.decompose(_e.position,_e.rotation,_e.scale),_e.matrixWorldNeedsUpdate=!0,c.linearVelocity?(_e.hasLinearVelocity=!0,_e.linearVelocity.copy(c.linearVelocity)):_e.hasLinearVelocity=!1,c.angularVelocity?(_e.hasAngularVelocity=!0,_e.angularVelocity.copy(c.angularVelocity)):_e.hasAngularVelocity=!1,this.dispatchEvent(_moveEvent)))}return _e!==null&&(_e.visible=c!==null),tt!==null&&(tt.visible=d!==null),nt!==null&&(nt.visible=b!==null),this}_getHandJoint(e,s){if(e.joints[s.jointName]===void 0){const a=new Group;a.matrixAutoUpdate=!1,a.visible=!1,e.joints[s.jointName]=a,e.add(a)}return e.joints[s.jointName]}}const _occlusion_vertex=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,_occlusion_fragment=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class WebXRDepthSensing{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,s,a){if(this.texture===null){const c=new Texture,d=e.properties.get(c);d.__webglTexture=s.texture,(s.depthNear!=a.depthNear||s.depthFar!=a.depthFar)&&(this.depthNear=s.depthNear,this.depthFar=s.depthFar),this.texture=c}}getMesh(e){if(this.texture!==null&&this.mesh===null){const s=e.cameras[0].viewport,a=new ShaderMaterial({vertexShader:_occlusion_vertex,fragmentShader:_occlusion_fragment,uniforms:{depthColor:{value:this.texture},depthWidth:{value:s.z},depthHeight:{value:s.w}}});this.mesh=new Mesh(new PlaneGeometry(20,20),a)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class WebXRManager extends EventDispatcher$1{constructor(e,s){super();const a=this;let c=null,d=1,b=null,_e="local-floor",tt=1,nt=null,it=null,ot=null,at=null,ct=null,ut=null;const ft=new WebXRDepthSensing,dt=s.getContextAttributes();let lt=null,ht=null;const mt=[],xt=[],St=new Vector2;let yt=null;const wt=new PerspectiveCamera;wt.viewport=new Vector4;const Et=new PerspectiveCamera;Et.viewport=new Vector4;const _t=[wt,Et],vt=new ArrayCamera;let Mt=null,jt=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(Bt){let tn=mt[Bt];return tn===void 0&&(tn=new WebXRController,mt[Bt]=tn),tn.getTargetRaySpace()},this.getControllerGrip=function(Bt){let tn=mt[Bt];return tn===void 0&&(tn=new WebXRController,mt[Bt]=tn),tn.getGripSpace()},this.getHand=function(Bt){let tn=mt[Bt];return tn===void 0&&(tn=new WebXRController,mt[Bt]=tn),tn.getHandSpace()};function Lt(Bt){const tn=xt.indexOf(Bt.inputSource);if(tn===-1)return;const cn=mt[tn];cn!==void 0&&(cn.update(Bt.inputSource,Bt.frame,nt||b),cn.dispatchEvent({type:Bt.type,data:Bt.inputSource}))}function Nt(){c.removeEventListener("select",Lt),c.removeEventListener("selectstart",Lt),c.removeEventListener("selectend",Lt),c.removeEventListener("squeeze",Lt),c.removeEventListener("squeezestart",Lt),c.removeEventListener("squeezeend",Lt),c.removeEventListener("end",Nt),c.removeEventListener("inputsourceschange",kt);for(let Bt=0;Bt<mt.length;Bt++){const tn=xt[Bt];tn!==null&&(xt[Bt]=null,mt[Bt].disconnect(tn))}Mt=null,jt=null,ft.reset(),e.setRenderTarget(lt),ct=null,at=null,ot=null,c=null,ht=null,sn.stop(),a.isPresenting=!1,e.setPixelRatio(yt),e.setSize(St.width,St.height,!1),a.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(Bt){d=Bt,a.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(Bt){_e=Bt,a.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return nt||b},this.setReferenceSpace=function(Bt){nt=Bt},this.getBaseLayer=function(){return at!==null?at:ct},this.getBinding=function(){return ot},this.getFrame=function(){return ut},this.getSession=function(){return c},this.setSession=async function(Bt){if(c=Bt,c!==null){if(lt=e.getRenderTarget(),c.addEventListener("select",Lt),c.addEventListener("selectstart",Lt),c.addEventListener("selectend",Lt),c.addEventListener("squeeze",Lt),c.addEventListener("squeezestart",Lt),c.addEventListener("squeezeend",Lt),c.addEventListener("end",Nt),c.addEventListener("inputsourceschange",kt),dt.xrCompatible!==!0&&await s.makeXRCompatible(),yt=e.getPixelRatio(),e.getSize(St),c.renderState.layers===void 0){const tn={antialias:dt.antialias,alpha:!0,depth:dt.depth,stencil:dt.stencil,framebufferScaleFactor:d};ct=new XRWebGLLayer(c,s,tn),c.updateRenderState({baseLayer:ct}),e.setPixelRatio(1),e.setSize(ct.framebufferWidth,ct.framebufferHeight,!1),ht=new WebGLRenderTarget(ct.framebufferWidth,ct.framebufferHeight,{format:RGBAFormat,type:UnsignedByteType,colorSpace:e.outputColorSpace,stencilBuffer:dt.stencil})}else{let tn=null,cn=null,vn=null;dt.depth&&(vn=dt.stencil?s.DEPTH24_STENCIL8:s.DEPTH_COMPONENT24,tn=dt.stencil?DepthStencilFormat:DepthFormat,cn=dt.stencil?UnsignedInt248Type:UnsignedIntType);const On={colorFormat:s.RGBA8,depthFormat:vn,scaleFactor:d};ot=new XRWebGLBinding(c,s),at=ot.createProjectionLayer(On),c.updateRenderState({layers:[at]}),e.setPixelRatio(1),e.setSize(at.textureWidth,at.textureHeight,!1),ht=new WebGLRenderTarget(at.textureWidth,at.textureHeight,{format:RGBAFormat,type:UnsignedByteType,depthTexture:new DepthTexture(at.textureWidth,at.textureHeight,cn,void 0,void 0,void 0,void 0,void 0,void 0,tn),stencilBuffer:dt.stencil,colorSpace:e.outputColorSpace,samples:dt.antialias?4:0,resolveDepthBuffer:at.ignoreDepthValues===!1})}ht.isXRRenderTarget=!0,this.setFoveation(tt),nt=null,b=await c.requestReferenceSpace(_e),sn.setContext(c),sn.start(),a.isPresenting=!0,a.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(c!==null)return c.environmentBlendMode},this.getDepthTexture=function(){return ft.getDepthTexture()};function kt(Bt){for(let tn=0;tn<Bt.removed.length;tn++){const cn=Bt.removed[tn],vn=xt.indexOf(cn);vn>=0&&(xt[vn]=null,mt[vn].disconnect(cn))}for(let tn=0;tn<Bt.added.length;tn++){const cn=Bt.added[tn];let vn=xt.indexOf(cn);if(vn===-1){for(let rr=0;rr<mt.length;rr++)if(rr>=xt.length){xt.push(cn),vn=rr;break}else if(xt[rr]===null){xt[rr]=cn,vn=rr;break}if(vn===-1)break}const On=mt[vn];On&&On.connect(cn)}}const Ot=new Vector3,Ht=new Vector3;function Ct(Bt,tn,cn){Ot.setFromMatrixPosition(tn.matrixWorld),Ht.setFromMatrixPosition(cn.matrixWorld);const vn=Ot.distanceTo(Ht),On=tn.projectionMatrix.elements,rr=cn.projectionMatrix.elements,Wn=On[14]/(On[10]-1),Bn=On[14]/(On[10]+1),gn=(On[9]+1)/On[5],bn=(On[9]-1)/On[5],Kt=(On[8]-1)/On[0],Jn=(rr[8]+1)/rr[0],Cn=Wn*Kt,kn=Wn*Jn,Nn=vn/(-Kt+Jn),ir=Nn*-Kt;if(tn.matrixWorld.decompose(Bt.position,Bt.quaternion,Bt.scale),Bt.translateX(ir),Bt.translateZ(Nn),Bt.matrixWorld.compose(Bt.position,Bt.quaternion,Bt.scale),Bt.matrixWorldInverse.copy(Bt.matrixWorld).invert(),On[10]===-1)Bt.projectionMatrix.copy(tn.projectionMatrix),Bt.projectionMatrixInverse.copy(tn.projectionMatrixInverse);else{const Un=Wn+Nn,zt=Bn+Nn,It=Cn-ir,on=kn+(vn-ir),xn=gn*Bn/zt*Un,wn=bn*Bn/zt*Un;Bt.projectionMatrix.makePerspective(It,on,xn,wn,Un,zt),Bt.projectionMatrixInverse.copy(Bt.projectionMatrix).invert()}}function Ut(Bt,tn){tn===null?Bt.matrixWorld.copy(Bt.matrix):Bt.matrixWorld.multiplyMatrices(tn.matrixWorld,Bt.matrix),Bt.matrixWorldInverse.copy(Bt.matrixWorld).invert()}this.updateCamera=function(Bt){if(c===null)return;let tn=Bt.near,cn=Bt.far;ft.texture!==null&&(ft.depthNear>0&&(tn=ft.depthNear),ft.depthFar>0&&(cn=ft.depthFar)),vt.near=Et.near=wt.near=tn,vt.far=Et.far=wt.far=cn,(Mt!==vt.near||jt!==vt.far)&&(c.updateRenderState({depthNear:vt.near,depthFar:vt.far}),Mt=vt.near,jt=vt.far),wt.layers.mask=Bt.layers.mask|2,Et.layers.mask=Bt.layers.mask|4,vt.layers.mask=wt.layers.mask|Et.layers.mask;const vn=Bt.parent,On=vt.cameras;Ut(vt,vn);for(let rr=0;rr<On.length;rr++)Ut(On[rr],vn);On.length===2?Ct(vt,wt,Et):vt.projectionMatrix.copy(wt.projectionMatrix),Gt(Bt,vt,vn)};function Gt(Bt,tn,cn){cn===null?Bt.matrix.copy(tn.matrixWorld):(Bt.matrix.copy(cn.matrixWorld),Bt.matrix.invert(),Bt.matrix.multiply(tn.matrixWorld)),Bt.matrix.decompose(Bt.position,Bt.quaternion,Bt.scale),Bt.updateMatrixWorld(!0),Bt.projectionMatrix.copy(tn.projectionMatrix),Bt.projectionMatrixInverse.copy(tn.projectionMatrixInverse),Bt.isPerspectiveCamera&&(Bt.fov=RAD2DEG*2*Math.atan(1/Bt.projectionMatrix.elements[5]),Bt.zoom=1)}this.getCamera=function(){return vt},this.getFoveation=function(){if(!(at===null&&ct===null))return tt},this.setFoveation=function(Bt){tt=Bt,at!==null&&(at.fixedFoveation=Bt),ct!==null&&ct.fixedFoveation!==void 0&&(ct.fixedFoveation=Bt)},this.hasDepthSensing=function(){return ft.texture!==null},this.getDepthSensingMesh=function(){return ft.getMesh(vt)};let Pt=null;function Wt(Bt,tn){if(it=tn.getViewerPose(nt||b),ut=tn,it!==null){const cn=it.views;ct!==null&&(e.setRenderTargetFramebuffer(ht,ct.framebuffer),e.setRenderTarget(ht));let vn=!1;cn.length!==vt.cameras.length&&(vt.cameras.length=0,vn=!0);for(let rr=0;rr<cn.length;rr++){const Wn=cn[rr];let Bn=null;if(ct!==null)Bn=ct.getViewport(Wn);else{const bn=ot.getViewSubImage(at,Wn);Bn=bn.viewport,rr===0&&(e.setRenderTargetTextures(ht,bn.colorTexture,at.ignoreDepthValues?void 0:bn.depthStencilTexture),e.setRenderTarget(ht))}let gn=_t[rr];gn===void 0&&(gn=new PerspectiveCamera,gn.layers.enable(rr),gn.viewport=new Vector4,_t[rr]=gn),gn.matrix.fromArray(Wn.transform.matrix),gn.matrix.decompose(gn.position,gn.quaternion,gn.scale),gn.projectionMatrix.fromArray(Wn.projectionMatrix),gn.projectionMatrixInverse.copy(gn.projectionMatrix).invert(),gn.viewport.set(Bn.x,Bn.y,Bn.width,Bn.height),rr===0&&(vt.matrix.copy(gn.matrix),vt.matrix.decompose(vt.position,vt.quaternion,vt.scale)),vn===!0&&vt.cameras.push(gn)}const On=c.enabledFeatures;if(On&&On.includes("depth-sensing")){const rr=ot.getDepthInformation(cn[0]);rr&&rr.isValid&&rr.texture&&ft.init(e,rr,c.renderState)}}for(let cn=0;cn<mt.length;cn++){const vn=xt[cn],On=mt[cn];vn!==null&&On!==void 0&&On.update(vn,tn,nt||b)}Pt&&Pt(Bt,tn),tn.detectedPlanes&&a.dispatchEvent({type:"planesdetected",data:tn}),ut=null}const sn=new WebGLAnimation;sn.setAnimationLoop(Wt),this.setAnimationLoop=function(Bt){Pt=Bt},this.dispose=function(){}}}const _e1=new Euler,_m1=new Matrix4;function WebGLMaterials(o,e){function s(dt,lt){dt.matrixAutoUpdate===!0&&dt.updateMatrix(),lt.value.copy(dt.matrix)}function a(dt,lt){lt.color.getRGB(dt.fogColor.value,getUnlitUniformColorSpace(o)),lt.isFog?(dt.fogNear.value=lt.near,dt.fogFar.value=lt.far):lt.isFogExp2&&(dt.fogDensity.value=lt.density)}function c(dt,lt,ht,mt,xt){lt.isMeshBasicMaterial||lt.isMeshLambertMaterial?d(dt,lt):lt.isMeshToonMaterial?(d(dt,lt),ot(dt,lt)):lt.isMeshPhongMaterial?(d(dt,lt),it(dt,lt)):lt.isMeshStandardMaterial?(d(dt,lt),at(dt,lt),lt.isMeshPhysicalMaterial&&ct(dt,lt,xt)):lt.isMeshMatcapMaterial?(d(dt,lt),ut(dt,lt)):lt.isMeshDepthMaterial?d(dt,lt):lt.isMeshDistanceMaterial?(d(dt,lt),ft(dt,lt)):lt.isMeshNormalMaterial?d(dt,lt):lt.isLineBasicMaterial?(b(dt,lt),lt.isLineDashedMaterial&&_e(dt,lt)):lt.isPointsMaterial?tt(dt,lt,ht,mt):lt.isSpriteMaterial?nt(dt,lt):lt.isShadowMaterial?(dt.color.value.copy(lt.color),dt.opacity.value=lt.opacity):lt.isShaderMaterial&&(lt.uniformsNeedUpdate=!1)}function d(dt,lt){dt.opacity.value=lt.opacity,lt.color&&dt.diffuse.value.copy(lt.color),lt.emissive&&dt.emissive.value.copy(lt.emissive).multiplyScalar(lt.emissiveIntensity),lt.map&&(dt.map.value=lt.map,s(lt.map,dt.mapTransform)),lt.alphaMap&&(dt.alphaMap.value=lt.alphaMap,s(lt.alphaMap,dt.alphaMapTransform)),lt.bumpMap&&(dt.bumpMap.value=lt.bumpMap,s(lt.bumpMap,dt.bumpMapTransform),dt.bumpScale.value=lt.bumpScale,lt.side===BackSide&&(dt.bumpScale.value*=-1)),lt.normalMap&&(dt.normalMap.value=lt.normalMap,s(lt.normalMap,dt.normalMapTransform),dt.normalScale.value.copy(lt.normalScale),lt.side===BackSide&&dt.normalScale.value.negate()),lt.displacementMap&&(dt.displacementMap.value=lt.displacementMap,s(lt.displacementMap,dt.displacementMapTransform),dt.displacementScale.value=lt.displacementScale,dt.displacementBias.value=lt.displacementBias),lt.emissiveMap&&(dt.emissiveMap.value=lt.emissiveMap,s(lt.emissiveMap,dt.emissiveMapTransform)),lt.specularMap&&(dt.specularMap.value=lt.specularMap,s(lt.specularMap,dt.specularMapTransform)),lt.alphaTest>0&&(dt.alphaTest.value=lt.alphaTest);const ht=e.get(lt),mt=ht.envMap,xt=ht.envMapRotation;mt&&(dt.envMap.value=mt,_e1.copy(xt),_e1.x*=-1,_e1.y*=-1,_e1.z*=-1,mt.isCubeTexture&&mt.isRenderTargetTexture===!1&&(_e1.y*=-1,_e1.z*=-1),dt.envMapRotation.value.setFromMatrix4(_m1.makeRotationFromEuler(_e1)),dt.flipEnvMap.value=mt.isCubeTexture&&mt.isRenderTargetTexture===!1?-1:1,dt.reflectivity.value=lt.reflectivity,dt.ior.value=lt.ior,dt.refractionRatio.value=lt.refractionRatio),lt.lightMap&&(dt.lightMap.value=lt.lightMap,dt.lightMapIntensity.value=lt.lightMapIntensity,s(lt.lightMap,dt.lightMapTransform)),lt.aoMap&&(dt.aoMap.value=lt.aoMap,dt.aoMapIntensity.value=lt.aoMapIntensity,s(lt.aoMap,dt.aoMapTransform))}function b(dt,lt){dt.diffuse.value.copy(lt.color),dt.opacity.value=lt.opacity,lt.map&&(dt.map.value=lt.map,s(lt.map,dt.mapTransform))}function _e(dt,lt){dt.dashSize.value=lt.dashSize,dt.totalSize.value=lt.dashSize+lt.gapSize,dt.scale.value=lt.scale}function tt(dt,lt,ht,mt){dt.diffuse.value.copy(lt.color),dt.opacity.value=lt.opacity,dt.size.value=lt.size*ht,dt.scale.value=mt*.5,lt.map&&(dt.map.value=lt.map,s(lt.map,dt.uvTransform)),lt.alphaMap&&(dt.alphaMap.value=lt.alphaMap,s(lt.alphaMap,dt.alphaMapTransform)),lt.alphaTest>0&&(dt.alphaTest.value=lt.alphaTest)}function nt(dt,lt){dt.diffuse.value.copy(lt.color),dt.opacity.value=lt.opacity,dt.rotation.value=lt.rotation,lt.map&&(dt.map.value=lt.map,s(lt.map,dt.mapTransform)),lt.alphaMap&&(dt.alphaMap.value=lt.alphaMap,s(lt.alphaMap,dt.alphaMapTransform)),lt.alphaTest>0&&(dt.alphaTest.value=lt.alphaTest)}function it(dt,lt){dt.specular.value.copy(lt.specular),dt.shininess.value=Math.max(lt.shininess,1e-4)}function ot(dt,lt){lt.gradientMap&&(dt.gradientMap.value=lt.gradientMap)}function at(dt,lt){dt.metalness.value=lt.metalness,lt.metalnessMap&&(dt.metalnessMap.value=lt.metalnessMap,s(lt.metalnessMap,dt.metalnessMapTransform)),dt.roughness.value=lt.roughness,lt.roughnessMap&&(dt.roughnessMap.value=lt.roughnessMap,s(lt.roughnessMap,dt.roughnessMapTransform)),lt.envMap&&(dt.envMapIntensity.value=lt.envMapIntensity)}function ct(dt,lt,ht){dt.ior.value=lt.ior,lt.sheen>0&&(dt.sheenColor.value.copy(lt.sheenColor).multiplyScalar(lt.sheen),dt.sheenRoughness.value=lt.sheenRoughness,lt.sheenColorMap&&(dt.sheenColorMap.value=lt.sheenColorMap,s(lt.sheenColorMap,dt.sheenColorMapTransform)),lt.sheenRoughnessMap&&(dt.sheenRoughnessMap.value=lt.sheenRoughnessMap,s(lt.sheenRoughnessMap,dt.sheenRoughnessMapTransform))),lt.clearcoat>0&&(dt.clearcoat.value=lt.clearcoat,dt.clearcoatRoughness.value=lt.clearcoatRoughness,lt.clearcoatMap&&(dt.clearcoatMap.value=lt.clearcoatMap,s(lt.clearcoatMap,dt.clearcoatMapTransform)),lt.clearcoatRoughnessMap&&(dt.clearcoatRoughnessMap.value=lt.clearcoatRoughnessMap,s(lt.clearcoatRoughnessMap,dt.clearcoatRoughnessMapTransform)),lt.clearcoatNormalMap&&(dt.clearcoatNormalMap.value=lt.clearcoatNormalMap,s(lt.clearcoatNormalMap,dt.clearcoatNormalMapTransform),dt.clearcoatNormalScale.value.copy(lt.clearcoatNormalScale),lt.side===BackSide&&dt.clearcoatNormalScale.value.negate())),lt.dispersion>0&&(dt.dispersion.value=lt.dispersion),lt.iridescence>0&&(dt.iridescence.value=lt.iridescence,dt.iridescenceIOR.value=lt.iridescenceIOR,dt.iridescenceThicknessMinimum.value=lt.iridescenceThicknessRange[0],dt.iridescenceThicknessMaximum.value=lt.iridescenceThicknessRange[1],lt.iridescenceMap&&(dt.iridescenceMap.value=lt.iridescenceMap,s(lt.iridescenceMap,dt.iridescenceMapTransform)),lt.iridescenceThicknessMap&&(dt.iridescenceThicknessMap.value=lt.iridescenceThicknessMap,s(lt.iridescenceThicknessMap,dt.iridescenceThicknessMapTransform))),lt.transmission>0&&(dt.transmission.value=lt.transmission,dt.transmissionSamplerMap.value=ht.texture,dt.transmissionSamplerSize.value.set(ht.width,ht.height),lt.transmissionMap&&(dt.transmissionMap.value=lt.transmissionMap,s(lt.transmissionMap,dt.transmissionMapTransform)),dt.thickness.value=lt.thickness,lt.thicknessMap&&(dt.thicknessMap.value=lt.thicknessMap,s(lt.thicknessMap,dt.thicknessMapTransform)),dt.attenuationDistance.value=lt.attenuationDistance,dt.attenuationColor.value.copy(lt.attenuationColor)),lt.anisotropy>0&&(dt.anisotropyVector.value.set(lt.anisotropy*Math.cos(lt.anisotropyRotation),lt.anisotropy*Math.sin(lt.anisotropyRotation)),lt.anisotropyMap&&(dt.anisotropyMap.value=lt.anisotropyMap,s(lt.anisotropyMap,dt.anisotropyMapTransform))),dt.specularIntensity.value=lt.specularIntensity,dt.specularColor.value.copy(lt.specularColor),lt.specularColorMap&&(dt.specularColorMap.value=lt.specularColorMap,s(lt.specularColorMap,dt.specularColorMapTransform)),lt.specularIntensityMap&&(dt.specularIntensityMap.value=lt.specularIntensityMap,s(lt.specularIntensityMap,dt.specularIntensityMapTransform))}function ut(dt,lt){lt.matcap&&(dt.matcap.value=lt.matcap)}function ft(dt,lt){const ht=e.get(lt).light;dt.referencePosition.value.setFromMatrixPosition(ht.matrixWorld),dt.nearDistance.value=ht.shadow.camera.near,dt.farDistance.value=ht.shadow.camera.far}return{refreshFogUniforms:a,refreshMaterialUniforms:c}}function WebGLUniformsGroups(o,e,s,a){let c={},d={},b=[];const _e=o.getParameter(o.MAX_UNIFORM_BUFFER_BINDINGS);function tt(ht,mt){const xt=mt.program;a.uniformBlockBinding(ht,xt)}function nt(ht,mt){let xt=c[ht.id];xt===void 0&&(ut(ht),xt=it(ht),c[ht.id]=xt,ht.addEventListener("dispose",dt));const St=mt.program;a.updateUBOMapping(ht,St);const yt=e.render.frame;d[ht.id]!==yt&&(at(ht),d[ht.id]=yt)}function it(ht){const mt=ot();ht.__bindingPointIndex=mt;const xt=o.createBuffer(),St=ht.__size,yt=ht.usage;return o.bindBuffer(o.UNIFORM_BUFFER,xt),o.bufferData(o.UNIFORM_BUFFER,St,yt),o.bindBuffer(o.UNIFORM_BUFFER,null),o.bindBufferBase(o.UNIFORM_BUFFER,mt,xt),xt}function ot(){for(let ht=0;ht<_e;ht++)if(b.indexOf(ht)===-1)return b.push(ht),ht;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function at(ht){const mt=c[ht.id],xt=ht.uniforms,St=ht.__cache;o.bindBuffer(o.UNIFORM_BUFFER,mt);for(let yt=0,wt=xt.length;yt<wt;yt++){const Et=Array.isArray(xt[yt])?xt[yt]:[xt[yt]];for(let _t=0,vt=Et.length;_t<vt;_t++){const Mt=Et[_t];if(ct(Mt,yt,_t,St)===!0){const jt=Mt.__offset,Lt=Array.isArray(Mt.value)?Mt.value:[Mt.value];let Nt=0;for(let kt=0;kt<Lt.length;kt++){const Ot=Lt[kt],Ht=ft(Ot);typeof Ot=="number"||typeof Ot=="boolean"?(Mt.__data[0]=Ot,o.bufferSubData(o.UNIFORM_BUFFER,jt+Nt,Mt.__data)):Ot.isMatrix3?(Mt.__data[0]=Ot.elements[0],Mt.__data[1]=Ot.elements[1],Mt.__data[2]=Ot.elements[2],Mt.__data[3]=0,Mt.__data[4]=Ot.elements[3],Mt.__data[5]=Ot.elements[4],Mt.__data[6]=Ot.elements[5],Mt.__data[7]=0,Mt.__data[8]=Ot.elements[6],Mt.__data[9]=Ot.elements[7],Mt.__data[10]=Ot.elements[8],Mt.__data[11]=0):(Ot.toArray(Mt.__data,Nt),Nt+=Ht.storage/Float32Array.BYTES_PER_ELEMENT)}o.bufferSubData(o.UNIFORM_BUFFER,jt,Mt.__data)}}}o.bindBuffer(o.UNIFORM_BUFFER,null)}function ct(ht,mt,xt,St){const yt=ht.value,wt=mt+"_"+xt;if(St[wt]===void 0)return typeof yt=="number"||typeof yt=="boolean"?St[wt]=yt:St[wt]=yt.clone(),!0;{const Et=St[wt];if(typeof yt=="number"||typeof yt=="boolean"){if(Et!==yt)return St[wt]=yt,!0}else if(Et.equals(yt)===!1)return Et.copy(yt),!0}return!1}function ut(ht){const mt=ht.uniforms;let xt=0;const St=16;for(let wt=0,Et=mt.length;wt<Et;wt++){const _t=Array.isArray(mt[wt])?mt[wt]:[mt[wt]];for(let vt=0,Mt=_t.length;vt<Mt;vt++){const jt=_t[vt],Lt=Array.isArray(jt.value)?jt.value:[jt.value];for(let Nt=0,kt=Lt.length;Nt<kt;Nt++){const Ot=Lt[Nt],Ht=ft(Ot),Ct=xt%St,Ut=Ct%Ht.boundary,Gt=Ct+Ut;xt+=Ut,Gt!==0&&St-Gt<Ht.storage&&(xt+=St-Gt),jt.__data=new Float32Array(Ht.storage/Float32Array.BYTES_PER_ELEMENT),jt.__offset=xt,xt+=Ht.storage}}}const yt=xt%St;return yt>0&&(xt+=St-yt),ht.__size=xt,ht.__cache={},this}function ft(ht){const mt={boundary:0,storage:0};return typeof ht=="number"||typeof ht=="boolean"?(mt.boundary=4,mt.storage=4):ht.isVector2?(mt.boundary=8,mt.storage=8):ht.isVector3||ht.isColor?(mt.boundary=16,mt.storage=12):ht.isVector4?(mt.boundary=16,mt.storage=16):ht.isMatrix3?(mt.boundary=48,mt.storage=48):ht.isMatrix4?(mt.boundary=64,mt.storage=64):ht.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",ht),mt}function dt(ht){const mt=ht.target;mt.removeEventListener("dispose",dt);const xt=b.indexOf(mt.__bindingPointIndex);b.splice(xt,1),o.deleteBuffer(c[mt.id]),delete c[mt.id],delete d[mt.id]}function lt(){for(const ht in c)o.deleteBuffer(c[ht]);b=[],c={},d={}}return{bind:tt,update:nt,dispose:lt}}class WebGLRenderer{constructor(e={}){const{canvas:s=createCanvasElement(),context:a=null,depth:c=!0,stencil:d=!1,alpha:b=!1,antialias:_e=!1,premultipliedAlpha:tt=!0,preserveDrawingBuffer:nt=!1,powerPreference:it="default",failIfMajorPerformanceCaveat:ot=!1,reverseDepthBuffer:at=!1}=e;this.isWebGLRenderer=!0;let ct;if(a!==null){if(typeof WebGLRenderingContext<"u"&&a instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");ct=a.getContextAttributes().alpha}else ct=b;const ut=new Uint32Array(4),ft=new Int32Array(4);let dt=null,lt=null;const ht=[],mt=[];this.domElement=s,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=SRGBColorSpace$1,this.toneMapping=NoToneMapping,this.toneMappingExposure=1;const xt=this;let St=!1,yt=0,wt=0,Et=null,_t=-1,vt=null;const Mt=new Vector4,jt=new Vector4;let Lt=null;const Nt=new Color(0);let kt=0,Ot=s.width,Ht=s.height,Ct=1,Ut=null,Gt=null;const Pt=new Vector4(0,0,Ot,Ht),Wt=new Vector4(0,0,Ot,Ht);let sn=!1;const Bt=new Frustum;let tn=!1,cn=!1;const vn=new Matrix4,On=new Matrix4,rr=new Vector3,Wn=new Vector4,Bn={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let gn=!1;function bn(){return Et===null?Ct:1}let Kt=a;function Jn(At,Vt){return s.getContext(At,Vt)}try{const At={alpha:!0,depth:c,stencil:d,antialias:_e,premultipliedAlpha:tt,preserveDrawingBuffer:nt,powerPreference:it,failIfMajorPerformanceCaveat:ot};if("setAttribute"in s&&s.setAttribute("data-engine",`three.js r${REVISION}`),s.addEventListener("webglcontextlost",_n,!1),s.addEventListener("webglcontextrestored",Vn,!1),s.addEventListener("webglcontextcreationerror",Gn,!1),Kt===null){const Vt="webgl2";if(Kt=Jn(Vt,At),Kt===null)throw Jn(Vt)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(At){throw console.error("THREE.WebGLRenderer: "+At.message),At}let Cn,kn,Nn,ir,Un,zt,It,on,xn,wn,En,Hn,Fn,zn,xr,Tn,Qn,sr,er,Xn,qt,fn,jn,Qt;function an(){Cn=new WebGLExtensions(Kt),Cn.init(),fn=new WebGLUtils(Kt,Cn),kn=new WebGLCapabilities(Kt,Cn,e,fn),Nn=new WebGLState(Kt,Cn),kn.reverseDepthBuffer&&at&&Nn.buffers.depth.setReversed(!0),ir=new WebGLInfo(Kt),Un=new WebGLProperties,zt=new WebGLTextures(Kt,Cn,Nn,Un,kn,fn,ir),It=new WebGLCubeMaps(xt),on=new WebGLCubeUVMaps(xt),xn=new WebGLAttributes(Kt),jn=new WebGLBindingStates(Kt,xn),wn=new WebGLGeometries(Kt,xn,ir,jn),En=new WebGLObjects(Kt,wn,xn,ir),er=new WebGLMorphtargets(Kt,kn,zt),Tn=new WebGLClipping(Un),Hn=new WebGLPrograms(xt,It,on,Cn,kn,jn,Tn),Fn=new WebGLMaterials(xt,Un),zn=new WebGLRenderLists,xr=new WebGLRenderStates(Cn),sr=new WebGLBackground(xt,It,on,Nn,En,ct,tt),Qn=new WebGLShadowMap(xt,En,kn),Qt=new WebGLUniformsGroups(Kt,ir,kn,Nn),Xn=new WebGLBufferRenderer(Kt,Cn,ir),qt=new WebGLIndexedBufferRenderer(Kt,Cn,ir),ir.programs=Hn.programs,xt.capabilities=kn,xt.extensions=Cn,xt.properties=Un,xt.renderLists=zn,xt.shadowMap=Qn,xt.state=Nn,xt.info=ir}an();const hn=new WebXRManager(xt,Kt);this.xr=hn,this.getContext=function(){return Kt},this.getContextAttributes=function(){return Kt.getContextAttributes()},this.forceContextLoss=function(){const At=Cn.get("WEBGL_lose_context");At&&At.loseContext()},this.forceContextRestore=function(){const At=Cn.get("WEBGL_lose_context");At&&At.restoreContext()},this.getPixelRatio=function(){return Ct},this.setPixelRatio=function(At){At!==void 0&&(Ct=At,this.setSize(Ot,Ht,!1))},this.getSize=function(At){return At.set(Ot,Ht)},this.setSize=function(At,Vt,Yt=!0){if(hn.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}Ot=At,Ht=Vt,s.width=Math.floor(At*Ct),s.height=Math.floor(Vt*Ct),Yt===!0&&(s.style.width=At+"px",s.style.height=Vt+"px"),this.setViewport(0,0,At,Vt)},this.getDrawingBufferSize=function(At){return At.set(Ot*Ct,Ht*Ct).floor()},this.setDrawingBufferSize=function(At,Vt,Yt){Ot=At,Ht=Vt,Ct=Yt,s.width=Math.floor(At*Yt),s.height=Math.floor(Vt*Yt),this.setViewport(0,0,At,Vt)},this.getCurrentViewport=function(At){return At.copy(Mt)},this.getViewport=function(At){return At.copy(Pt)},this.setViewport=function(At,Vt,Yt,Jt){At.isVector4?Pt.set(At.x,At.y,At.z,At.w):Pt.set(At,Vt,Yt,Jt),Nn.viewport(Mt.copy(Pt).multiplyScalar(Ct).round())},this.getScissor=function(At){return At.copy(Wt)},this.setScissor=function(At,Vt,Yt,Jt){At.isVector4?Wt.set(At.x,At.y,At.z,At.w):Wt.set(At,Vt,Yt,Jt),Nn.scissor(jt.copy(Wt).multiplyScalar(Ct).round())},this.getScissorTest=function(){return sn},this.setScissorTest=function(At){Nn.setScissorTest(sn=At)},this.setOpaqueSort=function(At){Ut=At},this.setTransparentSort=function(At){Gt=At},this.getClearColor=function(At){return At.copy(sr.getClearColor())},this.setClearColor=function(){sr.setClearColor.apply(sr,arguments)},this.getClearAlpha=function(){return sr.getClearAlpha()},this.setClearAlpha=function(){sr.setClearAlpha.apply(sr,arguments)},this.clear=function(At=!0,Vt=!0,Yt=!0){let Jt=0;if(At){let Xt=!1;if(Et!==null){const rn=Et.texture.format;Xt=rn===RGBAIntegerFormat||rn===RGIntegerFormat||rn===RedIntegerFormat}if(Xt){const rn=Et.texture.type,ln=rn===UnsignedByteType||rn===UnsignedIntType||rn===UnsignedShortType||rn===UnsignedInt248Type||rn===UnsignedShort4444Type||rn===UnsignedShort5551Type,Pn=sr.getClearColor(),Sn=sr.getClearAlpha(),Rn=Pn.r,Ln=Pn.g,An=Pn.b;ln?(ut[0]=Rn,ut[1]=Ln,ut[2]=An,ut[3]=Sn,Kt.clearBufferuiv(Kt.COLOR,0,ut)):(ft[0]=Rn,ft[1]=Ln,ft[2]=An,ft[3]=Sn,Kt.clearBufferiv(Kt.COLOR,0,ft))}else Jt|=Kt.COLOR_BUFFER_BIT}Vt&&(Jt|=Kt.DEPTH_BUFFER_BIT),Yt&&(Jt|=Kt.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),Kt.clear(Jt)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){s.removeEventListener("webglcontextlost",_n,!1),s.removeEventListener("webglcontextrestored",Vn,!1),s.removeEventListener("webglcontextcreationerror",Gn,!1),zn.dispose(),xr.dispose(),Un.dispose(),It.dispose(),on.dispose(),En.dispose(),jn.dispose(),Qt.dispose(),Hn.dispose(),hn.dispose(),hn.removeEventListener("sessionstart",Mo),hn.removeEventListener("sessionend",Ro),rs.stop()};function _n(At){At.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),St=!0}function Vn(){console.log("THREE.WebGLRenderer: Context Restored."),St=!1;const At=ir.autoReset,Vt=Qn.enabled,Yt=Qn.autoUpdate,Jt=Qn.needsUpdate,Xt=Qn.type;an(),ir.autoReset=At,Qn.enabled=Vt,Qn.autoUpdate=Yt,Qn.needsUpdate=Jt,Qn.type=Xt}function Gn(At){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",At.statusMessage)}function ur(At){const Vt=At.target;Vt.removeEventListener("dispose",ur),Mr(Vt)}function Mr(At){Ir(At),Un.remove(At)}function Ir(At){const Vt=Un.get(At).programs;Vt!==void 0&&(Vt.forEach(function(Yt){Hn.releaseProgram(Yt)}),At.isShaderMaterial&&Hn.releaseShaderCache(At))}this.renderBufferDirect=function(At,Vt,Yt,Jt,Xt,rn){Vt===null&&(Vt=Bn);const ln=Xt.isMesh&&Xt.matrixWorld.determinant()<0,Pn=Zt(At,Vt,Yt,Jt,Xt);Nn.setMaterial(Jt,ln);let Sn=Yt.index,Rn=1;if(Jt.wireframe===!0){if(Sn=wn.getWireframeAttribute(Yt),Sn===void 0)return;Rn=2}const Ln=Yt.drawRange,An=Yt.attributes.position;let Zn=Ln.start*Rn,nr=(Ln.start+Ln.count)*Rn;rn!==null&&(Zn=Math.max(Zn,rn.start*Rn),nr=Math.min(nr,(rn.start+rn.count)*Rn)),Sn!==null?(Zn=Math.max(Zn,0),nr=Math.min(nr,Sn.count)):An!=null&&(Zn=Math.max(Zn,0),nr=Math.min(nr,An.count));const Yn=nr-Zn;if(Yn<0||Yn===1/0)return;jn.setup(Xt,Jt,Pn,Yt,Sn);let ar,qn=Xn;if(Sn!==null&&(ar=xn.get(Sn),qn=qt,qn.setIndex(ar)),Xt.isMesh)Jt.wireframe===!0?(Nn.setLineWidth(Jt.wireframeLinewidth*bn()),qn.setMode(Kt.LINES)):qn.setMode(Kt.TRIANGLES);else if(Xt.isLine){let Dn=Jt.linewidth;Dn===void 0&&(Dn=1),Nn.setLineWidth(Dn*bn()),Xt.isLineSegments?qn.setMode(Kt.LINES):Xt.isLineLoop?qn.setMode(Kt.LINE_LOOP):qn.setMode(Kt.LINE_STRIP)}else Xt.isPoints?qn.setMode(Kt.POINTS):Xt.isSprite&&qn.setMode(Kt.TRIANGLES);if(Xt.isBatchedMesh)if(Xt._multiDrawInstances!==null)qn.renderMultiDrawInstances(Xt._multiDrawStarts,Xt._multiDrawCounts,Xt._multiDrawCount,Xt._multiDrawInstances);else if(Cn.get("WEBGL_multi_draw"))qn.renderMultiDraw(Xt._multiDrawStarts,Xt._multiDrawCounts,Xt._multiDrawCount);else{const Dn=Xt._multiDrawStarts,hr=Xt._multiDrawCounts,lr=Xt._multiDrawCount,Pr=Sn?xn.get(Sn).bytesPerElement:1,Lr=Un.get(Jt).currentProgram.getUniforms();for(let jr=0;jr<lr;jr++)Lr.setValue(Kt,"_gl_DrawID",jr),qn.render(Dn[jr]/Pr,hr[jr])}else if(Xt.isInstancedMesh)qn.renderInstances(Zn,Yn,Xt.count);else if(Yt.isInstancedBufferGeometry){const Dn=Yt._maxInstanceCount!==void 0?Yt._maxInstanceCount:1/0,hr=Math.min(Yt.instanceCount,Dn);qn.renderInstances(Zn,Yn,hr)}else qn.render(Zn,Yn)};function yr(At,Vt,Yt){At.transparent===!0&&At.side===DoubleSide&&At.forceSinglePass===!1?(At.side=BackSide,At.needsUpdate=!0,Ys(At,Vt,Yt),At.side=FrontSide,At.needsUpdate=!0,Ys(At,Vt,Yt),At.side=DoubleSide):Ys(At,Vt,Yt)}this.compile=function(At,Vt,Yt=null){Yt===null&&(Yt=At),lt=xr.get(Yt),lt.init(Vt),mt.push(lt),Yt.traverseVisible(function(Xt){Xt.isLight&&Xt.layers.test(Vt.layers)&&(lt.pushLight(Xt),Xt.castShadow&&lt.pushShadow(Xt))}),At!==Yt&&At.traverseVisible(function(Xt){Xt.isLight&&Xt.layers.test(Vt.layers)&&(lt.pushLight(Xt),Xt.castShadow&&lt.pushShadow(Xt))}),lt.setupLights();const Jt=new Set;return At.traverse(function(Xt){if(!(Xt.isMesh||Xt.isPoints||Xt.isLine||Xt.isSprite))return;const rn=Xt.material;if(rn)if(Array.isArray(rn))for(let ln=0;ln<rn.length;ln++){const Pn=rn[ln];yr(Pn,Yt,Xt),Jt.add(Pn)}else yr(rn,Yt,Xt),Jt.add(rn)}),mt.pop(),lt=null,Jt},this.compileAsync=function(At,Vt,Yt=null){const Jt=this.compile(At,Vt,Yt);return new Promise(Xt=>{function rn(){if(Jt.forEach(function(ln){Un.get(ln).currentProgram.isReady()&&Jt.delete(ln)}),Jt.size===0){Xt(At);return}setTimeout(rn,10)}Cn.get("KHR_parallel_shader_compile")!==null?rn():setTimeout(rn,10)})};let Or=null;function Wr(At){Or&&Or(At)}function Mo(){rs.stop()}function Ro(){rs.start()}const rs=new WebGLAnimation;rs.setAnimationLoop(Wr),typeof self<"u"&&rs.setContext(self),this.setAnimationLoop=function(At){Or=At,hn.setAnimationLoop(At),At===null?rs.stop():rs.start()},hn.addEventListener("sessionstart",Mo),hn.addEventListener("sessionend",Ro),this.render=function(At,Vt){if(Vt!==void 0&&Vt.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(St===!0)return;if(At.matrixWorldAutoUpdate===!0&&At.updateMatrixWorld(),Vt.parent===null&&Vt.matrixWorldAutoUpdate===!0&&Vt.updateMatrixWorld(),hn.enabled===!0&&hn.isPresenting===!0&&(hn.cameraAutoUpdate===!0&&hn.updateCamera(Vt),Vt=hn.getCamera()),At.isScene===!0&&At.onBeforeRender(xt,At,Vt,Et),lt=xr.get(At,mt.length),lt.init(Vt),mt.push(lt),On.multiplyMatrices(Vt.projectionMatrix,Vt.matrixWorldInverse),Bt.setFromProjectionMatrix(On),cn=this.localClippingEnabled,tn=Tn.init(this.clippingPlanes,cn),dt=zn.get(At,ht.length),dt.init(),ht.push(dt),hn.enabled===!0&&hn.isPresenting===!0){const rn=xt.xr.getDepthSensingMesh();rn!==null&&Gs(rn,Vt,-1/0,xt.sortObjects)}Gs(At,Vt,0,xt.sortObjects),dt.finish(),xt.sortObjects===!0&&dt.sort(Ut,Gt),gn=hn.enabled===!1||hn.isPresenting===!1||hn.hasDepthSensing()===!1,gn&&sr.addToRenderList(dt,At),this.info.render.frame++,tn===!0&&Tn.beginShadows();const Yt=lt.state.shadowsArray;Qn.render(Yt,At,Vt),tn===!0&&Tn.endShadows(),this.info.autoReset===!0&&this.info.reset();const Jt=dt.opaque,Xt=dt.transmissive;if(lt.setupLights(),Vt.isArrayCamera){const rn=Vt.cameras;if(Xt.length>0)for(let ln=0,Pn=rn.length;ln<Pn;ln++){const Sn=rn[ln];ls(Jt,Xt,At,Sn)}gn&&sr.render(At);for(let ln=0,Pn=rn.length;ln<Pn;ln++){const Sn=rn[ln];js(dt,At,Sn,Sn.viewport)}}else Xt.length>0&&ls(Jt,Xt,At,Vt),gn&&sr.render(At),js(dt,At,Vt);Et!==null&&(zt.updateMultisampleRenderTarget(Et),zt.updateRenderTargetMipmap(Et)),At.isScene===!0&&At.onAfterRender(xt,At,Vt),jn.resetDefaultState(),_t=-1,vt=null,mt.pop(),mt.length>0?(lt=mt[mt.length-1],tn===!0&&Tn.setGlobalState(xt.clippingPlanes,lt.state.camera)):lt=null,ht.pop(),ht.length>0?dt=ht[ht.length-1]:dt=null};function Gs(At,Vt,Yt,Jt){if(At.visible===!1)return;if(At.layers.test(Vt.layers)){if(At.isGroup)Yt=At.renderOrder;else if(At.isLOD)At.autoUpdate===!0&&At.update(Vt);else if(At.isLight)lt.pushLight(At),At.castShadow&&lt.pushShadow(At);else if(At.isSprite){if(!At.frustumCulled||Bt.intersectsSprite(At)){Jt&&Wn.setFromMatrixPosition(At.matrixWorld).applyMatrix4(On);const ln=En.update(At),Pn=At.material;Pn.visible&&dt.push(At,ln,Pn,Yt,Wn.z,null)}}else if((At.isMesh||At.isLine||At.isPoints)&&(!At.frustumCulled||Bt.intersectsObject(At))){const ln=En.update(At),Pn=At.material;if(Jt&&(At.boundingSphere!==void 0?(At.boundingSphere===null&&At.computeBoundingSphere(),Wn.copy(At.boundingSphere.center)):(ln.boundingSphere===null&&ln.computeBoundingSphere(),Wn.copy(ln.boundingSphere.center)),Wn.applyMatrix4(At.matrixWorld).applyMatrix4(On)),Array.isArray(Pn)){const Sn=ln.groups;for(let Rn=0,Ln=Sn.length;Rn<Ln;Rn++){const An=Sn[Rn],Zn=Pn[An.materialIndex];Zn&&Zn.visible&&dt.push(At,ln,Zn,Yt,Wn.z,An)}}else Pn.visible&&dt.push(At,ln,Pn,Yt,Wn.z,null)}}const rn=At.children;for(let ln=0,Pn=rn.length;ln<Pn;ln++)Gs(rn[ln],Vt,Yt,Jt)}function js(At,Vt,Yt,Jt){const Xt=At.opaque,rn=At.transmissive,ln=At.transparent;lt.setupLightsView(Yt),tn===!0&&Tn.setGlobalState(xt.clippingPlanes,Yt),Jt&&Nn.viewport(Mt.copy(Jt)),Xt.length>0&&gr(Xt,Vt,Yt),rn.length>0&&gr(rn,Vt,Yt),ln.length>0&&gr(ln,Vt,Yt),Nn.buffers.depth.setTest(!0),Nn.buffers.depth.setMask(!0),Nn.buffers.color.setMask(!0),Nn.setPolygonOffset(!1)}function ls(At,Vt,Yt,Jt){if((Yt.isScene===!0?Yt.overrideMaterial:null)!==null)return;lt.state.transmissionRenderTarget[Jt.id]===void 0&&(lt.state.transmissionRenderTarget[Jt.id]=new WebGLRenderTarget(1,1,{generateMipmaps:!0,type:Cn.has("EXT_color_buffer_half_float")||Cn.has("EXT_color_buffer_float")?HalfFloatType:UnsignedByteType,minFilter:LinearMipmapLinearFilter,samples:4,stencilBuffer:d,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:ColorManagement.workingColorSpace}));const rn=lt.state.transmissionRenderTarget[Jt.id],ln=Jt.viewport||Mt;rn.setSize(ln.z,ln.w);const Pn=xt.getRenderTarget();xt.setRenderTarget(rn),xt.getClearColor(Nt),kt=xt.getClearAlpha(),kt<1&&xt.setClearColor(16777215,.5),xt.clear(),gn&&sr.render(Yt);const Sn=xt.toneMapping;xt.toneMapping=NoToneMapping;const Rn=Jt.viewport;if(Jt.viewport!==void 0&&(Jt.viewport=void 0),lt.setupLightsView(Jt),tn===!0&&Tn.setGlobalState(xt.clippingPlanes,Jt),gr(At,Yt,Jt),zt.updateMultisampleRenderTarget(rn),zt.updateRenderTargetMipmap(rn),Cn.has("WEBGL_multisampled_render_to_texture")===!1){let Ln=!1;for(let An=0,Zn=Vt.length;An<Zn;An++){const nr=Vt[An],Yn=nr.object,ar=nr.geometry,qn=nr.material,Dn=nr.group;if(qn.side===DoubleSide&&Yn.layers.test(Jt.layers)){const hr=qn.side;qn.side=BackSide,qn.needsUpdate=!0,uo(Yn,Yt,Jt,ar,qn,Dn),qn.side=hr,qn.needsUpdate=!0,Ln=!0}}Ln===!0&&(zt.updateMultisampleRenderTarget(rn),zt.updateRenderTargetMipmap(rn))}xt.setRenderTarget(Pn),xt.setClearColor(Nt,kt),Rn!==void 0&&(Jt.viewport=Rn),xt.toneMapping=Sn}function gr(At,Vt,Yt){const Jt=Vt.isScene===!0?Vt.overrideMaterial:null;for(let Xt=0,rn=At.length;Xt<rn;Xt++){const ln=At[Xt],Pn=ln.object,Sn=ln.geometry,Rn=Jt===null?ln.material:Jt,Ln=ln.group;Pn.layers.test(Yt.layers)&&uo(Pn,Vt,Yt,Sn,Rn,Ln)}}function uo(At,Vt,Yt,Jt,Xt,rn){At.onBeforeRender(xt,Vt,Yt,Jt,Xt,rn),At.modelViewMatrix.multiplyMatrices(Yt.matrixWorldInverse,At.matrixWorld),At.normalMatrix.getNormalMatrix(At.modelViewMatrix),Xt.onBeforeRender(xt,Vt,Yt,Jt,At,rn),Xt.transparent===!0&&Xt.side===DoubleSide&&Xt.forceSinglePass===!1?(Xt.side=BackSide,Xt.needsUpdate=!0,xt.renderBufferDirect(Yt,Vt,Jt,Xt,At,rn),Xt.side=FrontSide,Xt.needsUpdate=!0,xt.renderBufferDirect(Yt,Vt,Jt,Xt,At,rn),Xt.side=DoubleSide):xt.renderBufferDirect(Yt,Vt,Jt,Xt,At,rn),At.onAfterRender(xt,Vt,Yt,Jt,Xt,rn)}function Ys(At,Vt,Yt){Vt.isScene!==!0&&(Vt=Bn);const Jt=Un.get(At),Xt=lt.state.lights,rn=lt.state.shadowsArray,ln=Xt.state.version,Pn=Hn.getParameters(At,Xt.state,rn,Vt,Yt),Sn=Hn.getProgramCacheKey(Pn);let Rn=Jt.programs;Jt.environment=At.isMeshStandardMaterial?Vt.environment:null,Jt.fog=Vt.fog,Jt.envMap=(At.isMeshStandardMaterial?on:It).get(At.envMap||Jt.environment),Jt.envMapRotation=Jt.environment!==null&&At.envMap===null?Vt.environmentRotation:At.envMapRotation,Rn===void 0&&(At.addEventListener("dispose",ur),Rn=new Map,Jt.programs=Rn);let Ln=Rn.get(Sn);if(Ln!==void 0){if(Jt.currentProgram===Ln&&Jt.lightsStateVersion===ln)return Dt(At,Pn),Ln}else Pn.uniforms=Hn.getUniforms(At),At.onBeforeCompile(Pn,xt),Ln=Hn.acquireProgram(Pn,Sn),Rn.set(Sn,Ln),Jt.uniforms=Pn.uniforms;const An=Jt.uniforms;return(!At.isShaderMaterial&&!At.isRawShaderMaterial||At.clipping===!0)&&(An.clippingPlanes=Tn.uniform),Dt(At,Pn),Jt.needsLights=mn(At),Jt.lightsStateVersion=ln,Jt.needsLights&&(An.ambientLightColor.value=Xt.state.ambient,An.lightProbe.value=Xt.state.probe,An.directionalLights.value=Xt.state.directional,An.directionalLightShadows.value=Xt.state.directionalShadow,An.spotLights.value=Xt.state.spot,An.spotLightShadows.value=Xt.state.spotShadow,An.rectAreaLights.value=Xt.state.rectArea,An.ltc_1.value=Xt.state.rectAreaLTC1,An.ltc_2.value=Xt.state.rectAreaLTC2,An.pointLights.value=Xt.state.point,An.pointLightShadows.value=Xt.state.pointShadow,An.hemisphereLights.value=Xt.state.hemi,An.directionalShadowMap.value=Xt.state.directionalShadowMap,An.directionalShadowMatrix.value=Xt.state.directionalShadowMatrix,An.spotShadowMap.value=Xt.state.spotShadowMap,An.spotLightMatrix.value=Xt.state.spotLightMatrix,An.spotLightMap.value=Xt.state.spotLightMap,An.pointShadowMap.value=Xt.state.pointShadowMap,An.pointShadowMatrix.value=Xt.state.pointShadowMatrix),Jt.currentProgram=Ln,Jt.uniformsList=null,Ln}function Tt(At){if(At.uniformsList===null){const Vt=At.currentProgram.getUniforms();At.uniformsList=WebGLUniforms.seqWithValue(Vt.seq,At.uniforms)}return At.uniformsList}function Dt(At,Vt){const Yt=Un.get(At);Yt.outputColorSpace=Vt.outputColorSpace,Yt.batching=Vt.batching,Yt.batchingColor=Vt.batchingColor,Yt.instancing=Vt.instancing,Yt.instancingColor=Vt.instancingColor,Yt.instancingMorph=Vt.instancingMorph,Yt.skinning=Vt.skinning,Yt.morphTargets=Vt.morphTargets,Yt.morphNormals=Vt.morphNormals,Yt.morphColors=Vt.morphColors,Yt.morphTargetsCount=Vt.morphTargetsCount,Yt.numClippingPlanes=Vt.numClippingPlanes,Yt.numIntersection=Vt.numClipIntersection,Yt.vertexAlphas=Vt.vertexAlphas,Yt.vertexTangents=Vt.vertexTangents,Yt.toneMapping=Vt.toneMapping}function Zt(At,Vt,Yt,Jt,Xt){Vt.isScene!==!0&&(Vt=Bn),zt.resetTextureUnits();const rn=Vt.fog,ln=Jt.isMeshStandardMaterial?Vt.environment:null,Pn=Et===null?xt.outputColorSpace:Et.isXRRenderTarget===!0?Et.texture.colorSpace:LinearSRGBColorSpace$1,Sn=(Jt.isMeshStandardMaterial?on:It).get(Jt.envMap||ln),Rn=Jt.vertexColors===!0&&!!Yt.attributes.color&&Yt.attributes.color.itemSize===4,Ln=!!Yt.attributes.tangent&&(!!Jt.normalMap||Jt.anisotropy>0),An=!!Yt.morphAttributes.position,Zn=!!Yt.morphAttributes.normal,nr=!!Yt.morphAttributes.color;let Yn=NoToneMapping;Jt.toneMapped&&(Et===null||Et.isXRRenderTarget===!0)&&(Yn=xt.toneMapping);const ar=Yt.morphAttributes.position||Yt.morphAttributes.normal||Yt.morphAttributes.color,qn=ar!==void 0?ar.length:0,Dn=Un.get(Jt),hr=lt.state.lights;if(tn===!0&&(cn===!0||At!==vt)){const wr=At===vt&&Jt.id===_t;Tn.setState(Jt,At,wr)}let lr=!1;Jt.version===Dn.__version?(Dn.needsLights&&Dn.lightsStateVersion!==hr.state.version||Dn.outputColorSpace!==Pn||Xt.isBatchedMesh&&Dn.batching===!1||!Xt.isBatchedMesh&&Dn.batching===!0||Xt.isBatchedMesh&&Dn.batchingColor===!0&&Xt.colorTexture===null||Xt.isBatchedMesh&&Dn.batchingColor===!1&&Xt.colorTexture!==null||Xt.isInstancedMesh&&Dn.instancing===!1||!Xt.isInstancedMesh&&Dn.instancing===!0||Xt.isSkinnedMesh&&Dn.skinning===!1||!Xt.isSkinnedMesh&&Dn.skinning===!0||Xt.isInstancedMesh&&Dn.instancingColor===!0&&Xt.instanceColor===null||Xt.isInstancedMesh&&Dn.instancingColor===!1&&Xt.instanceColor!==null||Xt.isInstancedMesh&&Dn.instancingMorph===!0&&Xt.morphTexture===null||Xt.isInstancedMesh&&Dn.instancingMorph===!1&&Xt.morphTexture!==null||Dn.envMap!==Sn||Jt.fog===!0&&Dn.fog!==rn||Dn.numClippingPlanes!==void 0&&(Dn.numClippingPlanes!==Tn.numPlanes||Dn.numIntersection!==Tn.numIntersection)||Dn.vertexAlphas!==Rn||Dn.vertexTangents!==Ln||Dn.morphTargets!==An||Dn.morphNormals!==Zn||Dn.morphColors!==nr||Dn.toneMapping!==Yn||Dn.morphTargetsCount!==qn)&&(lr=!0):(lr=!0,Dn.__version=Jt.version);let Pr=Dn.currentProgram;lr===!0&&(Pr=Ys(Jt,Vt,Xt));let Lr=!1,jr=!1,Rr=!1;const pr=Pr.getUniforms(),vr=Dn.uniforms;if(Nn.useProgram(Pr.program)&&(Lr=!0,jr=!0,Rr=!0),Jt.id!==_t&&(_t=Jt.id,jr=!0),Lr||vt!==At){Nn.buffers.depth.getReversed()?(vn.copy(At.projectionMatrix),toNormalizedProjectionMatrix(vn),toReversedProjectionMatrix(vn),pr.setValue(Kt,"projectionMatrix",vn)):pr.setValue(Kt,"projectionMatrix",At.projectionMatrix),pr.setValue(Kt,"viewMatrix",At.matrixWorldInverse);const Xr=pr.map.cameraPosition;Xr!==void 0&&Xr.setValue(Kt,rr.setFromMatrixPosition(At.matrixWorld)),kn.logarithmicDepthBuffer&&pr.setValue(Kt,"logDepthBufFC",2/(Math.log(At.far+1)/Math.LN2)),(Jt.isMeshPhongMaterial||Jt.isMeshToonMaterial||Jt.isMeshLambertMaterial||Jt.isMeshBasicMaterial||Jt.isMeshStandardMaterial||Jt.isShaderMaterial)&&pr.setValue(Kt,"isOrthographic",At.isOrthographicCamera===!0),vt!==At&&(vt=At,jr=!0,Rr=!0)}if(Xt.isSkinnedMesh){pr.setOptional(Kt,Xt,"bindMatrix"),pr.setOptional(Kt,Xt,"bindMatrixInverse");const wr=Xt.skeleton;wr&&(wr.boneTexture===null&&wr.computeBoneTexture(),pr.setValue(Kt,"boneTexture",wr.boneTexture,zt))}Xt.isBatchedMesh&&(pr.setOptional(Kt,Xt,"batchingTexture"),pr.setValue(Kt,"batchingTexture",Xt._matricesTexture,zt),pr.setOptional(Kt,Xt,"batchingIdTexture"),pr.setValue(Kt,"batchingIdTexture",Xt._indirectTexture,zt),pr.setOptional(Kt,Xt,"batchingColorTexture"),Xt._colorsTexture!==null&&pr.setValue(Kt,"batchingColorTexture",Xt._colorsTexture,zt));const br=Yt.morphAttributes;if((br.position!==void 0||br.normal!==void 0||br.color!==void 0)&&er.update(Xt,Yt,Pr),(jr||Dn.receiveShadow!==Xt.receiveShadow)&&(Dn.receiveShadow=Xt.receiveShadow,pr.setValue(Kt,"receiveShadow",Xt.receiveShadow)),Jt.isMeshGouraudMaterial&&Jt.envMap!==null&&(vr.envMap.value=Sn,vr.flipEnvMap.value=Sn.isCubeTexture&&Sn.isRenderTargetTexture===!1?-1:1),Jt.isMeshStandardMaterial&&Jt.envMap===null&&Vt.environment!==null&&(vr.envMapIntensity.value=Vt.environmentIntensity),jr&&(pr.setValue(Kt,"toneMappingExposure",xt.toneMappingExposure),Dn.needsLights&&dn(vr,Rr),rn&&Jt.fog===!0&&Fn.refreshFogUniforms(vr,rn),Fn.refreshMaterialUniforms(vr,Jt,Ct,Ht,lt.state.transmissionRenderTarget[At.id]),WebGLUniforms.upload(Kt,Tt(Dn),vr,zt)),Jt.isShaderMaterial&&Jt.uniformsNeedUpdate===!0&&(WebGLUniforms.upload(Kt,Tt(Dn),vr,zt),Jt.uniformsNeedUpdate=!1),Jt.isSpriteMaterial&&pr.setValue(Kt,"center",Xt.center),pr.setValue(Kt,"modelViewMatrix",Xt.modelViewMatrix),pr.setValue(Kt,"normalMatrix",Xt.normalMatrix),pr.setValue(Kt,"modelMatrix",Xt.matrixWorld),Jt.isShaderMaterial||Jt.isRawShaderMaterial){const wr=Jt.uniformsGroups;for(let Xr=0,Dr=wr.length;Xr<Dr;Xr++){const hs=wr[Xr];Qt.update(hs,Pr),Qt.bind(hs,Pr)}}return Pr}function dn(At,Vt){At.ambientLightColor.needsUpdate=Vt,At.lightProbe.needsUpdate=Vt,At.directionalLights.needsUpdate=Vt,At.directionalLightShadows.needsUpdate=Vt,At.pointLights.needsUpdate=Vt,At.pointLightShadows.needsUpdate=Vt,At.spotLights.needsUpdate=Vt,At.spotLightShadows.needsUpdate=Vt,At.rectAreaLights.needsUpdate=Vt,At.hemisphereLights.needsUpdate=Vt}function mn(At){return At.isMeshLambertMaterial||At.isMeshToonMaterial||At.isMeshPhongMaterial||At.isMeshStandardMaterial||At.isShadowMaterial||At.isShaderMaterial&&At.lights===!0}this.getActiveCubeFace=function(){return yt},this.getActiveMipmapLevel=function(){return wt},this.getRenderTarget=function(){return Et},this.setRenderTargetTextures=function(At,Vt,Yt){Un.get(At.texture).__webglTexture=Vt,Un.get(At.depthTexture).__webglTexture=Yt;const Jt=Un.get(At);Jt.__hasExternalTextures=!0,Jt.__autoAllocateDepthBuffer=Yt===void 0,Jt.__autoAllocateDepthBuffer||Cn.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),Jt.__useRenderToTexture=!1)},this.setRenderTargetFramebuffer=function(At,Vt){const Yt=Un.get(At);Yt.__webglFramebuffer=Vt,Yt.__useDefaultFramebuffer=Vt===void 0},this.setRenderTarget=function(At,Vt=0,Yt=0){Et=At,yt=Vt,wt=Yt;let Jt=!0,Xt=null,rn=!1,ln=!1;if(At){const Sn=Un.get(At);if(Sn.__useDefaultFramebuffer!==void 0)Nn.bindFramebuffer(Kt.FRAMEBUFFER,null),Jt=!1;else if(Sn.__webglFramebuffer===void 0)zt.setupRenderTarget(At);else if(Sn.__hasExternalTextures)zt.rebindTextures(At,Un.get(At.texture).__webglTexture,Un.get(At.depthTexture).__webglTexture);else if(At.depthBuffer){const An=At.depthTexture;if(Sn.__boundDepthTexture!==An){if(An!==null&&Un.has(An)&&(At.width!==An.image.width||At.height!==An.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");zt.setupDepthRenderbuffer(At)}}const Rn=At.texture;(Rn.isData3DTexture||Rn.isDataArrayTexture||Rn.isCompressedArrayTexture)&&(ln=!0);const Ln=Un.get(At).__webglFramebuffer;At.isWebGLCubeRenderTarget?(Array.isArray(Ln[Vt])?Xt=Ln[Vt][Yt]:Xt=Ln[Vt],rn=!0):At.samples>0&&zt.useMultisampledRTT(At)===!1?Xt=Un.get(At).__webglMultisampledFramebuffer:Array.isArray(Ln)?Xt=Ln[Yt]:Xt=Ln,Mt.copy(At.viewport),jt.copy(At.scissor),Lt=At.scissorTest}else Mt.copy(Pt).multiplyScalar(Ct).floor(),jt.copy(Wt).multiplyScalar(Ct).floor(),Lt=sn;if(Nn.bindFramebuffer(Kt.FRAMEBUFFER,Xt)&&Jt&&Nn.drawBuffers(At,Xt),Nn.viewport(Mt),Nn.scissor(jt),Nn.setScissorTest(Lt),rn){const Sn=Un.get(At.texture);Kt.framebufferTexture2D(Kt.FRAMEBUFFER,Kt.COLOR_ATTACHMENT0,Kt.TEXTURE_CUBE_MAP_POSITIVE_X+Vt,Sn.__webglTexture,Yt)}else if(ln){const Sn=Un.get(At.texture),Rn=Vt||0;Kt.framebufferTextureLayer(Kt.FRAMEBUFFER,Kt.COLOR_ATTACHMENT0,Sn.__webglTexture,Yt||0,Rn)}_t=-1},this.readRenderTargetPixels=function(At,Vt,Yt,Jt,Xt,rn,ln){if(!(At&&At.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let Pn=Un.get(At).__webglFramebuffer;if(At.isWebGLCubeRenderTarget&&ln!==void 0&&(Pn=Pn[ln]),Pn){Nn.bindFramebuffer(Kt.FRAMEBUFFER,Pn);try{const Sn=At.texture,Rn=Sn.format,Ln=Sn.type;if(!kn.textureFormatReadable(Rn)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!kn.textureTypeReadable(Ln)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}Vt>=0&&Vt<=At.width-Jt&&Yt>=0&&Yt<=At.height-Xt&&Kt.readPixels(Vt,Yt,Jt,Xt,fn.convert(Rn),fn.convert(Ln),rn)}finally{const Sn=Et!==null?Un.get(Et).__webglFramebuffer:null;Nn.bindFramebuffer(Kt.FRAMEBUFFER,Sn)}}},this.readRenderTargetPixelsAsync=async function(At,Vt,Yt,Jt,Xt,rn,ln){if(!(At&&At.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let Pn=Un.get(At).__webglFramebuffer;if(At.isWebGLCubeRenderTarget&&ln!==void 0&&(Pn=Pn[ln]),Pn){const Sn=At.texture,Rn=Sn.format,Ln=Sn.type;if(!kn.textureFormatReadable(Rn))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!kn.textureTypeReadable(Ln))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");if(Vt>=0&&Vt<=At.width-Jt&&Yt>=0&&Yt<=At.height-Xt){Nn.bindFramebuffer(Kt.FRAMEBUFFER,Pn);const An=Kt.createBuffer();Kt.bindBuffer(Kt.PIXEL_PACK_BUFFER,An),Kt.bufferData(Kt.PIXEL_PACK_BUFFER,rn.byteLength,Kt.STREAM_READ),Kt.readPixels(Vt,Yt,Jt,Xt,fn.convert(Rn),fn.convert(Ln),0);const Zn=Et!==null?Un.get(Et).__webglFramebuffer:null;Nn.bindFramebuffer(Kt.FRAMEBUFFER,Zn);const nr=Kt.fenceSync(Kt.SYNC_GPU_COMMANDS_COMPLETE,0);return Kt.flush(),await probeAsync(Kt,nr,4),Kt.bindBuffer(Kt.PIXEL_PACK_BUFFER,An),Kt.getBufferSubData(Kt.PIXEL_PACK_BUFFER,0,rn),Kt.deleteBuffer(An),Kt.deleteSync(nr),rn}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")}},this.copyFramebufferToTexture=function(At,Vt=null,Yt=0){At.isTexture!==!0&&(warnOnce("WebGLRenderer: copyFramebufferToTexture function signature has changed."),Vt=arguments[0]||null,At=arguments[1]);const Jt=Math.pow(2,-Yt),Xt=Math.floor(At.image.width*Jt),rn=Math.floor(At.image.height*Jt),ln=Vt!==null?Vt.x:0,Pn=Vt!==null?Vt.y:0;zt.setTexture2D(At,0),Kt.copyTexSubImage2D(Kt.TEXTURE_2D,Yt,0,0,ln,Pn,Xt,rn),Nn.unbindTexture()},this.copyTextureToTexture=function(At,Vt,Yt=null,Jt=null,Xt=0){At.isTexture!==!0&&(warnOnce("WebGLRenderer: copyTextureToTexture function signature has changed."),Jt=arguments[0]||null,At=arguments[1],Vt=arguments[2],Xt=arguments[3]||0,Yt=null);let rn,ln,Pn,Sn,Rn,Ln,An,Zn,nr;const Yn=At.isCompressedTexture?At.mipmaps[Xt]:At.image;Yt!==null?(rn=Yt.max.x-Yt.min.x,ln=Yt.max.y-Yt.min.y,Pn=Yt.isBox3?Yt.max.z-Yt.min.z:1,Sn=Yt.min.x,Rn=Yt.min.y,Ln=Yt.isBox3?Yt.min.z:0):(rn=Yn.width,ln=Yn.height,Pn=Yn.depth||1,Sn=0,Rn=0,Ln=0),Jt!==null?(An=Jt.x,Zn=Jt.y,nr=Jt.z):(An=0,Zn=0,nr=0);const ar=fn.convert(Vt.format),qn=fn.convert(Vt.type);let Dn;Vt.isData3DTexture?(zt.setTexture3D(Vt,0),Dn=Kt.TEXTURE_3D):Vt.isDataArrayTexture||Vt.isCompressedArrayTexture?(zt.setTexture2DArray(Vt,0),Dn=Kt.TEXTURE_2D_ARRAY):(zt.setTexture2D(Vt,0),Dn=Kt.TEXTURE_2D),Kt.pixelStorei(Kt.UNPACK_FLIP_Y_WEBGL,Vt.flipY),Kt.pixelStorei(Kt.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Vt.premultiplyAlpha),Kt.pixelStorei(Kt.UNPACK_ALIGNMENT,Vt.unpackAlignment);const hr=Kt.getParameter(Kt.UNPACK_ROW_LENGTH),lr=Kt.getParameter(Kt.UNPACK_IMAGE_HEIGHT),Pr=Kt.getParameter(Kt.UNPACK_SKIP_PIXELS),Lr=Kt.getParameter(Kt.UNPACK_SKIP_ROWS),jr=Kt.getParameter(Kt.UNPACK_SKIP_IMAGES);Kt.pixelStorei(Kt.UNPACK_ROW_LENGTH,Yn.width),Kt.pixelStorei(Kt.UNPACK_IMAGE_HEIGHT,Yn.height),Kt.pixelStorei(Kt.UNPACK_SKIP_PIXELS,Sn),Kt.pixelStorei(Kt.UNPACK_SKIP_ROWS,Rn),Kt.pixelStorei(Kt.UNPACK_SKIP_IMAGES,Ln);const Rr=At.isDataArrayTexture||At.isData3DTexture,pr=Vt.isDataArrayTexture||Vt.isData3DTexture;if(At.isRenderTargetTexture||At.isDepthTexture){const vr=Un.get(At),br=Un.get(Vt),wr=Un.get(vr.__renderTarget),Xr=Un.get(br.__renderTarget);Nn.bindFramebuffer(Kt.READ_FRAMEBUFFER,wr.__webglFramebuffer),Nn.bindFramebuffer(Kt.DRAW_FRAMEBUFFER,Xr.__webglFramebuffer);for(let Dr=0;Dr<Pn;Dr++)Rr&&Kt.framebufferTextureLayer(Kt.READ_FRAMEBUFFER,Kt.COLOR_ATTACHMENT0,Un.get(At).__webglTexture,Xt,Ln+Dr),At.isDepthTexture?(pr&&Kt.framebufferTextureLayer(Kt.DRAW_FRAMEBUFFER,Kt.COLOR_ATTACHMENT0,Un.get(Vt).__webglTexture,Xt,nr+Dr),Kt.blitFramebuffer(Sn,Rn,rn,ln,An,Zn,rn,ln,Kt.DEPTH_BUFFER_BIT,Kt.NEAREST)):pr?Kt.copyTexSubImage3D(Dn,Xt,An,Zn,nr+Dr,Sn,Rn,rn,ln):Kt.copyTexSubImage2D(Dn,Xt,An,Zn,nr+Dr,Sn,Rn,rn,ln);Nn.bindFramebuffer(Kt.READ_FRAMEBUFFER,null),Nn.bindFramebuffer(Kt.DRAW_FRAMEBUFFER,null)}else pr?At.isDataTexture||At.isData3DTexture?Kt.texSubImage3D(Dn,Xt,An,Zn,nr,rn,ln,Pn,ar,qn,Yn.data):Vt.isCompressedArrayTexture?Kt.compressedTexSubImage3D(Dn,Xt,An,Zn,nr,rn,ln,Pn,ar,Yn.data):Kt.texSubImage3D(Dn,Xt,An,Zn,nr,rn,ln,Pn,ar,qn,Yn):At.isDataTexture?Kt.texSubImage2D(Kt.TEXTURE_2D,Xt,An,Zn,rn,ln,ar,qn,Yn.data):At.isCompressedTexture?Kt.compressedTexSubImage2D(Kt.TEXTURE_2D,Xt,An,Zn,Yn.width,Yn.height,ar,Yn.data):Kt.texSubImage2D(Kt.TEXTURE_2D,Xt,An,Zn,rn,ln,ar,qn,Yn);Kt.pixelStorei(Kt.UNPACK_ROW_LENGTH,hr),Kt.pixelStorei(Kt.UNPACK_IMAGE_HEIGHT,lr),Kt.pixelStorei(Kt.UNPACK_SKIP_PIXELS,Pr),Kt.pixelStorei(Kt.UNPACK_SKIP_ROWS,Lr),Kt.pixelStorei(Kt.UNPACK_SKIP_IMAGES,jr),Xt===0&&Vt.generateMipmaps&&Kt.generateMipmap(Dn),Nn.unbindTexture()},this.copyTextureToTexture3D=function(At,Vt,Yt=null,Jt=null,Xt=0){return At.isTexture!==!0&&(warnOnce("WebGLRenderer: copyTextureToTexture3D function signature has changed."),Yt=arguments[0]||null,Jt=arguments[1]||null,At=arguments[2],Vt=arguments[3],Xt=arguments[4]||0),warnOnce('WebGLRenderer: copyTextureToTexture3D function has been deprecated. Use "copyTextureToTexture" instead.'),this.copyTextureToTexture(At,Vt,Yt,Jt,Xt)},this.initRenderTarget=function(At){Un.get(At).__webglFramebuffer===void 0&&zt.setupRenderTarget(At)},this.initTexture=function(At){At.isCubeTexture?zt.setTextureCube(At,0):At.isData3DTexture?zt.setTexture3D(At,0):At.isDataArrayTexture||At.isCompressedArrayTexture?zt.setTexture2DArray(At,0):zt.setTexture2D(At,0),Nn.unbindTexture()},this.resetState=function(){yt=0,wt=0,Et=null,Nn.reset(),jn.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return WebGLCoordinateSystem}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const s=this.getContext();s.drawingBufferColorspace=ColorManagement._getDrawingBufferColorSpace(e),s.unpackColorSpace=ColorManagement._getUnpackColorSpace()}}class FogExp2{constructor(e,s=25e-5){this.isFogExp2=!0,this.name="",this.color=new Color(e),this.density=s}clone(){return new FogExp2(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class Fog{constructor(e,s=1,a=1e3){this.isFog=!0,this.name="",this.color=new Color(e),this.near=s,this.far=a}clone(){return new Fog(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class Scene extends Object3D{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new Euler,this.environmentIntensity=1,this.environmentRotation=new Euler,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,s){return super.copy(e,s),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const s=super.toJSON(e);return this.fog!==null&&(s.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(s.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(s.object.backgroundIntensity=this.backgroundIntensity),s.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(s.object.environmentIntensity=this.environmentIntensity),s.object.environmentRotation=this.environmentRotation.toArray(),s}}class InterleavedBuffer{constructor(e,s){this.isInterleavedBuffer=!0,this.array=e,this.stride=s,this.count=e!==void 0?e.length/s:0,this.usage=StaticDrawUsage,this.updateRanges=[],this.version=0,this.uuid=generateUUID()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,s){this.updateRanges.push({start:e,count:s})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,s,a){e*=this.stride,a*=s.stride;for(let c=0,d=this.stride;c<d;c++)this.array[e+c]=s.array[a+c];return this}set(e,s=0){return this.array.set(e,s),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=generateUUID()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const s=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),a=new this.constructor(s,this.stride);return a.setUsage(this.usage),a}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=generateUUID()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const _vector$6=new Vector3;class InterleavedBufferAttribute{constructor(e,s,a,c=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=s,this.offset=a,this.normalized=c}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let s=0,a=this.data.count;s<a;s++)_vector$6.fromBufferAttribute(this,s),_vector$6.applyMatrix4(e),this.setXYZ(s,_vector$6.x,_vector$6.y,_vector$6.z);return this}applyNormalMatrix(e){for(let s=0,a=this.count;s<a;s++)_vector$6.fromBufferAttribute(this,s),_vector$6.applyNormalMatrix(e),this.setXYZ(s,_vector$6.x,_vector$6.y,_vector$6.z);return this}transformDirection(e){for(let s=0,a=this.count;s<a;s++)_vector$6.fromBufferAttribute(this,s),_vector$6.transformDirection(e),this.setXYZ(s,_vector$6.x,_vector$6.y,_vector$6.z);return this}getComponent(e,s){let a=this.array[e*this.data.stride+this.offset+s];return this.normalized&&(a=denormalize(a,this.array)),a}setComponent(e,s,a){return this.normalized&&(a=normalize(a,this.array)),this.data.array[e*this.data.stride+this.offset+s]=a,this}setX(e,s){return this.normalized&&(s=normalize(s,this.array)),this.data.array[e*this.data.stride+this.offset]=s,this}setY(e,s){return this.normalized&&(s=normalize(s,this.array)),this.data.array[e*this.data.stride+this.offset+1]=s,this}setZ(e,s){return this.normalized&&(s=normalize(s,this.array)),this.data.array[e*this.data.stride+this.offset+2]=s,this}setW(e,s){return this.normalized&&(s=normalize(s,this.array)),this.data.array[e*this.data.stride+this.offset+3]=s,this}getX(e){let s=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(s=denormalize(s,this.array)),s}getY(e){let s=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(s=denormalize(s,this.array)),s}getZ(e){let s=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(s=denormalize(s,this.array)),s}getW(e){let s=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(s=denormalize(s,this.array)),s}setXY(e,s,a){return e=e*this.data.stride+this.offset,this.normalized&&(s=normalize(s,this.array),a=normalize(a,this.array)),this.data.array[e+0]=s,this.data.array[e+1]=a,this}setXYZ(e,s,a,c){return e=e*this.data.stride+this.offset,this.normalized&&(s=normalize(s,this.array),a=normalize(a,this.array),c=normalize(c,this.array)),this.data.array[e+0]=s,this.data.array[e+1]=a,this.data.array[e+2]=c,this}setXYZW(e,s,a,c,d){return e=e*this.data.stride+this.offset,this.normalized&&(s=normalize(s,this.array),a=normalize(a,this.array),c=normalize(c,this.array),d=normalize(d,this.array)),this.data.array[e+0]=s,this.data.array[e+1]=a,this.data.array[e+2]=c,this.data.array[e+3]=d,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const s=[];for(let a=0;a<this.count;a++){const c=a*this.data.stride+this.offset;for(let d=0;d<this.itemSize;d++)s.push(this.data.array[c+d])}return new BufferAttribute(new this.array.constructor(s),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new InterleavedBufferAttribute(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const s=[];for(let a=0;a<this.count;a++){const c=a*this.data.stride+this.offset;for(let d=0;d<this.itemSize;d++)s.push(this.data.array[c+d])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:s,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class SpriteMaterial extends Material{static get type(){return"SpriteMaterial"}constructor(e){super(),this.isSpriteMaterial=!0,this.color=new Color(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let _geometry;const _intersectPoint=new Vector3,_worldScale=new Vector3,_mvPosition=new Vector3,_alignedPosition=new Vector2,_rotatedPosition=new Vector2,_viewWorldMatrix=new Matrix4,_vA=new Vector3,_vB=new Vector3,_vC=new Vector3,_uvA=new Vector2,_uvB=new Vector2,_uvC=new Vector2;class Sprite extends Object3D{constructor(e=new SpriteMaterial){if(super(),this.isSprite=!0,this.type="Sprite",_geometry===void 0){_geometry=new BufferGeometry;const s=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),a=new InterleavedBuffer(s,5);_geometry.setIndex([0,1,2,0,2,3]),_geometry.setAttribute("position",new InterleavedBufferAttribute(a,3,0,!1)),_geometry.setAttribute("uv",new InterleavedBufferAttribute(a,2,3,!1))}this.geometry=_geometry,this.material=e,this.center=new Vector2(.5,.5)}raycast(e,s){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),_worldScale.setFromMatrixScale(this.matrixWorld),_viewWorldMatrix.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),_mvPosition.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&_worldScale.multiplyScalar(-_mvPosition.z);const a=this.material.rotation;let c,d;a!==0&&(d=Math.cos(a),c=Math.sin(a));const b=this.center;transformVertex(_vA.set(-.5,-.5,0),_mvPosition,b,_worldScale,c,d),transformVertex(_vB.set(.5,-.5,0),_mvPosition,b,_worldScale,c,d),transformVertex(_vC.set(.5,.5,0),_mvPosition,b,_worldScale,c,d),_uvA.set(0,0),_uvB.set(1,0),_uvC.set(1,1);let _e=e.ray.intersectTriangle(_vA,_vB,_vC,!1,_intersectPoint);if(_e===null&&(transformVertex(_vB.set(-.5,.5,0),_mvPosition,b,_worldScale,c,d),_uvB.set(0,1),_e=e.ray.intersectTriangle(_vA,_vC,_vB,!1,_intersectPoint),_e===null))return;const tt=e.ray.origin.distanceTo(_intersectPoint);tt<e.near||tt>e.far||s.push({distance:tt,point:_intersectPoint.clone(),uv:Triangle.getInterpolation(_intersectPoint,_vA,_vB,_vC,_uvA,_uvB,_uvC,new Vector2),face:null,object:this})}copy(e,s){return super.copy(e,s),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function transformVertex(o,e,s,a,c,d){_alignedPosition.subVectors(o,s).addScalar(.5).multiply(a),c!==void 0?(_rotatedPosition.x=d*_alignedPosition.x-c*_alignedPosition.y,_rotatedPosition.y=c*_alignedPosition.x+d*_alignedPosition.y):_rotatedPosition.copy(_alignedPosition),o.copy(e),o.x+=_rotatedPosition.x,o.y+=_rotatedPosition.y,o.applyMatrix4(_viewWorldMatrix)}const _v1$2=new Vector3,_v2$1=new Vector3;class LOD extends Object3D{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const s=e.levels;for(let a=0,c=s.length;a<c;a++){const d=s[a];this.addLevel(d.object.clone(),d.distance,d.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,s=0,a=0){s=Math.abs(s);const c=this.levels;let d;for(d=0;d<c.length&&!(s<c[d].distance);d++);return c.splice(d,0,{distance:s,hysteresis:a,object:e}),this.add(e),this}removeLevel(e){const s=this.levels;for(let a=0;a<s.length;a++)if(s[a].distance===e){const c=s.splice(a,1);return this.remove(c[0].object),!0}return!1}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const s=this.levels;if(s.length>0){let a,c;for(a=1,c=s.length;a<c;a++){let d=s[a].distance;if(s[a].object.visible&&(d-=d*s[a].hysteresis),e<d)break}return s[a-1].object}return null}raycast(e,s){if(this.levels.length>0){_v1$2.setFromMatrixPosition(this.matrixWorld);const c=e.ray.origin.distanceTo(_v1$2);this.getObjectForDistance(c).raycast(e,s)}}update(e){const s=this.levels;if(s.length>1){_v1$2.setFromMatrixPosition(e.matrixWorld),_v2$1.setFromMatrixPosition(this.matrixWorld);const a=_v1$2.distanceTo(_v2$1)/e.zoom;s[0].object.visible=!0;let c,d;for(c=1,d=s.length;c<d;c++){let b=s[c].distance;if(s[c].object.visible&&(b-=b*s[c].hysteresis),a>=b)s[c-1].object.visible=!1,s[c].object.visible=!0;else break}for(this._currentLevel=c-1;c<d;c++)s[c].object.visible=!1}}toJSON(e){const s=super.toJSON(e);this.autoUpdate===!1&&(s.object.autoUpdate=!1),s.object.levels=[];const a=this.levels;for(let c=0,d=a.length;c<d;c++){const b=a[c];s.object.levels.push({object:b.object.uuid,distance:b.distance,hysteresis:b.hysteresis})}return s}}const _basePosition=new Vector3,_skinIndex=new Vector4,_skinWeight=new Vector4,_vector3=new Vector3,_matrix4=new Matrix4,_vertex=new Vector3,_sphere$4=new Sphere,_inverseMatrix$2=new Matrix4,_ray$2=new Ray;class SkinnedMesh extends Mesh{constructor(e,s){super(e,s),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=AttachedBindMode,this.bindMatrix=new Matrix4,this.bindMatrixInverse=new Matrix4,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new Box3),this.boundingBox.makeEmpty();const s=e.getAttribute("position");for(let a=0;a<s.count;a++)this.getVertexPosition(a,_vertex),this.boundingBox.expandByPoint(_vertex)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new Sphere),this.boundingSphere.makeEmpty();const s=e.getAttribute("position");for(let a=0;a<s.count;a++)this.getVertexPosition(a,_vertex),this.boundingSphere.expandByPoint(_vertex)}copy(e,s){return super.copy(e,s),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,s){const a=this.material,c=this.matrixWorld;a!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),_sphere$4.copy(this.boundingSphere),_sphere$4.applyMatrix4(c),e.ray.intersectsSphere(_sphere$4)!==!1&&(_inverseMatrix$2.copy(c).invert(),_ray$2.copy(e.ray).applyMatrix4(_inverseMatrix$2),!(this.boundingBox!==null&&_ray$2.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,s,_ray$2)))}getVertexPosition(e,s){return super.getVertexPosition(e,s),this.applyBoneTransform(e,s),s}bind(e,s){this.skeleton=e,s===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),s=this.matrixWorld),this.bindMatrix.copy(s),this.bindMatrixInverse.copy(s).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Vector4,s=this.geometry.attributes.skinWeight;for(let a=0,c=s.count;a<c;a++){e.fromBufferAttribute(s,a);const d=1/e.manhattanLength();d!==1/0?e.multiplyScalar(d):e.set(1,0,0,0),s.setXYZW(a,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===AttachedBindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===DetachedBindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,s){const a=this.skeleton,c=this.geometry;_skinIndex.fromBufferAttribute(c.attributes.skinIndex,e),_skinWeight.fromBufferAttribute(c.attributes.skinWeight,e),_basePosition.copy(s).applyMatrix4(this.bindMatrix),s.set(0,0,0);for(let d=0;d<4;d++){const b=_skinWeight.getComponent(d);if(b!==0){const _e=_skinIndex.getComponent(d);_matrix4.multiplyMatrices(a.bones[_e].matrixWorld,a.boneInverses[_e]),s.addScaledVector(_vector3.copy(_basePosition).applyMatrix4(_matrix4),b)}}return s.applyMatrix4(this.bindMatrixInverse)}}class Bone extends Object3D{constructor(){super(),this.isBone=!0,this.type="Bone"}}class DataTexture extends Texture{constructor(e=null,s=1,a=1,c,d,b,_e,tt,nt=NearestFilter,it=NearestFilter,ot,at){super(null,b,_e,tt,nt,it,c,d,ot,at),this.isDataTexture=!0,this.image={data:e,width:s,height:a},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const _offsetMatrix=new Matrix4,_identityMatrix$1=new Matrix4;class Skeleton{constructor(e=[],s=[]){this.uuid=generateUUID(),this.bones=e.slice(0),this.boneInverses=s,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,s=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),s.length===0)this.calculateInverses();else if(e.length!==s.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let a=0,c=this.bones.length;a<c;a++)this.boneInverses.push(new Matrix4)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,s=this.bones.length;e<s;e++){const a=new Matrix4;this.bones[e]&&a.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(a)}}pose(){for(let e=0,s=this.bones.length;e<s;e++){const a=this.bones[e];a&&a.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,s=this.bones.length;e<s;e++){const a=this.bones[e];a&&(a.parent&&a.parent.isBone?(a.matrix.copy(a.parent.matrixWorld).invert(),a.matrix.multiply(a.matrixWorld)):a.matrix.copy(a.matrixWorld),a.matrix.decompose(a.position,a.quaternion,a.scale))}}update(){const e=this.bones,s=this.boneInverses,a=this.boneMatrices,c=this.boneTexture;for(let d=0,b=e.length;d<b;d++){const _e=e[d]?e[d].matrixWorld:_identityMatrix$1;_offsetMatrix.multiplyMatrices(_e,s[d]),_offsetMatrix.toArray(a,d*16)}c!==null&&(c.needsUpdate=!0)}clone(){return new Skeleton(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const s=new Float32Array(e*e*4);s.set(this.boneMatrices);const a=new DataTexture(s,e,e,RGBAFormat,FloatType);return a.needsUpdate=!0,this.boneMatrices=s,this.boneTexture=a,this}getBoneByName(e){for(let s=0,a=this.bones.length;s<a;s++){const c=this.bones[s];if(c.name===e)return c}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,s){this.uuid=e.uuid;for(let a=0,c=e.bones.length;a<c;a++){const d=e.bones[a];let b=s[d];b===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",d),b=new Bone),this.bones.push(b),this.boneInverses.push(new Matrix4().fromArray(e.boneInverses[a]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const s=this.bones,a=this.boneInverses;for(let c=0,d=s.length;c<d;c++){const b=s[c];e.bones.push(b.uuid);const _e=a[c];e.boneInverses.push(_e.toArray())}return e}}class InstancedBufferAttribute extends BufferAttribute{constructor(e,s,a,c=1){super(e,s,a),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=c}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const _instanceLocalMatrix=new Matrix4,_instanceWorldMatrix=new Matrix4,_instanceIntersects=[],_box3=new Box3,_identity=new Matrix4,_mesh$1=new Mesh,_sphere$3=new Sphere;class InstancedMesh extends Mesh{constructor(e,s,a){super(e,s),this.isInstancedMesh=!0,this.instanceMatrix=new InstancedBufferAttribute(new Float32Array(a*16),16),this.instanceColor=null,this.morphTexture=null,this.count=a,this.boundingBox=null,this.boundingSphere=null;for(let c=0;c<a;c++)this.setMatrixAt(c,_identity)}computeBoundingBox(){const e=this.geometry,s=this.count;this.boundingBox===null&&(this.boundingBox=new Box3),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let a=0;a<s;a++)this.getMatrixAt(a,_instanceLocalMatrix),_box3.copy(e.boundingBox).applyMatrix4(_instanceLocalMatrix),this.boundingBox.union(_box3)}computeBoundingSphere(){const e=this.geometry,s=this.count;this.boundingSphere===null&&(this.boundingSphere=new Sphere),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let a=0;a<s;a++)this.getMatrixAt(a,_instanceLocalMatrix),_sphere$3.copy(e.boundingSphere).applyMatrix4(_instanceLocalMatrix),this.boundingSphere.union(_sphere$3)}copy(e,s){return super.copy(e,s),this.instanceMatrix.copy(e.instanceMatrix),e.morphTexture!==null&&(this.morphTexture=e.morphTexture.clone()),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,s){s.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,s){s.fromArray(this.instanceMatrix.array,e*16)}getMorphAt(e,s){const a=s.morphTargetInfluences,c=this.morphTexture.source.data.data,d=a.length+1,b=e*d+1;for(let _e=0;_e<a.length;_e++)a[_e]=c[b+_e]}raycast(e,s){const a=this.matrixWorld,c=this.count;if(_mesh$1.geometry=this.geometry,_mesh$1.material=this.material,_mesh$1.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),_sphere$3.copy(this.boundingSphere),_sphere$3.applyMatrix4(a),e.ray.intersectsSphere(_sphere$3)!==!1))for(let d=0;d<c;d++){this.getMatrixAt(d,_instanceLocalMatrix),_instanceWorldMatrix.multiplyMatrices(a,_instanceLocalMatrix),_mesh$1.matrixWorld=_instanceWorldMatrix,_mesh$1.raycast(e,_instanceIntersects);for(let b=0,_e=_instanceIntersects.length;b<_e;b++){const tt=_instanceIntersects[b];tt.instanceId=d,tt.object=this,s.push(tt)}_instanceIntersects.length=0}}setColorAt(e,s){this.instanceColor===null&&(this.instanceColor=new InstancedBufferAttribute(new Float32Array(this.instanceMatrix.count*3).fill(1),3)),s.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,s){s.toArray(this.instanceMatrix.array,e*16)}setMorphAt(e,s){const a=s.morphTargetInfluences,c=a.length+1;this.morphTexture===null&&(this.morphTexture=new DataTexture(new Float32Array(c*this.count),c,this.count,RedFormat,FloatType));const d=this.morphTexture.source.data.data;let b=0;for(let nt=0;nt<a.length;nt++)b+=a[nt];const _e=this.geometry.morphTargetsRelative?1:1-b,tt=c*e;d[tt]=_e,d.set(a,tt+1)}updateMorphTargets(){}dispose(){return this.dispatchEvent({type:"dispose"}),this.morphTexture!==null&&(this.morphTexture.dispose(),this.morphTexture=null),this}}function ascIdSort(o,e){return o-e}function sortOpaque(o,e){return o.z-e.z}function sortTransparent(o,e){return e.z-o.z}class MultiDrawRenderList{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,s,a,c){const d=this.pool,b=this.list;this.index>=d.length&&d.push({start:-1,count:-1,z:-1,index:-1});const _e=d[this.index];b.push(_e),this.index++,_e.start=e,_e.count=s,_e.z=a,_e.index=c}reset(){this.list.length=0,this.index=0}}const _matrix$1=new Matrix4,_whiteColor=new Color(1,1,1),_frustum=new Frustum,_box$1=new Box3,_sphere$2=new Sphere,_vector$5=new Vector3,_forward=new Vector3,_temp=new Vector3,_renderList=new MultiDrawRenderList,_mesh=new Mesh,_batchIntersects=[];function copyAttributeData(o,e,s=0){const a=e.itemSize;if(o.isInterleavedBufferAttribute||o.array.constructor!==e.array.constructor){const c=o.count;for(let d=0;d<c;d++)for(let b=0;b<a;b++)e.setComponent(d+s,b,o.getComponent(d,b))}else e.array.set(o.array,s*a);e.needsUpdate=!0}function copyArrayContents(o,e){if(o.constructor!==e.constructor){const s=Math.min(o.length,e.length);for(let a=0;a<s;a++)e[a]=o[a]}else{const s=Math.min(o.length,e.length);e.set(new o.constructor(o.buffer,0,s))}}class BatchedMesh extends Mesh{get maxInstanceCount(){return this._maxInstanceCount}get instanceCount(){return this._instanceInfo.length-this._availableInstanceIds.length}get unusedVertexCount(){return this._maxVertexCount-this._nextVertexStart}get unusedIndexCount(){return this._maxIndexCount-this._nextIndexStart}constructor(e,s,a=s*2,c){super(new BufferGeometry,c),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._instanceInfo=[],this._geometryInfo=[],this._availableInstanceIds=[],this._availableGeometryIds=[],this._nextIndexStart=0,this._nextVertexStart=0,this._geometryCount=0,this._visibilityChanged=!0,this._geometryInitialized=!1,this._maxInstanceCount=e,this._maxVertexCount=s,this._maxIndexCount=a,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._multiDrawInstances=null,this._matricesTexture=null,this._indirectTexture=null,this._colorsTexture=null,this._initMatricesTexture(),this._initIndirectTexture()}_initMatricesTexture(){let e=Math.sqrt(this._maxInstanceCount*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const s=new Float32Array(e*e*4),a=new DataTexture(s,e,e,RGBAFormat,FloatType);this._matricesTexture=a}_initIndirectTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const s=new Uint32Array(e*e),a=new DataTexture(s,e,e,RedIntegerFormat,UnsignedIntType);this._indirectTexture=a}_initColorsTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const s=new Float32Array(e*e*4).fill(1),a=new DataTexture(s,e,e,RGBAFormat,FloatType);a.colorSpace=ColorManagement.workingColorSpace,this._colorsTexture=a}_initializeGeometry(e){const s=this.geometry,a=this._maxVertexCount,c=this._maxIndexCount;if(this._geometryInitialized===!1){for(const d in e.attributes){const b=e.getAttribute(d),{array:_e,itemSize:tt,normalized:nt}=b,it=new _e.constructor(a*tt),ot=new BufferAttribute(it,tt,nt);s.setAttribute(d,ot)}if(e.getIndex()!==null){const d=a>65535?new Uint32Array(c):new Uint16Array(c);s.setIndex(new BufferAttribute(d,1))}this._geometryInitialized=!0}}_validateGeometry(e){const s=this.geometry;if(!!e.getIndex()!=!!s.getIndex())throw new Error('BatchedMesh: All geometries must consistently have "index".');for(const a in s.attributes){if(!e.hasAttribute(a))throw new Error(`BatchedMesh: Added geometry missing "${a}". All geometries must have consistent attributes.`);const c=e.getAttribute(a),d=s.getAttribute(a);if(c.itemSize!==d.itemSize||c.normalized!==d.normalized)throw new Error("BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Box3);const e=this.boundingBox,s=this._instanceInfo;e.makeEmpty();for(let a=0,c=s.length;a<c;a++){if(s[a].active===!1)continue;const d=s[a].geometryIndex;this.getMatrixAt(a,_matrix$1),this.getBoundingBoxAt(d,_box$1).applyMatrix4(_matrix$1),e.union(_box$1)}}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Sphere);const e=this.boundingSphere,s=this._instanceInfo;e.makeEmpty();for(let a=0,c=s.length;a<c;a++){if(s[a].active===!1)continue;const d=s[a].geometryIndex;this.getMatrixAt(a,_matrix$1),this.getBoundingSphereAt(d,_sphere$2).applyMatrix4(_matrix$1),e.union(_sphere$2)}}addInstance(e){if(this._instanceInfo.length>=this.maxInstanceCount&&this._availableInstanceIds.length===0)throw new Error("BatchedMesh: Maximum item count reached.");const a={visible:!0,active:!0,geometryIndex:e};let c=null;this._availableInstanceIds.length>0?(this._availableInstanceIds.sort(ascIdSort),c=this._availableInstanceIds.shift(),this._instanceInfo[c]=a):(c=this._instanceInfo.length,this._instanceInfo.push(a));const d=this._matricesTexture;_matrix$1.identity().toArray(d.image.data,c*16),d.needsUpdate=!0;const b=this._colorsTexture;return b&&(_whiteColor.toArray(b.image.data,c*4),b.needsUpdate=!0),this._visibilityChanged=!0,c}addGeometry(e,s=-1,a=-1){this._initializeGeometry(e),this._validateGeometry(e);const c={vertexStart:-1,vertexCount:-1,reservedVertexCount:-1,indexStart:-1,indexCount:-1,reservedIndexCount:-1,start:-1,count:-1,boundingBox:null,boundingSphere:null,active:!0},d=this._geometryInfo;c.vertexStart=this._nextVertexStart,c.reservedVertexCount=s===-1?e.getAttribute("position").count:s;const b=e.getIndex();if(b!==null&&(c.indexStart=this._nextIndexStart,c.reservedIndexCount=a===-1?b.count:a),c.indexStart!==-1&&c.indexStart+c.reservedIndexCount>this._maxIndexCount||c.vertexStart+c.reservedVertexCount>this._maxVertexCount)throw new Error("BatchedMesh: Reserved space request exceeds the maximum buffer size.");let tt;return this._availableGeometryIds.length>0?(this._availableGeometryIds.sort(ascIdSort),tt=this._availableGeometryIds.shift(),d[tt]=c):(tt=this._geometryCount,this._geometryCount++,d.push(c)),this.setGeometryAt(tt,e),this._nextIndexStart=c.indexStart+c.reservedIndexCount,this._nextVertexStart=c.vertexStart+c.reservedVertexCount,tt}setGeometryAt(e,s){if(e>=this._geometryCount)throw new Error("BatchedMesh: Maximum geometry count reached.");this._validateGeometry(s);const a=this.geometry,c=a.getIndex()!==null,d=a.getIndex(),b=s.getIndex(),_e=this._geometryInfo[e];if(c&&b.count>_e.reservedIndexCount||s.attributes.position.count>_e.reservedVertexCount)throw new Error("BatchedMesh: Reserved space not large enough for provided geometry.");const tt=_e.vertexStart,nt=_e.reservedVertexCount;_e.vertexCount=s.getAttribute("position").count;for(const it in a.attributes){const ot=s.getAttribute(it),at=a.getAttribute(it);copyAttributeData(ot,at,tt);const ct=ot.itemSize;for(let ut=ot.count,ft=nt;ut<ft;ut++){const dt=tt+ut;for(let lt=0;lt<ct;lt++)at.setComponent(dt,lt,0)}at.needsUpdate=!0,at.addUpdateRange(tt*ct,nt*ct)}if(c){const it=_e.indexStart,ot=_e.reservedIndexCount;_e.indexCount=s.getIndex().count;for(let at=0;at<b.count;at++)d.setX(it+at,tt+b.getX(at));for(let at=b.count,ct=ot;at<ct;at++)d.setX(it+at,tt);d.needsUpdate=!0,d.addUpdateRange(it,_e.reservedIndexCount)}return _e.start=c?_e.indexStart:_e.vertexStart,_e.count=c?_e.indexCount:_e.vertexCount,_e.boundingBox=null,s.boundingBox!==null&&(_e.boundingBox=s.boundingBox.clone()),_e.boundingSphere=null,s.boundingSphere!==null&&(_e.boundingSphere=s.boundingSphere.clone()),this._visibilityChanged=!0,e}deleteGeometry(e){const s=this._geometryInfo;if(e>=s.length||s[e].active===!1)return this;const a=this._instanceInfo;for(let c=0,d=a.length;c<d;c++)a[c].geometryIndex===e&&this.deleteInstance(c);return s[e].active=!1,this._availableGeometryIds.push(e),this._visibilityChanged=!0,this}deleteInstance(e){const s=this._instanceInfo;return e>=s.length||s[e].active===!1?this:(s[e].active=!1,this._availableInstanceIds.push(e),this._visibilityChanged=!0,this)}optimize(){let e=0,s=0;const a=this._geometryInfo,c=a.map((b,_e)=>_e).sort((b,_e)=>a[b].vertexStart-a[_e].vertexStart),d=this.geometry;for(let b=0,_e=a.length;b<_e;b++){const tt=c[b],nt=a[tt];if(nt.active!==!1){if(d.index!==null){if(nt.indexStart!==s){const{indexStart:it,vertexStart:ot,reservedIndexCount:at}=nt,ct=d.index,ut=ct.array,ft=e-ot;for(let dt=it;dt<it+at;dt++)ut[dt]=ut[dt]+ft;ct.array.copyWithin(s,it,it+at),ct.addUpdateRange(s,at),nt.indexStart=s}s+=nt.reservedIndexCount}if(nt.vertexStart!==e){const{vertexStart:it,reservedVertexCount:ot}=nt,at=d.attributes;for(const ct in at){const ut=at[ct],{array:ft,itemSize:dt}=ut;ft.copyWithin(e*dt,it*dt,(it+ot)*dt),ut.addUpdateRange(e*dt,ot*dt)}nt.vertexStart=e}e+=nt.reservedVertexCount,nt.start=d.index?nt.indexStart:nt.vertexStart,this._nextIndexStart=d.index?nt.indexStart+nt.reservedIndexCount:0,this._nextVertexStart=nt.vertexStart+nt.reservedVertexCount}}return this}getBoundingBoxAt(e,s){if(e>=this._geometryCount)return null;const a=this.geometry,c=this._geometryInfo[e];if(c.boundingBox===null){const d=new Box3,b=a.index,_e=a.attributes.position;for(let tt=c.start,nt=c.start+c.count;tt<nt;tt++){let it=tt;b&&(it=b.getX(it)),d.expandByPoint(_vector$5.fromBufferAttribute(_e,it))}c.boundingBox=d}return s.copy(c.boundingBox),s}getBoundingSphereAt(e,s){if(e>=this._geometryCount)return null;const a=this.geometry,c=this._geometryInfo[e];if(c.boundingSphere===null){const d=new Sphere;this.getBoundingBoxAt(e,_box$1),_box$1.getCenter(d.center);const b=a.index,_e=a.attributes.position;let tt=0;for(let nt=c.start,it=c.start+c.count;nt<it;nt++){let ot=nt;b&&(ot=b.getX(ot)),_vector$5.fromBufferAttribute(_e,ot),tt=Math.max(tt,d.center.distanceToSquared(_vector$5))}d.radius=Math.sqrt(tt),c.boundingSphere=d}return s.copy(c.boundingSphere),s}setMatrixAt(e,s){const a=this._instanceInfo,c=this._matricesTexture,d=this._matricesTexture.image.data;return e>=a.length||a[e].active===!1?this:(s.toArray(d,e*16),c.needsUpdate=!0,this)}getMatrixAt(e,s){const a=this._instanceInfo,c=this._matricesTexture.image.data;return e>=a.length||a[e].active===!1?null:s.fromArray(c,e*16)}setColorAt(e,s){this._colorsTexture===null&&this._initColorsTexture();const a=this._colorsTexture,c=this._colorsTexture.image.data,d=this._instanceInfo;return e>=d.length||d[e].active===!1?this:(s.toArray(c,e*4),a.needsUpdate=!0,this)}getColorAt(e,s){const a=this._colorsTexture.image.data,c=this._instanceInfo;return e>=c.length||c[e].active===!1?null:s.fromArray(a,e*4)}setVisibleAt(e,s){const a=this._instanceInfo;return e>=a.length||a[e].active===!1||a[e].visible===s?this:(a[e].visible=s,this._visibilityChanged=!0,this)}getVisibleAt(e){const s=this._instanceInfo;return e>=s.length||s[e].active===!1?!1:s[e].visible}setGeometryIdAt(e,s){const a=this._instanceInfo,c=this._geometryInfo;return e>=a.length||a[e].active===!1||s>=c.length||c[s].active===!1?null:(a[e].geometryIndex=s,this)}getGeometryIdAt(e){const s=this._instanceInfo;return e>=s.length||s[e].active===!1?-1:s[e].geometryIndex}getGeometryRangeAt(e,s={}){if(e<0||e>=this._geometryCount)return null;const a=this._geometryInfo[e];return s.vertexStart=a.vertexStart,s.vertexCount=a.vertexCount,s.reservedVertexCount=a.reservedVertexCount,s.indexStart=a.indexStart,s.indexCount=a.indexCount,s.reservedIndexCount=a.reservedIndexCount,s.start=a.start,s.count=a.count,s}setInstanceCount(e){const s=this._availableInstanceIds,a=this._instanceInfo;for(s.sort(ascIdSort);s[s.length-1]===a.length;)a.pop(),s.pop();if(e<a.length)throw new Error(`BatchedMesh: Instance ids outside the range ${e} are being used. Cannot shrink instance count.`);const c=new Int32Array(e),d=new Int32Array(e);copyArrayContents(this._multiDrawCounts,c),copyArrayContents(this._multiDrawStarts,d),this._multiDrawCounts=c,this._multiDrawStarts=d,this._maxInstanceCount=e;const b=this._indirectTexture,_e=this._matricesTexture,tt=this._colorsTexture;b.dispose(),this._initIndirectTexture(),copyArrayContents(b.image.data,this._indirectTexture.image.data),_e.dispose(),this._initMatricesTexture(),copyArrayContents(_e.image.data,this._matricesTexture.image.data),tt&&(tt.dispose(),this._initColorsTexture(),copyArrayContents(tt.image.data,this._colorsTexture.image.data))}setGeometrySize(e,s){const a=[...this._geometryInfo].filter(_e=>_e.active);if(Math.max(...a.map(_e=>_e.vertexStart+_e.reservedVertexCount))>e)throw new Error(`BatchedMesh: Geometry vertex values are being used outside the range ${s}. Cannot shrink further.`);if(this.geometry.index&&Math.max(...a.map(tt=>tt.indexStart+tt.reservedIndexCount))>s)throw new Error(`BatchedMesh: Geometry index values are being used outside the range ${s}. Cannot shrink further.`);const d=this.geometry;d.dispose(),this._maxVertexCount=e,this._maxIndexCount=s,this._geometryInitialized&&(this._geometryInitialized=!1,this.geometry=new BufferGeometry,this._initializeGeometry(d));const b=this.geometry;d.index&&copyArrayContents(d.index.array,b.index.array);for(const _e in d.attributes)copyArrayContents(d.attributes[_e].array,b.attributes[_e].array)}raycast(e,s){const a=this._instanceInfo,c=this._geometryInfo,d=this.matrixWorld,b=this.geometry;_mesh.material=this.material,_mesh.geometry.index=b.index,_mesh.geometry.attributes=b.attributes,_mesh.geometry.boundingBox===null&&(_mesh.geometry.boundingBox=new Box3),_mesh.geometry.boundingSphere===null&&(_mesh.geometry.boundingSphere=new Sphere);for(let _e=0,tt=a.length;_e<tt;_e++){if(!a[_e].visible||!a[_e].active)continue;const nt=a[_e].geometryIndex,it=c[nt];_mesh.geometry.setDrawRange(it.start,it.count),this.getMatrixAt(_e,_mesh.matrixWorld).premultiply(d),this.getBoundingBoxAt(nt,_mesh.geometry.boundingBox),this.getBoundingSphereAt(nt,_mesh.geometry.boundingSphere),_mesh.raycast(e,_batchIntersects);for(let ot=0,at=_batchIntersects.length;ot<at;ot++){const ct=_batchIntersects[ot];ct.object=this,ct.batchId=_e,s.push(ct)}_batchIntersects.length=0}_mesh.material=null,_mesh.geometry.index=null,_mesh.geometry.attributes={},_mesh.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=e.boundingBox!==null?e.boundingBox.clone():null,this.boundingSphere=e.boundingSphere!==null?e.boundingSphere.clone():null,this._geometryInfo=e._geometryInfo.map(s=>({...s,boundingBox:s.boundingBox!==null?s.boundingBox.clone():null,boundingSphere:s.boundingSphere!==null?s.boundingSphere.clone():null})),this._instanceInfo=e._instanceInfo.map(s=>({...s})),this._maxInstanceCount=e._maxInstanceCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._geometryCount=e._geometryCount,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.data.slice(),this._colorsTexture!==null&&(this._colorsTexture=e._colorsTexture.clone(),this._colorsTexture.image.data=this._colorsTexture.image.data.slice()),this}dispose(){return this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this._indirectTexture.dispose(),this._indirectTexture=null,this._colorsTexture!==null&&(this._colorsTexture.dispose(),this._colorsTexture=null),this}onBeforeRender(e,s,a,c,d){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const b=c.getIndex(),_e=b===null?1:b.array.BYTES_PER_ELEMENT,tt=this._instanceInfo,nt=this._multiDrawStarts,it=this._multiDrawCounts,ot=this._geometryInfo,at=this.perObjectFrustumCulled,ct=this._indirectTexture,ut=ct.image.data;at&&(_matrix$1.multiplyMatrices(a.projectionMatrix,a.matrixWorldInverse).multiply(this.matrixWorld),_frustum.setFromProjectionMatrix(_matrix$1,e.coordinateSystem));let ft=0;if(this.sortObjects){_matrix$1.copy(this.matrixWorld).invert(),_vector$5.setFromMatrixPosition(a.matrixWorld).applyMatrix4(_matrix$1),_forward.set(0,0,-1).transformDirection(a.matrixWorld).transformDirection(_matrix$1);for(let ht=0,mt=tt.length;ht<mt;ht++)if(tt[ht].visible&&tt[ht].active){const xt=tt[ht].geometryIndex;this.getMatrixAt(ht,_matrix$1),this.getBoundingSphereAt(xt,_sphere$2).applyMatrix4(_matrix$1);let St=!1;if(at&&(St=!_frustum.intersectsSphere(_sphere$2)),!St){const yt=ot[xt],wt=_temp.subVectors(_sphere$2.center,_vector$5).dot(_forward);_renderList.push(yt.start,yt.count,wt,ht)}}const dt=_renderList.list,lt=this.customSort;lt===null?dt.sort(d.transparent?sortTransparent:sortOpaque):lt.call(this,dt,a);for(let ht=0,mt=dt.length;ht<mt;ht++){const xt=dt[ht];nt[ft]=xt.start*_e,it[ft]=xt.count,ut[ft]=xt.index,ft++}_renderList.reset()}else for(let dt=0,lt=tt.length;dt<lt;dt++)if(tt[dt].visible&&tt[dt].active){const ht=tt[dt].geometryIndex;let mt=!1;if(at&&(this.getMatrixAt(dt,_matrix$1),this.getBoundingSphereAt(ht,_sphere$2).applyMatrix4(_matrix$1),mt=!_frustum.intersectsSphere(_sphere$2)),!mt){const xt=ot[ht];nt[ft]=xt.start*_e,it[ft]=xt.count,ut[ft]=dt,ft++}}ct.needsUpdate=!0,this._multiDrawCount=ft,this._visibilityChanged=!1}onBeforeShadow(e,s,a,c,d,b){this.onBeforeRender(e,null,c,d,b)}}class LineBasicMaterial extends Material{static get type(){return"LineBasicMaterial"}constructor(e){super(),this.isLineBasicMaterial=!0,this.color=new Color(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const _vStart=new Vector3,_vEnd=new Vector3,_inverseMatrix$1=new Matrix4,_ray$1=new Ray,_sphere$1=new Sphere,_intersectPointOnRay=new Vector3,_intersectPointOnSegment=new Vector3;class Line extends Object3D{constructor(e=new BufferGeometry,s=new LineBasicMaterial){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=s,this.updateMorphTargets()}copy(e,s){return super.copy(e,s),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const s=e.attributes.position,a=[0];for(let c=1,d=s.count;c<d;c++)_vStart.fromBufferAttribute(s,c-1),_vEnd.fromBufferAttribute(s,c),a[c]=a[c-1],a[c]+=_vStart.distanceTo(_vEnd);e.setAttribute("lineDistance",new Float32BufferAttribute(a,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,s){const a=this.geometry,c=this.matrixWorld,d=e.params.Line.threshold,b=a.drawRange;if(a.boundingSphere===null&&a.computeBoundingSphere(),_sphere$1.copy(a.boundingSphere),_sphere$1.applyMatrix4(c),_sphere$1.radius+=d,e.ray.intersectsSphere(_sphere$1)===!1)return;_inverseMatrix$1.copy(c).invert(),_ray$1.copy(e.ray).applyMatrix4(_inverseMatrix$1);const _e=d/((this.scale.x+this.scale.y+this.scale.z)/3),tt=_e*_e,nt=this.isLineSegments?2:1,it=a.index,at=a.attributes.position;if(it!==null){const ct=Math.max(0,b.start),ut=Math.min(it.count,b.start+b.count);for(let ft=ct,dt=ut-1;ft<dt;ft+=nt){const lt=it.getX(ft),ht=it.getX(ft+1),mt=checkIntersection(this,e,_ray$1,tt,lt,ht);mt&&s.push(mt)}if(this.isLineLoop){const ft=it.getX(ut-1),dt=it.getX(ct),lt=checkIntersection(this,e,_ray$1,tt,ft,dt);lt&&s.push(lt)}}else{const ct=Math.max(0,b.start),ut=Math.min(at.count,b.start+b.count);for(let ft=ct,dt=ut-1;ft<dt;ft+=nt){const lt=checkIntersection(this,e,_ray$1,tt,ft,ft+1);lt&&s.push(lt)}if(this.isLineLoop){const ft=checkIntersection(this,e,_ray$1,tt,ut-1,ct);ft&&s.push(ft)}}}updateMorphTargets(){const s=this.geometry.morphAttributes,a=Object.keys(s);if(a.length>0){const c=s[a[0]];if(c!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let d=0,b=c.length;d<b;d++){const _e=c[d].name||String(d);this.morphTargetInfluences.push(0),this.morphTargetDictionary[_e]=d}}}}}function checkIntersection(o,e,s,a,c,d){const b=o.geometry.attributes.position;if(_vStart.fromBufferAttribute(b,c),_vEnd.fromBufferAttribute(b,d),s.distanceSqToSegment(_vStart,_vEnd,_intersectPointOnRay,_intersectPointOnSegment)>a)return;_intersectPointOnRay.applyMatrix4(o.matrixWorld);const tt=e.ray.origin.distanceTo(_intersectPointOnRay);if(!(tt<e.near||tt>e.far))return{distance:tt,point:_intersectPointOnSegment.clone().applyMatrix4(o.matrixWorld),index:c,face:null,faceIndex:null,barycoord:null,object:o}}const _start=new Vector3,_end=new Vector3;class LineSegments extends Line{constructor(e,s){super(e,s),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const s=e.attributes.position,a=[];for(let c=0,d=s.count;c<d;c+=2)_start.fromBufferAttribute(s,c),_end.fromBufferAttribute(s,c+1),a[c]=c===0?0:a[c-1],a[c+1]=a[c]+_start.distanceTo(_end);e.setAttribute("lineDistance",new Float32BufferAttribute(a,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class LineLoop extends Line{constructor(e,s){super(e,s),this.isLineLoop=!0,this.type="LineLoop"}}class PointsMaterial extends Material{static get type(){return"PointsMaterial"}constructor(e){super(),this.isPointsMaterial=!0,this.color=new Color(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const _inverseMatrix=new Matrix4,_ray$4=new Ray,_sphere=new Sphere,_position$2=new Vector3;class Points extends Object3D{constructor(e=new BufferGeometry,s=new PointsMaterial){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=s,this.updateMorphTargets()}copy(e,s){return super.copy(e,s),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,s){const a=this.geometry,c=this.matrixWorld,d=e.params.Points.threshold,b=a.drawRange;if(a.boundingSphere===null&&a.computeBoundingSphere(),_sphere.copy(a.boundingSphere),_sphere.applyMatrix4(c),_sphere.radius+=d,e.ray.intersectsSphere(_sphere)===!1)return;_inverseMatrix.copy(c).invert(),_ray$4.copy(e.ray).applyMatrix4(_inverseMatrix);const _e=d/((this.scale.x+this.scale.y+this.scale.z)/3),tt=_e*_e,nt=a.index,ot=a.attributes.position;if(nt!==null){const at=Math.max(0,b.start),ct=Math.min(nt.count,b.start+b.count);for(let ut=at,ft=ct;ut<ft;ut++){const dt=nt.getX(ut);_position$2.fromBufferAttribute(ot,dt),testPoint(_position$2,dt,tt,c,e,s,this)}}else{const at=Math.max(0,b.start),ct=Math.min(ot.count,b.start+b.count);for(let ut=at,ft=ct;ut<ft;ut++)_position$2.fromBufferAttribute(ot,ut),testPoint(_position$2,ut,tt,c,e,s,this)}}updateMorphTargets(){const s=this.geometry.morphAttributes,a=Object.keys(s);if(a.length>0){const c=s[a[0]];if(c!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let d=0,b=c.length;d<b;d++){const _e=c[d].name||String(d);this.morphTargetInfluences.push(0),this.morphTargetDictionary[_e]=d}}}}}function testPoint(o,e,s,a,c,d,b){const _e=_ray$4.distanceSqToPoint(o);if(_e<s){const tt=new Vector3;_ray$4.closestPointToPoint(o,tt),tt.applyMatrix4(a);const nt=c.ray.origin.distanceTo(tt);if(nt<c.near||nt>c.far)return;d.push({distance:nt,distanceToRay:Math.sqrt(_e),point:tt,index:e,face:null,faceIndex:null,barycoord:null,object:b})}}class VideoTexture extends Texture{constructor(e,s,a,c,d,b,_e,tt,nt){super(e,s,a,c,d,b,_e,tt,nt),this.isVideoTexture=!0,this.minFilter=b!==void 0?b:LinearFilter,this.magFilter=d!==void 0?d:LinearFilter,this.generateMipmaps=!1;const it=this;function ot(){it.needsUpdate=!0,e.requestVideoFrameCallback(ot)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(ot)}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class FramebufferTexture extends Texture{constructor(e,s){super({width:e,height:s}),this.isFramebufferTexture=!0,this.magFilter=NearestFilter,this.minFilter=NearestFilter,this.generateMipmaps=!1,this.needsUpdate=!0}}class CompressedTexture extends Texture{constructor(e,s,a,c,d,b,_e,tt,nt,it,ot,at){super(null,b,_e,tt,nt,it,c,d,ot,at),this.isCompressedTexture=!0,this.image={width:s,height:a},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class CompressedArrayTexture extends CompressedTexture{constructor(e,s,a,c,d,b){super(e,s,a,d,b),this.isCompressedArrayTexture=!0,this.image.depth=c,this.wrapR=ClampToEdgeWrapping,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class CompressedCubeTexture extends CompressedTexture{constructor(e,s,a){super(void 0,e[0].width,e[0].height,s,a,CubeReflectionMapping),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class CanvasTexture extends Texture{constructor(e,s,a,c,d,b,_e,tt,nt){super(e,s,a,c,d,b,_e,tt,nt),this.isCanvasTexture=!0,this.needsUpdate=!0}}class Curve{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,s){const a=this.getUtoTmapping(e);return this.getPoint(a,s)}getPoints(e=5){const s=[];for(let a=0;a<=e;a++)s.push(this.getPoint(a/e));return s}getSpacedPoints(e=5){const s=[];for(let a=0;a<=e;a++)s.push(this.getPointAt(a/e));return s}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const s=[];let a,c=this.getPoint(0),d=0;s.push(0);for(let b=1;b<=e;b++)a=this.getPoint(b/e),d+=a.distanceTo(c),s.push(d),c=a;return this.cacheArcLengths=s,s}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,s){const a=this.getLengths();let c=0;const d=a.length;let b;s?b=s:b=e*a[d-1];let _e=0,tt=d-1,nt;for(;_e<=tt;)if(c=Math.floor(_e+(tt-_e)/2),nt=a[c]-b,nt<0)_e=c+1;else if(nt>0)tt=c-1;else{tt=c;break}if(c=tt,a[c]===b)return c/(d-1);const it=a[c],at=a[c+1]-it,ct=(b-it)/at;return(c+ct)/(d-1)}getTangent(e,s){let c=e-1e-4,d=e+1e-4;c<0&&(c=0),d>1&&(d=1);const b=this.getPoint(c),_e=this.getPoint(d),tt=s||(b.isVector2?new Vector2:new Vector3);return tt.copy(_e).sub(b).normalize(),tt}getTangentAt(e,s){const a=this.getUtoTmapping(e);return this.getTangent(a,s)}computeFrenetFrames(e,s){const a=new Vector3,c=[],d=[],b=[],_e=new Vector3,tt=new Matrix4;for(let ct=0;ct<=e;ct++){const ut=ct/e;c[ct]=this.getTangentAt(ut,new Vector3)}d[0]=new Vector3,b[0]=new Vector3;let nt=Number.MAX_VALUE;const it=Math.abs(c[0].x),ot=Math.abs(c[0].y),at=Math.abs(c[0].z);it<=nt&&(nt=it,a.set(1,0,0)),ot<=nt&&(nt=ot,a.set(0,1,0)),at<=nt&&a.set(0,0,1),_e.crossVectors(c[0],a).normalize(),d[0].crossVectors(c[0],_e),b[0].crossVectors(c[0],d[0]);for(let ct=1;ct<=e;ct++){if(d[ct]=d[ct-1].clone(),b[ct]=b[ct-1].clone(),_e.crossVectors(c[ct-1],c[ct]),_e.length()>Number.EPSILON){_e.normalize();const ut=Math.acos(clamp(c[ct-1].dot(c[ct]),-1,1));d[ct].applyMatrix4(tt.makeRotationAxis(_e,ut))}b[ct].crossVectors(c[ct],d[ct])}if(s===!0){let ct=Math.acos(clamp(d[0].dot(d[e]),-1,1));ct/=e,c[0].dot(_e.crossVectors(d[0],d[e]))>0&&(ct=-ct);for(let ut=1;ut<=e;ut++)d[ut].applyMatrix4(tt.makeRotationAxis(c[ut],ct*ut)),b[ut].crossVectors(c[ut],d[ut])}return{tangents:c,normals:d,binormals:b}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class EllipseCurve extends Curve{constructor(e=0,s=0,a=1,c=1,d=0,b=Math.PI*2,_e=!1,tt=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=s,this.xRadius=a,this.yRadius=c,this.aStartAngle=d,this.aEndAngle=b,this.aClockwise=_e,this.aRotation=tt}getPoint(e,s=new Vector2){const a=s,c=Math.PI*2;let d=this.aEndAngle-this.aStartAngle;const b=Math.abs(d)<Number.EPSILON;for(;d<0;)d+=c;for(;d>c;)d-=c;d<Number.EPSILON&&(b?d=0:d=c),this.aClockwise===!0&&!b&&(d===c?d=-c:d=d-c);const _e=this.aStartAngle+e*d;let tt=this.aX+this.xRadius*Math.cos(_e),nt=this.aY+this.yRadius*Math.sin(_e);if(this.aRotation!==0){const it=Math.cos(this.aRotation),ot=Math.sin(this.aRotation),at=tt-this.aX,ct=nt-this.aY;tt=at*it-ct*ot+this.aX,nt=at*ot+ct*it+this.aY}return a.set(tt,nt)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class ArcCurve extends EllipseCurve{constructor(e,s,a,c,d,b){super(e,s,a,a,c,d,b),this.isArcCurve=!0,this.type="ArcCurve"}}function CubicPoly(){let o=0,e=0,s=0,a=0;function c(d,b,_e,tt){o=d,e=_e,s=-3*d+3*b-2*_e-tt,a=2*d-2*b+_e+tt}return{initCatmullRom:function(d,b,_e,tt,nt){c(b,_e,nt*(_e-d),nt*(tt-b))},initNonuniformCatmullRom:function(d,b,_e,tt,nt,it,ot){let at=(b-d)/nt-(_e-d)/(nt+it)+(_e-b)/it,ct=(_e-b)/it-(tt-b)/(it+ot)+(tt-_e)/ot;at*=it,ct*=it,c(b,_e,at,ct)},calc:function(d){const b=d*d,_e=b*d;return o+e*d+s*b+a*_e}}}const tmp=new Vector3,px=new CubicPoly,py=new CubicPoly,pz=new CubicPoly;class CatmullRomCurve3 extends Curve{constructor(e=[],s=!1,a="centripetal",c=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=s,this.curveType=a,this.tension=c}getPoint(e,s=new Vector3){const a=s,c=this.points,d=c.length,b=(d-(this.closed?0:1))*e;let _e=Math.floor(b),tt=b-_e;this.closed?_e+=_e>0?0:(Math.floor(Math.abs(_e)/d)+1)*d:tt===0&&_e===d-1&&(_e=d-2,tt=1);let nt,it;this.closed||_e>0?nt=c[(_e-1)%d]:(tmp.subVectors(c[0],c[1]).add(c[0]),nt=tmp);const ot=c[_e%d],at=c[(_e+1)%d];if(this.closed||_e+2<d?it=c[(_e+2)%d]:(tmp.subVectors(c[d-1],c[d-2]).add(c[d-1]),it=tmp),this.curveType==="centripetal"||this.curveType==="chordal"){const ct=this.curveType==="chordal"?.5:.25;let ut=Math.pow(nt.distanceToSquared(ot),ct),ft=Math.pow(ot.distanceToSquared(at),ct),dt=Math.pow(at.distanceToSquared(it),ct);ft<1e-4&&(ft=1),ut<1e-4&&(ut=ft),dt<1e-4&&(dt=ft),px.initNonuniformCatmullRom(nt.x,ot.x,at.x,it.x,ut,ft,dt),py.initNonuniformCatmullRom(nt.y,ot.y,at.y,it.y,ut,ft,dt),pz.initNonuniformCatmullRom(nt.z,ot.z,at.z,it.z,ut,ft,dt)}else this.curveType==="catmullrom"&&(px.initCatmullRom(nt.x,ot.x,at.x,it.x,this.tension),py.initCatmullRom(nt.y,ot.y,at.y,it.y,this.tension),pz.initCatmullRom(nt.z,ot.z,at.z,it.z,this.tension));return a.set(px.calc(tt),py.calc(tt),pz.calc(tt)),a}copy(e){super.copy(e),this.points=[];for(let s=0,a=e.points.length;s<a;s++){const c=e.points[s];this.points.push(c.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let s=0,a=this.points.length;s<a;s++){const c=this.points[s];e.points.push(c.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let s=0,a=e.points.length;s<a;s++){const c=e.points[s];this.points.push(new Vector3().fromArray(c))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function CatmullRom(o,e,s,a,c){const d=(a-e)*.5,b=(c-s)*.5,_e=o*o,tt=o*_e;return(2*s-2*a+d+b)*tt+(-3*s+3*a-2*d-b)*_e+d*o+s}function QuadraticBezierP0(o,e){const s=1-o;return s*s*e}function QuadraticBezierP1(o,e){return 2*(1-o)*o*e}function QuadraticBezierP2(o,e){return o*o*e}function QuadraticBezier(o,e,s,a){return QuadraticBezierP0(o,e)+QuadraticBezierP1(o,s)+QuadraticBezierP2(o,a)}function CubicBezierP0(o,e){const s=1-o;return s*s*s*e}function CubicBezierP1(o,e){const s=1-o;return 3*s*s*o*e}function CubicBezierP2(o,e){return 3*(1-o)*o*o*e}function CubicBezierP3(o,e){return o*o*o*e}function CubicBezier(o,e,s,a,c){return CubicBezierP0(o,e)+CubicBezierP1(o,s)+CubicBezierP2(o,a)+CubicBezierP3(o,c)}class CubicBezierCurve extends Curve{constructor(e=new Vector2,s=new Vector2,a=new Vector2,c=new Vector2){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=s,this.v2=a,this.v3=c}getPoint(e,s=new Vector2){const a=s,c=this.v0,d=this.v1,b=this.v2,_e=this.v3;return a.set(CubicBezier(e,c.x,d.x,b.x,_e.x),CubicBezier(e,c.y,d.y,b.y,_e.y)),a}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class CubicBezierCurve3 extends Curve{constructor(e=new Vector3,s=new Vector3,a=new Vector3,c=new Vector3){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=s,this.v2=a,this.v3=c}getPoint(e,s=new Vector3){const a=s,c=this.v0,d=this.v1,b=this.v2,_e=this.v3;return a.set(CubicBezier(e,c.x,d.x,b.x,_e.x),CubicBezier(e,c.y,d.y,b.y,_e.y),CubicBezier(e,c.z,d.z,b.z,_e.z)),a}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class LineCurve extends Curve{constructor(e=new Vector2,s=new Vector2){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=s}getPoint(e,s=new Vector2){const a=s;return e===1?a.copy(this.v2):(a.copy(this.v2).sub(this.v1),a.multiplyScalar(e).add(this.v1)),a}getPointAt(e,s){return this.getPoint(e,s)}getTangent(e,s=new Vector2){return s.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,s){return this.getTangent(e,s)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class LineCurve3 extends Curve{constructor(e=new Vector3,s=new Vector3){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=s}getPoint(e,s=new Vector3){const a=s;return e===1?a.copy(this.v2):(a.copy(this.v2).sub(this.v1),a.multiplyScalar(e).add(this.v1)),a}getPointAt(e,s){return this.getPoint(e,s)}getTangent(e,s=new Vector3){return s.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,s){return this.getTangent(e,s)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class QuadraticBezierCurve extends Curve{constructor(e=new Vector2,s=new Vector2,a=new Vector2){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=s,this.v2=a}getPoint(e,s=new Vector2){const a=s,c=this.v0,d=this.v1,b=this.v2;return a.set(QuadraticBezier(e,c.x,d.x,b.x),QuadraticBezier(e,c.y,d.y,b.y)),a}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class QuadraticBezierCurve3 extends Curve{constructor(e=new Vector3,s=new Vector3,a=new Vector3){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=s,this.v2=a}getPoint(e,s=new Vector3){const a=s,c=this.v0,d=this.v1,b=this.v2;return a.set(QuadraticBezier(e,c.x,d.x,b.x),QuadraticBezier(e,c.y,d.y,b.y),QuadraticBezier(e,c.z,d.z,b.z)),a}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class SplineCurve extends Curve{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,s=new Vector2){const a=s,c=this.points,d=(c.length-1)*e,b=Math.floor(d),_e=d-b,tt=c[b===0?b:b-1],nt=c[b],it=c[b>c.length-2?c.length-1:b+1],ot=c[b>c.length-3?c.length-1:b+2];return a.set(CatmullRom(_e,tt.x,nt.x,it.x,ot.x),CatmullRom(_e,tt.y,nt.y,it.y,ot.y)),a}copy(e){super.copy(e),this.points=[];for(let s=0,a=e.points.length;s<a;s++){const c=e.points[s];this.points.push(c.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let s=0,a=this.points.length;s<a;s++){const c=this.points[s];e.points.push(c.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let s=0,a=e.points.length;s<a;s++){const c=e.points[s];this.points.push(new Vector2().fromArray(c))}return this}}var Curves=Object.freeze({__proto__:null,ArcCurve,CatmullRomCurve3,CubicBezierCurve,CubicBezierCurve3,EllipseCurve,LineCurve,LineCurve3,QuadraticBezierCurve,QuadraticBezierCurve3,SplineCurve});class CurvePath extends Curve{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),s=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(s)){const a=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new Curves[a](s,e))}return this}getPoint(e,s){const a=e*this.getLength(),c=this.getCurveLengths();let d=0;for(;d<c.length;){if(c[d]>=a){const b=c[d]-a,_e=this.curves[d],tt=_e.getLength(),nt=tt===0?0:1-b/tt;return _e.getPointAt(nt,s)}d++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let s=0;for(let a=0,c=this.curves.length;a<c;a++)s+=this.curves[a].getLength(),e.push(s);return this.cacheLengths=e,e}getSpacedPoints(e=40){const s=[];for(let a=0;a<=e;a++)s.push(this.getPoint(a/e));return this.autoClose&&s.push(s[0]),s}getPoints(e=12){const s=[];let a;for(let c=0,d=this.curves;c<d.length;c++){const b=d[c],_e=b.isEllipseCurve?e*2:b.isLineCurve||b.isLineCurve3?1:b.isSplineCurve?e*b.points.length:e,tt=b.getPoints(_e);for(let nt=0;nt<tt.length;nt++){const it=tt[nt];a&&a.equals(it)||(s.push(it),a=it)}}return this.autoClose&&s.length>1&&!s[s.length-1].equals(s[0])&&s.push(s[0]),s}copy(e){super.copy(e),this.curves=[];for(let s=0,a=e.curves.length;s<a;s++){const c=e.curves[s];this.curves.push(c.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let s=0,a=this.curves.length;s<a;s++){const c=this.curves[s];e.curves.push(c.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let s=0,a=e.curves.length;s<a;s++){const c=e.curves[s];this.curves.push(new Curves[c.type]().fromJSON(c))}return this}}class Path extends CurvePath{constructor(e){super(),this.type="Path",this.currentPoint=new Vector2,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let s=1,a=e.length;s<a;s++)this.lineTo(e[s].x,e[s].y);return this}moveTo(e,s){return this.currentPoint.set(e,s),this}lineTo(e,s){const a=new LineCurve(this.currentPoint.clone(),new Vector2(e,s));return this.curves.push(a),this.currentPoint.set(e,s),this}quadraticCurveTo(e,s,a,c){const d=new QuadraticBezierCurve(this.currentPoint.clone(),new Vector2(e,s),new Vector2(a,c));return this.curves.push(d),this.currentPoint.set(a,c),this}bezierCurveTo(e,s,a,c,d,b){const _e=new CubicBezierCurve(this.currentPoint.clone(),new Vector2(e,s),new Vector2(a,c),new Vector2(d,b));return this.curves.push(_e),this.currentPoint.set(d,b),this}splineThru(e){const s=[this.currentPoint.clone()].concat(e),a=new SplineCurve(s);return this.curves.push(a),this.currentPoint.copy(e[e.length-1]),this}arc(e,s,a,c,d,b){const _e=this.currentPoint.x,tt=this.currentPoint.y;return this.absarc(e+_e,s+tt,a,c,d,b),this}absarc(e,s,a,c,d,b){return this.absellipse(e,s,a,a,c,d,b),this}ellipse(e,s,a,c,d,b,_e,tt){const nt=this.currentPoint.x,it=this.currentPoint.y;return this.absellipse(e+nt,s+it,a,c,d,b,_e,tt),this}absellipse(e,s,a,c,d,b,_e,tt){const nt=new EllipseCurve(e,s,a,c,d,b,_e,tt);if(this.curves.length>0){const ot=nt.getPoint(0);ot.equals(this.currentPoint)||this.lineTo(ot.x,ot.y)}this.curves.push(nt);const it=nt.getPoint(1);return this.currentPoint.copy(it),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class LatheGeometry extends BufferGeometry{constructor(e=[new Vector2(0,-.5),new Vector2(.5,0),new Vector2(0,.5)],s=12,a=0,c=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:s,phiStart:a,phiLength:c},s=Math.floor(s),c=clamp(c,0,Math.PI*2);const d=[],b=[],_e=[],tt=[],nt=[],it=1/s,ot=new Vector3,at=new Vector2,ct=new Vector3,ut=new Vector3,ft=new Vector3;let dt=0,lt=0;for(let ht=0;ht<=e.length-1;ht++)switch(ht){case 0:dt=e[ht+1].x-e[ht].x,lt=e[ht+1].y-e[ht].y,ct.x=lt*1,ct.y=-dt,ct.z=lt*0,ft.copy(ct),ct.normalize(),tt.push(ct.x,ct.y,ct.z);break;case e.length-1:tt.push(ft.x,ft.y,ft.z);break;default:dt=e[ht+1].x-e[ht].x,lt=e[ht+1].y-e[ht].y,ct.x=lt*1,ct.y=-dt,ct.z=lt*0,ut.copy(ct),ct.x+=ft.x,ct.y+=ft.y,ct.z+=ft.z,ct.normalize(),tt.push(ct.x,ct.y,ct.z),ft.copy(ut)}for(let ht=0;ht<=s;ht++){const mt=a+ht*it*c,xt=Math.sin(mt),St=Math.cos(mt);for(let yt=0;yt<=e.length-1;yt++){ot.x=e[yt].x*xt,ot.y=e[yt].y,ot.z=e[yt].x*St,b.push(ot.x,ot.y,ot.z),at.x=ht/s,at.y=yt/(e.length-1),_e.push(at.x,at.y);const wt=tt[3*yt+0]*xt,Et=tt[3*yt+1],_t=tt[3*yt+0]*St;nt.push(wt,Et,_t)}}for(let ht=0;ht<s;ht++)for(let mt=0;mt<e.length-1;mt++){const xt=mt+ht*e.length,St=xt,yt=xt+e.length,wt=xt+e.length+1,Et=xt+1;d.push(St,yt,Et),d.push(wt,Et,yt)}this.setIndex(d),this.setAttribute("position",new Float32BufferAttribute(b,3)),this.setAttribute("uv",new Float32BufferAttribute(_e,2)),this.setAttribute("normal",new Float32BufferAttribute(nt,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new LatheGeometry(e.points,e.segments,e.phiStart,e.phiLength)}}class CapsuleGeometry extends LatheGeometry{constructor(e=1,s=1,a=4,c=8){const d=new Path;d.absarc(0,-s/2,e,Math.PI*1.5,0),d.absarc(0,s/2,e,0,Math.PI*.5),super(d.getPoints(a),c),this.type="CapsuleGeometry",this.parameters={radius:e,length:s,capSegments:a,radialSegments:c}}static fromJSON(e){return new CapsuleGeometry(e.radius,e.length,e.capSegments,e.radialSegments)}}class CircleGeometry extends BufferGeometry{constructor(e=1,s=32,a=0,c=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:s,thetaStart:a,thetaLength:c},s=Math.max(3,s);const d=[],b=[],_e=[],tt=[],nt=new Vector3,it=new Vector2;b.push(0,0,0),_e.push(0,0,1),tt.push(.5,.5);for(let ot=0,at=3;ot<=s;ot++,at+=3){const ct=a+ot/s*c;nt.x=e*Math.cos(ct),nt.y=e*Math.sin(ct),b.push(nt.x,nt.y,nt.z),_e.push(0,0,1),it.x=(b[at]/e+1)/2,it.y=(b[at+1]/e+1)/2,tt.push(it.x,it.y)}for(let ot=1;ot<=s;ot++)d.push(ot,ot+1,0);this.setIndex(d),this.setAttribute("position",new Float32BufferAttribute(b,3)),this.setAttribute("normal",new Float32BufferAttribute(_e,3)),this.setAttribute("uv",new Float32BufferAttribute(tt,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new CircleGeometry(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class CylinderGeometry extends BufferGeometry{constructor(e=1,s=1,a=1,c=32,d=1,b=!1,_e=0,tt=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:s,height:a,radialSegments:c,heightSegments:d,openEnded:b,thetaStart:_e,thetaLength:tt};const nt=this;c=Math.floor(c),d=Math.floor(d);const it=[],ot=[],at=[],ct=[];let ut=0;const ft=[],dt=a/2;let lt=0;ht(),b===!1&&(e>0&&mt(!0),s>0&&mt(!1)),this.setIndex(it),this.setAttribute("position",new Float32BufferAttribute(ot,3)),this.setAttribute("normal",new Float32BufferAttribute(at,3)),this.setAttribute("uv",new Float32BufferAttribute(ct,2));function ht(){const xt=new Vector3,St=new Vector3;let yt=0;const wt=(s-e)/a;for(let Et=0;Et<=d;Et++){const _t=[],vt=Et/d,Mt=vt*(s-e)+e;for(let jt=0;jt<=c;jt++){const Lt=jt/c,Nt=Lt*tt+_e,kt=Math.sin(Nt),Ot=Math.cos(Nt);St.x=Mt*kt,St.y=-vt*a+dt,St.z=Mt*Ot,ot.push(St.x,St.y,St.z),xt.set(kt,wt,Ot).normalize(),at.push(xt.x,xt.y,xt.z),ct.push(Lt,1-vt),_t.push(ut++)}ft.push(_t)}for(let Et=0;Et<c;Et++)for(let _t=0;_t<d;_t++){const vt=ft[_t][Et],Mt=ft[_t+1][Et],jt=ft[_t+1][Et+1],Lt=ft[_t][Et+1];(e>0||_t!==0)&&(it.push(vt,Mt,Lt),yt+=3),(s>0||_t!==d-1)&&(it.push(Mt,jt,Lt),yt+=3)}nt.addGroup(lt,yt,0),lt+=yt}function mt(xt){const St=ut,yt=new Vector2,wt=new Vector3;let Et=0;const _t=xt===!0?e:s,vt=xt===!0?1:-1;for(let jt=1;jt<=c;jt++)ot.push(0,dt*vt,0),at.push(0,vt,0),ct.push(.5,.5),ut++;const Mt=ut;for(let jt=0;jt<=c;jt++){const Nt=jt/c*tt+_e,kt=Math.cos(Nt),Ot=Math.sin(Nt);wt.x=_t*Ot,wt.y=dt*vt,wt.z=_t*kt,ot.push(wt.x,wt.y,wt.z),at.push(0,vt,0),yt.x=kt*.5+.5,yt.y=Ot*.5*vt+.5,ct.push(yt.x,yt.y),ut++}for(let jt=0;jt<c;jt++){const Lt=St+jt,Nt=Mt+jt;xt===!0?it.push(Nt,Nt+1,Lt):it.push(Nt+1,Nt,Lt),Et+=3}nt.addGroup(lt,Et,xt===!0?1:2),lt+=Et}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new CylinderGeometry(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class ConeGeometry extends CylinderGeometry{constructor(e=1,s=1,a=32,c=1,d=!1,b=0,_e=Math.PI*2){super(0,e,s,a,c,d,b,_e),this.type="ConeGeometry",this.parameters={radius:e,height:s,radialSegments:a,heightSegments:c,openEnded:d,thetaStart:b,thetaLength:_e}}static fromJSON(e){return new ConeGeometry(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class PolyhedronGeometry extends BufferGeometry{constructor(e=[],s=[],a=1,c=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:s,radius:a,detail:c};const d=[],b=[];_e(c),nt(a),it(),this.setAttribute("position",new Float32BufferAttribute(d,3)),this.setAttribute("normal",new Float32BufferAttribute(d.slice(),3)),this.setAttribute("uv",new Float32BufferAttribute(b,2)),c===0?this.computeVertexNormals():this.normalizeNormals();function _e(ht){const mt=new Vector3,xt=new Vector3,St=new Vector3;for(let yt=0;yt<s.length;yt+=3)ct(s[yt+0],mt),ct(s[yt+1],xt),ct(s[yt+2],St),tt(mt,xt,St,ht)}function tt(ht,mt,xt,St){const yt=St+1,wt=[];for(let Et=0;Et<=yt;Et++){wt[Et]=[];const _t=ht.clone().lerp(xt,Et/yt),vt=mt.clone().lerp(xt,Et/yt),Mt=yt-Et;for(let jt=0;jt<=Mt;jt++)jt===0&&Et===yt?wt[Et][jt]=_t:wt[Et][jt]=_t.clone().lerp(vt,jt/Mt)}for(let Et=0;Et<yt;Et++)for(let _t=0;_t<2*(yt-Et)-1;_t++){const vt=Math.floor(_t/2);_t%2===0?(at(wt[Et][vt+1]),at(wt[Et+1][vt]),at(wt[Et][vt])):(at(wt[Et][vt+1]),at(wt[Et+1][vt+1]),at(wt[Et+1][vt]))}}function nt(ht){const mt=new Vector3;for(let xt=0;xt<d.length;xt+=3)mt.x=d[xt+0],mt.y=d[xt+1],mt.z=d[xt+2],mt.normalize().multiplyScalar(ht),d[xt+0]=mt.x,d[xt+1]=mt.y,d[xt+2]=mt.z}function it(){const ht=new Vector3;for(let mt=0;mt<d.length;mt+=3){ht.x=d[mt+0],ht.y=d[mt+1],ht.z=d[mt+2];const xt=dt(ht)/2/Math.PI+.5,St=lt(ht)/Math.PI+.5;b.push(xt,1-St)}ut(),ot()}function ot(){for(let ht=0;ht<b.length;ht+=6){const mt=b[ht+0],xt=b[ht+2],St=b[ht+4],yt=Math.max(mt,xt,St),wt=Math.min(mt,xt,St);yt>.9&&wt<.1&&(mt<.2&&(b[ht+0]+=1),xt<.2&&(b[ht+2]+=1),St<.2&&(b[ht+4]+=1))}}function at(ht){d.push(ht.x,ht.y,ht.z)}function ct(ht,mt){const xt=ht*3;mt.x=e[xt+0],mt.y=e[xt+1],mt.z=e[xt+2]}function ut(){const ht=new Vector3,mt=new Vector3,xt=new Vector3,St=new Vector3,yt=new Vector2,wt=new Vector2,Et=new Vector2;for(let _t=0,vt=0;_t<d.length;_t+=9,vt+=6){ht.set(d[_t+0],d[_t+1],d[_t+2]),mt.set(d[_t+3],d[_t+4],d[_t+5]),xt.set(d[_t+6],d[_t+7],d[_t+8]),yt.set(b[vt+0],b[vt+1]),wt.set(b[vt+2],b[vt+3]),Et.set(b[vt+4],b[vt+5]),St.copy(ht).add(mt).add(xt).divideScalar(3);const Mt=dt(St);ft(yt,vt+0,ht,Mt),ft(wt,vt+2,mt,Mt),ft(Et,vt+4,xt,Mt)}}function ft(ht,mt,xt,St){St<0&&ht.x===1&&(b[mt]=ht.x-1),xt.x===0&&xt.z===0&&(b[mt]=St/2/Math.PI+.5)}function dt(ht){return Math.atan2(ht.z,-ht.x)}function lt(ht){return Math.atan2(-ht.y,Math.sqrt(ht.x*ht.x+ht.z*ht.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new PolyhedronGeometry(e.vertices,e.indices,e.radius,e.details)}}class DodecahedronGeometry extends PolyhedronGeometry{constructor(e=1,s=0){const a=(1+Math.sqrt(5))/2,c=1/a,d=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-c,-a,0,-c,a,0,c,-a,0,c,a,-c,-a,0,-c,a,0,c,-a,0,c,a,0,-a,0,-c,a,0,-c,-a,0,c,a,0,c],b=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(d,b,e,s),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:s}}static fromJSON(e){return new DodecahedronGeometry(e.radius,e.detail)}}const _v0=new Vector3,_v1$1=new Vector3,_normal=new Vector3,_triangle=new Triangle;class EdgesGeometry extends BufferGeometry{constructor(e=null,s=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:s},e!==null){const c=Math.pow(10,4),d=Math.cos(DEG2RAD*s),b=e.getIndex(),_e=e.getAttribute("position"),tt=b?b.count:_e.count,nt=[0,0,0],it=["a","b","c"],ot=new Array(3),at={},ct=[];for(let ut=0;ut<tt;ut+=3){b?(nt[0]=b.getX(ut),nt[1]=b.getX(ut+1),nt[2]=b.getX(ut+2)):(nt[0]=ut,nt[1]=ut+1,nt[2]=ut+2);const{a:ft,b:dt,c:lt}=_triangle;if(ft.fromBufferAttribute(_e,nt[0]),dt.fromBufferAttribute(_e,nt[1]),lt.fromBufferAttribute(_e,nt[2]),_triangle.getNormal(_normal),ot[0]=`${Math.round(ft.x*c)},${Math.round(ft.y*c)},${Math.round(ft.z*c)}`,ot[1]=`${Math.round(dt.x*c)},${Math.round(dt.y*c)},${Math.round(dt.z*c)}`,ot[2]=`${Math.round(lt.x*c)},${Math.round(lt.y*c)},${Math.round(lt.z*c)}`,!(ot[0]===ot[1]||ot[1]===ot[2]||ot[2]===ot[0]))for(let ht=0;ht<3;ht++){const mt=(ht+1)%3,xt=ot[ht],St=ot[mt],yt=_triangle[it[ht]],wt=_triangle[it[mt]],Et=`${xt}_${St}`,_t=`${St}_${xt}`;_t in at&&at[_t]?(_normal.dot(at[_t].normal)<=d&&(ct.push(yt.x,yt.y,yt.z),ct.push(wt.x,wt.y,wt.z)),at[_t]=null):Et in at||(at[Et]={index0:nt[ht],index1:nt[mt],normal:_normal.clone()})}}for(const ut in at)if(at[ut]){const{index0:ft,index1:dt}=at[ut];_v0.fromBufferAttribute(_e,ft),_v1$1.fromBufferAttribute(_e,dt),ct.push(_v0.x,_v0.y,_v0.z),ct.push(_v1$1.x,_v1$1.y,_v1$1.z)}this.setAttribute("position",new Float32BufferAttribute(ct,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class Shape extends Path{constructor(e){super(e),this.uuid=generateUUID(),this.type="Shape",this.holes=[]}getPointsHoles(e){const s=[];for(let a=0,c=this.holes.length;a<c;a++)s[a]=this.holes[a].getPoints(e);return s}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let s=0,a=e.holes.length;s<a;s++){const c=e.holes[s];this.holes.push(c.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let s=0,a=this.holes.length;s<a;s++){const c=this.holes[s];e.holes.push(c.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let s=0,a=e.holes.length;s<a;s++){const c=e.holes[s];this.holes.push(new Path().fromJSON(c))}return this}}const Earcut={triangulate:function(o,e,s=2){const a=e&&e.length,c=a?e[0]*s:o.length;let d=linkedList(o,0,c,s,!0);const b=[];if(!d||d.next===d.prev)return b;let _e,tt,nt,it,ot,at,ct;if(a&&(d=eliminateHoles(o,e,d,s)),o.length>80*s){_e=nt=o[0],tt=it=o[1];for(let ut=s;ut<c;ut+=s)ot=o[ut],at=o[ut+1],ot<_e&&(_e=ot),at<tt&&(tt=at),ot>nt&&(nt=ot),at>it&&(it=at);ct=Math.max(nt-_e,it-tt),ct=ct!==0?32767/ct:0}return earcutLinked(d,b,s,_e,tt,ct,0),b}};function linkedList(o,e,s,a,c){let d,b;if(c===signedArea(o,e,s,a)>0)for(d=e;d<s;d+=a)b=insertNode(d,o[d],o[d+1],b);else for(d=s-a;d>=e;d-=a)b=insertNode(d,o[d],o[d+1],b);return b&&equals(b,b.next)&&(removeNode(b),b=b.next),b}function filterPoints(o,e){if(!o)return o;e||(e=o);let s=o,a;do if(a=!1,!s.steiner&&(equals(s,s.next)||area(s.prev,s,s.next)===0)){if(removeNode(s),s=e=s.prev,s===s.next)break;a=!0}else s=s.next;while(a||s!==e);return e}function earcutLinked(o,e,s,a,c,d,b){if(!o)return;!b&&d&&indexCurve(o,a,c,d);let _e=o,tt,nt;for(;o.prev!==o.next;){if(tt=o.prev,nt=o.next,d?isEarHashed(o,a,c,d):isEar(o)){e.push(tt.i/s|0),e.push(o.i/s|0),e.push(nt.i/s|0),removeNode(o),o=nt.next,_e=nt.next;continue}if(o=nt,o===_e){b?b===1?(o=cureLocalIntersections(filterPoints(o),e,s),earcutLinked(o,e,s,a,c,d,2)):b===2&&splitEarcut(o,e,s,a,c,d):earcutLinked(filterPoints(o),e,s,a,c,d,1);break}}}function isEar(o){const e=o.prev,s=o,a=o.next;if(area(e,s,a)>=0)return!1;const c=e.x,d=s.x,b=a.x,_e=e.y,tt=s.y,nt=a.y,it=c<d?c<b?c:b:d<b?d:b,ot=_e<tt?_e<nt?_e:nt:tt<nt?tt:nt,at=c>d?c>b?c:b:d>b?d:b,ct=_e>tt?_e>nt?_e:nt:tt>nt?tt:nt;let ut=a.next;for(;ut!==e;){if(ut.x>=it&&ut.x<=at&&ut.y>=ot&&ut.y<=ct&&pointInTriangle(c,_e,d,tt,b,nt,ut.x,ut.y)&&area(ut.prev,ut,ut.next)>=0)return!1;ut=ut.next}return!0}function isEarHashed(o,e,s,a){const c=o.prev,d=o,b=o.next;if(area(c,d,b)>=0)return!1;const _e=c.x,tt=d.x,nt=b.x,it=c.y,ot=d.y,at=b.y,ct=_e<tt?_e<nt?_e:nt:tt<nt?tt:nt,ut=it<ot?it<at?it:at:ot<at?ot:at,ft=_e>tt?_e>nt?_e:nt:tt>nt?tt:nt,dt=it>ot?it>at?it:at:ot>at?ot:at,lt=zOrder(ct,ut,e,s,a),ht=zOrder(ft,dt,e,s,a);let mt=o.prevZ,xt=o.nextZ;for(;mt&&mt.z>=lt&&xt&&xt.z<=ht;){if(mt.x>=ct&&mt.x<=ft&&mt.y>=ut&&mt.y<=dt&&mt!==c&&mt!==b&&pointInTriangle(_e,it,tt,ot,nt,at,mt.x,mt.y)&&area(mt.prev,mt,mt.next)>=0||(mt=mt.prevZ,xt.x>=ct&&xt.x<=ft&&xt.y>=ut&&xt.y<=dt&&xt!==c&&xt!==b&&pointInTriangle(_e,it,tt,ot,nt,at,xt.x,xt.y)&&area(xt.prev,xt,xt.next)>=0))return!1;xt=xt.nextZ}for(;mt&&mt.z>=lt;){if(mt.x>=ct&&mt.x<=ft&&mt.y>=ut&&mt.y<=dt&&mt!==c&&mt!==b&&pointInTriangle(_e,it,tt,ot,nt,at,mt.x,mt.y)&&area(mt.prev,mt,mt.next)>=0)return!1;mt=mt.prevZ}for(;xt&&xt.z<=ht;){if(xt.x>=ct&&xt.x<=ft&&xt.y>=ut&&xt.y<=dt&&xt!==c&&xt!==b&&pointInTriangle(_e,it,tt,ot,nt,at,xt.x,xt.y)&&area(xt.prev,xt,xt.next)>=0)return!1;xt=xt.nextZ}return!0}function cureLocalIntersections(o,e,s){let a=o;do{const c=a.prev,d=a.next.next;!equals(c,d)&&intersects(c,a,a.next,d)&&locallyInside(c,d)&&locallyInside(d,c)&&(e.push(c.i/s|0),e.push(a.i/s|0),e.push(d.i/s|0),removeNode(a),removeNode(a.next),a=o=d),a=a.next}while(a!==o);return filterPoints(a)}function splitEarcut(o,e,s,a,c,d){let b=o;do{let _e=b.next.next;for(;_e!==b.prev;){if(b.i!==_e.i&&isValidDiagonal(b,_e)){let tt=splitPolygon(b,_e);b=filterPoints(b,b.next),tt=filterPoints(tt,tt.next),earcutLinked(b,e,s,a,c,d,0),earcutLinked(tt,e,s,a,c,d,0);return}_e=_e.next}b=b.next}while(b!==o)}function eliminateHoles(o,e,s,a){const c=[];let d,b,_e,tt,nt;for(d=0,b=e.length;d<b;d++)_e=e[d]*a,tt=d<b-1?e[d+1]*a:o.length,nt=linkedList(o,_e,tt,a,!1),nt===nt.next&&(nt.steiner=!0),c.push(getLeftmost(nt));for(c.sort(compareX),d=0;d<c.length;d++)s=eliminateHole(c[d],s);return s}function compareX(o,e){return o.x-e.x}function eliminateHole(o,e){const s=findHoleBridge(o,e);if(!s)return e;const a=splitPolygon(s,o);return filterPoints(a,a.next),filterPoints(s,s.next)}function findHoleBridge(o,e){let s=e,a=-1/0,c;const d=o.x,b=o.y;do{if(b<=s.y&&b>=s.next.y&&s.next.y!==s.y){const at=s.x+(b-s.y)*(s.next.x-s.x)/(s.next.y-s.y);if(at<=d&&at>a&&(a=at,c=s.x<s.next.x?s:s.next,at===d))return c}s=s.next}while(s!==e);if(!c)return null;const _e=c,tt=c.x,nt=c.y;let it=1/0,ot;s=c;do d>=s.x&&s.x>=tt&&d!==s.x&&pointInTriangle(b<nt?d:a,b,tt,nt,b<nt?a:d,b,s.x,s.y)&&(ot=Math.abs(b-s.y)/(d-s.x),locallyInside(s,o)&&(ot<it||ot===it&&(s.x>c.x||s.x===c.x&&sectorContainsSector(c,s)))&&(c=s,it=ot)),s=s.next;while(s!==_e);return c}function sectorContainsSector(o,e){return area(o.prev,o,e.prev)<0&&area(e.next,o,o.next)<0}function indexCurve(o,e,s,a){let c=o;do c.z===0&&(c.z=zOrder(c.x,c.y,e,s,a)),c.prevZ=c.prev,c.nextZ=c.next,c=c.next;while(c!==o);c.prevZ.nextZ=null,c.prevZ=null,sortLinked(c)}function sortLinked(o){let e,s,a,c,d,b,_e,tt,nt=1;do{for(s=o,o=null,d=null,b=0;s;){for(b++,a=s,_e=0,e=0;e<nt&&(_e++,a=a.nextZ,!!a);e++);for(tt=nt;_e>0||tt>0&&a;)_e!==0&&(tt===0||!a||s.z<=a.z)?(c=s,s=s.nextZ,_e--):(c=a,a=a.nextZ,tt--),d?d.nextZ=c:o=c,c.prevZ=d,d=c;s=a}d.nextZ=null,nt*=2}while(b>1);return o}function zOrder(o,e,s,a,c){return o=(o-s)*c|0,e=(e-a)*c|0,o=(o|o<<8)&16711935,o=(o|o<<4)&252645135,o=(o|o<<2)&858993459,o=(o|o<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,o|e<<1}function getLeftmost(o){let e=o,s=o;do(e.x<s.x||e.x===s.x&&e.y<s.y)&&(s=e),e=e.next;while(e!==o);return s}function pointInTriangle(o,e,s,a,c,d,b,_e){return(c-b)*(e-_e)>=(o-b)*(d-_e)&&(o-b)*(a-_e)>=(s-b)*(e-_e)&&(s-b)*(d-_e)>=(c-b)*(a-_e)}function isValidDiagonal(o,e){return o.next.i!==e.i&&o.prev.i!==e.i&&!intersectsPolygon(o,e)&&(locallyInside(o,e)&&locallyInside(e,o)&&middleInside(o,e)&&(area(o.prev,o,e.prev)||area(o,e.prev,e))||equals(o,e)&&area(o.prev,o,o.next)>0&&area(e.prev,e,e.next)>0)}function area(o,e,s){return(e.y-o.y)*(s.x-e.x)-(e.x-o.x)*(s.y-e.y)}function equals(o,e){return o.x===e.x&&o.y===e.y}function intersects(o,e,s,a){const c=sign(area(o,e,s)),d=sign(area(o,e,a)),b=sign(area(s,a,o)),_e=sign(area(s,a,e));return!!(c!==d&&b!==_e||c===0&&onSegment(o,s,e)||d===0&&onSegment(o,a,e)||b===0&&onSegment(s,o,a)||_e===0&&onSegment(s,e,a))}function onSegment(o,e,s){return e.x<=Math.max(o.x,s.x)&&e.x>=Math.min(o.x,s.x)&&e.y<=Math.max(o.y,s.y)&&e.y>=Math.min(o.y,s.y)}function sign(o){return o>0?1:o<0?-1:0}function intersectsPolygon(o,e){let s=o;do{if(s.i!==o.i&&s.next.i!==o.i&&s.i!==e.i&&s.next.i!==e.i&&intersects(s,s.next,o,e))return!0;s=s.next}while(s!==o);return!1}function locallyInside(o,e){return area(o.prev,o,o.next)<0?area(o,e,o.next)>=0&&area(o,o.prev,e)>=0:area(o,e,o.prev)<0||area(o,o.next,e)<0}function middleInside(o,e){let s=o,a=!1;const c=(o.x+e.x)/2,d=(o.y+e.y)/2;do s.y>d!=s.next.y>d&&s.next.y!==s.y&&c<(s.next.x-s.x)*(d-s.y)/(s.next.y-s.y)+s.x&&(a=!a),s=s.next;while(s!==o);return a}function splitPolygon(o,e){const s=new Node(o.i,o.x,o.y),a=new Node(e.i,e.x,e.y),c=o.next,d=e.prev;return o.next=e,e.prev=o,s.next=c,c.prev=s,a.next=s,s.prev=a,d.next=a,a.prev=d,a}function insertNode(o,e,s,a){const c=new Node(o,e,s);return a?(c.next=a.next,c.prev=a,a.next.prev=c,a.next=c):(c.prev=c,c.next=c),c}function removeNode(o){o.next.prev=o.prev,o.prev.next=o.next,o.prevZ&&(o.prevZ.nextZ=o.nextZ),o.nextZ&&(o.nextZ.prevZ=o.prevZ)}function Node(o,e,s){this.i=o,this.x=e,this.y=s,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function signedArea(o,e,s,a){let c=0;for(let d=e,b=s-a;d<s;d+=a)c+=(o[b]-o[d])*(o[d+1]+o[b+1]),b=d;return c}class ShapeUtils{static area(e){const s=e.length;let a=0;for(let c=s-1,d=0;d<s;c=d++)a+=e[c].x*e[d].y-e[d].x*e[c].y;return a*.5}static isClockWise(e){return ShapeUtils.area(e)<0}static triangulateShape(e,s){const a=[],c=[],d=[];removeDupEndPts(e),addContour(a,e);let b=e.length;s.forEach(removeDupEndPts);for(let tt=0;tt<s.length;tt++)c.push(b),b+=s[tt].length,addContour(a,s[tt]);const _e=Earcut.triangulate(a,c);for(let tt=0;tt<_e.length;tt+=3)d.push(_e.slice(tt,tt+3));return d}}function removeDupEndPts(o){const e=o.length;e>2&&o[e-1].equals(o[0])&&o.pop()}function addContour(o,e){for(let s=0;s<e.length;s++)o.push(e[s].x),o.push(e[s].y)}class ExtrudeGeometry extends BufferGeometry{constructor(e=new Shape([new Vector2(.5,.5),new Vector2(-.5,.5),new Vector2(-.5,-.5),new Vector2(.5,-.5)]),s={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:s},e=Array.isArray(e)?e:[e];const a=this,c=[],d=[];for(let _e=0,tt=e.length;_e<tt;_e++){const nt=e[_e];b(nt)}this.setAttribute("position",new Float32BufferAttribute(c,3)),this.setAttribute("uv",new Float32BufferAttribute(d,2)),this.computeVertexNormals();function b(_e){const tt=[],nt=s.curveSegments!==void 0?s.curveSegments:12,it=s.steps!==void 0?s.steps:1,ot=s.depth!==void 0?s.depth:1;let at=s.bevelEnabled!==void 0?s.bevelEnabled:!0,ct=s.bevelThickness!==void 0?s.bevelThickness:.2,ut=s.bevelSize!==void 0?s.bevelSize:ct-.1,ft=s.bevelOffset!==void 0?s.bevelOffset:0,dt=s.bevelSegments!==void 0?s.bevelSegments:3;const lt=s.extrudePath,ht=s.UVGenerator!==void 0?s.UVGenerator:WorldUVGenerator;let mt,xt=!1,St,yt,wt,Et;lt&&(mt=lt.getSpacedPoints(it),xt=!0,at=!1,St=lt.computeFrenetFrames(it,!1),yt=new Vector3,wt=new Vector3,Et=new Vector3),at||(dt=0,ct=0,ut=0,ft=0);const _t=_e.extractPoints(nt);let vt=_t.shape;const Mt=_t.holes;if(!ShapeUtils.isClockWise(vt)){vt=vt.reverse();for(let gn=0,bn=Mt.length;gn<bn;gn++){const Kt=Mt[gn];ShapeUtils.isClockWise(Kt)&&(Mt[gn]=Kt.reverse())}}const Lt=ShapeUtils.triangulateShape(vt,Mt),Nt=vt;for(let gn=0,bn=Mt.length;gn<bn;gn++){const Kt=Mt[gn];vt=vt.concat(Kt)}function kt(gn,bn,Kt){return bn||console.error("THREE.ExtrudeGeometry: vec does not exist"),gn.clone().addScaledVector(bn,Kt)}const Ot=vt.length,Ht=Lt.length;function Ct(gn,bn,Kt){let Jn,Cn,kn;const Nn=gn.x-bn.x,ir=gn.y-bn.y,Un=Kt.x-gn.x,zt=Kt.y-gn.y,It=Nn*Nn+ir*ir,on=Nn*zt-ir*Un;if(Math.abs(on)>Number.EPSILON){const xn=Math.sqrt(It),wn=Math.sqrt(Un*Un+zt*zt),En=bn.x-ir/xn,Hn=bn.y+Nn/xn,Fn=Kt.x-zt/wn,zn=Kt.y+Un/wn,xr=((Fn-En)*zt-(zn-Hn)*Un)/(Nn*zt-ir*Un);Jn=En+Nn*xr-gn.x,Cn=Hn+ir*xr-gn.y;const Tn=Jn*Jn+Cn*Cn;if(Tn<=2)return new Vector2(Jn,Cn);kn=Math.sqrt(Tn/2)}else{let xn=!1;Nn>Number.EPSILON?Un>Number.EPSILON&&(xn=!0):Nn<-Number.EPSILON?Un<-Number.EPSILON&&(xn=!0):Math.sign(ir)===Math.sign(zt)&&(xn=!0),xn?(Jn=-ir,Cn=Nn,kn=Math.sqrt(It)):(Jn=Nn,Cn=ir,kn=Math.sqrt(It/2))}return new Vector2(Jn/kn,Cn/kn)}const Ut=[];for(let gn=0,bn=Nt.length,Kt=bn-1,Jn=gn+1;gn<bn;gn++,Kt++,Jn++)Kt===bn&&(Kt=0),Jn===bn&&(Jn=0),Ut[gn]=Ct(Nt[gn],Nt[Kt],Nt[Jn]);const Gt=[];let Pt,Wt=Ut.concat();for(let gn=0,bn=Mt.length;gn<bn;gn++){const Kt=Mt[gn];Pt=[];for(let Jn=0,Cn=Kt.length,kn=Cn-1,Nn=Jn+1;Jn<Cn;Jn++,kn++,Nn++)kn===Cn&&(kn=0),Nn===Cn&&(Nn=0),Pt[Jn]=Ct(Kt[Jn],Kt[kn],Kt[Nn]);Gt.push(Pt),Wt=Wt.concat(Pt)}for(let gn=0;gn<dt;gn++){const bn=gn/dt,Kt=ct*Math.cos(bn*Math.PI/2),Jn=ut*Math.sin(bn*Math.PI/2)+ft;for(let Cn=0,kn=Nt.length;Cn<kn;Cn++){const Nn=kt(Nt[Cn],Ut[Cn],Jn);vn(Nn.x,Nn.y,-Kt)}for(let Cn=0,kn=Mt.length;Cn<kn;Cn++){const Nn=Mt[Cn];Pt=Gt[Cn];for(let ir=0,Un=Nn.length;ir<Un;ir++){const zt=kt(Nn[ir],Pt[ir],Jn);vn(zt.x,zt.y,-Kt)}}}const sn=ut+ft;for(let gn=0;gn<Ot;gn++){const bn=at?kt(vt[gn],Wt[gn],sn):vt[gn];xt?(wt.copy(St.normals[0]).multiplyScalar(bn.x),yt.copy(St.binormals[0]).multiplyScalar(bn.y),Et.copy(mt[0]).add(wt).add(yt),vn(Et.x,Et.y,Et.z)):vn(bn.x,bn.y,0)}for(let gn=1;gn<=it;gn++)for(let bn=0;bn<Ot;bn++){const Kt=at?kt(vt[bn],Wt[bn],sn):vt[bn];xt?(wt.copy(St.normals[gn]).multiplyScalar(Kt.x),yt.copy(St.binormals[gn]).multiplyScalar(Kt.y),Et.copy(mt[gn]).add(wt).add(yt),vn(Et.x,Et.y,Et.z)):vn(Kt.x,Kt.y,ot/it*gn)}for(let gn=dt-1;gn>=0;gn--){const bn=gn/dt,Kt=ct*Math.cos(bn*Math.PI/2),Jn=ut*Math.sin(bn*Math.PI/2)+ft;for(let Cn=0,kn=Nt.length;Cn<kn;Cn++){const Nn=kt(Nt[Cn],Ut[Cn],Jn);vn(Nn.x,Nn.y,ot+Kt)}for(let Cn=0,kn=Mt.length;Cn<kn;Cn++){const Nn=Mt[Cn];Pt=Gt[Cn];for(let ir=0,Un=Nn.length;ir<Un;ir++){const zt=kt(Nn[ir],Pt[ir],Jn);xt?vn(zt.x,zt.y+mt[it-1].y,mt[it-1].x+Kt):vn(zt.x,zt.y,ot+Kt)}}}Bt(),tn();function Bt(){const gn=c.length/3;if(at){let bn=0,Kt=Ot*bn;for(let Jn=0;Jn<Ht;Jn++){const Cn=Lt[Jn];On(Cn[2]+Kt,Cn[1]+Kt,Cn[0]+Kt)}bn=it+dt*2,Kt=Ot*bn;for(let Jn=0;Jn<Ht;Jn++){const Cn=Lt[Jn];On(Cn[0]+Kt,Cn[1]+Kt,Cn[2]+Kt)}}else{for(let bn=0;bn<Ht;bn++){const Kt=Lt[bn];On(Kt[2],Kt[1],Kt[0])}for(let bn=0;bn<Ht;bn++){const Kt=Lt[bn];On(Kt[0]+Ot*it,Kt[1]+Ot*it,Kt[2]+Ot*it)}}a.addGroup(gn,c.length/3-gn,0)}function tn(){const gn=c.length/3;let bn=0;cn(Nt,bn),bn+=Nt.length;for(let Kt=0,Jn=Mt.length;Kt<Jn;Kt++){const Cn=Mt[Kt];cn(Cn,bn),bn+=Cn.length}a.addGroup(gn,c.length/3-gn,1)}function cn(gn,bn){let Kt=gn.length;for(;--Kt>=0;){const Jn=Kt;let Cn=Kt-1;Cn<0&&(Cn=gn.length-1);for(let kn=0,Nn=it+dt*2;kn<Nn;kn++){const ir=Ot*kn,Un=Ot*(kn+1),zt=bn+Jn+ir,It=bn+Cn+ir,on=bn+Cn+Un,xn=bn+Jn+Un;rr(zt,It,on,xn)}}}function vn(gn,bn,Kt){tt.push(gn),tt.push(bn),tt.push(Kt)}function On(gn,bn,Kt){Wn(gn),Wn(bn),Wn(Kt);const Jn=c.length/3,Cn=ht.generateTopUV(a,c,Jn-3,Jn-2,Jn-1);Bn(Cn[0]),Bn(Cn[1]),Bn(Cn[2])}function rr(gn,bn,Kt,Jn){Wn(gn),Wn(bn),Wn(Jn),Wn(bn),Wn(Kt),Wn(Jn);const Cn=c.length/3,kn=ht.generateSideWallUV(a,c,Cn-6,Cn-3,Cn-2,Cn-1);Bn(kn[0]),Bn(kn[1]),Bn(kn[3]),Bn(kn[1]),Bn(kn[2]),Bn(kn[3])}function Wn(gn){c.push(tt[gn*3+0]),c.push(tt[gn*3+1]),c.push(tt[gn*3+2])}function Bn(gn){d.push(gn.x),d.push(gn.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),s=this.parameters.shapes,a=this.parameters.options;return toJSON$1(s,a,e)}static fromJSON(e,s){const a=[];for(let d=0,b=e.shapes.length;d<b;d++){const _e=s[e.shapes[d]];a.push(_e)}const c=e.options.extrudePath;return c!==void 0&&(e.options.extrudePath=new Curves[c.type]().fromJSON(c)),new ExtrudeGeometry(a,e.options)}}const WorldUVGenerator={generateTopUV:function(o,e,s,a,c){const d=e[s*3],b=e[s*3+1],_e=e[a*3],tt=e[a*3+1],nt=e[c*3],it=e[c*3+1];return[new Vector2(d,b),new Vector2(_e,tt),new Vector2(nt,it)]},generateSideWallUV:function(o,e,s,a,c,d){const b=e[s*3],_e=e[s*3+1],tt=e[s*3+2],nt=e[a*3],it=e[a*3+1],ot=e[a*3+2],at=e[c*3],ct=e[c*3+1],ut=e[c*3+2],ft=e[d*3],dt=e[d*3+1],lt=e[d*3+2];return Math.abs(_e-it)<Math.abs(b-nt)?[new Vector2(b,1-tt),new Vector2(nt,1-ot),new Vector2(at,1-ut),new Vector2(ft,1-lt)]:[new Vector2(_e,1-tt),new Vector2(it,1-ot),new Vector2(ct,1-ut),new Vector2(dt,1-lt)]}};function toJSON$1(o,e,s){if(s.shapes=[],Array.isArray(o))for(let a=0,c=o.length;a<c;a++){const d=o[a];s.shapes.push(d.uuid)}else s.shapes.push(o.uuid);return s.options=Object.assign({},e),e.extrudePath!==void 0&&(s.options.extrudePath=e.extrudePath.toJSON()),s}class IcosahedronGeometry extends PolyhedronGeometry{constructor(e=1,s=0){const a=(1+Math.sqrt(5))/2,c=[-1,a,0,1,a,0,-1,-a,0,1,-a,0,0,-1,a,0,1,a,0,-1,-a,0,1,-a,a,0,-1,a,0,1,-a,0,-1,-a,0,1],d=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(c,d,e,s),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:s}}static fromJSON(e){return new IcosahedronGeometry(e.radius,e.detail)}}class OctahedronGeometry extends PolyhedronGeometry{constructor(e=1,s=0){const a=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],c=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(a,c,e,s),this.type="OctahedronGeometry",this.parameters={radius:e,detail:s}}static fromJSON(e){return new OctahedronGeometry(e.radius,e.detail)}}class RingGeometry extends BufferGeometry{constructor(e=.5,s=1,a=32,c=1,d=0,b=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:s,thetaSegments:a,phiSegments:c,thetaStart:d,thetaLength:b},a=Math.max(3,a),c=Math.max(1,c);const _e=[],tt=[],nt=[],it=[];let ot=e;const at=(s-e)/c,ct=new Vector3,ut=new Vector2;for(let ft=0;ft<=c;ft++){for(let dt=0;dt<=a;dt++){const lt=d+dt/a*b;ct.x=ot*Math.cos(lt),ct.y=ot*Math.sin(lt),tt.push(ct.x,ct.y,ct.z),nt.push(0,0,1),ut.x=(ct.x/s+1)/2,ut.y=(ct.y/s+1)/2,it.push(ut.x,ut.y)}ot+=at}for(let ft=0;ft<c;ft++){const dt=ft*(a+1);for(let lt=0;lt<a;lt++){const ht=lt+dt,mt=ht,xt=ht+a+1,St=ht+a+2,yt=ht+1;_e.push(mt,xt,yt),_e.push(xt,St,yt)}}this.setIndex(_e),this.setAttribute("position",new Float32BufferAttribute(tt,3)),this.setAttribute("normal",new Float32BufferAttribute(nt,3)),this.setAttribute("uv",new Float32BufferAttribute(it,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new RingGeometry(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class ShapeGeometry extends BufferGeometry{constructor(e=new Shape([new Vector2(0,.5),new Vector2(-.5,-.5),new Vector2(.5,-.5)]),s=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:s};const a=[],c=[],d=[],b=[];let _e=0,tt=0;if(Array.isArray(e)===!1)nt(e);else for(let it=0;it<e.length;it++)nt(e[it]),this.addGroup(_e,tt,it),_e+=tt,tt=0;this.setIndex(a),this.setAttribute("position",new Float32BufferAttribute(c,3)),this.setAttribute("normal",new Float32BufferAttribute(d,3)),this.setAttribute("uv",new Float32BufferAttribute(b,2));function nt(it){const ot=c.length/3,at=it.extractPoints(s);let ct=at.shape;const ut=at.holes;ShapeUtils.isClockWise(ct)===!1&&(ct=ct.reverse());for(let dt=0,lt=ut.length;dt<lt;dt++){const ht=ut[dt];ShapeUtils.isClockWise(ht)===!0&&(ut[dt]=ht.reverse())}const ft=ShapeUtils.triangulateShape(ct,ut);for(let dt=0,lt=ut.length;dt<lt;dt++){const ht=ut[dt];ct=ct.concat(ht)}for(let dt=0,lt=ct.length;dt<lt;dt++){const ht=ct[dt];c.push(ht.x,ht.y,0),d.push(0,0,1),b.push(ht.x,ht.y)}for(let dt=0,lt=ft.length;dt<lt;dt++){const ht=ft[dt],mt=ht[0]+ot,xt=ht[1]+ot,St=ht[2]+ot;a.push(mt,xt,St),tt+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),s=this.parameters.shapes;return toJSON(s,e)}static fromJSON(e,s){const a=[];for(let c=0,d=e.shapes.length;c<d;c++){const b=s[e.shapes[c]];a.push(b)}return new ShapeGeometry(a,e.curveSegments)}}function toJSON(o,e){if(e.shapes=[],Array.isArray(o))for(let s=0,a=o.length;s<a;s++){const c=o[s];e.shapes.push(c.uuid)}else e.shapes.push(o.uuid);return e}class SphereGeometry extends BufferGeometry{constructor(e=1,s=32,a=16,c=0,d=Math.PI*2,b=0,_e=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:s,heightSegments:a,phiStart:c,phiLength:d,thetaStart:b,thetaLength:_e},s=Math.max(3,Math.floor(s)),a=Math.max(2,Math.floor(a));const tt=Math.min(b+_e,Math.PI);let nt=0;const it=[],ot=new Vector3,at=new Vector3,ct=[],ut=[],ft=[],dt=[];for(let lt=0;lt<=a;lt++){const ht=[],mt=lt/a;let xt=0;lt===0&&b===0?xt=.5/s:lt===a&&tt===Math.PI&&(xt=-.5/s);for(let St=0;St<=s;St++){const yt=St/s;ot.x=-e*Math.cos(c+yt*d)*Math.sin(b+mt*_e),ot.y=e*Math.cos(b+mt*_e),ot.z=e*Math.sin(c+yt*d)*Math.sin(b+mt*_e),ut.push(ot.x,ot.y,ot.z),at.copy(ot).normalize(),ft.push(at.x,at.y,at.z),dt.push(yt+xt,1-mt),ht.push(nt++)}it.push(ht)}for(let lt=0;lt<a;lt++)for(let ht=0;ht<s;ht++){const mt=it[lt][ht+1],xt=it[lt][ht],St=it[lt+1][ht],yt=it[lt+1][ht+1];(lt!==0||b>0)&&ct.push(mt,xt,yt),(lt!==a-1||tt<Math.PI)&&ct.push(xt,St,yt)}this.setIndex(ct),this.setAttribute("position",new Float32BufferAttribute(ut,3)),this.setAttribute("normal",new Float32BufferAttribute(ft,3)),this.setAttribute("uv",new Float32BufferAttribute(dt,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new SphereGeometry(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class TetrahedronGeometry extends PolyhedronGeometry{constructor(e=1,s=0){const a=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],c=[2,1,0,0,3,2,1,3,0,2,3,1];super(a,c,e,s),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:s}}static fromJSON(e){return new TetrahedronGeometry(e.radius,e.detail)}}class TorusGeometry extends BufferGeometry{constructor(e=1,s=.4,a=12,c=48,d=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:s,radialSegments:a,tubularSegments:c,arc:d},a=Math.floor(a),c=Math.floor(c);const b=[],_e=[],tt=[],nt=[],it=new Vector3,ot=new Vector3,at=new Vector3;for(let ct=0;ct<=a;ct++)for(let ut=0;ut<=c;ut++){const ft=ut/c*d,dt=ct/a*Math.PI*2;ot.x=(e+s*Math.cos(dt))*Math.cos(ft),ot.y=(e+s*Math.cos(dt))*Math.sin(ft),ot.z=s*Math.sin(dt),_e.push(ot.x,ot.y,ot.z),it.x=e*Math.cos(ft),it.y=e*Math.sin(ft),at.subVectors(ot,it).normalize(),tt.push(at.x,at.y,at.z),nt.push(ut/c),nt.push(ct/a)}for(let ct=1;ct<=a;ct++)for(let ut=1;ut<=c;ut++){const ft=(c+1)*ct+ut-1,dt=(c+1)*(ct-1)+ut-1,lt=(c+1)*(ct-1)+ut,ht=(c+1)*ct+ut;b.push(ft,dt,ht),b.push(dt,lt,ht)}this.setIndex(b),this.setAttribute("position",new Float32BufferAttribute(_e,3)),this.setAttribute("normal",new Float32BufferAttribute(tt,3)),this.setAttribute("uv",new Float32BufferAttribute(nt,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new TorusGeometry(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class TorusKnotGeometry extends BufferGeometry{constructor(e=1,s=.4,a=64,c=8,d=2,b=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:s,tubularSegments:a,radialSegments:c,p:d,q:b},a=Math.floor(a),c=Math.floor(c);const _e=[],tt=[],nt=[],it=[],ot=new Vector3,at=new Vector3,ct=new Vector3,ut=new Vector3,ft=new Vector3,dt=new Vector3,lt=new Vector3;for(let mt=0;mt<=a;++mt){const xt=mt/a*d*Math.PI*2;ht(xt,d,b,e,ct),ht(xt+.01,d,b,e,ut),dt.subVectors(ut,ct),lt.addVectors(ut,ct),ft.crossVectors(dt,lt),lt.crossVectors(ft,dt),ft.normalize(),lt.normalize();for(let St=0;St<=c;++St){const yt=St/c*Math.PI*2,wt=-s*Math.cos(yt),Et=s*Math.sin(yt);ot.x=ct.x+(wt*lt.x+Et*ft.x),ot.y=ct.y+(wt*lt.y+Et*ft.y),ot.z=ct.z+(wt*lt.z+Et*ft.z),tt.push(ot.x,ot.y,ot.z),at.subVectors(ot,ct).normalize(),nt.push(at.x,at.y,at.z),it.push(mt/a),it.push(St/c)}}for(let mt=1;mt<=a;mt++)for(let xt=1;xt<=c;xt++){const St=(c+1)*(mt-1)+(xt-1),yt=(c+1)*mt+(xt-1),wt=(c+1)*mt+xt,Et=(c+1)*(mt-1)+xt;_e.push(St,yt,Et),_e.push(yt,wt,Et)}this.setIndex(_e),this.setAttribute("position",new Float32BufferAttribute(tt,3)),this.setAttribute("normal",new Float32BufferAttribute(nt,3)),this.setAttribute("uv",new Float32BufferAttribute(it,2));function ht(mt,xt,St,yt,wt){const Et=Math.cos(mt),_t=Math.sin(mt),vt=St/xt*mt,Mt=Math.cos(vt);wt.x=yt*(2+Mt)*.5*Et,wt.y=yt*(2+Mt)*_t*.5,wt.z=yt*Math.sin(vt)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new TorusKnotGeometry(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class TubeGeometry extends BufferGeometry{constructor(e=new QuadraticBezierCurve3(new Vector3(-1,-1,0),new Vector3(-1,1,0),new Vector3(1,1,0)),s=64,a=1,c=8,d=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:s,radius:a,radialSegments:c,closed:d};const b=e.computeFrenetFrames(s,d);this.tangents=b.tangents,this.normals=b.normals,this.binormals=b.binormals;const _e=new Vector3,tt=new Vector3,nt=new Vector2;let it=new Vector3;const ot=[],at=[],ct=[],ut=[];ft(),this.setIndex(ut),this.setAttribute("position",new Float32BufferAttribute(ot,3)),this.setAttribute("normal",new Float32BufferAttribute(at,3)),this.setAttribute("uv",new Float32BufferAttribute(ct,2));function ft(){for(let mt=0;mt<s;mt++)dt(mt);dt(d===!1?s:0),ht(),lt()}function dt(mt){it=e.getPointAt(mt/s,it);const xt=b.normals[mt],St=b.binormals[mt];for(let yt=0;yt<=c;yt++){const wt=yt/c*Math.PI*2,Et=Math.sin(wt),_t=-Math.cos(wt);tt.x=_t*xt.x+Et*St.x,tt.y=_t*xt.y+Et*St.y,tt.z=_t*xt.z+Et*St.z,tt.normalize(),at.push(tt.x,tt.y,tt.z),_e.x=it.x+a*tt.x,_e.y=it.y+a*tt.y,_e.z=it.z+a*tt.z,ot.push(_e.x,_e.y,_e.z)}}function lt(){for(let mt=1;mt<=s;mt++)for(let xt=1;xt<=c;xt++){const St=(c+1)*(mt-1)+(xt-1),yt=(c+1)*mt+(xt-1),wt=(c+1)*mt+xt,Et=(c+1)*(mt-1)+xt;ut.push(St,yt,Et),ut.push(yt,wt,Et)}}function ht(){for(let mt=0;mt<=s;mt++)for(let xt=0;xt<=c;xt++)nt.x=mt/s,nt.y=xt/c,ct.push(nt.x,nt.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new TubeGeometry(new Curves[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class WireframeGeometry extends BufferGeometry{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const s=[],a=new Set,c=new Vector3,d=new Vector3;if(e.index!==null){const b=e.attributes.position,_e=e.index;let tt=e.groups;tt.length===0&&(tt=[{start:0,count:_e.count,materialIndex:0}]);for(let nt=0,it=tt.length;nt<it;++nt){const ot=tt[nt],at=ot.start,ct=ot.count;for(let ut=at,ft=at+ct;ut<ft;ut+=3)for(let dt=0;dt<3;dt++){const lt=_e.getX(ut+dt),ht=_e.getX(ut+(dt+1)%3);c.fromBufferAttribute(b,lt),d.fromBufferAttribute(b,ht),isUniqueEdge(c,d,a)===!0&&(s.push(c.x,c.y,c.z),s.push(d.x,d.y,d.z))}}}else{const b=e.attributes.position;for(let _e=0,tt=b.count/3;_e<tt;_e++)for(let nt=0;nt<3;nt++){const it=3*_e+nt,ot=3*_e+(nt+1)%3;c.fromBufferAttribute(b,it),d.fromBufferAttribute(b,ot),isUniqueEdge(c,d,a)===!0&&(s.push(c.x,c.y,c.z),s.push(d.x,d.y,d.z))}}this.setAttribute("position",new Float32BufferAttribute(s,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function isUniqueEdge(o,e,s){const a=`${o.x},${o.y},${o.z}-${e.x},${e.y},${e.z}`,c=`${e.x},${e.y},${e.z}-${o.x},${o.y},${o.z}`;return s.has(a)===!0||s.has(c)===!0?!1:(s.add(a),s.add(c),!0)}var Geometries=Object.freeze({__proto__:null,BoxGeometry,CapsuleGeometry,CircleGeometry,ConeGeometry,CylinderGeometry,DodecahedronGeometry,EdgesGeometry,ExtrudeGeometry,IcosahedronGeometry,LatheGeometry,OctahedronGeometry,PlaneGeometry,PolyhedronGeometry,RingGeometry,ShapeGeometry,SphereGeometry,TetrahedronGeometry,TorusGeometry,TorusKnotGeometry,TubeGeometry,WireframeGeometry});class ShadowMaterial extends Material{static get type(){return"ShadowMaterial"}constructor(e){super(),this.isShadowMaterial=!0,this.color=new Color(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class RawShaderMaterial extends ShaderMaterial{static get type(){return"RawShaderMaterial"}constructor(e){super(e),this.isRawShaderMaterial=!0}}class MeshStandardMaterial extends Material{static get type(){return"MeshStandardMaterial"}constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.color=new Color(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Euler,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class MeshPhysicalMaterial extends MeshStandardMaterial{static get type(){return"MeshPhysicalMaterial"}constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Vector2(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return clamp(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(s){this.ior=(1+.4*s)/(1-.4*s)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Color(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Color(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Color(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class MeshPhongMaterial extends Material{static get type(){return"MeshPhongMaterial"}constructor(e){super(),this.isMeshPhongMaterial=!0,this.color=new Color(16777215),this.specular=new Color(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Euler,this.combine=MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class MeshToonMaterial extends Material{static get type(){return"MeshToonMaterial"}constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.color=new Color(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class MeshNormalMaterial extends Material{static get type(){return"MeshNormalMaterial"}constructor(e){super(),this.isMeshNormalMaterial=!0,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class MeshLambertMaterial extends Material{static get type(){return"MeshLambertMaterial"}constructor(e){super(),this.isMeshLambertMaterial=!0,this.color=new Color(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Euler,this.combine=MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class MeshMatcapMaterial extends Material{static get type(){return"MeshMatcapMaterial"}constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.color=new Color(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class LineDashedMaterial extends LineBasicMaterial{static get type(){return"LineDashedMaterial"}constructor(e){super(),this.isLineDashedMaterial=!0,this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function convertArray(o,e,s){return!o||!s&&o.constructor===e?o:typeof e.BYTES_PER_ELEMENT=="number"?new e(o):Array.prototype.slice.call(o)}function isTypedArray(o){return ArrayBuffer.isView(o)&&!(o instanceof DataView)}function getKeyframeOrder(o){function e(c,d){return o[c]-o[d]}const s=o.length,a=new Array(s);for(let c=0;c!==s;++c)a[c]=c;return a.sort(e),a}function sortedArray(o,e,s){const a=o.length,c=new o.constructor(a);for(let d=0,b=0;b!==a;++d){const _e=s[d]*e;for(let tt=0;tt!==e;++tt)c[b++]=o[_e+tt]}return c}function flattenJSON(o,e,s,a){let c=1,d=o[0];for(;d!==void 0&&d[a]===void 0;)d=o[c++];if(d===void 0)return;let b=d[a];if(b!==void 0)if(Array.isArray(b))do b=d[a],b!==void 0&&(e.push(d.time),s.push.apply(s,b)),d=o[c++];while(d!==void 0);else if(b.toArray!==void 0)do b=d[a],b!==void 0&&(e.push(d.time),b.toArray(s,s.length)),d=o[c++];while(d!==void 0);else do b=d[a],b!==void 0&&(e.push(d.time),s.push(b)),d=o[c++];while(d!==void 0)}function subclip(o,e,s,a,c=30){const d=o.clone();d.name=e;const b=[];for(let tt=0;tt<d.tracks.length;++tt){const nt=d.tracks[tt],it=nt.getValueSize(),ot=[],at=[];for(let ct=0;ct<nt.times.length;++ct){const ut=nt.times[ct]*c;if(!(ut<s||ut>=a)){ot.push(nt.times[ct]);for(let ft=0;ft<it;++ft)at.push(nt.values[ct*it+ft])}}ot.length!==0&&(nt.times=convertArray(ot,nt.times.constructor),nt.values=convertArray(at,nt.values.constructor),b.push(nt))}d.tracks=b;let _e=1/0;for(let tt=0;tt<d.tracks.length;++tt)_e>d.tracks[tt].times[0]&&(_e=d.tracks[tt].times[0]);for(let tt=0;tt<d.tracks.length;++tt)d.tracks[tt].shift(-1*_e);return d.resetDuration(),d}function makeClipAdditive(o,e=0,s=o,a=30){a<=0&&(a=30);const c=s.tracks.length,d=e/a;for(let b=0;b<c;++b){const _e=s.tracks[b],tt=_e.ValueTypeName;if(tt==="bool"||tt==="string")continue;const nt=o.tracks.find(function(lt){return lt.name===_e.name&&lt.ValueTypeName===tt});if(nt===void 0)continue;let it=0;const ot=_e.getValueSize();_e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(it=ot/3);let at=0;const ct=nt.getValueSize();nt.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(at=ct/3);const ut=_e.times.length-1;let ft;if(d<=_e.times[0]){const lt=it,ht=ot-it;ft=_e.values.slice(lt,ht)}else if(d>=_e.times[ut]){const lt=ut*ot+it,ht=lt+ot-it;ft=_e.values.slice(lt,ht)}else{const lt=_e.createInterpolant(),ht=it,mt=ot-it;lt.evaluate(d),ft=lt.resultBuffer.slice(ht,mt)}tt==="quaternion"&&new Quaternion().fromArray(ft).normalize().conjugate().toArray(ft);const dt=nt.times.length;for(let lt=0;lt<dt;++lt){const ht=lt*ct+at;if(tt==="quaternion")Quaternion.multiplyQuaternionsFlat(nt.values,ht,ft,0,nt.values,ht);else{const mt=ct-at*2;for(let xt=0;xt<mt;++xt)nt.values[ht+xt]-=ft[xt]}}}return o.blendMode=AdditiveAnimationBlendMode,o}const AnimationUtils={convertArray,isTypedArray,getKeyframeOrder,sortedArray,flattenJSON,subclip,makeClipAdditive};class Interpolant{constructor(e,s,a,c){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=c!==void 0?c:new s.constructor(a),this.sampleValues=s,this.valueSize=a,this.settings=null,this.DefaultSettings_={}}evaluate(e){const s=this.parameterPositions;let a=this._cachedIndex,c=s[a],d=s[a-1];e:{t:{let b;n:{r:if(!(e<c)){for(let _e=a+2;;){if(c===void 0){if(e<d)break r;return a=s.length,this._cachedIndex=a,this.copySampleValue_(a-1)}if(a===_e)break;if(d=c,c=s[++a],e<c)break t}b=s.length;break n}if(!(e>=d)){const _e=s[1];e<_e&&(a=2,d=_e);for(let tt=a-2;;){if(d===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(a===tt)break;if(c=d,d=s[--a-1],e>=d)break t}b=a,a=0;break n}break e}for(;a<b;){const _e=a+b>>>1;e<s[_e]?b=_e:a=_e+1}if(c=s[a],d=s[a-1],d===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(c===void 0)return a=s.length,this._cachedIndex=a,this.copySampleValue_(a-1)}this._cachedIndex=a,this.intervalChanged_(a,d,c)}return this.interpolate_(a,d,e,c)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const s=this.resultBuffer,a=this.sampleValues,c=this.valueSize,d=e*c;for(let b=0;b!==c;++b)s[b]=a[d+b];return s}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class CubicInterpolant extends Interpolant{constructor(e,s,a,c){super(e,s,a,c),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:ZeroCurvatureEnding,endingEnd:ZeroCurvatureEnding}}intervalChanged_(e,s,a){const c=this.parameterPositions;let d=e-2,b=e+1,_e=c[d],tt=c[b];if(_e===void 0)switch(this.getSettings_().endingStart){case ZeroSlopeEnding:d=e,_e=2*s-a;break;case WrapAroundEnding:d=c.length-2,_e=s+c[d]-c[d+1];break;default:d=e,_e=a}if(tt===void 0)switch(this.getSettings_().endingEnd){case ZeroSlopeEnding:b=e,tt=2*a-s;break;case WrapAroundEnding:b=1,tt=a+c[1]-c[0];break;default:b=e-1,tt=s}const nt=(a-s)*.5,it=this.valueSize;this._weightPrev=nt/(s-_e),this._weightNext=nt/(tt-a),this._offsetPrev=d*it,this._offsetNext=b*it}interpolate_(e,s,a,c){const d=this.resultBuffer,b=this.sampleValues,_e=this.valueSize,tt=e*_e,nt=tt-_e,it=this._offsetPrev,ot=this._offsetNext,at=this._weightPrev,ct=this._weightNext,ut=(a-s)/(c-s),ft=ut*ut,dt=ft*ut,lt=-at*dt+2*at*ft-at*ut,ht=(1+at)*dt+(-1.5-2*at)*ft+(-.5+at)*ut+1,mt=(-1-ct)*dt+(1.5+ct)*ft+.5*ut,xt=ct*dt-ct*ft;for(let St=0;St!==_e;++St)d[St]=lt*b[it+St]+ht*b[nt+St]+mt*b[tt+St]+xt*b[ot+St];return d}}class LinearInterpolant extends Interpolant{constructor(e,s,a,c){super(e,s,a,c)}interpolate_(e,s,a,c){const d=this.resultBuffer,b=this.sampleValues,_e=this.valueSize,tt=e*_e,nt=tt-_e,it=(a-s)/(c-s),ot=1-it;for(let at=0;at!==_e;++at)d[at]=b[nt+at]*ot+b[tt+at]*it;return d}}class DiscreteInterpolant extends Interpolant{constructor(e,s,a,c){super(e,s,a,c)}interpolate_(e){return this.copySampleValue_(e-1)}}class KeyframeTrack{constructor(e,s,a,c){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(s===void 0||s.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=convertArray(s,this.TimeBufferType),this.values=convertArray(a,this.ValueBufferType),this.setInterpolation(c||this.DefaultInterpolation)}static toJSON(e){const s=e.constructor;let a;if(s.toJSON!==this.toJSON)a=s.toJSON(e);else{a={name:e.name,times:convertArray(e.times,Array),values:convertArray(e.values,Array)};const c=e.getInterpolation();c!==e.DefaultInterpolation&&(a.interpolation=c)}return a.type=e.ValueTypeName,a}InterpolantFactoryMethodDiscrete(e){return new DiscreteInterpolant(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new LinearInterpolant(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new CubicInterpolant(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let s;switch(e){case InterpolateDiscrete:s=this.InterpolantFactoryMethodDiscrete;break;case InterpolateLinear:s=this.InterpolantFactoryMethodLinear;break;case InterpolateSmooth:s=this.InterpolantFactoryMethodSmooth;break}if(s===void 0){const a="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(a);return console.warn("THREE.KeyframeTrack:",a),this}return this.createInterpolant=s,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return InterpolateDiscrete;case this.InterpolantFactoryMethodLinear:return InterpolateLinear;case this.InterpolantFactoryMethodSmooth:return InterpolateSmooth}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const s=this.times;for(let a=0,c=s.length;a!==c;++a)s[a]+=e}return this}scale(e){if(e!==1){const s=this.times;for(let a=0,c=s.length;a!==c;++a)s[a]*=e}return this}trim(e,s){const a=this.times,c=a.length;let d=0,b=c-1;for(;d!==c&&a[d]<e;)++d;for(;b!==-1&&a[b]>s;)--b;if(++b,d!==0||b!==c){d>=b&&(b=Math.max(b,1),d=b-1);const _e=this.getValueSize();this.times=a.slice(d,b),this.values=this.values.slice(d*_e,b*_e)}return this}validate(){let e=!0;const s=this.getValueSize();s-Math.floor(s)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const a=this.times,c=this.values,d=a.length;d===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let b=null;for(let _e=0;_e!==d;_e++){const tt=a[_e];if(typeof tt=="number"&&isNaN(tt)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,_e,tt),e=!1;break}if(b!==null&&b>tt){console.error("THREE.KeyframeTrack: Out of order keys.",this,_e,tt,b),e=!1;break}b=tt}if(c!==void 0&&isTypedArray(c))for(let _e=0,tt=c.length;_e!==tt;++_e){const nt=c[_e];if(isNaN(nt)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,_e,nt),e=!1;break}}return e}optimize(){const e=this.times.slice(),s=this.values.slice(),a=this.getValueSize(),c=this.getInterpolation()===InterpolateSmooth,d=e.length-1;let b=1;for(let _e=1;_e<d;++_e){let tt=!1;const nt=e[_e],it=e[_e+1];if(nt!==it&&(_e!==1||nt!==e[0]))if(c)tt=!0;else{const ot=_e*a,at=ot-a,ct=ot+a;for(let ut=0;ut!==a;++ut){const ft=s[ot+ut];if(ft!==s[at+ut]||ft!==s[ct+ut]){tt=!0;break}}}if(tt){if(_e!==b){e[b]=e[_e];const ot=_e*a,at=b*a;for(let ct=0;ct!==a;++ct)s[at+ct]=s[ot+ct]}++b}}if(d>0){e[b]=e[d];for(let _e=d*a,tt=b*a,nt=0;nt!==a;++nt)s[tt+nt]=s[_e+nt];++b}return b!==e.length?(this.times=e.slice(0,b),this.values=s.slice(0,b*a)):(this.times=e,this.values=s),this}clone(){const e=this.times.slice(),s=this.values.slice(),a=this.constructor,c=new a(this.name,e,s);return c.createInterpolant=this.createInterpolant,c}}KeyframeTrack.prototype.TimeBufferType=Float32Array;KeyframeTrack.prototype.ValueBufferType=Float32Array;KeyframeTrack.prototype.DefaultInterpolation=InterpolateLinear;class BooleanKeyframeTrack extends KeyframeTrack{constructor(e,s,a){super(e,s,a)}}BooleanKeyframeTrack.prototype.ValueTypeName="bool";BooleanKeyframeTrack.prototype.ValueBufferType=Array;BooleanKeyframeTrack.prototype.DefaultInterpolation=InterpolateDiscrete;BooleanKeyframeTrack.prototype.InterpolantFactoryMethodLinear=void 0;BooleanKeyframeTrack.prototype.InterpolantFactoryMethodSmooth=void 0;class ColorKeyframeTrack extends KeyframeTrack{}ColorKeyframeTrack.prototype.ValueTypeName="color";class NumberKeyframeTrack extends KeyframeTrack{}NumberKeyframeTrack.prototype.ValueTypeName="number";class QuaternionLinearInterpolant extends Interpolant{constructor(e,s,a,c){super(e,s,a,c)}interpolate_(e,s,a,c){const d=this.resultBuffer,b=this.sampleValues,_e=this.valueSize,tt=(a-s)/(c-s);let nt=e*_e;for(let it=nt+_e;nt!==it;nt+=4)Quaternion.slerpFlat(d,0,b,nt-_e,b,nt,tt);return d}}class QuaternionKeyframeTrack extends KeyframeTrack{InterpolantFactoryMethodLinear(e){return new QuaternionLinearInterpolant(this.times,this.values,this.getValueSize(),e)}}QuaternionKeyframeTrack.prototype.ValueTypeName="quaternion";QuaternionKeyframeTrack.prototype.InterpolantFactoryMethodSmooth=void 0;class StringKeyframeTrack extends KeyframeTrack{constructor(e,s,a){super(e,s,a)}}StringKeyframeTrack.prototype.ValueTypeName="string";StringKeyframeTrack.prototype.ValueBufferType=Array;StringKeyframeTrack.prototype.DefaultInterpolation=InterpolateDiscrete;StringKeyframeTrack.prototype.InterpolantFactoryMethodLinear=void 0;StringKeyframeTrack.prototype.InterpolantFactoryMethodSmooth=void 0;class VectorKeyframeTrack extends KeyframeTrack{}VectorKeyframeTrack.prototype.ValueTypeName="vector";class AnimationClip{constructor(e="",s=-1,a=[],c=NormalAnimationBlendMode){this.name=e,this.tracks=a,this.duration=s,this.blendMode=c,this.uuid=generateUUID(),this.duration<0&&this.resetDuration()}static parse(e){const s=[],a=e.tracks,c=1/(e.fps||1);for(let b=0,_e=a.length;b!==_e;++b)s.push(parseKeyframeTrack(a[b]).scale(c));const d=new this(e.name,e.duration,s,e.blendMode);return d.uuid=e.uuid,d}static toJSON(e){const s=[],a=e.tracks,c={name:e.name,duration:e.duration,tracks:s,uuid:e.uuid,blendMode:e.blendMode};for(let d=0,b=a.length;d!==b;++d)s.push(KeyframeTrack.toJSON(a[d]));return c}static CreateFromMorphTargetSequence(e,s,a,c){const d=s.length,b=[];for(let _e=0;_e<d;_e++){let tt=[],nt=[];tt.push((_e+d-1)%d,_e,(_e+1)%d),nt.push(0,1,0);const it=getKeyframeOrder(tt);tt=sortedArray(tt,1,it),nt=sortedArray(nt,1,it),!c&&tt[0]===0&&(tt.push(d),nt.push(nt[0])),b.push(new NumberKeyframeTrack(".morphTargetInfluences["+s[_e].name+"]",tt,nt).scale(1/a))}return new this(e,-1,b)}static findByName(e,s){let a=e;if(!Array.isArray(e)){const c=e;a=c.geometry&&c.geometry.animations||c.animations}for(let c=0;c<a.length;c++)if(a[c].name===s)return a[c];return null}static CreateClipsFromMorphTargetSequences(e,s,a){const c={},d=/^([\w-]*?)([\d]+)$/;for(let _e=0,tt=e.length;_e<tt;_e++){const nt=e[_e],it=nt.name.match(d);if(it&&it.length>1){const ot=it[1];let at=c[ot];at||(c[ot]=at=[]),at.push(nt)}}const b=[];for(const _e in c)b.push(this.CreateFromMorphTargetSequence(_e,c[_e],s,a));return b}static parseAnimation(e,s){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const a=function(ot,at,ct,ut,ft){if(ct.length!==0){const dt=[],lt=[];flattenJSON(ct,dt,lt,ut),dt.length!==0&&ft.push(new ot(at,dt,lt))}},c=[],d=e.name||"default",b=e.fps||30,_e=e.blendMode;let tt=e.length||-1;const nt=e.hierarchy||[];for(let ot=0;ot<nt.length;ot++){const at=nt[ot].keys;if(!(!at||at.length===0))if(at[0].morphTargets){const ct={};let ut;for(ut=0;ut<at.length;ut++)if(at[ut].morphTargets)for(let ft=0;ft<at[ut].morphTargets.length;ft++)ct[at[ut].morphTargets[ft]]=-1;for(const ft in ct){const dt=[],lt=[];for(let ht=0;ht!==at[ut].morphTargets.length;++ht){const mt=at[ut];dt.push(mt.time),lt.push(mt.morphTarget===ft?1:0)}c.push(new NumberKeyframeTrack(".morphTargetInfluence["+ft+"]",dt,lt))}tt=ct.length*b}else{const ct=".bones["+s[ot].name+"]";a(VectorKeyframeTrack,ct+".position",at,"pos",c),a(QuaternionKeyframeTrack,ct+".quaternion",at,"rot",c),a(VectorKeyframeTrack,ct+".scale",at,"scl",c)}}return c.length===0?null:new this(d,tt,c,_e)}resetDuration(){const e=this.tracks;let s=0;for(let a=0,c=e.length;a!==c;++a){const d=this.tracks[a];s=Math.max(s,d.times[d.times.length-1])}return this.duration=s,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let s=0;s<this.tracks.length;s++)e=e&&this.tracks[s].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let s=0;s<this.tracks.length;s++)e.push(this.tracks[s].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function getTrackTypeForValueTypeName(o){switch(o.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return NumberKeyframeTrack;case"vector":case"vector2":case"vector3":case"vector4":return VectorKeyframeTrack;case"color":return ColorKeyframeTrack;case"quaternion":return QuaternionKeyframeTrack;case"bool":case"boolean":return BooleanKeyframeTrack;case"string":return StringKeyframeTrack}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+o)}function parseKeyframeTrack(o){if(o.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=getTrackTypeForValueTypeName(o.type);if(o.times===void 0){const s=[],a=[];flattenJSON(o.keys,s,a,"value"),o.times=s,o.values=a}return e.parse!==void 0?e.parse(o):new e(o.name,o.times,o.values,o.interpolation)}const Cache={enabled:!1,files:{},add:function(o,e){this.enabled!==!1&&(this.files[o]=e)},get:function(o){if(this.enabled!==!1)return this.files[o]},remove:function(o){delete this.files[o]},clear:function(){this.files={}}};class LoadingManager{constructor(e,s,a){const c=this;let d=!1,b=0,_e=0,tt;const nt=[];this.onStart=void 0,this.onLoad=e,this.onProgress=s,this.onError=a,this.itemStart=function(it){_e++,d===!1&&c.onStart!==void 0&&c.onStart(it,b,_e),d=!0},this.itemEnd=function(it){b++,c.onProgress!==void 0&&c.onProgress(it,b,_e),b===_e&&(d=!1,c.onLoad!==void 0&&c.onLoad())},this.itemError=function(it){c.onError!==void 0&&c.onError(it)},this.resolveURL=function(it){return tt?tt(it):it},this.setURLModifier=function(it){return tt=it,this},this.addHandler=function(it,ot){return nt.push(it,ot),this},this.removeHandler=function(it){const ot=nt.indexOf(it);return ot!==-1&&nt.splice(ot,2),this},this.getHandler=function(it){for(let ot=0,at=nt.length;ot<at;ot+=2){const ct=nt[ot],ut=nt[ot+1];if(ct.global&&(ct.lastIndex=0),ct.test(it))return ut}return null}}}const DefaultLoadingManager=new LoadingManager;class Loader{constructor(e){this.manager=e!==void 0?e:DefaultLoadingManager,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,s){const a=this;return new Promise(function(c,d){a.load(e,c,s,d)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}Loader.DEFAULT_MATERIAL_NAME="__DEFAULT";const loading={};class HttpError extends Error{constructor(e,s){super(e),this.response=s}}class FileLoader extends Loader{constructor(e){super(e)}load(e,s,a,c){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const d=Cache.get(e);if(d!==void 0)return this.manager.itemStart(e),setTimeout(()=>{s&&s(d),this.manager.itemEnd(e)},0),d;if(loading[e]!==void 0){loading[e].push({onLoad:s,onProgress:a,onError:c});return}loading[e]=[],loading[e].push({onLoad:s,onProgress:a,onError:c});const b=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),_e=this.mimeType,tt=this.responseType;fetch(b).then(nt=>{if(nt.status===200||nt.status===0){if(nt.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||nt.body===void 0||nt.body.getReader===void 0)return nt;const it=loading[e],ot=nt.body.getReader(),at=nt.headers.get("X-File-Size")||nt.headers.get("Content-Length"),ct=at?parseInt(at):0,ut=ct!==0;let ft=0;const dt=new ReadableStream({start(lt){ht();function ht(){ot.read().then(({done:mt,value:xt})=>{if(mt)lt.close();else{ft+=xt.byteLength;const St=new ProgressEvent("progress",{lengthComputable:ut,loaded:ft,total:ct});for(let yt=0,wt=it.length;yt<wt;yt++){const Et=it[yt];Et.onProgress&&Et.onProgress(St)}lt.enqueue(xt),ht()}},mt=>{lt.error(mt)})}}});return new Response(dt)}else throw new HttpError(`fetch for "${nt.url}" responded with ${nt.status}: ${nt.statusText}`,nt)}).then(nt=>{switch(tt){case"arraybuffer":return nt.arrayBuffer();case"blob":return nt.blob();case"document":return nt.text().then(it=>new DOMParser().parseFromString(it,_e));case"json":return nt.json();default:if(_e===void 0)return nt.text();{const ot=/charset="?([^;"\s]*)"?/i.exec(_e),at=ot&&ot[1]?ot[1].toLowerCase():void 0,ct=new TextDecoder(at);return nt.arrayBuffer().then(ut=>ct.decode(ut))}}}).then(nt=>{Cache.add(e,nt);const it=loading[e];delete loading[e];for(let ot=0,at=it.length;ot<at;ot++){const ct=it[ot];ct.onLoad&&ct.onLoad(nt)}}).catch(nt=>{const it=loading[e];if(it===void 0)throw this.manager.itemError(e),nt;delete loading[e];for(let ot=0,at=it.length;ot<at;ot++){const ct=it[ot];ct.onError&&ct.onError(nt)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class AnimationLoader extends Loader{constructor(e){super(e)}load(e,s,a,c){const d=this,b=new FileLoader(this.manager);b.setPath(this.path),b.setRequestHeader(this.requestHeader),b.setWithCredentials(this.withCredentials),b.load(e,function(_e){try{s(d.parse(JSON.parse(_e)))}catch(tt){c?c(tt):console.error(tt),d.manager.itemError(e)}},a,c)}parse(e){const s=[];for(let a=0;a<e.length;a++){const c=AnimationClip.parse(e[a]);s.push(c)}return s}}class CompressedTextureLoader extends Loader{constructor(e){super(e)}load(e,s,a,c){const d=this,b=[],_e=new CompressedTexture,tt=new FileLoader(this.manager);tt.setPath(this.path),tt.setResponseType("arraybuffer"),tt.setRequestHeader(this.requestHeader),tt.setWithCredentials(d.withCredentials);let nt=0;function it(ot){tt.load(e[ot],function(at){const ct=d.parse(at,!0);b[ot]={width:ct.width,height:ct.height,format:ct.format,mipmaps:ct.mipmaps},nt+=1,nt===6&&(ct.mipmapCount===1&&(_e.minFilter=LinearFilter),_e.image=b,_e.format=ct.format,_e.needsUpdate=!0,s&&s(_e))},a,c)}if(Array.isArray(e))for(let ot=0,at=e.length;ot<at;++ot)it(ot);else tt.load(e,function(ot){const at=d.parse(ot,!0);if(at.isCubemap){const ct=at.mipmaps.length/at.mipmapCount;for(let ut=0;ut<ct;ut++){b[ut]={mipmaps:[]};for(let ft=0;ft<at.mipmapCount;ft++)b[ut].mipmaps.push(at.mipmaps[ut*at.mipmapCount+ft]),b[ut].format=at.format,b[ut].width=at.width,b[ut].height=at.height}_e.image=b}else _e.image.width=at.width,_e.image.height=at.height,_e.mipmaps=at.mipmaps;at.mipmapCount===1&&(_e.minFilter=LinearFilter),_e.format=at.format,_e.needsUpdate=!0,s&&s(_e)},a,c);return _e}}class ImageLoader extends Loader{constructor(e){super(e)}load(e,s,a,c){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const d=this,b=Cache.get(e);if(b!==void 0)return d.manager.itemStart(e),setTimeout(function(){s&&s(b),d.manager.itemEnd(e)},0),b;const _e=createElementNS("img");function tt(){it(),Cache.add(e,this),s&&s(this),d.manager.itemEnd(e)}function nt(ot){it(),c&&c(ot),d.manager.itemError(e),d.manager.itemEnd(e)}function it(){_e.removeEventListener("load",tt,!1),_e.removeEventListener("error",nt,!1)}return _e.addEventListener("load",tt,!1),_e.addEventListener("error",nt,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(_e.crossOrigin=this.crossOrigin),d.manager.itemStart(e),_e.src=e,_e}}class CubeTextureLoader extends Loader{constructor(e){super(e)}load(e,s,a,c){const d=new CubeTexture;d.colorSpace=SRGBColorSpace$1;const b=new ImageLoader(this.manager);b.setCrossOrigin(this.crossOrigin),b.setPath(this.path);let _e=0;function tt(nt){b.load(e[nt],function(it){d.images[nt]=it,_e++,_e===6&&(d.needsUpdate=!0,s&&s(d))},void 0,c)}for(let nt=0;nt<e.length;++nt)tt(nt);return d}}class DataTextureLoader extends Loader{constructor(e){super(e)}load(e,s,a,c){const d=this,b=new DataTexture,_e=new FileLoader(this.manager);return _e.setResponseType("arraybuffer"),_e.setRequestHeader(this.requestHeader),_e.setPath(this.path),_e.setWithCredentials(d.withCredentials),_e.load(e,function(tt){let nt;try{nt=d.parse(tt)}catch(it){if(c!==void 0)c(it);else{console.error(it);return}}nt.image!==void 0?b.image=nt.image:nt.data!==void 0&&(b.image.width=nt.width,b.image.height=nt.height,b.image.data=nt.data),b.wrapS=nt.wrapS!==void 0?nt.wrapS:ClampToEdgeWrapping,b.wrapT=nt.wrapT!==void 0?nt.wrapT:ClampToEdgeWrapping,b.magFilter=nt.magFilter!==void 0?nt.magFilter:LinearFilter,b.minFilter=nt.minFilter!==void 0?nt.minFilter:LinearFilter,b.anisotropy=nt.anisotropy!==void 0?nt.anisotropy:1,nt.colorSpace!==void 0&&(b.colorSpace=nt.colorSpace),nt.flipY!==void 0&&(b.flipY=nt.flipY),nt.format!==void 0&&(b.format=nt.format),nt.type!==void 0&&(b.type=nt.type),nt.mipmaps!==void 0&&(b.mipmaps=nt.mipmaps,b.minFilter=LinearMipmapLinearFilter),nt.mipmapCount===1&&(b.minFilter=LinearFilter),nt.generateMipmaps!==void 0&&(b.generateMipmaps=nt.generateMipmaps),b.needsUpdate=!0,s&&s(b,nt)},a,c),b}}class TextureLoader extends Loader{constructor(e){super(e)}load(e,s,a,c){const d=new Texture,b=new ImageLoader(this.manager);return b.setCrossOrigin(this.crossOrigin),b.setPath(this.path),b.load(e,function(_e){d.image=_e,d.needsUpdate=!0,s!==void 0&&s(d)},a,c),d}}class Light extends Object3D{constructor(e,s=1){super(),this.isLight=!0,this.type="Light",this.color=new Color(e),this.intensity=s}dispose(){}copy(e,s){return super.copy(e,s),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const s=super.toJSON(e);return s.object.color=this.color.getHex(),s.object.intensity=this.intensity,this.groundColor!==void 0&&(s.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(s.object.distance=this.distance),this.angle!==void 0&&(s.object.angle=this.angle),this.decay!==void 0&&(s.object.decay=this.decay),this.penumbra!==void 0&&(s.object.penumbra=this.penumbra),this.shadow!==void 0&&(s.object.shadow=this.shadow.toJSON()),this.target!==void 0&&(s.object.target=this.target.uuid),s}}class HemisphereLight extends Light{constructor(e,s,a){super(e,a),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Object3D.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Color(s)}copy(e,s){return super.copy(e,s),this.groundColor.copy(e.groundColor),this}}const _projScreenMatrix$1=new Matrix4,_lightPositionWorld$1=new Vector3,_lookTarget$1=new Vector3;class LightShadow{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Vector2(512,512),this.map=null,this.mapPass=null,this.matrix=new Matrix4,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Frustum,this._frameExtents=new Vector2(1,1),this._viewportCount=1,this._viewports=[new Vector4(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const s=this.camera,a=this.matrix;_lightPositionWorld$1.setFromMatrixPosition(e.matrixWorld),s.position.copy(_lightPositionWorld$1),_lookTarget$1.setFromMatrixPosition(e.target.matrixWorld),s.lookAt(_lookTarget$1),s.updateMatrixWorld(),_projScreenMatrix$1.multiplyMatrices(s.projectionMatrix,s.matrixWorldInverse),this._frustum.setFromProjectionMatrix(_projScreenMatrix$1),a.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),a.multiply(_projScreenMatrix$1)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class SpotLightShadow extends LightShadow{constructor(){super(new PerspectiveCamera(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const s=this.camera,a=RAD2DEG*2*e.angle*this.focus,c=this.mapSize.width/this.mapSize.height,d=e.distance||s.far;(a!==s.fov||c!==s.aspect||d!==s.far)&&(s.fov=a,s.aspect=c,s.far=d,s.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class SpotLight extends Light{constructor(e,s,a=0,c=Math.PI/3,d=0,b=2){super(e,s),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Object3D.DEFAULT_UP),this.updateMatrix(),this.target=new Object3D,this.distance=a,this.angle=c,this.penumbra=d,this.decay=b,this.map=null,this.shadow=new SpotLightShadow}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,s){return super.copy(e,s),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const _projScreenMatrix=new Matrix4,_lightPositionWorld=new Vector3,_lookTarget=new Vector3;class PointLightShadow extends LightShadow{constructor(){super(new PerspectiveCamera(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Vector2(4,2),this._viewportCount=6,this._viewports=[new Vector4(2,1,1,1),new Vector4(0,1,1,1),new Vector4(3,1,1,1),new Vector4(1,1,1,1),new Vector4(3,0,1,1),new Vector4(1,0,1,1)],this._cubeDirections=[new Vector3(1,0,0),new Vector3(-1,0,0),new Vector3(0,0,1),new Vector3(0,0,-1),new Vector3(0,1,0),new Vector3(0,-1,0)],this._cubeUps=[new Vector3(0,1,0),new Vector3(0,1,0),new Vector3(0,1,0),new Vector3(0,1,0),new Vector3(0,0,1),new Vector3(0,0,-1)]}updateMatrices(e,s=0){const a=this.camera,c=this.matrix,d=e.distance||a.far;d!==a.far&&(a.far=d,a.updateProjectionMatrix()),_lightPositionWorld.setFromMatrixPosition(e.matrixWorld),a.position.copy(_lightPositionWorld),_lookTarget.copy(a.position),_lookTarget.add(this._cubeDirections[s]),a.up.copy(this._cubeUps[s]),a.lookAt(_lookTarget),a.updateMatrixWorld(),c.makeTranslation(-_lightPositionWorld.x,-_lightPositionWorld.y,-_lightPositionWorld.z),_projScreenMatrix.multiplyMatrices(a.projectionMatrix,a.matrixWorldInverse),this._frustum.setFromProjectionMatrix(_projScreenMatrix)}}class PointLight extends Light{constructor(e,s,a=0,c=2){super(e,s),this.isPointLight=!0,this.type="PointLight",this.distance=a,this.decay=c,this.shadow=new PointLightShadow}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,s){return super.copy(e,s),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class DirectionalLightShadow extends LightShadow{constructor(){super(new OrthographicCamera$1(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class DirectionalLight extends Light{constructor(e,s){super(e,s),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Object3D.DEFAULT_UP),this.updateMatrix(),this.target=new Object3D,this.shadow=new DirectionalLightShadow}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class AmbientLight extends Light{constructor(e,s){super(e,s),this.isAmbientLight=!0,this.type="AmbientLight"}}class RectAreaLight extends Light{constructor(e,s,a=10,c=10){super(e,s),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=a,this.height=c}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const s=super.toJSON(e);return s.object.width=this.width,s.object.height=this.height,s}}class SphericalHarmonics3{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new Vector3)}set(e){for(let s=0;s<9;s++)this.coefficients[s].copy(e[s]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,s){const a=e.x,c=e.y,d=e.z,b=this.coefficients;return s.copy(b[0]).multiplyScalar(.282095),s.addScaledVector(b[1],.488603*c),s.addScaledVector(b[2],.488603*d),s.addScaledVector(b[3],.488603*a),s.addScaledVector(b[4],1.092548*(a*c)),s.addScaledVector(b[5],1.092548*(c*d)),s.addScaledVector(b[6],.315392*(3*d*d-1)),s.addScaledVector(b[7],1.092548*(a*d)),s.addScaledVector(b[8],.546274*(a*a-c*c)),s}getIrradianceAt(e,s){const a=e.x,c=e.y,d=e.z,b=this.coefficients;return s.copy(b[0]).multiplyScalar(.886227),s.addScaledVector(b[1],2*.511664*c),s.addScaledVector(b[2],2*.511664*d),s.addScaledVector(b[3],2*.511664*a),s.addScaledVector(b[4],2*.429043*a*c),s.addScaledVector(b[5],2*.429043*c*d),s.addScaledVector(b[6],.743125*d*d-.247708),s.addScaledVector(b[7],2*.429043*a*d),s.addScaledVector(b[8],.429043*(a*a-c*c)),s}add(e){for(let s=0;s<9;s++)this.coefficients[s].add(e.coefficients[s]);return this}addScaledSH(e,s){for(let a=0;a<9;a++)this.coefficients[a].addScaledVector(e.coefficients[a],s);return this}scale(e){for(let s=0;s<9;s++)this.coefficients[s].multiplyScalar(e);return this}lerp(e,s){for(let a=0;a<9;a++)this.coefficients[a].lerp(e.coefficients[a],s);return this}equals(e){for(let s=0;s<9;s++)if(!this.coefficients[s].equals(e.coefficients[s]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,s=0){const a=this.coefficients;for(let c=0;c<9;c++)a[c].fromArray(e,s+c*3);return this}toArray(e=[],s=0){const a=this.coefficients;for(let c=0;c<9;c++)a[c].toArray(e,s+c*3);return e}static getBasisAt(e,s){const a=e.x,c=e.y,d=e.z;s[0]=.282095,s[1]=.488603*c,s[2]=.488603*d,s[3]=.488603*a,s[4]=1.092548*a*c,s[5]=1.092548*c*d,s[6]=.315392*(3*d*d-1),s[7]=1.092548*a*d,s[8]=.546274*(a*a-c*c)}}class LightProbe extends Light{constructor(e=new SphericalHarmonics3,s=1){super(void 0,s),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const s=super.toJSON(e);return s.object.sh=this.sh.toArray(),s}}class MaterialLoader extends Loader{constructor(e){super(e),this.textures={}}load(e,s,a,c){const d=this,b=new FileLoader(d.manager);b.setPath(d.path),b.setRequestHeader(d.requestHeader),b.setWithCredentials(d.withCredentials),b.load(e,function(_e){try{s(d.parse(JSON.parse(_e)))}catch(tt){c?c(tt):console.error(tt),d.manager.itemError(e)}},a,c)}parse(e){const s=this.textures;function a(d){return s[d]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",d),s[d]}const c=this.createMaterialFromType(e.type);if(e.uuid!==void 0&&(c.uuid=e.uuid),e.name!==void 0&&(c.name=e.name),e.color!==void 0&&c.color!==void 0&&c.color.setHex(e.color),e.roughness!==void 0&&(c.roughness=e.roughness),e.metalness!==void 0&&(c.metalness=e.metalness),e.sheen!==void 0&&(c.sheen=e.sheen),e.sheenColor!==void 0&&(c.sheenColor=new Color().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(c.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&c.emissive!==void 0&&c.emissive.setHex(e.emissive),e.specular!==void 0&&c.specular!==void 0&&c.specular.setHex(e.specular),e.specularIntensity!==void 0&&(c.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&c.specularColor!==void 0&&c.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(c.shininess=e.shininess),e.clearcoat!==void 0&&(c.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(c.clearcoatRoughness=e.clearcoatRoughness),e.dispersion!==void 0&&(c.dispersion=e.dispersion),e.iridescence!==void 0&&(c.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(c.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(c.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(c.transmission=e.transmission),e.thickness!==void 0&&(c.thickness=e.thickness),e.attenuationDistance!==void 0&&(c.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&c.attenuationColor!==void 0&&c.attenuationColor.setHex(e.attenuationColor),e.anisotropy!==void 0&&(c.anisotropy=e.anisotropy),e.anisotropyRotation!==void 0&&(c.anisotropyRotation=e.anisotropyRotation),e.fog!==void 0&&(c.fog=e.fog),e.flatShading!==void 0&&(c.flatShading=e.flatShading),e.blending!==void 0&&(c.blending=e.blending),e.combine!==void 0&&(c.combine=e.combine),e.side!==void 0&&(c.side=e.side),e.shadowSide!==void 0&&(c.shadowSide=e.shadowSide),e.opacity!==void 0&&(c.opacity=e.opacity),e.transparent!==void 0&&(c.transparent=e.transparent),e.alphaTest!==void 0&&(c.alphaTest=e.alphaTest),e.alphaHash!==void 0&&(c.alphaHash=e.alphaHash),e.depthFunc!==void 0&&(c.depthFunc=e.depthFunc),e.depthTest!==void 0&&(c.depthTest=e.depthTest),e.depthWrite!==void 0&&(c.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(c.colorWrite=e.colorWrite),e.blendSrc!==void 0&&(c.blendSrc=e.blendSrc),e.blendDst!==void 0&&(c.blendDst=e.blendDst),e.blendEquation!==void 0&&(c.blendEquation=e.blendEquation),e.blendSrcAlpha!==void 0&&(c.blendSrcAlpha=e.blendSrcAlpha),e.blendDstAlpha!==void 0&&(c.blendDstAlpha=e.blendDstAlpha),e.blendEquationAlpha!==void 0&&(c.blendEquationAlpha=e.blendEquationAlpha),e.blendColor!==void 0&&c.blendColor!==void 0&&c.blendColor.setHex(e.blendColor),e.blendAlpha!==void 0&&(c.blendAlpha=e.blendAlpha),e.stencilWriteMask!==void 0&&(c.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(c.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(c.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(c.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(c.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(c.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(c.stencilZPass=e.stencilZPass),e.stencilWrite!==void 0&&(c.stencilWrite=e.stencilWrite),e.wireframe!==void 0&&(c.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(c.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(c.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(c.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(c.rotation=e.rotation),e.linewidth!==void 0&&(c.linewidth=e.linewidth),e.dashSize!==void 0&&(c.dashSize=e.dashSize),e.gapSize!==void 0&&(c.gapSize=e.gapSize),e.scale!==void 0&&(c.scale=e.scale),e.polygonOffset!==void 0&&(c.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(c.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(c.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(c.dithering=e.dithering),e.alphaToCoverage!==void 0&&(c.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(c.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(c.forceSinglePass=e.forceSinglePass),e.visible!==void 0&&(c.visible=e.visible),e.toneMapped!==void 0&&(c.toneMapped=e.toneMapped),e.userData!==void 0&&(c.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?c.vertexColors=e.vertexColors>0:c.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const d in e.uniforms){const b=e.uniforms[d];switch(c.uniforms[d]={},b.type){case"t":c.uniforms[d].value=a(b.value);break;case"c":c.uniforms[d].value=new Color().setHex(b.value);break;case"v2":c.uniforms[d].value=new Vector2().fromArray(b.value);break;case"v3":c.uniforms[d].value=new Vector3().fromArray(b.value);break;case"v4":c.uniforms[d].value=new Vector4().fromArray(b.value);break;case"m3":c.uniforms[d].value=new Matrix3().fromArray(b.value);break;case"m4":c.uniforms[d].value=new Matrix4().fromArray(b.value);break;default:c.uniforms[d].value=b.value}}if(e.defines!==void 0&&(c.defines=e.defines),e.vertexShader!==void 0&&(c.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(c.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(c.glslVersion=e.glslVersion),e.extensions!==void 0)for(const d in e.extensions)c.extensions[d]=e.extensions[d];if(e.lights!==void 0&&(c.lights=e.lights),e.clipping!==void 0&&(c.clipping=e.clipping),e.size!==void 0&&(c.size=e.size),e.sizeAttenuation!==void 0&&(c.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(c.map=a(e.map)),e.matcap!==void 0&&(c.matcap=a(e.matcap)),e.alphaMap!==void 0&&(c.alphaMap=a(e.alphaMap)),e.bumpMap!==void 0&&(c.bumpMap=a(e.bumpMap)),e.bumpScale!==void 0&&(c.bumpScale=e.bumpScale),e.normalMap!==void 0&&(c.normalMap=a(e.normalMap)),e.normalMapType!==void 0&&(c.normalMapType=e.normalMapType),e.normalScale!==void 0){let d=e.normalScale;Array.isArray(d)===!1&&(d=[d,d]),c.normalScale=new Vector2().fromArray(d)}return e.displacementMap!==void 0&&(c.displacementMap=a(e.displacementMap)),e.displacementScale!==void 0&&(c.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(c.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(c.roughnessMap=a(e.roughnessMap)),e.metalnessMap!==void 0&&(c.metalnessMap=a(e.metalnessMap)),e.emissiveMap!==void 0&&(c.emissiveMap=a(e.emissiveMap)),e.emissiveIntensity!==void 0&&(c.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(c.specularMap=a(e.specularMap)),e.specularIntensityMap!==void 0&&(c.specularIntensityMap=a(e.specularIntensityMap)),e.specularColorMap!==void 0&&(c.specularColorMap=a(e.specularColorMap)),e.envMap!==void 0&&(c.envMap=a(e.envMap)),e.envMapRotation!==void 0&&c.envMapRotation.fromArray(e.envMapRotation),e.envMapIntensity!==void 0&&(c.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(c.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(c.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(c.lightMap=a(e.lightMap)),e.lightMapIntensity!==void 0&&(c.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(c.aoMap=a(e.aoMap)),e.aoMapIntensity!==void 0&&(c.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(c.gradientMap=a(e.gradientMap)),e.clearcoatMap!==void 0&&(c.clearcoatMap=a(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(c.clearcoatRoughnessMap=a(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(c.clearcoatNormalMap=a(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(c.clearcoatNormalScale=new Vector2().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(c.iridescenceMap=a(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(c.iridescenceThicknessMap=a(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(c.transmissionMap=a(e.transmissionMap)),e.thicknessMap!==void 0&&(c.thicknessMap=a(e.thicknessMap)),e.anisotropyMap!==void 0&&(c.anisotropyMap=a(e.anisotropyMap)),e.sheenColorMap!==void 0&&(c.sheenColorMap=a(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(c.sheenRoughnessMap=a(e.sheenRoughnessMap)),c}setTextures(e){return this.textures=e,this}createMaterialFromType(e){return MaterialLoader.createMaterialFromType(e)}static createMaterialFromType(e){const s={ShadowMaterial,SpriteMaterial,RawShaderMaterial,ShaderMaterial,PointsMaterial,MeshPhysicalMaterial,MeshStandardMaterial,MeshPhongMaterial,MeshToonMaterial,MeshNormalMaterial,MeshLambertMaterial,MeshDepthMaterial,MeshDistanceMaterial,MeshBasicMaterial,MeshMatcapMaterial,LineDashedMaterial,LineBasicMaterial,Material};return new s[e]}}class LoaderUtils{static decodeText(e){if(console.warn("THREE.LoaderUtils: decodeText() has been deprecated with r165 and will be removed with r175. Use TextDecoder instead."),typeof TextDecoder<"u")return new TextDecoder().decode(e);let s="";for(let a=0,c=e.length;a<c;a++)s+=String.fromCharCode(e[a]);try{return decodeURIComponent(escape(s))}catch{return s}}static extractUrlBase(e){const s=e.lastIndexOf("/");return s===-1?"./":e.slice(0,s+1)}static resolveURL(e,s){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(s)&&/^\//.test(e)&&(s=s.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:s+e)}}class InstancedBufferGeometry extends BufferGeometry{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class BufferGeometryLoader extends Loader{constructor(e){super(e)}load(e,s,a,c){const d=this,b=new FileLoader(d.manager);b.setPath(d.path),b.setRequestHeader(d.requestHeader),b.setWithCredentials(d.withCredentials),b.load(e,function(_e){try{s(d.parse(JSON.parse(_e)))}catch(tt){c?c(tt):console.error(tt),d.manager.itemError(e)}},a,c)}parse(e){const s={},a={};function c(ct,ut){if(s[ut]!==void 0)return s[ut];const dt=ct.interleavedBuffers[ut],lt=d(ct,dt.buffer),ht=getTypedArray(dt.type,lt),mt=new InterleavedBuffer(ht,dt.stride);return mt.uuid=dt.uuid,s[ut]=mt,mt}function d(ct,ut){if(a[ut]!==void 0)return a[ut];const dt=ct.arrayBuffers[ut],lt=new Uint32Array(dt).buffer;return a[ut]=lt,lt}const b=e.isInstancedBufferGeometry?new InstancedBufferGeometry:new BufferGeometry,_e=e.data.index;if(_e!==void 0){const ct=getTypedArray(_e.type,_e.array);b.setIndex(new BufferAttribute(ct,1))}const tt=e.data.attributes;for(const ct in tt){const ut=tt[ct];let ft;if(ut.isInterleavedBufferAttribute){const dt=c(e.data,ut.data);ft=new InterleavedBufferAttribute(dt,ut.itemSize,ut.offset,ut.normalized)}else{const dt=getTypedArray(ut.type,ut.array),lt=ut.isInstancedBufferAttribute?InstancedBufferAttribute:BufferAttribute;ft=new lt(dt,ut.itemSize,ut.normalized)}ut.name!==void 0&&(ft.name=ut.name),ut.usage!==void 0&&ft.setUsage(ut.usage),b.setAttribute(ct,ft)}const nt=e.data.morphAttributes;if(nt)for(const ct in nt){const ut=nt[ct],ft=[];for(let dt=0,lt=ut.length;dt<lt;dt++){const ht=ut[dt];let mt;if(ht.isInterleavedBufferAttribute){const xt=c(e.data,ht.data);mt=new InterleavedBufferAttribute(xt,ht.itemSize,ht.offset,ht.normalized)}else{const xt=getTypedArray(ht.type,ht.array);mt=new BufferAttribute(xt,ht.itemSize,ht.normalized)}ht.name!==void 0&&(mt.name=ht.name),ft.push(mt)}b.morphAttributes[ct]=ft}e.data.morphTargetsRelative&&(b.morphTargetsRelative=!0);const ot=e.data.groups||e.data.drawcalls||e.data.offsets;if(ot!==void 0)for(let ct=0,ut=ot.length;ct!==ut;++ct){const ft=ot[ct];b.addGroup(ft.start,ft.count,ft.materialIndex)}const at=e.data.boundingSphere;if(at!==void 0){const ct=new Vector3;at.center!==void 0&&ct.fromArray(at.center),b.boundingSphere=new Sphere(ct,at.radius)}return e.name&&(b.name=e.name),e.userData&&(b.userData=e.userData),b}}class ObjectLoader extends Loader{constructor(e){super(e)}load(e,s,a,c){const d=this,b=this.path===""?LoaderUtils.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||b;const _e=new FileLoader(this.manager);_e.setPath(this.path),_e.setRequestHeader(this.requestHeader),_e.setWithCredentials(this.withCredentials),_e.load(e,function(tt){let nt=null;try{nt=JSON.parse(tt)}catch(ot){c!==void 0&&c(ot),console.error("THREE:ObjectLoader: Can't parse "+e+".",ot.message);return}const it=nt.metadata;if(it===void 0||it.type===void 0||it.type.toLowerCase()==="geometry"){c!==void 0&&c(new Error("THREE.ObjectLoader: Can't load "+e)),console.error("THREE.ObjectLoader: Can't load "+e);return}d.parse(nt,s)},a,c)}async loadAsync(e,s){const a=this,c=this.path===""?LoaderUtils.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||c;const d=new FileLoader(this.manager);d.setPath(this.path),d.setRequestHeader(this.requestHeader),d.setWithCredentials(this.withCredentials);const b=await d.loadAsync(e,s),_e=JSON.parse(b),tt=_e.metadata;if(tt===void 0||tt.type===void 0||tt.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await a.parseAsync(_e)}parse(e,s){const a=this.parseAnimations(e.animations),c=this.parseShapes(e.shapes),d=this.parseGeometries(e.geometries,c),b=this.parseImages(e.images,function(){s!==void 0&&s(nt)}),_e=this.parseTextures(e.textures,b),tt=this.parseMaterials(e.materials,_e),nt=this.parseObject(e.object,d,tt,_e,a),it=this.parseSkeletons(e.skeletons,nt);if(this.bindSkeletons(nt,it),this.bindLightTargets(nt),s!==void 0){let ot=!1;for(const at in b)if(b[at].data instanceof HTMLImageElement){ot=!0;break}ot===!1&&s(nt)}return nt}async parseAsync(e){const s=this.parseAnimations(e.animations),a=this.parseShapes(e.shapes),c=this.parseGeometries(e.geometries,a),d=await this.parseImagesAsync(e.images),b=this.parseTextures(e.textures,d),_e=this.parseMaterials(e.materials,b),tt=this.parseObject(e.object,c,_e,b,s),nt=this.parseSkeletons(e.skeletons,tt);return this.bindSkeletons(tt,nt),this.bindLightTargets(tt),tt}parseShapes(e){const s={};if(e!==void 0)for(let a=0,c=e.length;a<c;a++){const d=new Shape().fromJSON(e[a]);s[d.uuid]=d}return s}parseSkeletons(e,s){const a={},c={};if(s.traverse(function(d){d.isBone&&(c[d.uuid]=d)}),e!==void 0)for(let d=0,b=e.length;d<b;d++){const _e=new Skeleton().fromJSON(e[d],c);a[_e.uuid]=_e}return a}parseGeometries(e,s){const a={};if(e!==void 0){const c=new BufferGeometryLoader;for(let d=0,b=e.length;d<b;d++){let _e;const tt=e[d];switch(tt.type){case"BufferGeometry":case"InstancedBufferGeometry":_e=c.parse(tt);break;default:tt.type in Geometries?_e=Geometries[tt.type].fromJSON(tt,s):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${tt.type}"`)}_e.uuid=tt.uuid,tt.name!==void 0&&(_e.name=tt.name),tt.userData!==void 0&&(_e.userData=tt.userData),a[tt.uuid]=_e}}return a}parseMaterials(e,s){const a={},c={};if(e!==void 0){const d=new MaterialLoader;d.setTextures(s);for(let b=0,_e=e.length;b<_e;b++){const tt=e[b];a[tt.uuid]===void 0&&(a[tt.uuid]=d.parse(tt)),c[tt.uuid]=a[tt.uuid]}}return c}parseAnimations(e){const s={};if(e!==void 0)for(let a=0;a<e.length;a++){const c=e[a],d=AnimationClip.parse(c);s[d.uuid]=d}return s}parseImages(e,s){const a=this,c={};let d;function b(tt){return a.manager.itemStart(tt),d.load(tt,function(){a.manager.itemEnd(tt)},void 0,function(){a.manager.itemError(tt),a.manager.itemEnd(tt)})}function _e(tt){if(typeof tt=="string"){const nt=tt,it=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(nt)?nt:a.resourcePath+nt;return b(it)}else return tt.data?{data:getTypedArray(tt.type,tt.data),width:tt.width,height:tt.height}:null}if(e!==void 0&&e.length>0){const tt=new LoadingManager(s);d=new ImageLoader(tt),d.setCrossOrigin(this.crossOrigin);for(let nt=0,it=e.length;nt<it;nt++){const ot=e[nt],at=ot.url;if(Array.isArray(at)){const ct=[];for(let ut=0,ft=at.length;ut<ft;ut++){const dt=at[ut],lt=_e(dt);lt!==null&&(lt instanceof HTMLImageElement?ct.push(lt):ct.push(new DataTexture(lt.data,lt.width,lt.height)))}c[ot.uuid]=new Source(ct)}else{const ct=_e(ot.url);c[ot.uuid]=new Source(ct)}}}return c}async parseImagesAsync(e){const s=this,a={};let c;async function d(b){if(typeof b=="string"){const _e=b,tt=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(_e)?_e:s.resourcePath+_e;return await c.loadAsync(tt)}else return b.data?{data:getTypedArray(b.type,b.data),width:b.width,height:b.height}:null}if(e!==void 0&&e.length>0){c=new ImageLoader(this.manager),c.setCrossOrigin(this.crossOrigin);for(let b=0,_e=e.length;b<_e;b++){const tt=e[b],nt=tt.url;if(Array.isArray(nt)){const it=[];for(let ot=0,at=nt.length;ot<at;ot++){const ct=nt[ot],ut=await d(ct);ut!==null&&(ut instanceof HTMLImageElement?it.push(ut):it.push(new DataTexture(ut.data,ut.width,ut.height)))}a[tt.uuid]=new Source(it)}else{const it=await d(tt.url);a[tt.uuid]=new Source(it)}}}return a}parseTextures(e,s){function a(d,b){return typeof d=="number"?d:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",d),b[d])}const c={};if(e!==void 0)for(let d=0,b=e.length;d<b;d++){const _e=e[d];_e.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',_e.uuid),s[_e.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",_e.image);const tt=s[_e.image],nt=tt.data;let it;Array.isArray(nt)?(it=new CubeTexture,nt.length===6&&(it.needsUpdate=!0)):(nt&&nt.data?it=new DataTexture:it=new Texture,nt&&(it.needsUpdate=!0)),it.source=tt,it.uuid=_e.uuid,_e.name!==void 0&&(it.name=_e.name),_e.mapping!==void 0&&(it.mapping=a(_e.mapping,TEXTURE_MAPPING)),_e.channel!==void 0&&(it.channel=_e.channel),_e.offset!==void 0&&it.offset.fromArray(_e.offset),_e.repeat!==void 0&&it.repeat.fromArray(_e.repeat),_e.center!==void 0&&it.center.fromArray(_e.center),_e.rotation!==void 0&&(it.rotation=_e.rotation),_e.wrap!==void 0&&(it.wrapS=a(_e.wrap[0],TEXTURE_WRAPPING),it.wrapT=a(_e.wrap[1],TEXTURE_WRAPPING)),_e.format!==void 0&&(it.format=_e.format),_e.internalFormat!==void 0&&(it.internalFormat=_e.internalFormat),_e.type!==void 0&&(it.type=_e.type),_e.colorSpace!==void 0&&(it.colorSpace=_e.colorSpace),_e.minFilter!==void 0&&(it.minFilter=a(_e.minFilter,TEXTURE_FILTER)),_e.magFilter!==void 0&&(it.magFilter=a(_e.magFilter,TEXTURE_FILTER)),_e.anisotropy!==void 0&&(it.anisotropy=_e.anisotropy),_e.flipY!==void 0&&(it.flipY=_e.flipY),_e.generateMipmaps!==void 0&&(it.generateMipmaps=_e.generateMipmaps),_e.premultiplyAlpha!==void 0&&(it.premultiplyAlpha=_e.premultiplyAlpha),_e.unpackAlignment!==void 0&&(it.unpackAlignment=_e.unpackAlignment),_e.compareFunction!==void 0&&(it.compareFunction=_e.compareFunction),_e.userData!==void 0&&(it.userData=_e.userData),c[_e.uuid]=it}return c}parseObject(e,s,a,c,d){let b;function _e(at){return s[at]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",at),s[at]}function tt(at){if(at!==void 0){if(Array.isArray(at)){const ct=[];for(let ut=0,ft=at.length;ut<ft;ut++){const dt=at[ut];a[dt]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",dt),ct.push(a[dt])}return ct}return a[at]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",at),a[at]}}function nt(at){return c[at]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",at),c[at]}let it,ot;switch(e.type){case"Scene":b=new Scene,e.background!==void 0&&(Number.isInteger(e.background)?b.background=new Color(e.background):b.background=nt(e.background)),e.environment!==void 0&&(b.environment=nt(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?b.fog=new Fog(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(b.fog=new FogExp2(e.fog.color,e.fog.density)),e.fog.name!==""&&(b.fog.name=e.fog.name)),e.backgroundBlurriness!==void 0&&(b.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(b.backgroundIntensity=e.backgroundIntensity),e.backgroundRotation!==void 0&&b.backgroundRotation.fromArray(e.backgroundRotation),e.environmentIntensity!==void 0&&(b.environmentIntensity=e.environmentIntensity),e.environmentRotation!==void 0&&b.environmentRotation.fromArray(e.environmentRotation);break;case"PerspectiveCamera":b=new PerspectiveCamera(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(b.focus=e.focus),e.zoom!==void 0&&(b.zoom=e.zoom),e.filmGauge!==void 0&&(b.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(b.filmOffset=e.filmOffset),e.view!==void 0&&(b.view=Object.assign({},e.view));break;case"OrthographicCamera":b=new OrthographicCamera$1(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(b.zoom=e.zoom),e.view!==void 0&&(b.view=Object.assign({},e.view));break;case"AmbientLight":b=new AmbientLight(e.color,e.intensity);break;case"DirectionalLight":b=new DirectionalLight(e.color,e.intensity),b.target=e.target||"";break;case"PointLight":b=new PointLight(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":b=new RectAreaLight(e.color,e.intensity,e.width,e.height);break;case"SpotLight":b=new SpotLight(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay),b.target=e.target||"";break;case"HemisphereLight":b=new HemisphereLight(e.color,e.groundColor,e.intensity);break;case"LightProbe":b=new LightProbe().fromJSON(e);break;case"SkinnedMesh":it=_e(e.geometry),ot=tt(e.material),b=new SkinnedMesh(it,ot),e.bindMode!==void 0&&(b.bindMode=e.bindMode),e.bindMatrix!==void 0&&b.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(b.skeleton=e.skeleton);break;case"Mesh":it=_e(e.geometry),ot=tt(e.material),b=new Mesh(it,ot);break;case"InstancedMesh":it=_e(e.geometry),ot=tt(e.material);const at=e.count,ct=e.instanceMatrix,ut=e.instanceColor;b=new InstancedMesh(it,ot,at),b.instanceMatrix=new InstancedBufferAttribute(new Float32Array(ct.array),16),ut!==void 0&&(b.instanceColor=new InstancedBufferAttribute(new Float32Array(ut.array),ut.itemSize));break;case"BatchedMesh":it=_e(e.geometry),ot=tt(e.material),b=new BatchedMesh(e.maxInstanceCount,e.maxVertexCount,e.maxIndexCount,ot),b.geometry=it,b.perObjectFrustumCulled=e.perObjectFrustumCulled,b.sortObjects=e.sortObjects,b._drawRanges=e.drawRanges,b._reservedRanges=e.reservedRanges,b._visibility=e.visibility,b._active=e.active,b._bounds=e.bounds.map(ft=>{const dt=new Box3;dt.min.fromArray(ft.boxMin),dt.max.fromArray(ft.boxMax);const lt=new Sphere;return lt.radius=ft.sphereRadius,lt.center.fromArray(ft.sphereCenter),{boxInitialized:ft.boxInitialized,box:dt,sphereInitialized:ft.sphereInitialized,sphere:lt}}),b._maxInstanceCount=e.maxInstanceCount,b._maxVertexCount=e.maxVertexCount,b._maxIndexCount=e.maxIndexCount,b._geometryInitialized=e.geometryInitialized,b._geometryCount=e.geometryCount,b._matricesTexture=nt(e.matricesTexture.uuid),e.colorsTexture!==void 0&&(b._colorsTexture=nt(e.colorsTexture.uuid));break;case"LOD":b=new LOD;break;case"Line":b=new Line(_e(e.geometry),tt(e.material));break;case"LineLoop":b=new LineLoop(_e(e.geometry),tt(e.material));break;case"LineSegments":b=new LineSegments(_e(e.geometry),tt(e.material));break;case"PointCloud":case"Points":b=new Points(_e(e.geometry),tt(e.material));break;case"Sprite":b=new Sprite(tt(e.material));break;case"Group":b=new Group;break;case"Bone":b=new Bone;break;default:b=new Object3D}if(b.uuid=e.uuid,e.name!==void 0&&(b.name=e.name),e.matrix!==void 0?(b.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(b.matrixAutoUpdate=e.matrixAutoUpdate),b.matrixAutoUpdate&&b.matrix.decompose(b.position,b.quaternion,b.scale)):(e.position!==void 0&&b.position.fromArray(e.position),e.rotation!==void 0&&b.rotation.fromArray(e.rotation),e.quaternion!==void 0&&b.quaternion.fromArray(e.quaternion),e.scale!==void 0&&b.scale.fromArray(e.scale)),e.up!==void 0&&b.up.fromArray(e.up),e.castShadow!==void 0&&(b.castShadow=e.castShadow),e.receiveShadow!==void 0&&(b.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.intensity!==void 0&&(b.shadow.intensity=e.shadow.intensity),e.shadow.bias!==void 0&&(b.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(b.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(b.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&b.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(b.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(b.visible=e.visible),e.frustumCulled!==void 0&&(b.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(b.renderOrder=e.renderOrder),e.userData!==void 0&&(b.userData=e.userData),e.layers!==void 0&&(b.layers.mask=e.layers),e.children!==void 0){const at=e.children;for(let ct=0;ct<at.length;ct++)b.add(this.parseObject(at[ct],s,a,c,d))}if(e.animations!==void 0){const at=e.animations;for(let ct=0;ct<at.length;ct++){const ut=at[ct];b.animations.push(d[ut])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(b.autoUpdate=e.autoUpdate);const at=e.levels;for(let ct=0;ct<at.length;ct++){const ut=at[ct],ft=b.getObjectByProperty("uuid",ut.object);ft!==void 0&&b.addLevel(ft,ut.distance,ut.hysteresis)}}return b}bindSkeletons(e,s){Object.keys(s).length!==0&&e.traverse(function(a){if(a.isSkinnedMesh===!0&&a.skeleton!==void 0){const c=s[a.skeleton];c===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",a.skeleton):a.bind(c,a.bindMatrix)}})}bindLightTargets(e){e.traverse(function(s){if(s.isDirectionalLight||s.isSpotLight){const a=s.target,c=e.getObjectByProperty("uuid",a);c!==void 0?s.target=c:s.target=new Object3D}})}}const TEXTURE_MAPPING={UVMapping,CubeReflectionMapping,CubeRefractionMapping,EquirectangularReflectionMapping,EquirectangularRefractionMapping,CubeUVReflectionMapping},TEXTURE_WRAPPING={RepeatWrapping,ClampToEdgeWrapping,MirroredRepeatWrapping},TEXTURE_FILTER={NearestFilter,NearestMipmapNearestFilter,NearestMipmapLinearFilter,LinearFilter,LinearMipmapNearestFilter,LinearMipmapLinearFilter};class ImageBitmapLoader extends Loader{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,s,a,c){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const d=this,b=Cache.get(e);if(b!==void 0){if(d.manager.itemStart(e),b.then){b.then(nt=>{s&&s(nt),d.manager.itemEnd(e)}).catch(nt=>{c&&c(nt)});return}return setTimeout(function(){s&&s(b),d.manager.itemEnd(e)},0),b}const _e={};_e.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",_e.headers=this.requestHeader;const tt=fetch(e,_e).then(function(nt){return nt.blob()}).then(function(nt){return createImageBitmap(nt,Object.assign(d.options,{colorSpaceConversion:"none"}))}).then(function(nt){return Cache.add(e,nt),s&&s(nt),d.manager.itemEnd(e),nt}).catch(function(nt){c&&c(nt),Cache.remove(e),d.manager.itemError(e),d.manager.itemEnd(e)});Cache.add(e,tt),d.manager.itemStart(e)}}let _context,AudioContext$1=class{static getContext(){return _context===void 0&&(_context=new(window.AudioContext||window.webkitAudioContext)),_context}static setContext(e){_context=e}};class AudioLoader extends Loader{constructor(e){super(e)}load(e,s,a,c){const d=this,b=new FileLoader(this.manager);b.setResponseType("arraybuffer"),b.setPath(this.path),b.setRequestHeader(this.requestHeader),b.setWithCredentials(this.withCredentials),b.load(e,function(tt){try{const nt=tt.slice(0);AudioContext$1.getContext().decodeAudioData(nt,function(ot){s(ot)}).catch(_e)}catch(nt){_e(nt)}},a,c);function _e(tt){c?c(tt):console.error(tt),d.manager.itemError(e)}}}const _eyeRight=new Matrix4,_eyeLeft=new Matrix4,_projectionMatrix=new Matrix4;class StereoCamera{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new PerspectiveCamera,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new PerspectiveCamera,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const s=this._cache;if(s.focus!==e.focus||s.fov!==e.fov||s.aspect!==e.aspect*this.aspect||s.near!==e.near||s.far!==e.far||s.zoom!==e.zoom||s.eyeSep!==this.eyeSep){s.focus=e.focus,s.fov=e.fov,s.aspect=e.aspect*this.aspect,s.near=e.near,s.far=e.far,s.zoom=e.zoom,s.eyeSep=this.eyeSep,_projectionMatrix.copy(e.projectionMatrix);const c=s.eyeSep/2,d=c*s.near/s.focus,b=s.near*Math.tan(DEG2RAD*s.fov*.5)/s.zoom;let _e,tt;_eyeLeft.elements[12]=-c,_eyeRight.elements[12]=c,_e=-b*s.aspect+d,tt=b*s.aspect+d,_projectionMatrix.elements[0]=2*s.near/(tt-_e),_projectionMatrix.elements[8]=(tt+_e)/(tt-_e),this.cameraL.projectionMatrix.copy(_projectionMatrix),_e=-b*s.aspect-d,tt=b*s.aspect-d,_projectionMatrix.elements[0]=2*s.near/(tt-_e),_projectionMatrix.elements[8]=(tt+_e)/(tt-_e),this.cameraR.projectionMatrix.copy(_projectionMatrix)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(_eyeLeft),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(_eyeRight)}}class Clock{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const s=now();e=(s-this.oldTime)/1e3,this.oldTime=s,this.elapsedTime+=e}return e}}function now(){return performance.now()}const _position$1=new Vector3,_quaternion$1=new Quaternion,_scale$1=new Vector3,_orientation$1=new Vector3;class AudioListener extends Object3D{constructor(){super(),this.type="AudioListener",this.context=AudioContext$1.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new Clock}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const s=this.context.listener,a=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(_position$1,_quaternion$1,_scale$1),_orientation$1.set(0,0,-1).applyQuaternion(_quaternion$1),s.positionX){const c=this.context.currentTime+this.timeDelta;s.positionX.linearRampToValueAtTime(_position$1.x,c),s.positionY.linearRampToValueAtTime(_position$1.y,c),s.positionZ.linearRampToValueAtTime(_position$1.z,c),s.forwardX.linearRampToValueAtTime(_orientation$1.x,c),s.forwardY.linearRampToValueAtTime(_orientation$1.y,c),s.forwardZ.linearRampToValueAtTime(_orientation$1.z,c),s.upX.linearRampToValueAtTime(a.x,c),s.upY.linearRampToValueAtTime(a.y,c),s.upZ.linearRampToValueAtTime(a.z,c)}else s.setPosition(_position$1.x,_position$1.y,_position$1.z),s.setOrientation(_orientation$1.x,_orientation$1.y,_orientation$1.z,a.x,a.y,a.z)}}class Audio extends Object3D{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const s=this.context.createBufferSource();return s.buffer=this.buffer,s.loop=this.loop,s.loopStart=this.loopStart,s.loopEnd=this.loopEnd,s.onended=this.onEnded.bind(this),s.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=s,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(e=0){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(this.context.currentTime+e),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,s=this.filters.length;e<s;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,s=this.filters.length;e<s;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){return this.detune=e,this.isPlaying===!0&&this.source.detune!==void 0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}const _position=new Vector3,_quaternion=new Quaternion,_scale=new Vector3,_orientation=new Vector3;class PositionalAudio extends Audio{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){super.connect(),this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,s,a){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=s,this.panner.coneOuterGain=a,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(_position,_quaternion,_scale),_orientation.set(0,0,1).applyQuaternion(_quaternion);const s=this.panner;if(s.positionX){const a=this.context.currentTime+this.listener.timeDelta;s.positionX.linearRampToValueAtTime(_position.x,a),s.positionY.linearRampToValueAtTime(_position.y,a),s.positionZ.linearRampToValueAtTime(_position.z,a),s.orientationX.linearRampToValueAtTime(_orientation.x,a),s.orientationY.linearRampToValueAtTime(_orientation.y,a),s.orientationZ.linearRampToValueAtTime(_orientation.z,a)}else s.setPosition(_position.x,_position.y,_position.z),s.setOrientation(_orientation.x,_orientation.y,_orientation.z)}}class AudioAnalyser{constructor(e,s=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=s,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const s=this.getFrequencyData();for(let a=0;a<s.length;a++)e+=s[a];return e/s.length}}class PropertyMixer{constructor(e,s,a){this.binding=e,this.valueSize=a;let c,d,b;switch(s){case"quaternion":c=this._slerp,d=this._slerpAdditive,b=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(a*6),this._workIndex=5;break;case"string":case"bool":c=this._select,d=this._select,b=this._setAdditiveIdentityOther,this.buffer=new Array(a*5);break;default:c=this._lerp,d=this._lerpAdditive,b=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(a*5)}this._mixBufferRegion=c,this._mixBufferRegionAdditive=d,this._setIdentity=b,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,s){const a=this.buffer,c=this.valueSize,d=e*c+c;let b=this.cumulativeWeight;if(b===0){for(let _e=0;_e!==c;++_e)a[d+_e]=a[_e];b=s}else{b+=s;const _e=s/b;this._mixBufferRegion(a,d,0,_e,c)}this.cumulativeWeight=b}accumulateAdditive(e){const s=this.buffer,a=this.valueSize,c=a*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(s,c,0,e,a),this.cumulativeWeightAdditive+=e}apply(e){const s=this.valueSize,a=this.buffer,c=e*s+s,d=this.cumulativeWeight,b=this.cumulativeWeightAdditive,_e=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,d<1){const tt=s*this._origIndex;this._mixBufferRegion(a,c,tt,1-d,s)}b>0&&this._mixBufferRegionAdditive(a,c,this._addIndex*s,1,s);for(let tt=s,nt=s+s;tt!==nt;++tt)if(a[tt]!==a[tt+s]){_e.setValue(a,c);break}}saveOriginalState(){const e=this.binding,s=this.buffer,a=this.valueSize,c=a*this._origIndex;e.getValue(s,c);for(let d=a,b=c;d!==b;++d)s[d]=s[c+d%a];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,s=e+this.valueSize;for(let a=e;a<s;a++)this.buffer[a]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,s=this._addIndex*this.valueSize;for(let a=0;a<this.valueSize;a++)this.buffer[s+a]=this.buffer[e+a]}_select(e,s,a,c,d){if(c>=.5)for(let b=0;b!==d;++b)e[s+b]=e[a+b]}_slerp(e,s,a,c){Quaternion.slerpFlat(e,s,e,s,e,a,c)}_slerpAdditive(e,s,a,c,d){const b=this._workIndex*d;Quaternion.multiplyQuaternionsFlat(e,b,e,s,e,a),Quaternion.slerpFlat(e,s,e,s,e,b,c)}_lerp(e,s,a,c,d){const b=1-c;for(let _e=0;_e!==d;++_e){const tt=s+_e;e[tt]=e[tt]*b+e[a+_e]*c}}_lerpAdditive(e,s,a,c,d){for(let b=0;b!==d;++b){const _e=s+b;e[_e]=e[_e]+e[a+b]*c}}}const _RESERVED_CHARS_RE="\\[\\]\\.:\\/",_reservedRe=new RegExp("["+_RESERVED_CHARS_RE+"]","g"),_wordChar="[^"+_RESERVED_CHARS_RE+"]",_wordCharOrDot="[^"+_RESERVED_CHARS_RE.replace("\\.","")+"]",_directoryRe=/((?:WC+[\/:])*)/.source.replace("WC",_wordChar),_nodeRe=/(WCOD+)?/.source.replace("WCOD",_wordCharOrDot),_objectRe=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",_wordChar),_propertyRe=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",_wordChar),_trackRe=new RegExp("^"+_directoryRe+_nodeRe+_objectRe+_propertyRe+"$"),_supportedObjectNames=["material","materials","bones","map"];class Composite{constructor(e,s,a){const c=a||PropertyBinding.parseTrackName(s);this._targetGroup=e,this._bindings=e.subscribe_(s,c)}getValue(e,s){this.bind();const a=this._targetGroup.nCachedObjects_,c=this._bindings[a];c!==void 0&&c.getValue(e,s)}setValue(e,s){const a=this._bindings;for(let c=this._targetGroup.nCachedObjects_,d=a.length;c!==d;++c)a[c].setValue(e,s)}bind(){const e=this._bindings;for(let s=this._targetGroup.nCachedObjects_,a=e.length;s!==a;++s)e[s].bind()}unbind(){const e=this._bindings;for(let s=this._targetGroup.nCachedObjects_,a=e.length;s!==a;++s)e[s].unbind()}}class PropertyBinding{constructor(e,s,a){this.path=s,this.parsedPath=a||PropertyBinding.parseTrackName(s),this.node=PropertyBinding.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,s,a){return e&&e.isAnimationObjectGroup?new PropertyBinding.Composite(e,s,a):new PropertyBinding(e,s,a)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(_reservedRe,"")}static parseTrackName(e){const s=_trackRe.exec(e);if(s===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const a={nodeName:s[2],objectName:s[3],objectIndex:s[4],propertyName:s[5],propertyIndex:s[6]},c=a.nodeName&&a.nodeName.lastIndexOf(".");if(c!==void 0&&c!==-1){const d=a.nodeName.substring(c+1);_supportedObjectNames.indexOf(d)!==-1&&(a.nodeName=a.nodeName.substring(0,c),a.objectName=d)}if(a.propertyName===null||a.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return a}static findNode(e,s){if(s===void 0||s===""||s==="."||s===-1||s===e.name||s===e.uuid)return e;if(e.skeleton){const a=e.skeleton.getBoneByName(s);if(a!==void 0)return a}if(e.children){const a=function(d){for(let b=0;b<d.length;b++){const _e=d[b];if(_e.name===s||_e.uuid===s)return _e;const tt=a(_e.children);if(tt)return tt}return null},c=a(e.children);if(c)return c}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,s){e[s]=this.targetObject[this.propertyName]}_getValue_array(e,s){const a=this.resolvedProperty;for(let c=0,d=a.length;c!==d;++c)e[s++]=a[c]}_getValue_arrayElement(e,s){e[s]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,s){this.resolvedProperty.toArray(e,s)}_setValue_direct(e,s){this.targetObject[this.propertyName]=e[s]}_setValue_direct_setNeedsUpdate(e,s){this.targetObject[this.propertyName]=e[s],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,s){this.targetObject[this.propertyName]=e[s],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,s){const a=this.resolvedProperty;for(let c=0,d=a.length;c!==d;++c)a[c]=e[s++]}_setValue_array_setNeedsUpdate(e,s){const a=this.resolvedProperty;for(let c=0,d=a.length;c!==d;++c)a[c]=e[s++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,s){const a=this.resolvedProperty;for(let c=0,d=a.length;c!==d;++c)a[c]=e[s++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,s){this.resolvedProperty[this.propertyIndex]=e[s]}_setValue_arrayElement_setNeedsUpdate(e,s){this.resolvedProperty[this.propertyIndex]=e[s],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,s){this.resolvedProperty[this.propertyIndex]=e[s],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,s){this.resolvedProperty.fromArray(e,s)}_setValue_fromArray_setNeedsUpdate(e,s){this.resolvedProperty.fromArray(e,s),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,s){this.resolvedProperty.fromArray(e,s),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,s){this.bind(),this.getValue(e,s)}_setValue_unbound(e,s){this.bind(),this.setValue(e,s)}bind(){let e=this.node;const s=this.parsedPath,a=s.objectName,c=s.propertyName;let d=s.propertyIndex;if(e||(e=PropertyBinding.findNode(this.rootNode,s.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(a){let nt=s.objectIndex;switch(a){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let it=0;it<e.length;it++)if(e[it].name===nt){nt=it;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[a]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[a]}if(nt!==void 0){if(e[nt]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[nt]}}const b=e[c];if(b===void 0){const nt=s.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+nt+"."+c+" but it wasn't found.",e);return}let _e=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?_e=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(_e=this.Versioning.MatrixWorldNeedsUpdate);let tt=this.BindingType.Direct;if(d!==void 0){if(c==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[d]!==void 0&&(d=e.morphTargetDictionary[d])}tt=this.BindingType.ArrayElement,this.resolvedProperty=b,this.propertyIndex=d}else b.fromArray!==void 0&&b.toArray!==void 0?(tt=this.BindingType.HasFromToArray,this.resolvedProperty=b):Array.isArray(b)?(tt=this.BindingType.EntireArray,this.resolvedProperty=b):this.propertyName=c;this.getValue=this.GetterByBindingType[tt],this.setValue=this.SetterByBindingTypeAndVersioning[tt][_e]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}PropertyBinding.Composite=Composite;PropertyBinding.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};PropertyBinding.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};PropertyBinding.prototype.GetterByBindingType=[PropertyBinding.prototype._getValue_direct,PropertyBinding.prototype._getValue_array,PropertyBinding.prototype._getValue_arrayElement,PropertyBinding.prototype._getValue_toArray];PropertyBinding.prototype.SetterByBindingTypeAndVersioning=[[PropertyBinding.prototype._setValue_direct,PropertyBinding.prototype._setValue_direct_setNeedsUpdate,PropertyBinding.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[PropertyBinding.prototype._setValue_array,PropertyBinding.prototype._setValue_array_setNeedsUpdate,PropertyBinding.prototype._setValue_array_setMatrixWorldNeedsUpdate],[PropertyBinding.prototype._setValue_arrayElement,PropertyBinding.prototype._setValue_arrayElement_setNeedsUpdate,PropertyBinding.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[PropertyBinding.prototype._setValue_fromArray,PropertyBinding.prototype._setValue_fromArray_setNeedsUpdate,PropertyBinding.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class AnimationObjectGroup{constructor(){this.isAnimationObjectGroup=!0,this.uuid=generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let a=0,c=arguments.length;a!==c;++a)e[arguments[a].uuid]=a;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const s=this;this.stats={objects:{get total(){return s._objects.length},get inUse(){return this.total-s.nCachedObjects_}},get bindingsPerObject(){return s._bindings.length}}}add(){const e=this._objects,s=this._indicesByUUID,a=this._paths,c=this._parsedPaths,d=this._bindings,b=d.length;let _e,tt=e.length,nt=this.nCachedObjects_;for(let it=0,ot=arguments.length;it!==ot;++it){const at=arguments[it],ct=at.uuid;let ut=s[ct];if(ut===void 0){ut=tt++,s[ct]=ut,e.push(at);for(let ft=0,dt=b;ft!==dt;++ft)d[ft].push(new PropertyBinding(at,a[ft],c[ft]))}else if(ut<nt){_e=e[ut];const ft=--nt,dt=e[ft];s[dt.uuid]=ut,e[ut]=dt,s[ct]=ft,e[ft]=at;for(let lt=0,ht=b;lt!==ht;++lt){const mt=d[lt],xt=mt[ft];let St=mt[ut];mt[ut]=xt,St===void 0&&(St=new PropertyBinding(at,a[lt],c[lt])),mt[ft]=St}}else e[ut]!==_e&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=nt}remove(){const e=this._objects,s=this._indicesByUUID,a=this._bindings,c=a.length;let d=this.nCachedObjects_;for(let b=0,_e=arguments.length;b!==_e;++b){const tt=arguments[b],nt=tt.uuid,it=s[nt];if(it!==void 0&&it>=d){const ot=d++,at=e[ot];s[at.uuid]=it,e[it]=at,s[nt]=ot,e[ot]=tt;for(let ct=0,ut=c;ct!==ut;++ct){const ft=a[ct],dt=ft[ot],lt=ft[it];ft[it]=dt,ft[ot]=lt}}}this.nCachedObjects_=d}uncache(){const e=this._objects,s=this._indicesByUUID,a=this._bindings,c=a.length;let d=this.nCachedObjects_,b=e.length;for(let _e=0,tt=arguments.length;_e!==tt;++_e){const nt=arguments[_e],it=nt.uuid,ot=s[it];if(ot!==void 0)if(delete s[it],ot<d){const at=--d,ct=e[at],ut=--b,ft=e[ut];s[ct.uuid]=ot,e[ot]=ct,s[ft.uuid]=at,e[at]=ft,e.pop();for(let dt=0,lt=c;dt!==lt;++dt){const ht=a[dt],mt=ht[at],xt=ht[ut];ht[ot]=mt,ht[at]=xt,ht.pop()}}else{const at=--b,ct=e[at];at>0&&(s[ct.uuid]=ot),e[ot]=ct,e.pop();for(let ut=0,ft=c;ut!==ft;++ut){const dt=a[ut];dt[ot]=dt[at],dt.pop()}}}this.nCachedObjects_=d}subscribe_(e,s){const a=this._bindingsIndicesByPath;let c=a[e];const d=this._bindings;if(c!==void 0)return d[c];const b=this._paths,_e=this._parsedPaths,tt=this._objects,nt=tt.length,it=this.nCachedObjects_,ot=new Array(nt);c=d.length,a[e]=c,b.push(e),_e.push(s),d.push(ot);for(let at=it,ct=tt.length;at!==ct;++at){const ut=tt[at];ot[at]=new PropertyBinding(ut,e,s)}return ot}unsubscribe_(e){const s=this._bindingsIndicesByPath,a=s[e];if(a!==void 0){const c=this._paths,d=this._parsedPaths,b=this._bindings,_e=b.length-1,tt=b[_e],nt=e[_e];s[nt]=a,b[a]=tt,b.pop(),d[a]=d[_e],d.pop(),c[a]=c[_e],c.pop()}}}class AnimationAction{constructor(e,s,a=null,c=s.blendMode){this._mixer=e,this._clip=s,this._localRoot=a,this.blendMode=c;const d=s.tracks,b=d.length,_e=new Array(b),tt={endingStart:ZeroCurvatureEnding,endingEnd:ZeroCurvatureEnding};for(let nt=0;nt!==b;++nt){const it=d[nt].createInterpolant(null);_e[nt]=it,it.settings=tt}this._interpolantSettings=tt,this._interpolants=_e,this._propertyBindings=new Array(b),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=LoopRepeat,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,s){return this.loop=e,this.repetitions=s,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,s,a){if(e.fadeOut(s),this.fadeIn(s),a){const c=this._clip.duration,d=e._clip.duration,b=d/c,_e=c/d;e.warp(1,b,s),this.warp(_e,1,s)}return this}crossFadeTo(e,s,a){return e.crossFadeFrom(this,s,a)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,s,a){const c=this._mixer,d=c.time,b=this.timeScale;let _e=this._timeScaleInterpolant;_e===null&&(_e=c._lendControlInterpolant(),this._timeScaleInterpolant=_e);const tt=_e.parameterPositions,nt=_e.sampleValues;return tt[0]=d,tt[1]=d+a,nt[0]=e/b,nt[1]=s/b,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,s,a,c){if(!this.enabled){this._updateWeight(e);return}const d=this._startTime;if(d!==null){const tt=(e-d)*a;tt<0||a===0?s=0:(this._startTime=null,s=a*tt)}s*=this._updateTimeScale(e);const b=this._updateTime(s),_e=this._updateWeight(e);if(_e>0){const tt=this._interpolants,nt=this._propertyBindings;switch(this.blendMode){case AdditiveAnimationBlendMode:for(let it=0,ot=tt.length;it!==ot;++it)tt[it].evaluate(b),nt[it].accumulateAdditive(_e);break;case NormalAnimationBlendMode:default:for(let it=0,ot=tt.length;it!==ot;++it)tt[it].evaluate(b),nt[it].accumulate(c,_e)}}}_updateWeight(e){let s=0;if(this.enabled){s=this.weight;const a=this._weightInterpolant;if(a!==null){const c=a.evaluate(e)[0];s*=c,e>a.parameterPositions[1]&&(this.stopFading(),c===0&&(this.enabled=!1))}}return this._effectiveWeight=s,s}_updateTimeScale(e){let s=0;if(!this.paused){s=this.timeScale;const a=this._timeScaleInterpolant;if(a!==null){const c=a.evaluate(e)[0];s*=c,e>a.parameterPositions[1]&&(this.stopWarping(),s===0?this.paused=!0:this.timeScale=s)}}return this._effectiveTimeScale=s,s}_updateTime(e){const s=this._clip.duration,a=this.loop;let c=this.time+e,d=this._loopCount;const b=a===LoopPingPong;if(e===0)return d===-1?c:b&&(d&1)===1?s-c:c;if(a===LoopOnce){d===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(c>=s)c=s;else if(c<0)c=0;else{this.time=c;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=c,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(d===-1&&(e>=0?(d=0,this._setEndings(!0,this.repetitions===0,b)):this._setEndings(this.repetitions===0,!0,b)),c>=s||c<0){const _e=Math.floor(c/s);c-=s*_e,d+=Math.abs(_e);const tt=this.repetitions-d;if(tt<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,c=e>0?s:0,this.time=c,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(tt===1){const nt=e<0;this._setEndings(nt,!nt,b)}else this._setEndings(!1,!1,b);this._loopCount=d,this.time=c,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:_e})}}else this.time=c;if(b&&(d&1)===1)return s-c}return c}_setEndings(e,s,a){const c=this._interpolantSettings;a?(c.endingStart=ZeroSlopeEnding,c.endingEnd=ZeroSlopeEnding):(e?c.endingStart=this.zeroSlopeAtStart?ZeroSlopeEnding:ZeroCurvatureEnding:c.endingStart=WrapAroundEnding,s?c.endingEnd=this.zeroSlopeAtEnd?ZeroSlopeEnding:ZeroCurvatureEnding:c.endingEnd=WrapAroundEnding)}_scheduleFading(e,s,a){const c=this._mixer,d=c.time;let b=this._weightInterpolant;b===null&&(b=c._lendControlInterpolant(),this._weightInterpolant=b);const _e=b.parameterPositions,tt=b.sampleValues;return _e[0]=d,tt[0]=s,_e[1]=d+e,tt[1]=a,this}}const _controlInterpolantsResultBuffer=new Float32Array(1);class AnimationMixer extends EventDispatcher$1{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,s){const a=e._localRoot||this._root,c=e._clip.tracks,d=c.length,b=e._propertyBindings,_e=e._interpolants,tt=a.uuid,nt=this._bindingsByRootAndName;let it=nt[tt];it===void 0&&(it={},nt[tt]=it);for(let ot=0;ot!==d;++ot){const at=c[ot],ct=at.name;let ut=it[ct];if(ut!==void 0)++ut.referenceCount,b[ot]=ut;else{if(ut=b[ot],ut!==void 0){ut._cacheIndex===null&&(++ut.referenceCount,this._addInactiveBinding(ut,tt,ct));continue}const ft=s&&s._propertyBindings[ot].binding.parsedPath;ut=new PropertyMixer(PropertyBinding.create(a,ct,ft),at.ValueTypeName,at.getValueSize()),++ut.referenceCount,this._addInactiveBinding(ut,tt,ct),b[ot]=ut}_e[ot].resultBuffer=ut.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const a=(e._localRoot||this._root).uuid,c=e._clip.uuid,d=this._actionsByClip[c];this._bindAction(e,d&&d.knownActions[0]),this._addInactiveAction(e,c,a)}const s=e._propertyBindings;for(let a=0,c=s.length;a!==c;++a){const d=s[a];d.useCount++===0&&(this._lendBinding(d),d.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const s=e._propertyBindings;for(let a=0,c=s.length;a!==c;++a){const d=s[a];--d.useCount===0&&(d.restoreOriginalState(),this._takeBackBinding(d))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const s=e._cacheIndex;return s!==null&&s<this._nActiveActions}_addInactiveAction(e,s,a){const c=this._actions,d=this._actionsByClip;let b=d[s];if(b===void 0)b={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,d[s]=b;else{const _e=b.knownActions;e._byClipCacheIndex=_e.length,_e.push(e)}e._cacheIndex=c.length,c.push(e),b.actionByRoot[a]=e}_removeInactiveAction(e){const s=this._actions,a=s[s.length-1],c=e._cacheIndex;a._cacheIndex=c,s[c]=a,s.pop(),e._cacheIndex=null;const d=e._clip.uuid,b=this._actionsByClip,_e=b[d],tt=_e.knownActions,nt=tt[tt.length-1],it=e._byClipCacheIndex;nt._byClipCacheIndex=it,tt[it]=nt,tt.pop(),e._byClipCacheIndex=null;const ot=_e.actionByRoot,at=(e._localRoot||this._root).uuid;delete ot[at],tt.length===0&&delete b[d],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const s=e._propertyBindings;for(let a=0,c=s.length;a!==c;++a){const d=s[a];--d.referenceCount===0&&this._removeInactiveBinding(d)}}_lendAction(e){const s=this._actions,a=e._cacheIndex,c=this._nActiveActions++,d=s[c];e._cacheIndex=c,s[c]=e,d._cacheIndex=a,s[a]=d}_takeBackAction(e){const s=this._actions,a=e._cacheIndex,c=--this._nActiveActions,d=s[c];e._cacheIndex=c,s[c]=e,d._cacheIndex=a,s[a]=d}_addInactiveBinding(e,s,a){const c=this._bindingsByRootAndName,d=this._bindings;let b=c[s];b===void 0&&(b={},c[s]=b),b[a]=e,e._cacheIndex=d.length,d.push(e)}_removeInactiveBinding(e){const s=this._bindings,a=e.binding,c=a.rootNode.uuid,d=a.path,b=this._bindingsByRootAndName,_e=b[c],tt=s[s.length-1],nt=e._cacheIndex;tt._cacheIndex=nt,s[nt]=tt,s.pop(),delete _e[d],Object.keys(_e).length===0&&delete b[c]}_lendBinding(e){const s=this._bindings,a=e._cacheIndex,c=this._nActiveBindings++,d=s[c];e._cacheIndex=c,s[c]=e,d._cacheIndex=a,s[a]=d}_takeBackBinding(e){const s=this._bindings,a=e._cacheIndex,c=--this._nActiveBindings,d=s[c];e._cacheIndex=c,s[c]=e,d._cacheIndex=a,s[a]=d}_lendControlInterpolant(){const e=this._controlInterpolants,s=this._nActiveControlInterpolants++;let a=e[s];return a===void 0&&(a=new LinearInterpolant(new Float32Array(2),new Float32Array(2),1,_controlInterpolantsResultBuffer),a.__cacheIndex=s,e[s]=a),a}_takeBackControlInterpolant(e){const s=this._controlInterpolants,a=e.__cacheIndex,c=--this._nActiveControlInterpolants,d=s[c];e.__cacheIndex=c,s[c]=e,d.__cacheIndex=a,s[a]=d}clipAction(e,s,a){const c=s||this._root,d=c.uuid;let b=typeof e=="string"?AnimationClip.findByName(c,e):e;const _e=b!==null?b.uuid:e,tt=this._actionsByClip[_e];let nt=null;if(a===void 0&&(b!==null?a=b.blendMode:a=NormalAnimationBlendMode),tt!==void 0){const ot=tt.actionByRoot[d];if(ot!==void 0&&ot.blendMode===a)return ot;nt=tt.knownActions[0],b===null&&(b=nt._clip)}if(b===null)return null;const it=new AnimationAction(this,b,s,a);return this._bindAction(it,nt),this._addInactiveAction(it,_e,d),it}existingAction(e,s){const a=s||this._root,c=a.uuid,d=typeof e=="string"?AnimationClip.findByName(a,e):e,b=d?d.uuid:e,_e=this._actionsByClip[b];return _e!==void 0&&_e.actionByRoot[c]||null}stopAllAction(){const e=this._actions,s=this._nActiveActions;for(let a=s-1;a>=0;--a)e[a].stop();return this}update(e){e*=this.timeScale;const s=this._actions,a=this._nActiveActions,c=this.time+=e,d=Math.sign(e),b=this._accuIndex^=1;for(let nt=0;nt!==a;++nt)s[nt]._update(c,e,d,b);const _e=this._bindings,tt=this._nActiveBindings;for(let nt=0;nt!==tt;++nt)_e[nt].apply(b);return this}setTime(e){this.time=0;for(let s=0;s<this._actions.length;s++)this._actions[s].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const s=this._actions,a=e.uuid,c=this._actionsByClip,d=c[a];if(d!==void 0){const b=d.knownActions;for(let _e=0,tt=b.length;_e!==tt;++_e){const nt=b[_e];this._deactivateAction(nt);const it=nt._cacheIndex,ot=s[s.length-1];nt._cacheIndex=null,nt._byClipCacheIndex=null,ot._cacheIndex=it,s[it]=ot,s.pop(),this._removeInactiveBindingsForAction(nt)}delete c[a]}}uncacheRoot(e){const s=e.uuid,a=this._actionsByClip;for(const b in a){const _e=a[b].actionByRoot,tt=_e[s];tt!==void 0&&(this._deactivateAction(tt),this._removeInactiveAction(tt))}const c=this._bindingsByRootAndName,d=c[s];if(d!==void 0)for(const b in d){const _e=d[b];_e.restoreOriginalState(),this._removeInactiveBinding(_e)}}uncacheAction(e,s){const a=this.existingAction(e,s);a!==null&&(this._deactivateAction(a),this._removeInactiveAction(a))}}class Uniform{constructor(e){this.value=e}clone(){return new Uniform(this.value.clone===void 0?this.value:this.value.clone())}}let _id=0;class UniformsGroup extends EventDispatcher$1{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:_id++}),this.name="",this.usage=StaticDrawUsage,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const s=this.uniforms.indexOf(e);return s!==-1&&this.uniforms.splice(s,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(e){this.name=e.name,this.usage=e.usage;const s=e.uniforms;this.uniforms.length=0;for(let a=0,c=s.length;a<c;a++){const d=Array.isArray(s[a])?s[a]:[s[a]];for(let b=0;b<d.length;b++)this.uniforms.push(d[b].clone())}return this}clone(){return new this.constructor().copy(this)}}class InstancedInterleavedBuffer extends InterleavedBuffer{constructor(e,s,a=1){super(e,s),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=a}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const s=super.clone(e);return s.meshPerAttribute=this.meshPerAttribute,s}toJSON(e){const s=super.toJSON(e);return s.isInstancedInterleavedBuffer=!0,s.meshPerAttribute=this.meshPerAttribute,s}}class GLBufferAttribute{constructor(e,s,a,c,d){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=s,this.itemSize=a,this.elementSize=c,this.count=d,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,s){return this.type=e,this.elementSize=s,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}const _matrix=new Matrix4;class Raycaster{constructor(e,s,a=0,c=1/0){this.ray=new Ray(e,s),this.near=a,this.far=c,this.camera=null,this.layers=new Layers,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,s){this.ray.set(e,s)}setFromCamera(e,s){s.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(s.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(s).sub(this.ray.origin).normalize(),this.camera=s):s.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(s.near+s.far)/(s.near-s.far)).unproject(s),this.ray.direction.set(0,0,-1).transformDirection(s.matrixWorld),this.camera=s):console.error("THREE.Raycaster: Unsupported camera type: "+s.type)}setFromXRController(e){return _matrix.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(_matrix),this}intersectObject(e,s=!0,a=[]){return intersect(e,this,a,s),a.sort(ascSort),a}intersectObjects(e,s=!0,a=[]){for(let c=0,d=e.length;c<d;c++)intersect(e[c],this,a,s);return a.sort(ascSort),a}}function ascSort(o,e){return o.distance-e.distance}function intersect(o,e,s,a){let c=!0;if(o.layers.test(e.layers)&&o.raycast(e,s)===!1&&(c=!1),c===!0&&a===!0){const d=o.children;for(let b=0,_e=d.length;b<_e;b++)intersect(d[b],e,s,!0)}}class Spherical{constructor(e=1,s=0,a=0){return this.radius=e,this.phi=s,this.theta=a,this}set(e,s,a){return this.radius=e,this.phi=s,this.theta=a,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,s,a){return this.radius=Math.sqrt(e*e+s*s+a*a),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,a),this.phi=Math.acos(clamp(s/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class Cylindrical{constructor(e=1,s=0,a=0){return this.radius=e,this.theta=s,this.y=a,this}set(e,s,a){return this.radius=e,this.theta=s,this.y=a,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,s,a){return this.radius=Math.sqrt(e*e+a*a),this.theta=Math.atan2(e,a),this.y=s,this}clone(){return new this.constructor().copy(this)}}class Matrix2{constructor(e,s,a,c){Matrix2.prototype.isMatrix2=!0,this.elements=[1,0,0,1],e!==void 0&&this.set(e,s,a,c)}identity(){return this.set(1,0,0,1),this}fromArray(e,s=0){for(let a=0;a<4;a++)this.elements[a]=e[a+s];return this}set(e,s,a,c){const d=this.elements;return d[0]=e,d[2]=s,d[1]=a,d[3]=c,this}}const _vector$4=new Vector2;class Box2{constructor(e=new Vector2(1/0,1/0),s=new Vector2(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=s}set(e,s){return this.min.copy(e),this.max.copy(s),this}setFromPoints(e){this.makeEmpty();for(let s=0,a=e.length;s<a;s++)this.expandByPoint(e[s]);return this}setFromCenterAndSize(e,s){const a=_vector$4.copy(s).multiplyScalar(.5);return this.min.copy(e).sub(a),this.max.copy(e).add(a),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,s){return s.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y}clampPoint(e,s){return s.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,_vector$4).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const _startP=new Vector3,_startEnd=new Vector3;class Line3{constructor(e=new Vector3,s=new Vector3){this.start=e,this.end=s}set(e,s){return this.start.copy(e),this.end.copy(s),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,s){return this.delta(s).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,s){_startP.subVectors(e,this.start),_startEnd.subVectors(this.end,this.start);const a=_startEnd.dot(_startEnd);let d=_startEnd.dot(_startP)/a;return s&&(d=clamp(d,0,1)),d}closestPointToPoint(e,s,a){const c=this.closestPointToPointParameter(e,s);return this.delta(a).multiplyScalar(c).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const _vector$3=new Vector3;class SpotLightHelper extends Object3D{constructor(e,s){super(),this.light=e,this.matrixAutoUpdate=!1,this.color=s,this.type="SpotLightHelper";const a=new BufferGeometry,c=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let b=0,_e=1,tt=32;b<tt;b++,_e++){const nt=b/tt*Math.PI*2,it=_e/tt*Math.PI*2;c.push(Math.cos(nt),Math.sin(nt),1,Math.cos(it),Math.sin(it),1)}a.setAttribute("position",new Float32BufferAttribute(c,3));const d=new LineBasicMaterial({fog:!1,toneMapped:!1});this.cone=new LineSegments(a,d),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);const e=this.light.distance?this.light.distance:1e3,s=e*Math.tan(this.light.angle);this.cone.scale.set(s,s,e),_vector$3.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(_vector$3),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const _vector$2=new Vector3,_boneMatrix=new Matrix4,_matrixWorldInv=new Matrix4;class SkeletonHelper extends LineSegments{constructor(e){const s=getBoneList(e),a=new BufferGeometry,c=[],d=[],b=new Color(0,0,1),_e=new Color(0,1,0);for(let nt=0;nt<s.length;nt++){const it=s[nt];it.parent&&it.parent.isBone&&(c.push(0,0,0),c.push(0,0,0),d.push(b.r,b.g,b.b),d.push(_e.r,_e.g,_e.b))}a.setAttribute("position",new Float32BufferAttribute(c,3)),a.setAttribute("color",new Float32BufferAttribute(d,3));const tt=new LineBasicMaterial({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(a,tt),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=s,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const s=this.bones,a=this.geometry,c=a.getAttribute("position");_matrixWorldInv.copy(this.root.matrixWorld).invert();for(let d=0,b=0;d<s.length;d++){const _e=s[d];_e.parent&&_e.parent.isBone&&(_boneMatrix.multiplyMatrices(_matrixWorldInv,_e.matrixWorld),_vector$2.setFromMatrixPosition(_boneMatrix),c.setXYZ(b,_vector$2.x,_vector$2.y,_vector$2.z),_boneMatrix.multiplyMatrices(_matrixWorldInv,_e.parent.matrixWorld),_vector$2.setFromMatrixPosition(_boneMatrix),c.setXYZ(b+1,_vector$2.x,_vector$2.y,_vector$2.z),b+=2)}a.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose()}}function getBoneList(o){const e=[];o.isBone===!0&&e.push(o);for(let s=0;s<o.children.length;s++)e.push.apply(e,getBoneList(o.children[s]));return e}class PointLightHelper extends Mesh{constructor(e,s,a){const c=new SphereGeometry(s,4,2),d=new MeshBasicMaterial({wireframe:!0,fog:!1,toneMapped:!1});super(c,d),this.light=e,this.color=a,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const _vector$1=new Vector3,_color1=new Color,_color2=new Color;class HemisphereLightHelper extends Object3D{constructor(e,s,a){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=a,this.type="HemisphereLightHelper";const c=new OctahedronGeometry(s);c.rotateY(Math.PI*.5),this.material=new MeshBasicMaterial({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const d=c.getAttribute("position"),b=new Float32Array(d.count*3);c.setAttribute("color",new BufferAttribute(b,3)),this.add(new Mesh(c,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const s=e.geometry.getAttribute("color");_color1.copy(this.light.color),_color2.copy(this.light.groundColor);for(let a=0,c=s.count;a<c;a++){const d=a<c/2?_color1:_color2;s.setXYZ(a,d.r,d.g,d.b)}s.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(_vector$1.setFromMatrixPosition(this.light.matrixWorld).negate())}}class GridHelper extends LineSegments{constructor(e=10,s=10,a=4473924,c=8947848){a=new Color(a),c=new Color(c);const d=s/2,b=e/s,_e=e/2,tt=[],nt=[];for(let at=0,ct=0,ut=-_e;at<=s;at++,ut+=b){tt.push(-_e,0,ut,_e,0,ut),tt.push(ut,0,-_e,ut,0,_e);const ft=at===d?a:c;ft.toArray(nt,ct),ct+=3,ft.toArray(nt,ct),ct+=3,ft.toArray(nt,ct),ct+=3,ft.toArray(nt,ct),ct+=3}const it=new BufferGeometry;it.setAttribute("position",new Float32BufferAttribute(tt,3)),it.setAttribute("color",new Float32BufferAttribute(nt,3));const ot=new LineBasicMaterial({vertexColors:!0,toneMapped:!1});super(it,ot),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class PolarGridHelper extends LineSegments{constructor(e=10,s=16,a=8,c=64,d=4473924,b=8947848){d=new Color(d),b=new Color(b);const _e=[],tt=[];if(s>1)for(let ot=0;ot<s;ot++){const at=ot/s*(Math.PI*2),ct=Math.sin(at)*e,ut=Math.cos(at)*e;_e.push(0,0,0),_e.push(ct,0,ut);const ft=ot&1?d:b;tt.push(ft.r,ft.g,ft.b),tt.push(ft.r,ft.g,ft.b)}for(let ot=0;ot<a;ot++){const at=ot&1?d:b,ct=e-e/a*ot;for(let ut=0;ut<c;ut++){let ft=ut/c*(Math.PI*2),dt=Math.sin(ft)*ct,lt=Math.cos(ft)*ct;_e.push(dt,0,lt),tt.push(at.r,at.g,at.b),ft=(ut+1)/c*(Math.PI*2),dt=Math.sin(ft)*ct,lt=Math.cos(ft)*ct,_e.push(dt,0,lt),tt.push(at.r,at.g,at.b)}}const nt=new BufferGeometry;nt.setAttribute("position",new Float32BufferAttribute(_e,3)),nt.setAttribute("color",new Float32BufferAttribute(tt,3));const it=new LineBasicMaterial({vertexColors:!0,toneMapped:!1});super(nt,it),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const _v1=new Vector3,_v2=new Vector3,_v3=new Vector3;class DirectionalLightHelper extends Object3D{constructor(e,s,a){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=a,this.type="DirectionalLightHelper",s===void 0&&(s=1);let c=new BufferGeometry;c.setAttribute("position",new Float32BufferAttribute([-s,s,0,s,s,0,s,-s,0,-s,-s,0,-s,s,0],3));const d=new LineBasicMaterial({fog:!1,toneMapped:!1});this.lightPlane=new Line(c,d),this.add(this.lightPlane),c=new BufferGeometry,c.setAttribute("position",new Float32BufferAttribute([0,0,0,0,0,1],3)),this.targetLine=new Line(c,d),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),_v1.setFromMatrixPosition(this.light.matrixWorld),_v2.setFromMatrixPosition(this.light.target.matrixWorld),_v3.subVectors(_v2,_v1),this.lightPlane.lookAt(_v2),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(_v2),this.targetLine.scale.z=_v3.length()}}const _vector$d=new Vector3,_camera=new Camera;class CameraHelper extends LineSegments{constructor(e){const s=new BufferGeometry,a=new LineBasicMaterial({color:16777215,vertexColors:!0,toneMapped:!1}),c=[],d=[],b={};_e("n1","n2"),_e("n2","n4"),_e("n4","n3"),_e("n3","n1"),_e("f1","f2"),_e("f2","f4"),_e("f4","f3"),_e("f3","f1"),_e("n1","f1"),_e("n2","f2"),_e("n3","f3"),_e("n4","f4"),_e("p","n1"),_e("p","n2"),_e("p","n3"),_e("p","n4"),_e("u1","u2"),_e("u2","u3"),_e("u3","u1"),_e("c","t"),_e("p","c"),_e("cn1","cn2"),_e("cn3","cn4"),_e("cf1","cf2"),_e("cf3","cf4");function _e(ut,ft){tt(ut),tt(ft)}function tt(ut){c.push(0,0,0),d.push(0,0,0),b[ut]===void 0&&(b[ut]=[]),b[ut].push(c.length/3-1)}s.setAttribute("position",new Float32BufferAttribute(c,3)),s.setAttribute("color",new Float32BufferAttribute(d,3)),super(s,a),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=b,this.update();const nt=new Color(16755200),it=new Color(16711680),ot=new Color(43775),at=new Color(16777215),ct=new Color(3355443);this.setColors(nt,it,ot,at,ct)}setColors(e,s,a,c,d){const _e=this.geometry.getAttribute("color");_e.setXYZ(0,e.r,e.g,e.b),_e.setXYZ(1,e.r,e.g,e.b),_e.setXYZ(2,e.r,e.g,e.b),_e.setXYZ(3,e.r,e.g,e.b),_e.setXYZ(4,e.r,e.g,e.b),_e.setXYZ(5,e.r,e.g,e.b),_e.setXYZ(6,e.r,e.g,e.b),_e.setXYZ(7,e.r,e.g,e.b),_e.setXYZ(8,e.r,e.g,e.b),_e.setXYZ(9,e.r,e.g,e.b),_e.setXYZ(10,e.r,e.g,e.b),_e.setXYZ(11,e.r,e.g,e.b),_e.setXYZ(12,e.r,e.g,e.b),_e.setXYZ(13,e.r,e.g,e.b),_e.setXYZ(14,e.r,e.g,e.b),_e.setXYZ(15,e.r,e.g,e.b),_e.setXYZ(16,e.r,e.g,e.b),_e.setXYZ(17,e.r,e.g,e.b),_e.setXYZ(18,e.r,e.g,e.b),_e.setXYZ(19,e.r,e.g,e.b),_e.setXYZ(20,e.r,e.g,e.b),_e.setXYZ(21,e.r,e.g,e.b),_e.setXYZ(22,e.r,e.g,e.b),_e.setXYZ(23,e.r,e.g,e.b),_e.setXYZ(24,s.r,s.g,s.b),_e.setXYZ(25,s.r,s.g,s.b),_e.setXYZ(26,s.r,s.g,s.b),_e.setXYZ(27,s.r,s.g,s.b),_e.setXYZ(28,s.r,s.g,s.b),_e.setXYZ(29,s.r,s.g,s.b),_e.setXYZ(30,s.r,s.g,s.b),_e.setXYZ(31,s.r,s.g,s.b),_e.setXYZ(32,a.r,a.g,a.b),_e.setXYZ(33,a.r,a.g,a.b),_e.setXYZ(34,a.r,a.g,a.b),_e.setXYZ(35,a.r,a.g,a.b),_e.setXYZ(36,a.r,a.g,a.b),_e.setXYZ(37,a.r,a.g,a.b),_e.setXYZ(38,c.r,c.g,c.b),_e.setXYZ(39,c.r,c.g,c.b),_e.setXYZ(40,d.r,d.g,d.b),_e.setXYZ(41,d.r,d.g,d.b),_e.setXYZ(42,d.r,d.g,d.b),_e.setXYZ(43,d.r,d.g,d.b),_e.setXYZ(44,d.r,d.g,d.b),_e.setXYZ(45,d.r,d.g,d.b),_e.setXYZ(46,d.r,d.g,d.b),_e.setXYZ(47,d.r,d.g,d.b),_e.setXYZ(48,d.r,d.g,d.b),_e.setXYZ(49,d.r,d.g,d.b),_e.needsUpdate=!0}update(){const e=this.geometry,s=this.pointMap,a=1,c=1;_camera.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),setPoint("c",s,e,_camera,0,0,-1),setPoint("t",s,e,_camera,0,0,1),setPoint("n1",s,e,_camera,-a,-c,-1),setPoint("n2",s,e,_camera,a,-c,-1),setPoint("n3",s,e,_camera,-a,c,-1),setPoint("n4",s,e,_camera,a,c,-1),setPoint("f1",s,e,_camera,-a,-c,1),setPoint("f2",s,e,_camera,a,-c,1),setPoint("f3",s,e,_camera,-a,c,1),setPoint("f4",s,e,_camera,a,c,1),setPoint("u1",s,e,_camera,a*.7,c*1.1,-1),setPoint("u2",s,e,_camera,-a*.7,c*1.1,-1),setPoint("u3",s,e,_camera,0,c*2,-1),setPoint("cf1",s,e,_camera,-a,0,1),setPoint("cf2",s,e,_camera,a,0,1),setPoint("cf3",s,e,_camera,0,-c,1),setPoint("cf4",s,e,_camera,0,c,1),setPoint("cn1",s,e,_camera,-a,0,-1),setPoint("cn2",s,e,_camera,a,0,-1),setPoint("cn3",s,e,_camera,0,-c,-1),setPoint("cn4",s,e,_camera,0,c,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function setPoint(o,e,s,a,c,d,b){_vector$d.set(c,d,b).unproject(a);const _e=e[o];if(_e!==void 0){const tt=s.getAttribute("position");for(let nt=0,it=_e.length;nt<it;nt++)tt.setXYZ(_e[nt],_vector$d.x,_vector$d.y,_vector$d.z)}}const _box=new Box3;class BoxHelper extends LineSegments{constructor(e,s=16776960){const a=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),c=new Float32Array(8*3),d=new BufferGeometry;d.setIndex(new BufferAttribute(a,1)),d.setAttribute("position",new BufferAttribute(c,3)),super(d,new LineBasicMaterial({color:s,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(e!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&_box.setFromObject(this.object),_box.isEmpty())return;const s=_box.min,a=_box.max,c=this.geometry.attributes.position,d=c.array;d[0]=a.x,d[1]=a.y,d[2]=a.z,d[3]=s.x,d[4]=a.y,d[5]=a.z,d[6]=s.x,d[7]=s.y,d[8]=a.z,d[9]=a.x,d[10]=s.y,d[11]=a.z,d[12]=a.x,d[13]=a.y,d[14]=s.z,d[15]=s.x,d[16]=a.y,d[17]=s.z,d[18]=s.x,d[19]=s.y,d[20]=s.z,d[21]=a.x,d[22]=s.y,d[23]=s.z,c.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,s){return super.copy(e,s),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class Box3Helper extends LineSegments{constructor(e,s=16776960){const a=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),c=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],d=new BufferGeometry;d.setIndex(new BufferAttribute(a,1)),d.setAttribute("position",new Float32BufferAttribute(c,3)),super(d,new LineBasicMaterial({color:s,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const s=this.box;s.isEmpty()||(s.getCenter(this.position),s.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class PlaneHelper extends Line{constructor(e,s=1,a=16776960){const c=a,d=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],b=new BufferGeometry;b.setAttribute("position",new Float32BufferAttribute(d,3)),b.computeBoundingSphere(),super(b,new LineBasicMaterial({color:c,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=s;const _e=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],tt=new BufferGeometry;tt.setAttribute("position",new Float32BufferAttribute(_e,3)),tt.computeBoundingSphere(),this.add(new Mesh(tt,new MeshBasicMaterial({color:c,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const _axis=new Vector3;let _lineGeometry,_coneGeometry;class ArrowHelper extends Object3D{constructor(e=new Vector3(0,0,1),s=new Vector3(0,0,0),a=1,c=16776960,d=a*.2,b=d*.2){super(),this.type="ArrowHelper",_lineGeometry===void 0&&(_lineGeometry=new BufferGeometry,_lineGeometry.setAttribute("position",new Float32BufferAttribute([0,0,0,0,1,0],3)),_coneGeometry=new CylinderGeometry(0,.5,1,5,1),_coneGeometry.translate(0,-.5,0)),this.position.copy(s),this.line=new Line(_lineGeometry,new LineBasicMaterial({color:c,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Mesh(_coneGeometry,new MeshBasicMaterial({color:c,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(a,d,b)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{_axis.set(e.z,0,-e.x).normalize();const s=Math.acos(e.y);this.quaternion.setFromAxisAngle(_axis,s)}}setLength(e,s=e*.2,a=s*.2){this.line.scale.set(1,Math.max(1e-4,e-s),1),this.line.updateMatrix(),this.cone.scale.set(a,s,a),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class AxesHelper extends LineSegments{constructor(e=1){const s=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],a=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],c=new BufferGeometry;c.setAttribute("position",new Float32BufferAttribute(s,3)),c.setAttribute("color",new Float32BufferAttribute(a,3));const d=new LineBasicMaterial({vertexColors:!0,toneMapped:!1});super(c,d),this.type="AxesHelper"}setColors(e,s,a){const c=new Color,d=this.geometry.attributes.color.array;return c.set(e),c.toArray(d,0),c.toArray(d,3),c.set(s),c.toArray(d,6),c.toArray(d,9),c.set(a),c.toArray(d,12),c.toArray(d,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class ShapePath{constructor(){this.type="ShapePath",this.color=new Color,this.subPaths=[],this.currentPath=null}moveTo(e,s){return this.currentPath=new Path,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,s),this}lineTo(e,s){return this.currentPath.lineTo(e,s),this}quadraticCurveTo(e,s,a,c){return this.currentPath.quadraticCurveTo(e,s,a,c),this}bezierCurveTo(e,s,a,c,d,b){return this.currentPath.bezierCurveTo(e,s,a,c,d,b),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function s(lt){const ht=[];for(let mt=0,xt=lt.length;mt<xt;mt++){const St=lt[mt],yt=new Shape;yt.curves=St.curves,ht.push(yt)}return ht}function a(lt,ht){const mt=ht.length;let xt=!1;for(let St=mt-1,yt=0;yt<mt;St=yt++){let wt=ht[St],Et=ht[yt],_t=Et.x-wt.x,vt=Et.y-wt.y;if(Math.abs(vt)>Number.EPSILON){if(vt<0&&(wt=ht[yt],_t=-_t,Et=ht[St],vt=-vt),lt.y<wt.y||lt.y>Et.y)continue;if(lt.y===wt.y){if(lt.x===wt.x)return!0}else{const Mt=vt*(lt.x-wt.x)-_t*(lt.y-wt.y);if(Mt===0)return!0;if(Mt<0)continue;xt=!xt}}else{if(lt.y!==wt.y)continue;if(Et.x<=lt.x&&lt.x<=wt.x||wt.x<=lt.x&&lt.x<=Et.x)return!0}}return xt}const c=ShapeUtils.isClockWise,d=this.subPaths;if(d.length===0)return[];let b,_e,tt;const nt=[];if(d.length===1)return _e=d[0],tt=new Shape,tt.curves=_e.curves,nt.push(tt),nt;let it=!c(d[0].getPoints());it=e?!it:it;const ot=[],at=[];let ct=[],ut=0,ft;at[ut]=void 0,ct[ut]=[];for(let lt=0,ht=d.length;lt<ht;lt++)_e=d[lt],ft=_e.getPoints(),b=c(ft),b=e?!b:b,b?(!it&&at[ut]&&ut++,at[ut]={s:new Shape,p:ft},at[ut].s.curves=_e.curves,it&&ut++,ct[ut]=[]):ct[ut].push({h:_e,p:ft[0]});if(!at[0])return s(d);if(at.length>1){let lt=!1,ht=0;for(let mt=0,xt=at.length;mt<xt;mt++)ot[mt]=[];for(let mt=0,xt=at.length;mt<xt;mt++){const St=ct[mt];for(let yt=0;yt<St.length;yt++){const wt=St[yt];let Et=!0;for(let _t=0;_t<at.length;_t++)a(wt.p,at[_t].p)&&(mt!==_t&&ht++,Et?(Et=!1,ot[_t].push(wt)):lt=!0);Et&&ot[mt].push(wt)}}ht>0&&lt===!1&&(ct=ot)}let dt;for(let lt=0,ht=at.length;lt<ht;lt++){tt=at[lt].s,nt.push(tt),dt=ct[lt];for(let mt=0,xt=dt.length;mt<xt;mt++)tt.holes.push(dt[mt].h)}return nt}}class Controls extends EventDispatcher$1{constructor(e,s=null){super(),this.object=e,this.domElement=s,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(){}disconnect(){}dispose(){}update(){}}class WebGLMultipleRenderTargets extends WebGLRenderTarget{constructor(e=1,s=1,a=1,c={}){console.warn('THREE.WebGLMultipleRenderTargets has been deprecated and will be removed in r172. Use THREE.WebGLRenderTarget and set the "count" parameter to enable MRT.'),super(e,s,{...c,count:a}),this.isWebGLMultipleRenderTargets=!0}get texture(){return this.textures}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:REVISION}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=REVISION);const THREE=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping,AddEquation,AddOperation,AdditiveAnimationBlendMode,AdditiveBlending,AgXToneMapping,AlphaFormat,AlwaysCompare,AlwaysDepth,AlwaysStencilFunc,AmbientLight,AnimationAction,AnimationClip,AnimationLoader,AnimationMixer,AnimationObjectGroup,AnimationUtils,ArcCurve,ArrayCamera,ArrowHelper,AttachedBindMode,Audio,AudioAnalyser,AudioContext:AudioContext$1,AudioListener,AudioLoader,AxesHelper,BackSide,BasicDepthPacking,BasicShadowMap,BatchedMesh,Bone,BooleanKeyframeTrack,Box2,Box3,Box3Helper,BoxGeometry,BoxHelper,BufferAttribute,BufferGeometry,BufferGeometryLoader,ByteType,Cache,Camera,CameraHelper,CanvasTexture,CapsuleGeometry,CatmullRomCurve3,CineonToneMapping,CircleGeometry,ClampToEdgeWrapping,Clock,Color,ColorKeyframeTrack,ColorManagement,CompressedArrayTexture,CompressedCubeTexture,CompressedTexture,CompressedTextureLoader,ConeGeometry,ConstantAlphaFactor,ConstantColorFactor,Controls,CubeCamera,CubeReflectionMapping,CubeRefractionMapping,CubeTexture,CubeTextureLoader,CubeUVReflectionMapping,CubicBezierCurve,CubicBezierCurve3,CubicInterpolant,CullFaceBack,CullFaceFront,CullFaceFrontBack,CullFaceNone,Curve,CurvePath,CustomBlending,CustomToneMapping,CylinderGeometry,Cylindrical,Data3DTexture,DataArrayTexture,DataTexture,DataTextureLoader,DataUtils,DecrementStencilOp,DecrementWrapStencilOp,DefaultLoadingManager,DepthFormat,DepthStencilFormat,DepthTexture,DetachedBindMode,DirectionalLight,DirectionalLightHelper,DiscreteInterpolant,DodecahedronGeometry,DoubleSide,DstAlphaFactor,DstColorFactor,DynamicCopyUsage,DynamicDrawUsage,DynamicReadUsage,EdgesGeometry,EllipseCurve,EqualCompare,EqualDepth,EqualStencilFunc,EquirectangularReflectionMapping,EquirectangularRefractionMapping,Euler,EventDispatcher:EventDispatcher$1,ExtrudeGeometry,FileLoader,Float16BufferAttribute,Float32BufferAttribute,FloatType,Fog,FogExp2,FramebufferTexture,FrontSide,Frustum,GLBufferAttribute,GLSL1,GLSL3,GreaterCompare,GreaterDepth,GreaterEqualCompare,GreaterEqualDepth,GreaterEqualStencilFunc,GreaterStencilFunc,GridHelper,Group,HalfFloatType,HemisphereLight,HemisphereLightHelper,IcosahedronGeometry,ImageBitmapLoader,ImageLoader,ImageUtils,IncrementStencilOp,IncrementWrapStencilOp,InstancedBufferAttribute,InstancedBufferGeometry,InstancedInterleavedBuffer,InstancedMesh,Int16BufferAttribute,Int32BufferAttribute,Int8BufferAttribute,IntType,InterleavedBuffer,InterleavedBufferAttribute,Interpolant,InterpolateDiscrete,InterpolateLinear,InterpolateSmooth,InvertStencilOp,KeepStencilOp,KeyframeTrack,LOD,LatheGeometry,Layers,LessCompare,LessDepth,LessEqualCompare,LessEqualDepth,LessEqualStencilFunc,LessStencilFunc,Light,LightProbe,Line,Line3,LineBasicMaterial,LineCurve,LineCurve3,LineDashedMaterial,LineLoop,LineSegments,LinearFilter,LinearInterpolant,LinearMipMapLinearFilter,LinearMipMapNearestFilter,LinearMipmapLinearFilter,LinearMipmapNearestFilter,LinearSRGBColorSpace:LinearSRGBColorSpace$1,LinearToneMapping,LinearTransfer,Loader,LoaderUtils,LoadingManager,LoopOnce,LoopPingPong,LoopRepeat,LuminanceAlphaFormat,LuminanceFormat,MOUSE,Material,MaterialLoader,MathUtils,Matrix2,Matrix3,Matrix4,MaxEquation,Mesh,MeshBasicMaterial,MeshDepthMaterial,MeshDistanceMaterial,MeshLambertMaterial,MeshMatcapMaterial,MeshNormalMaterial,MeshPhongMaterial,MeshPhysicalMaterial,MeshStandardMaterial,MeshToonMaterial,MinEquation,MirroredRepeatWrapping,MixOperation,MultiplyBlending,MultiplyOperation,NearestFilter,NearestMipMapLinearFilter,NearestMipMapNearestFilter,NearestMipmapLinearFilter,NearestMipmapNearestFilter,NeutralToneMapping,NeverCompare,NeverDepth,NeverStencilFunc,NoBlending,NoColorSpace,NoToneMapping,NormalAnimationBlendMode,NormalBlending,NotEqualCompare,NotEqualDepth,NotEqualStencilFunc,NumberKeyframeTrack,Object3D,ObjectLoader,ObjectSpaceNormalMap,OctahedronGeometry,OneFactor,OneMinusConstantAlphaFactor,OneMinusConstantColorFactor,OneMinusDstAlphaFactor,OneMinusDstColorFactor,OneMinusSrcAlphaFactor,OneMinusSrcColorFactor,OrthographicCamera:OrthographicCamera$1,PCFShadowMap,PCFSoftShadowMap,PMREMGenerator,Path,PerspectiveCamera,Plane,PlaneGeometry,PlaneHelper,PointLight,PointLightHelper,Points,PointsMaterial,PolarGridHelper,PolyhedronGeometry,PositionalAudio,PropertyBinding,PropertyMixer,QuadraticBezierCurve,QuadraticBezierCurve3,Quaternion,QuaternionKeyframeTrack,QuaternionLinearInterpolant,RED_GREEN_RGTC2_Format,RED_RGTC1_Format,REVISION,RGBADepthPacking,RGBAFormat,RGBAIntegerFormat,RGBA_ASTC_10x10_Format,RGBA_ASTC_10x5_Format,RGBA_ASTC_10x6_Format,RGBA_ASTC_10x8_Format,RGBA_ASTC_12x10_Format,RGBA_ASTC_12x12_Format,RGBA_ASTC_4x4_Format,RGBA_ASTC_5x4_Format,RGBA_ASTC_5x5_Format,RGBA_ASTC_6x5_Format,RGBA_ASTC_6x6_Format,RGBA_ASTC_8x5_Format,RGBA_ASTC_8x6_Format,RGBA_ASTC_8x8_Format,RGBA_BPTC_Format,RGBA_ETC2_EAC_Format,RGBA_PVRTC_2BPPV1_Format,RGBA_PVRTC_4BPPV1_Format,RGBA_S3TC_DXT1_Format,RGBA_S3TC_DXT3_Format,RGBA_S3TC_DXT5_Format,RGBDepthPacking,RGBFormat,RGBIntegerFormat,RGB_BPTC_SIGNED_Format,RGB_BPTC_UNSIGNED_Format,RGB_ETC1_Format,RGB_ETC2_Format,RGB_PVRTC_2BPPV1_Format,RGB_PVRTC_4BPPV1_Format,RGB_S3TC_DXT1_Format,RGDepthPacking,RGFormat,RGIntegerFormat,RawShaderMaterial,Ray,Raycaster,RectAreaLight,RedFormat,RedIntegerFormat,ReinhardToneMapping,RenderTarget,RepeatWrapping,ReplaceStencilOp,ReverseSubtractEquation,RingGeometry,SIGNED_RED_GREEN_RGTC2_Format,SIGNED_RED_RGTC1_Format,SRGBColorSpace:SRGBColorSpace$1,SRGBTransfer,Scene,ShaderChunk,ShaderLib,ShaderMaterial,ShadowMaterial,Shape,ShapeGeometry,ShapePath,ShapeUtils,ShortType,Skeleton,SkeletonHelper,SkinnedMesh,Source,Sphere,SphereGeometry,Spherical,SphericalHarmonics3,SplineCurve,SpotLight,SpotLightHelper,Sprite,SpriteMaterial,SrcAlphaFactor,SrcAlphaSaturateFactor,SrcColorFactor,StaticCopyUsage,StaticDrawUsage,StaticReadUsage,StereoCamera,StreamCopyUsage,StreamDrawUsage,StreamReadUsage,StringKeyframeTrack,SubtractEquation,SubtractiveBlending,TOUCH,TangentSpaceNormalMap,TetrahedronGeometry,Texture,TextureLoader,TextureUtils,TorusGeometry,TorusKnotGeometry,Triangle,TriangleFanDrawMode,TriangleStripDrawMode,TrianglesDrawMode,TubeGeometry,UVMapping,Uint16BufferAttribute,Uint32BufferAttribute,Uint8BufferAttribute,Uint8ClampedBufferAttribute,Uniform,UniformsGroup,UniformsLib,UniformsUtils,UnsignedByteType,UnsignedInt248Type,UnsignedInt5999Type,UnsignedIntType,UnsignedShort4444Type,UnsignedShort5551Type,UnsignedShortType,VSMShadowMap,Vector2,Vector3,Vector4,VectorKeyframeTrack,VideoTexture,WebGL3DRenderTarget,WebGLArrayRenderTarget,WebGLCoordinateSystem,WebGLCubeRenderTarget,WebGLMultipleRenderTargets,WebGLRenderTarget,WebGLRenderer,WebGLUtils,WebGPUCoordinateSystem,WireframeGeometry,WrapAroundEnding,ZeroCurvatureEnding,ZeroFactor,ZeroSlopeEnding,ZeroStencilOp,createCanvasElement},Symbol.toStringTag,{value:"Module"}));var constants={exports:{}},reactReconcilerConstants_production_min={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */reactReconcilerConstants_production_min.ConcurrentRoot=1;reactReconcilerConstants_production_min.ContinuousEventPriority=4;reactReconcilerConstants_production_min.DefaultEventPriority=16;reactReconcilerConstants_production_min.DiscreteEventPriority=1;reactReconcilerConstants_production_min.IdleEventPriority=536870912;reactReconcilerConstants_production_min.LegacyRoot=0;constants.exports=reactReconcilerConstants_production_min;var constantsExports=constants.exports;function createStore$2(o){let e;const s=new Set,a=(nt,it)=>{const ot=typeof nt=="function"?nt(e):nt;if(ot!==e){const at=e;e=it?ot:Object.assign({},e,ot),s.forEach(ct=>ct(e,at))}},c=()=>e,d=(nt,it=c,ot=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let at=it(e);function ct(){const ut=it(e);if(!ot(at,ut)){const ft=at;nt(at=ut,ft)}}return s.add(ct),()=>s.delete(ct)},tt={setState:a,getState:c,subscribe:(nt,it,ot)=>it||ot?d(nt,it,ot):(s.add(nt),()=>s.delete(nt)),destroy:()=>s.clear()};return e=o(a,c,tt),tt}const isSSR=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),useIsomorphicLayoutEffect$1=isSSR?reactExports.useEffect:reactExports.useLayoutEffect;function create$2(o){const e=typeof o=="function"?createStore$2(o):o,s=(a=e.getState,c=Object.is)=>{const[,d]=reactExports.useReducer(dt=>dt+1,0),b=e.getState(),_e=reactExports.useRef(b),tt=reactExports.useRef(a),nt=reactExports.useRef(c),it=reactExports.useRef(!1),ot=reactExports.useRef();ot.current===void 0&&(ot.current=a(b));let at,ct=!1;(_e.current!==b||tt.current!==a||nt.current!==c||it.current)&&(at=a(b),ct=!c(ot.current,at)),useIsomorphicLayoutEffect$1(()=>{ct&&(ot.current=at),_e.current=b,tt.current=a,nt.current=c,it.current=!1});const ut=reactExports.useRef(b);useIsomorphicLayoutEffect$1(()=>{const dt=()=>{try{const ht=e.getState(),mt=tt.current(ht);nt.current(ot.current,mt)||(_e.current=ht,ot.current=mt,d())}catch{it.current=!0,d()}},lt=e.subscribe(dt);return e.getState()!==ut.current&&dt(),lt},[]);const ft=ct?at:ot.current;return reactExports.useDebugValue(ft),ft};return Object.assign(s,e),s[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const a=[s,e];return{next(){const c=a.length<=0;return{value:a.shift(),done:c}}}},s}const isPromise=o=>typeof o=="object"&&typeof o.then=="function",globalCache=[];function shallowEqualArrays(o,e,s=(a,c)=>a===c){if(o===e)return!0;if(!o||!e)return!1;const a=o.length;if(e.length!==a)return!1;for(let c=0;c<a;c++)if(!s(o[c],e[c]))return!1;return!0}function query(o,e=null,s=!1,a={}){e===null&&(e=[o]);for(const d of globalCache)if(shallowEqualArrays(e,d.keys,d.equal)){if(s)return;if(Object.prototype.hasOwnProperty.call(d,"error"))throw d.error;if(Object.prototype.hasOwnProperty.call(d,"response"))return a.lifespan&&a.lifespan>0&&(d.timeout&&clearTimeout(d.timeout),d.timeout=setTimeout(d.remove,a.lifespan)),d.response;if(!s)throw d.promise}const c={keys:e,equal:a.equal,remove:()=>{const d=globalCache.indexOf(c);d!==-1&&globalCache.splice(d,1)},promise:(isPromise(o)?o:o(...e)).then(d=>{c.response=d,a.lifespan&&a.lifespan>0&&(c.timeout=setTimeout(c.remove,a.lifespan))}).catch(d=>c.error=d)};if(globalCache.push(c),!s)throw c.promise}const suspend=(o,e,s)=>query(o,e,!1,s),preload=(o,e,s)=>void query(o,e,!0,s),clear=o=>{if(o===void 0||o.length===0)globalCache.splice(0,globalCache.length);else{const e=globalCache.find(s=>shallowEqualArrays(o,s.keys,s.equal));e&&e.remove()}};var reactReconciler={exports:{}},scheduler$1={exports:{}},scheduler_production_min$1={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredScheduler_production_min;function requireScheduler_production_min(){return hasRequiredScheduler_production_min||(hasRequiredScheduler_production_min=1,function(o){function e(Ct,Ut){var Gt=Ct.length;Ct.push(Ut);e:for(;0<Gt;){var Pt=Gt-1>>>1,Wt=Ct[Pt];if(0<c(Wt,Ut))Ct[Pt]=Ut,Ct[Gt]=Wt,Gt=Pt;else break e}}function s(Ct){return Ct.length===0?null:Ct[0]}function a(Ct){if(Ct.length===0)return null;var Ut=Ct[0],Gt=Ct.pop();if(Gt!==Ut){Ct[0]=Gt;e:for(var Pt=0,Wt=Ct.length,sn=Wt>>>1;Pt<sn;){var Bt=2*(Pt+1)-1,tn=Ct[Bt],cn=Bt+1,vn=Ct[cn];if(0>c(tn,Gt))cn<Wt&&0>c(vn,tn)?(Ct[Pt]=vn,Ct[cn]=Gt,Pt=cn):(Ct[Pt]=tn,Ct[Bt]=Gt,Pt=Bt);else if(cn<Wt&&0>c(vn,Gt))Ct[Pt]=vn,Ct[cn]=Gt,Pt=cn;else break e}}return Ut}function c(Ct,Ut){var Gt=Ct.sortIndex-Ut.sortIndex;return Gt!==0?Gt:Ct.id-Ut.id}if(typeof performance=="object"&&typeof performance.now=="function"){var d=performance;o.unstable_now=function(){return d.now()}}else{var b=Date,_e=b.now();o.unstable_now=function(){return b.now()-_e}}var tt=[],nt=[],it=1,ot=null,at=3,ct=!1,ut=!1,ft=!1,dt=typeof setTimeout=="function"?setTimeout:null,lt=typeof clearTimeout=="function"?clearTimeout:null,ht=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function mt(Ct){for(var Ut=s(nt);Ut!==null;){if(Ut.callback===null)a(nt);else if(Ut.startTime<=Ct)a(nt),Ut.sortIndex=Ut.expirationTime,e(tt,Ut);else break;Ut=s(nt)}}function xt(Ct){if(ft=!1,mt(Ct),!ut)if(s(tt)!==null)ut=!0,Ot(St);else{var Ut=s(nt);Ut!==null&&Ht(xt,Ut.startTime-Ct)}}function St(Ct,Ut){ut=!1,ft&&(ft=!1,lt(Et),Et=-1),ct=!0;var Gt=at;try{for(mt(Ut),ot=s(tt);ot!==null&&(!(ot.expirationTime>Ut)||Ct&&!Mt());){var Pt=ot.callback;if(typeof Pt=="function"){ot.callback=null,at=ot.priorityLevel;var Wt=Pt(ot.expirationTime<=Ut);Ut=o.unstable_now(),typeof Wt=="function"?ot.callback=Wt:ot===s(tt)&&a(tt),mt(Ut)}else a(tt);ot=s(tt)}if(ot!==null)var sn=!0;else{var Bt=s(nt);Bt!==null&&Ht(xt,Bt.startTime-Ut),sn=!1}return sn}finally{ot=null,at=Gt,ct=!1}}var yt=!1,wt=null,Et=-1,_t=5,vt=-1;function Mt(){return!(o.unstable_now()-vt<_t)}function jt(){if(wt!==null){var Ct=o.unstable_now();vt=Ct;var Ut=!0;try{Ut=wt(!0,Ct)}finally{Ut?Lt():(yt=!1,wt=null)}}else yt=!1}var Lt;if(typeof ht=="function")Lt=function(){ht(jt)};else if(typeof MessageChannel<"u"){var Nt=new MessageChannel,kt=Nt.port2;Nt.port1.onmessage=jt,Lt=function(){kt.postMessage(null)}}else Lt=function(){dt(jt,0)};function Ot(Ct){wt=Ct,yt||(yt=!0,Lt())}function Ht(Ct,Ut){Et=dt(function(){Ct(o.unstable_now())},Ut)}o.unstable_IdlePriority=5,o.unstable_ImmediatePriority=1,o.unstable_LowPriority=4,o.unstable_NormalPriority=3,o.unstable_Profiling=null,o.unstable_UserBlockingPriority=2,o.unstable_cancelCallback=function(Ct){Ct.callback=null},o.unstable_continueExecution=function(){ut||ct||(ut=!0,Ot(St))},o.unstable_forceFrameRate=function(Ct){0>Ct||125<Ct?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_t=0<Ct?Math.floor(1e3/Ct):5},o.unstable_getCurrentPriorityLevel=function(){return at},o.unstable_getFirstCallbackNode=function(){return s(tt)},o.unstable_next=function(Ct){switch(at){case 1:case 2:case 3:var Ut=3;break;default:Ut=at}var Gt=at;at=Ut;try{return Ct()}finally{at=Gt}},o.unstable_pauseExecution=function(){},o.unstable_requestPaint=function(){},o.unstable_runWithPriority=function(Ct,Ut){switch(Ct){case 1:case 2:case 3:case 4:case 5:break;default:Ct=3}var Gt=at;at=Ct;try{return Ut()}finally{at=Gt}},o.unstable_scheduleCallback=function(Ct,Ut,Gt){var Pt=o.unstable_now();switch(typeof Gt=="object"&&Gt!==null?(Gt=Gt.delay,Gt=typeof Gt=="number"&&0<Gt?Pt+Gt:Pt):Gt=Pt,Ct){case 1:var Wt=-1;break;case 2:Wt=250;break;case 5:Wt=1073741823;break;case 4:Wt=1e4;break;default:Wt=5e3}return Wt=Gt+Wt,Ct={id:it++,callback:Ut,priorityLevel:Ct,startTime:Gt,expirationTime:Wt,sortIndex:-1},Gt>Pt?(Ct.sortIndex=Gt,e(nt,Ct),s(tt)===null&&Ct===s(nt)&&(ft?(lt(Et),Et=-1):ft=!0,Ht(xt,Gt-Pt))):(Ct.sortIndex=Wt,e(tt,Ct),ut||ct||(ut=!0,Ot(St))),Ct},o.unstable_shouldYield=Mt,o.unstable_wrapCallback=function(Ct){var Ut=at;return function(){var Gt=at;at=Ut;try{return Ct.apply(this,arguments)}finally{at=Gt}}}}(scheduler_production_min$1)),scheduler_production_min$1}var hasRequiredScheduler;function requireScheduler(){return hasRequiredScheduler||(hasRequiredScheduler=1,scheduler$1.exports=requireScheduler_production_min()),scheduler$1.exports}/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var reactReconciler_production_min=function(e){var s={},a=reactExports,c=requireScheduler(),d=Object.assign;function b(rt){for(var st="https://reactjs.org/docs/error-decoder.html?invariant="+rt,pt=1;pt<arguments.length;pt++)st+="&args[]="+encodeURIComponent(arguments[pt]);return"Minified React error #"+rt+"; visit "+st+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var _e=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,tt=Symbol.for("react.element"),nt=Symbol.for("react.portal"),it=Symbol.for("react.fragment"),ot=Symbol.for("react.strict_mode"),at=Symbol.for("react.profiler"),ct=Symbol.for("react.provider"),ut=Symbol.for("react.context"),ft=Symbol.for("react.forward_ref"),dt=Symbol.for("react.suspense"),lt=Symbol.for("react.suspense_list"),ht=Symbol.for("react.memo"),mt=Symbol.for("react.lazy"),xt=Symbol.for("react.offscreen"),St=Symbol.iterator;function yt(rt){return rt===null||typeof rt!="object"?null:(rt=St&&rt[St]||rt["@@iterator"],typeof rt=="function"?rt:null)}function wt(rt){if(rt==null)return null;if(typeof rt=="function")return rt.displayName||rt.name||null;if(typeof rt=="string")return rt;switch(rt){case it:return"Fragment";case nt:return"Portal";case at:return"Profiler";case ot:return"StrictMode";case dt:return"Suspense";case lt:return"SuspenseList"}if(typeof rt=="object")switch(rt.$$typeof){case ut:return(rt.displayName||"Context")+".Consumer";case ct:return(rt._context.displayName||"Context")+".Provider";case ft:var st=rt.render;return rt=rt.displayName,rt||(rt=st.displayName||st.name||"",rt=rt!==""?"ForwardRef("+rt+")":"ForwardRef"),rt;case ht:return st=rt.displayName||null,st!==null?st:wt(rt.type)||"Memo";case mt:st=rt._payload,rt=rt._init;try{return wt(rt(st))}catch{}}return null}function Et(rt){var st=rt.type;switch(rt.tag){case 24:return"Cache";case 9:return(st.displayName||"Context")+".Consumer";case 10:return(st._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return rt=st.render,rt=rt.displayName||rt.name||"",st.displayName||(rt!==""?"ForwardRef("+rt+")":"ForwardRef");case 7:return"Fragment";case 5:return st;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return wt(st);case 8:return st===ot?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof st=="function")return st.displayName||st.name||null;if(typeof st=="string")return st}return null}function _t(rt){var st=rt,pt=rt;if(rt.alternate)for(;st.return;)st=st.return;else{rt=st;do st=rt,st.flags&4098&&(pt=st.return),rt=st.return;while(rt)}return st.tag===3?pt:null}function vt(rt){if(_t(rt)!==rt)throw Error(b(188))}function Mt(rt){var st=rt.alternate;if(!st){if(st=_t(rt),st===null)throw Error(b(188));return st!==rt?null:rt}for(var pt=rt,gt=st;;){var bt=pt.return;if(bt===null)break;var Rt=bt.alternate;if(Rt===null){if(gt=bt.return,gt!==null){pt=gt;continue}break}if(bt.child===Rt.child){for(Rt=bt.child;Rt;){if(Rt===pt)return vt(bt),rt;if(Rt===gt)return vt(bt),st;Rt=Rt.sibling}throw Error(b(188))}if(pt.return!==gt.return)pt=bt,gt=Rt;else{for(var $t=!1,en=bt.child;en;){if(en===pt){$t=!0,pt=bt,gt=Rt;break}if(en===gt){$t=!0,gt=bt,pt=Rt;break}en=en.sibling}if(!$t){for(en=Rt.child;en;){if(en===pt){$t=!0,pt=Rt,gt=bt;break}if(en===gt){$t=!0,gt=Rt,pt=bt;break}en=en.sibling}if(!$t)throw Error(b(189))}}if(pt.alternate!==gt)throw Error(b(190))}if(pt.tag!==3)throw Error(b(188));return pt.stateNode.current===pt?rt:st}function jt(rt){return rt=Mt(rt),rt!==null?Lt(rt):null}function Lt(rt){if(rt.tag===5||rt.tag===6)return rt;for(rt=rt.child;rt!==null;){var st=Lt(rt);if(st!==null)return st;rt=rt.sibling}return null}function Nt(rt){if(rt.tag===5||rt.tag===6)return rt;for(rt=rt.child;rt!==null;){if(rt.tag!==4){var st=Nt(rt);if(st!==null)return st}rt=rt.sibling}return null}var kt=Array.isArray,Ot=e.getPublicInstance,Ht=e.getRootHostContext,Ct=e.getChildHostContext,Ut=e.prepareForCommit,Gt=e.resetAfterCommit,Pt=e.createInstance,Wt=e.appendInitialChild,sn=e.finalizeInitialChildren,Bt=e.prepareUpdate,tn=e.shouldSetTextContent,cn=e.createTextInstance,vn=e.scheduleTimeout,On=e.cancelTimeout,rr=e.noTimeout,Wn=e.isPrimaryRenderer,Bn=e.supportsMutation,gn=e.supportsPersistence,bn=e.supportsHydration,Kt=e.getInstanceFromNode,Jn=e.preparePortalMount,Cn=e.getCurrentEventPriority,kn=e.detachDeletedInstance,Nn=e.supportsMicrotasks,ir=e.scheduleMicrotask,Un=e.supportsTestSelectors,zt=e.findFiberRoot,It=e.getBoundingRect,on=e.getTextContent,xn=e.isHiddenSubtree,wn=e.matchAccessibilityRole,En=e.setFocusIfFocusable,Hn=e.setupIntersectionObserver,Fn=e.appendChild,zn=e.appendChildToContainer,xr=e.commitTextUpdate,Tn=e.commitMount,Qn=e.commitUpdate,sr=e.insertBefore,er=e.insertInContainerBefore,Xn=e.removeChild,qt=e.removeChildFromContainer,fn=e.resetTextContent,jn=e.hideInstance,Qt=e.hideTextInstance,an=e.unhideInstance,hn=e.unhideTextInstance,_n=e.clearContainer,Vn=e.cloneInstance,Gn=e.createContainerChildSet,ur=e.appendChildToContainerChildSet,Mr=e.finalizeContainerChildren,Ir=e.replaceContainerChildren,yr=e.cloneHiddenInstance,Or=e.cloneHiddenTextInstance,Wr=e.canHydrateInstance,Mo=e.canHydrateTextInstance,Ro=e.canHydrateSuspenseInstance,rs=e.isSuspenseInstancePending,Gs=e.isSuspenseInstanceFallback,js=e.registerSuspenseInstanceRetry,ls=e.getNextHydratableSibling,gr=e.getFirstHydratableChild,uo=e.getFirstHydratableChildWithinContainer,Ys=e.getFirstHydratableChildWithinSuspenseInstance,Tt=e.hydrateInstance,Dt=e.hydrateTextInstance,Zt=e.hydrateSuspenseInstance,dn=e.getNextHydratableInstanceAfterSuspenseInstance,mn=e.commitHydratedContainer,At=e.commitHydratedSuspenseInstance,Vt=e.clearSuspenseBoundary,Yt=e.clearSuspenseBoundaryFromContainer,Jt=e.shouldDeleteUnhydratedTailInstances,Xt=e.didNotMatchHydratedContainerTextInstance,rn=e.didNotMatchHydratedTextInstance,ln;function Pn(rt){if(ln===void 0)try{throw Error()}catch(pt){var st=pt.stack.trim().match(/\n( *(at )?)/);ln=st&&st[1]||""}return`
`+ln+rt}var Sn=!1;function Rn(rt,st){if(!rt||Sn)return"";Sn=!0;var pt=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(st)if(st=function(){throw Error()},Object.defineProperty(st.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(st,[])}catch(In){var gt=In}Reflect.construct(rt,[],st)}else{try{st.call()}catch(In){gt=In}rt.call(st.prototype)}else{try{throw Error()}catch(In){gt=In}rt()}}catch(In){if(In&&gt&&typeof In.stack=="string"){for(var bt=In.stack.split(`
`),Rt=gt.stack.split(`
`),$t=bt.length-1,en=Rt.length-1;1<=$t&&0<=en&&bt[$t]!==Rt[en];)en--;for(;1<=$t&&0<=en;$t--,en--)if(bt[$t]!==Rt[en]){if($t!==1||en!==1)do if($t--,en--,0>en||bt[$t]!==Rt[en]){var yn=`
`+bt[$t].replace(" at new "," at ");return rt.displayName&&yn.includes("<anonymous>")&&(yn=yn.replace("<anonymous>",rt.displayName)),yn}while(1<=$t&&0<=en);break}}}finally{Sn=!1,Error.prepareStackTrace=pt}return(rt=rt?rt.displayName||rt.name:"")?Pn(rt):""}var Ln=Object.prototype.hasOwnProperty,An=[],Zn=-1;function nr(rt){return{current:rt}}function Yn(rt){0>Zn||(rt.current=An[Zn],An[Zn]=null,Zn--)}function ar(rt,st){Zn++,An[Zn]=rt.current,rt.current=st}var qn={},Dn=nr(qn),hr=nr(!1),lr=qn;function Pr(rt,st){var pt=rt.type.contextTypes;if(!pt)return qn;var gt=rt.stateNode;if(gt&&gt.__reactInternalMemoizedUnmaskedChildContext===st)return gt.__reactInternalMemoizedMaskedChildContext;var bt={},Rt;for(Rt in pt)bt[Rt]=st[Rt];return gt&&(rt=rt.stateNode,rt.__reactInternalMemoizedUnmaskedChildContext=st,rt.__reactInternalMemoizedMaskedChildContext=bt),bt}function Lr(rt){return rt=rt.childContextTypes,rt!=null}function jr(){Yn(hr),Yn(Dn)}function Rr(rt,st,pt){if(Dn.current!==qn)throw Error(b(168));ar(Dn,st),ar(hr,pt)}function pr(rt,st,pt){var gt=rt.stateNode;if(st=st.childContextTypes,typeof gt.getChildContext!="function")return pt;gt=gt.getChildContext();for(var bt in gt)if(!(bt in st))throw Error(b(108,Et(rt)||"Unknown",bt));return d({},pt,gt)}function vr(rt){return rt=(rt=rt.stateNode)&&rt.__reactInternalMemoizedMergedChildContext||qn,lr=Dn.current,ar(Dn,rt),ar(hr,hr.current),!0}function br(rt,st,pt){var gt=rt.stateNode;if(!gt)throw Error(b(169));pt?(rt=pr(rt,st,lr),gt.__reactInternalMemoizedMergedChildContext=rt,Yn(hr),Yn(Dn),ar(Dn,rt)):Yn(hr),ar(hr,pt)}var wr=Math.clz32?Math.clz32:hs,Xr=Math.log,Dr=Math.LN2;function hs(rt){return rt>>>=0,rt===0?32:31-(Xr(rt)/Dr|0)|0}var Tl=64,Nl=4194304;function Ko(rt){switch(rt&-rt){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return rt&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return rt&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return rt}}function Pl(rt,st){var pt=rt.pendingLanes;if(pt===0)return 0;var gt=0,bt=rt.suspendedLanes,Rt=rt.pingedLanes,$t=pt&268435455;if($t!==0){var en=$t&~bt;en!==0?gt=Ko(en):(Rt&=$t,Rt!==0&&(gt=Ko(Rt)))}else $t=pt&~bt,$t!==0?gt=Ko($t):Rt!==0&&(gt=Ko(Rt));if(gt===0)return 0;if(st!==0&&st!==gt&&!(st&bt)&&(bt=gt&-gt,Rt=st&-st,bt>=Rt||bt===16&&(Rt&4194240)!==0))return st;if(gt&4&&(gt|=pt&16),st=rt.entangledLanes,st!==0)for(rt=rt.entanglements,st&=gt;0<st;)pt=31-wr(st),bt=1<<pt,gt|=rt[pt],st&=~bt;return gt}function hx(rt,st){switch(rt){case 1:case 2:case 4:return st+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return st+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function fx(rt,st){for(var pt=rt.suspendedLanes,gt=rt.pingedLanes,bt=rt.expirationTimes,Rt=rt.pendingLanes;0<Rt;){var $t=31-wr(Rt),en=1<<$t,yn=bt[$t];yn===-1?(!(en&pt)||en&gt)&&(bt[$t]=hx(en,st)):yn<=st&&(rt.expiredLanes|=en),Rt&=~en}}function wu(rt){return rt=rt.pendingLanes&-1073741825,rt!==0?rt:rt&1073741824?1073741824:0}function Mu(rt){for(var st=[],pt=0;31>pt;pt++)st.push(rt);return st}function Yo(rt,st,pt){rt.pendingLanes|=st,st!==536870912&&(rt.suspendedLanes=0,rt.pingedLanes=0),rt=rt.eventTimes,st=31-wr(st),rt[st]=pt}function mx(rt,st){var pt=rt.pendingLanes&~st;rt.pendingLanes=st,rt.suspendedLanes=0,rt.pingedLanes=0,rt.expiredLanes&=st,rt.mutableReadLanes&=st,rt.entangledLanes&=st,st=rt.entanglements;var gt=rt.eventTimes;for(rt=rt.expirationTimes;0<pt;){var bt=31-wr(pt),Rt=1<<bt;st[bt]=0,gt[bt]=-1,rt[bt]=-1,pt&=~Rt}}function Ru(rt,st){var pt=rt.entangledLanes|=st;for(rt=rt.entanglements;pt;){var gt=31-wr(pt),bt=1<<gt;bt&st|rt[gt]&st&&(rt[gt]|=st),pt&=~bt}}var Ar=0;function Ap(rt){return rt&=-rt,1<rt?4<rt?rt&268435455?16:536870912:4:1}var Au=c.unstable_scheduleCallback,Cp=c.unstable_cancelCallback,xx=c.unstable_shouldYield,gx=c.unstable_requestPaint,Kr=c.unstable_now,Cu=c.unstable_ImmediatePriority,yx=c.unstable_UserBlockingPriority,Tu=c.unstable_NormalPriority,vx=c.unstable_IdlePriority,Il=null,Ns=null;function Ex(rt){if(Ns&&typeof Ns.onCommitFiberRoot=="function")try{Ns.onCommitFiberRoot(Il,rt,void 0,(rt.current.flags&128)===128)}catch{}}function Sx(rt,st){return rt===st&&(rt!==0||1/rt===1/st)||rt!==rt&&st!==st}var Ps=typeof Object.is=="function"?Object.is:Sx,zs=null,Ll=!1,ju=!1;function Tp(rt){zs===null?zs=[rt]:zs.push(rt)}function bx(rt){Ll=!0,Tp(rt)}function Is(){if(!ju&&zs!==null){ju=!0;var rt=0,st=Ar;try{var pt=zs;for(Ar=1;rt<pt.length;rt++){var gt=pt[rt];do gt=gt(!0);while(gt!==null)}zs=null,Ll=!1}catch(bt){throw zs!==null&&(zs=zs.slice(rt+1)),Au(Cu,Is),bt}finally{Ar=st,ju=!1}}return null}var wx=_e.ReactCurrentBatchConfig;function Bl(rt,st){if(Ps(rt,st))return!0;if(typeof rt!="object"||rt===null||typeof st!="object"||st===null)return!1;var pt=Object.keys(rt),gt=Object.keys(st);if(pt.length!==gt.length)return!1;for(gt=0;gt<pt.length;gt++){var bt=pt[gt];if(!Ln.call(st,bt)||!Ps(rt[bt],st[bt]))return!1}return!0}function Mx(rt){switch(rt.tag){case 5:return Pn(rt.type);case 16:return Pn("Lazy");case 13:return Pn("Suspense");case 19:return Pn("SuspenseList");case 0:case 2:case 15:return rt=Rn(rt.type,!1),rt;case 11:return rt=Rn(rt.type.render,!1),rt;case 1:return rt=Rn(rt.type,!0),rt;default:return""}}function As(rt,st){if(rt&&rt.defaultProps){st=d({},st),rt=rt.defaultProps;for(var pt in rt)st[pt]===void 0&&(st[pt]=rt[pt]);return st}return st}var Dl=nr(null),Fl=null,Ao=null,Nu=null;function Pu(){Nu=Ao=Fl=null}function jp(rt,st,pt){Wn?(ar(Dl,st._currentValue),st._currentValue=pt):(ar(Dl,st._currentValue2),st._currentValue2=pt)}function Iu(rt){var st=Dl.current;Yn(Dl),Wn?rt._currentValue=st:rt._currentValue2=st}function Lu(rt,st,pt){for(;rt!==null;){var gt=rt.alternate;if((rt.childLanes&st)!==st?(rt.childLanes|=st,gt!==null&&(gt.childLanes|=st)):gt!==null&&(gt.childLanes&st)!==st&&(gt.childLanes|=st),rt===pt)break;rt=rt.return}}function Co(rt,st){Fl=rt,Nu=Ao=null,rt=rt.dependencies,rt!==null&&rt.firstContext!==null&&(rt.lanes&st&&(ms=!0),rt.firstContext=null)}function ys(rt){var st=Wn?rt._currentValue:rt._currentValue2;if(Nu!==rt)if(rt={context:rt,memoizedValue:st,next:null},Ao===null){if(Fl===null)throw Error(b(308));Ao=rt,Fl.dependencies={lanes:0,firstContext:rt}}else Ao=Ao.next=rt;return st}var Ls=null,Js=!1;function Bu(rt){rt.updateQueue={baseState:rt.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Np(rt,st){rt=rt.updateQueue,st.updateQueue===rt&&(st.updateQueue={baseState:rt.baseState,firstBaseUpdate:rt.firstBaseUpdate,lastBaseUpdate:rt.lastBaseUpdate,shared:rt.shared,effects:rt.effects})}function Hs(rt,st){return{eventTime:rt,lane:st,tag:0,payload:null,callback:null,next:null}}function Qs(rt,st){var pt=rt.updateQueue;pt!==null&&(pt=pt.shared,Hr!==null&&rt.mode&1&&!(Sr&2)?(rt=pt.interleaved,rt===null?(st.next=st,Ls===null?Ls=[pt]:Ls.push(pt)):(st.next=rt.next,rt.next=st),pt.interleaved=st):(rt=pt.pending,rt===null?st.next=st:(st.next=rt.next,rt.next=st),pt.pending=st))}function Ol(rt,st,pt){if(st=st.updateQueue,st!==null&&(st=st.shared,(pt&4194240)!==0)){var gt=st.lanes;gt&=rt.pendingLanes,pt|=gt,st.lanes=pt,Ru(rt,pt)}}function Pp(rt,st){var pt=rt.updateQueue,gt=rt.alternate;if(gt!==null&&(gt=gt.updateQueue,pt===gt)){var bt=null,Rt=null;if(pt=pt.firstBaseUpdate,pt!==null){do{var $t={eventTime:pt.eventTime,lane:pt.lane,tag:pt.tag,payload:pt.payload,callback:pt.callback,next:null};Rt===null?bt=Rt=$t:Rt=Rt.next=$t,pt=pt.next}while(pt!==null);Rt===null?bt=Rt=st:Rt=Rt.next=st}else bt=Rt=st;pt={baseState:gt.baseState,firstBaseUpdate:bt,lastBaseUpdate:Rt,shared:gt.shared,effects:gt.effects},rt.updateQueue=pt;return}rt=pt.lastBaseUpdate,rt===null?pt.firstBaseUpdate=st:rt.next=st,pt.lastBaseUpdate=st}function Ul(rt,st,pt,gt){var bt=rt.updateQueue;Js=!1;var Rt=bt.firstBaseUpdate,$t=bt.lastBaseUpdate,en=bt.shared.pending;if(en!==null){bt.shared.pending=null;var yn=en,In=yn.next;yn.next=null,$t===null?Rt=In:$t.next=In,$t=yn;var tr=rt.alternate;tr!==null&&(tr=tr.updateQueue,en=tr.lastBaseUpdate,en!==$t&&(en===null?tr.firstBaseUpdate=In:en.next=In,tr.lastBaseUpdate=yn))}if(Rt!==null){var fr=bt.baseState;$t=0,tr=In=yn=null,en=Rt;do{var dr=en.lane,Br=en.eventTime;if((gt&dr)===dr){tr!==null&&(tr=tr.next={eventTime:Br,lane:0,tag:en.tag,payload:en.payload,callback:en.callback,next:null});e:{var cr=rt,es=en;switch(dr=st,Br=pt,es.tag){case 1:if(cr=es.payload,typeof cr=="function"){fr=cr.call(Br,fr,dr);break e}fr=cr;break e;case 3:cr.flags=cr.flags&-65537|128;case 0:if(cr=es.payload,dr=typeof cr=="function"?cr.call(Br,fr,dr):cr,dr==null)break e;fr=d({},fr,dr);break e;case 2:Js=!0}}en.callback!==null&&en.lane!==0&&(rt.flags|=64,dr=bt.effects,dr===null?bt.effects=[en]:dr.push(en))}else Br={eventTime:Br,lane:dr,tag:en.tag,payload:en.payload,callback:en.callback,next:null},tr===null?(In=tr=Br,yn=fr):tr=tr.next=Br,$t|=dr;if(en=en.next,en===null){if(en=bt.shared.pending,en===null)break;dr=en,en=dr.next,dr.next=null,bt.lastBaseUpdate=dr,bt.shared.pending=null}}while(!0);if(tr===null&&(yn=fr),bt.baseState=yn,bt.firstBaseUpdate=In,bt.lastBaseUpdate=tr,st=bt.shared.interleaved,st!==null){bt=st;do $t|=bt.lane,bt=bt.next;while(bt!==st)}else Rt===null&&(bt.shared.lanes=0);Fo|=$t,rt.lanes=$t,rt.memoizedState=fr}}function Ip(rt,st,pt){if(rt=st.effects,st.effects=null,rt!==null)for(st=0;st<rt.length;st++){var gt=rt[st],bt=gt.callback;if(bt!==null){if(gt.callback=null,gt=pt,typeof bt!="function")throw Error(b(191,bt));bt.call(gt)}}}var Lp=new a.Component().refs;function Du(rt,st,pt,gt){st=rt.memoizedState,pt=pt(gt,st),pt=pt==null?st:d({},st,pt),rt.memoizedState=pt,rt.lanes===0&&(rt.updateQueue.baseState=pt)}var Gl={isMounted:function(rt){return(rt=rt._reactInternals)?_t(rt)===rt:!1},enqueueSetState:function(rt,st,pt){rt=rt._reactInternals;var gt=os(),bt=eo(rt),Rt=Hs(gt,bt);Rt.payload=st,pt!=null&&(Rt.callback=pt),Qs(rt,Rt),st=bs(rt,bt,gt),st!==null&&Ol(st,rt,bt)},enqueueReplaceState:function(rt,st,pt){rt=rt._reactInternals;var gt=os(),bt=eo(rt),Rt=Hs(gt,bt);Rt.tag=1,Rt.payload=st,pt!=null&&(Rt.callback=pt),Qs(rt,Rt),st=bs(rt,bt,gt),st!==null&&Ol(st,rt,bt)},enqueueForceUpdate:function(rt,st){rt=rt._reactInternals;var pt=os(),gt=eo(rt),bt=Hs(pt,gt);bt.tag=2,st!=null&&(bt.callback=st),Qs(rt,bt),st=bs(rt,gt,pt),st!==null&&Ol(st,rt,gt)}};function Bp(rt,st,pt,gt,bt,Rt,$t){return rt=rt.stateNode,typeof rt.shouldComponentUpdate=="function"?rt.shouldComponentUpdate(gt,Rt,$t):st.prototype&&st.prototype.isPureReactComponent?!Bl(pt,gt)||!Bl(bt,Rt):!0}function Dp(rt,st,pt){var gt=!1,bt=qn,Rt=st.contextType;return typeof Rt=="object"&&Rt!==null?Rt=ys(Rt):(bt=Lr(st)?lr:Dn.current,gt=st.contextTypes,Rt=(gt=gt!=null)?Pr(rt,bt):qn),st=new st(pt,Rt),rt.memoizedState=st.state!==null&&st.state!==void 0?st.state:null,st.updater=Gl,rt.stateNode=st,st._reactInternals=rt,gt&&(rt=rt.stateNode,rt.__reactInternalMemoizedUnmaskedChildContext=bt,rt.__reactInternalMemoizedMaskedChildContext=Rt),st}function Fp(rt,st,pt,gt){rt=st.state,typeof st.componentWillReceiveProps=="function"&&st.componentWillReceiveProps(pt,gt),typeof st.UNSAFE_componentWillReceiveProps=="function"&&st.UNSAFE_componentWillReceiveProps(pt,gt),st.state!==rt&&Gl.enqueueReplaceState(st,st.state,null)}function Fu(rt,st,pt,gt){var bt=rt.stateNode;bt.props=pt,bt.state=rt.memoizedState,bt.refs=Lp,Bu(rt);var Rt=st.contextType;typeof Rt=="object"&&Rt!==null?bt.context=ys(Rt):(Rt=Lr(st)?lr:Dn.current,bt.context=Pr(rt,Rt)),bt.state=rt.memoizedState,Rt=st.getDerivedStateFromProps,typeof Rt=="function"&&(Du(rt,st,Rt,pt),bt.state=rt.memoizedState),typeof st.getDerivedStateFromProps=="function"||typeof bt.getSnapshotBeforeUpdate=="function"||typeof bt.UNSAFE_componentWillMount!="function"&&typeof bt.componentWillMount!="function"||(st=bt.state,typeof bt.componentWillMount=="function"&&bt.componentWillMount(),typeof bt.UNSAFE_componentWillMount=="function"&&bt.UNSAFE_componentWillMount(),st!==bt.state&&Gl.enqueueReplaceState(bt,bt.state,null),Ul(rt,pt,bt,gt),bt.state=rt.memoizedState),typeof bt.componentDidMount=="function"&&(rt.flags|=4194308)}var To=[],jo=0,zl=null,Hl=0,vs=[],Es=0,ho=null,Vs=1,$s="";function po(rt,st){To[jo++]=Hl,To[jo++]=zl,zl=rt,Hl=st}function kp(rt,st,pt){vs[Es++]=Vs,vs[Es++]=$s,vs[Es++]=ho,ho=rt;var gt=Vs;rt=$s;var bt=32-wr(gt)-1;gt&=~(1<<bt),pt+=1;var Rt=32-wr(st)+bt;if(30<Rt){var $t=bt-bt%5;Rt=(gt&(1<<$t)-1).toString(32),gt>>=$t,bt-=$t,Vs=1<<32-wr(st)+bt|pt<<bt|gt,$s=Rt+rt}else Vs=1<<Rt|pt<<bt|gt,$s=rt}function ku(rt){rt.return!==null&&(po(rt,1),kp(rt,1,0))}function Ou(rt){for(;rt===zl;)zl=To[--jo],To[jo]=null,Hl=To[--jo],To[jo]=null;for(;rt===ho;)ho=vs[--Es],vs[Es]=null,$s=vs[--Es],vs[Es]=null,Vs=vs[--Es],vs[Es]=null}var ps=null,fs=null,Fr=!1,Jo=!1,Cs=null;function Op(rt,st){var pt=ws(5,null,null,0);pt.elementType="DELETED",pt.stateNode=st,pt.return=rt,st=rt.deletions,st===null?(rt.deletions=[pt],rt.flags|=16):st.push(pt)}function Up(rt,st){switch(rt.tag){case 5:return st=Wr(st,rt.type,rt.pendingProps),st!==null?(rt.stateNode=st,ps=rt,fs=gr(st),!0):!1;case 6:return st=Mo(st,rt.pendingProps),st!==null?(rt.stateNode=st,ps=rt,fs=null,!0):!1;case 13:if(st=Ro(st),st!==null){var pt=ho!==null?{id:Vs,overflow:$s}:null;return rt.memoizedState={dehydrated:st,treeContext:pt,retryLane:1073741824},pt=ws(18,null,null,0),pt.stateNode=st,pt.return=rt,rt.child=pt,ps=rt,fs=null,!0}return!1;default:return!1}}function Uu(rt){return(rt.mode&1)!==0&&(rt.flags&128)===0}function Gu(rt){if(Fr){var st=fs;if(st){var pt=st;if(!Up(rt,st)){if(Uu(rt))throw Error(b(418));st=ls(pt);var gt=ps;st&&Up(rt,st)?Op(gt,pt):(rt.flags=rt.flags&-4097|2,Fr=!1,ps=rt)}}else{if(Uu(rt))throw Error(b(418));rt.flags=rt.flags&-4097|2,Fr=!1,ps=rt}}}function Gp(rt){for(rt=rt.return;rt!==null&&rt.tag!==5&&rt.tag!==3&&rt.tag!==13;)rt=rt.return;ps=rt}function Qo(rt){if(!bn||rt!==ps)return!1;if(!Fr)return Gp(rt),Fr=!0,!1;if(rt.tag!==3&&(rt.tag!==5||Jt(rt.type)&&!tn(rt.type,rt.memoizedProps))){var st=fs;if(st){if(Uu(rt)){for(rt=fs;rt;)rt=ls(rt);throw Error(b(418))}for(;st;)Op(rt,st),st=ls(st)}}if(Gp(rt),rt.tag===13){if(!bn)throw Error(b(316));if(rt=rt.memoizedState,rt=rt!==null?rt.dehydrated:null,!rt)throw Error(b(317));fs=dn(rt)}else fs=ps?ls(rt.stateNode):null;return!0}function No(){bn&&(fs=ps=null,Jo=Fr=!1)}function zu(rt){Cs===null?Cs=[rt]:Cs.push(rt)}function Zo(rt,st,pt){if(rt=pt.ref,rt!==null&&typeof rt!="function"&&typeof rt!="object"){if(pt._owner){if(pt=pt._owner,pt){if(pt.tag!==1)throw Error(b(309));var gt=pt.stateNode}if(!gt)throw Error(b(147,rt));var bt=gt,Rt=""+rt;return st!==null&&st.ref!==null&&typeof st.ref=="function"&&st.ref._stringRef===Rt?st.ref:(st=function($t){var en=bt.refs;en===Lp&&(en=bt.refs={}),$t===null?delete en[Rt]:en[Rt]=$t},st._stringRef=Rt,st)}if(typeof rt!="string")throw Error(b(284));if(!pt._owner)throw Error(b(290,rt))}return rt}function Vl(rt,st){throw rt=Object.prototype.toString.call(st),Error(b(31,rt==="[object Object]"?"object with keys {"+Object.keys(st).join(", ")+"}":rt))}function zp(rt){var st=rt._init;return st(rt._payload)}function Hp(rt){function st(un,nn){if(rt){var pn=un.deletions;pn===null?(un.deletions=[nn],un.flags|=16):pn.push(nn)}}function pt(un,nn){if(!rt)return null;for(;nn!==null;)st(un,nn),nn=nn.sibling;return null}function gt(un,nn){for(un=new Map;nn!==null;)nn.key!==null?un.set(nn.key,nn):un.set(nn.index,nn),nn=nn.sibling;return un}function bt(un,nn){return un=no(un,nn),un.index=0,un.sibling=null,un}function Rt(un,nn,pn){return un.index=pn,rt?(pn=un.alternate,pn!==null?(pn=pn.index,pn<nn?(un.flags|=2,nn):pn):(un.flags|=2,nn)):(un.flags|=1048576,nn)}function $t(un){return rt&&un.alternate===null&&(un.flags|=2),un}function en(un,nn,pn,Kn){return nn===null||nn.tag!==6?(nn=bp(pn,un.mode,Kn),nn.return=un,nn):(nn=bt(nn,pn),nn.return=un,nn)}function yn(un,nn,pn,Kn){var or=pn.type;return or===it?tr(un,nn,pn.props.children,Kn,pn.key):nn!==null&&(nn.elementType===or||typeof or=="object"&&or!==null&&or.$$typeof===mt&&zp(or)===nn.type)?(Kn=bt(nn,pn.props),Kn.ref=Zo(un,nn,pn),Kn.return=un,Kn):(Kn=_u(pn.type,pn.key,pn.props,null,un.mode,Kn),Kn.ref=Zo(un,nn,pn),Kn.return=un,Kn)}function In(un,nn,pn,Kn){return nn===null||nn.tag!==4||nn.stateNode.containerInfo!==pn.containerInfo||nn.stateNode.implementation!==pn.implementation?(nn=wp(pn,un.mode,Kn),nn.return=un,nn):(nn=bt(nn,pn.children||[]),nn.return=un,nn)}function tr(un,nn,pn,Kn,or){return nn===null||nn.tag!==7?(nn=Eo(pn,un.mode,Kn,or),nn.return=un,nn):(nn=bt(nn,pn),nn.return=un,nn)}function fr(un,nn,pn){if(typeof nn=="string"&&nn!==""||typeof nn=="number")return nn=bp(""+nn,un.mode,pn),nn.return=un,nn;if(typeof nn=="object"&&nn!==null){switch(nn.$$typeof){case tt:return pn=_u(nn.type,nn.key,nn.props,null,un.mode,pn),pn.ref=Zo(un,null,nn),pn.return=un,pn;case nt:return nn=wp(nn,un.mode,pn),nn.return=un,nn;case mt:var Kn=nn._init;return fr(un,Kn(nn._payload),pn)}if(kt(nn)||yt(nn))return nn=Eo(nn,un.mode,pn,null),nn.return=un,nn;Vl(un,nn)}return null}function dr(un,nn,pn,Kn){var or=nn!==null?nn.key:null;if(typeof pn=="string"&&pn!==""||typeof pn=="number")return or!==null?null:en(un,nn,""+pn,Kn);if(typeof pn=="object"&&pn!==null){switch(pn.$$typeof){case tt:return pn.key===or?yn(un,nn,pn,Kn):null;case nt:return pn.key===or?In(un,nn,pn,Kn):null;case mt:return or=pn._init,dr(un,nn,or(pn._payload),Kn)}if(kt(pn)||yt(pn))return or!==null?null:tr(un,nn,pn,Kn,null);Vl(un,pn)}return null}function Br(un,nn,pn,Kn,or){if(typeof Kn=="string"&&Kn!==""||typeof Kn=="number")return un=un.get(pn)||null,en(nn,un,""+Kn,or);if(typeof Kn=="object"&&Kn!==null){switch(Kn.$$typeof){case tt:return un=un.get(Kn.key===null?pn:Kn.key)||null,yn(nn,un,Kn,or);case nt:return un=un.get(Kn.key===null?pn:Kn.key)||null,In(nn,un,Kn,or);case mt:var Er=Kn._init;return Br(un,nn,pn,Er(Kn._payload),or)}if(kt(Kn)||yt(Kn))return un=un.get(pn)||null,tr(nn,un,Kn,or,null);Vl(nn,Kn)}return null}function cr(un,nn,pn,Kn){for(var or=null,Er=null,mr=nn,Cr=nn=0,Jr=null;mr!==null&&Cr<pn.length;Cr++){mr.index>Cr?(Jr=mr,mr=null):Jr=mr.sibling;var Tr=dr(un,mr,pn[Cr],Kn);if(Tr===null){mr===null&&(mr=Jr);break}rt&&mr&&Tr.alternate===null&&st(un,mr),nn=Rt(Tr,nn,Cr),Er===null?or=Tr:Er.sibling=Tr,Er=Tr,mr=Jr}if(Cr===pn.length)return pt(un,mr),Fr&&po(un,Cr),or;if(mr===null){for(;Cr<pn.length;Cr++)mr=fr(un,pn[Cr],Kn),mr!==null&&(nn=Rt(mr,nn,Cr),Er===null?or=mr:Er.sibling=mr,Er=mr);return Fr&&po(un,Cr),or}for(mr=gt(un,mr);Cr<pn.length;Cr++)Jr=Br(mr,un,Cr,pn[Cr],Kn),Jr!==null&&(rt&&Jr.alternate!==null&&mr.delete(Jr.key===null?Cr:Jr.key),nn=Rt(Jr,nn,Cr),Er===null?or=Jr:Er.sibling=Jr,Er=Jr);return rt&&mr.forEach(function(ro){return st(un,ro)}),Fr&&po(un,Cr),or}function es(un,nn,pn,Kn){var or=yt(pn);if(typeof or!="function")throw Error(b(150));if(pn=or.call(pn),pn==null)throw Error(b(151));for(var Er=or=null,mr=nn,Cr=nn=0,Jr=null,Tr=pn.next();mr!==null&&!Tr.done;Cr++,Tr=pn.next()){mr.index>Cr?(Jr=mr,mr=null):Jr=mr.sibling;var ro=dr(un,mr,Tr.value,Kn);if(ro===null){mr===null&&(mr=Jr);break}rt&&mr&&ro.alternate===null&&st(un,mr),nn=Rt(ro,nn,Cr),Er===null?or=ro:Er.sibling=ro,Er=ro,mr=Jr}if(Tr.done)return pt(un,mr),Fr&&po(un,Cr),or;if(mr===null){for(;!Tr.done;Cr++,Tr=pn.next())Tr=fr(un,Tr.value,Kn),Tr!==null&&(nn=Rt(Tr,nn,Cr),Er===null?or=Tr:Er.sibling=Tr,Er=Tr);return Fr&&po(un,Cr),or}for(mr=gt(un,mr);!Tr.done;Cr++,Tr=pn.next())Tr=Br(mr,un,Cr,Tr.value,Kn),Tr!==null&&(rt&&Tr.alternate!==null&&mr.delete(Tr.key===null?Cr:Tr.key),nn=Rt(Tr,nn,Cr),Er===null?or=Tr:Er.sibling=Tr,Er=Tr);return rt&&mr.forEach(function(e0){return st(un,e0)}),Fr&&po(un,Cr),or}function Ms(un,nn,pn,Kn){if(typeof pn=="object"&&pn!==null&&pn.type===it&&pn.key===null&&(pn=pn.props.children),typeof pn=="object"&&pn!==null){switch(pn.$$typeof){case tt:e:{for(var or=pn.key,Er=nn;Er!==null;){if(Er.key===or){if(or=pn.type,or===it){if(Er.tag===7){pt(un,Er.sibling),nn=bt(Er,pn.props.children),nn.return=un,un=nn;break e}}else if(Er.elementType===or||typeof or=="object"&&or!==null&&or.$$typeof===mt&&zp(or)===Er.type){pt(un,Er.sibling),nn=bt(Er,pn.props),nn.ref=Zo(un,Er,pn),nn.return=un,un=nn;break e}pt(un,Er);break}else st(un,Er);Er=Er.sibling}pn.type===it?(nn=Eo(pn.props.children,un.mode,Kn,pn.key),nn.return=un,un=nn):(Kn=_u(pn.type,pn.key,pn.props,null,un.mode,Kn),Kn.ref=Zo(un,nn,pn),Kn.return=un,un=Kn)}return $t(un);case nt:e:{for(Er=pn.key;nn!==null;){if(nn.key===Er)if(nn.tag===4&&nn.stateNode.containerInfo===pn.containerInfo&&nn.stateNode.implementation===pn.implementation){pt(un,nn.sibling),nn=bt(nn,pn.children||[]),nn.return=un,un=nn;break e}else{pt(un,nn);break}else st(un,nn);nn=nn.sibling}nn=wp(pn,un.mode,Kn),nn.return=un,un=nn}return $t(un);case mt:return Er=pn._init,Ms(un,nn,Er(pn._payload),Kn)}if(kt(pn))return cr(un,nn,pn,Kn);if(yt(pn))return es(un,nn,pn,Kn);Vl(un,pn)}return typeof pn=="string"&&pn!==""||typeof pn=="number"?(pn=""+pn,nn!==null&&nn.tag===6?(pt(un,nn.sibling),nn=bt(nn,pn),nn.return=un,un=nn):(pt(un,nn),nn=bp(pn,un.mode,Kn),nn.return=un,un=nn),$t(un)):pt(un,nn)}return Ms}var Po=Hp(!0),Vp=Hp(!1),qo={},_s=nr(qo),na=nr(qo),Io=nr(qo);function Bs(rt){if(rt===qo)throw Error(b(174));return rt}function Hu(rt,st){ar(Io,st),ar(na,rt),ar(_s,qo),rt=Ht(st),Yn(_s),ar(_s,rt)}function Lo(){Yn(_s),Yn(na),Yn(Io)}function $p(rt){var st=Bs(Io.current),pt=Bs(_s.current);st=Ct(pt,rt.type,st),pt!==st&&(ar(na,rt),ar(_s,st))}function Vu(rt){na.current===rt&&(Yn(_s),Yn(na))}var kr=nr(0);function $l(rt){for(var st=rt;st!==null;){if(st.tag===13){var pt=st.memoizedState;if(pt!==null&&(pt=pt.dehydrated,pt===null||rs(pt)||Gs(pt)))return st}else if(st.tag===19&&st.memoizedProps.revealOrder!==void 0){if(st.flags&128)return st}else if(st.child!==null){st.child.return=st,st=st.child;continue}if(st===rt)break;for(;st.sibling===null;){if(st.return===null||st.return===rt)return null;st=st.return}st.sibling.return=st.return,st=st.sibling}return null}var $u=[];function Wu(){for(var rt=0;rt<$u.length;rt++){var st=$u[rt];Wn?st._workInProgressVersionPrimary=null:st._workInProgressVersionSecondary=null}$u.length=0}var Wl=_e.ReactCurrentDispatcher,Ss=_e.ReactCurrentBatchConfig,Bo=0,Ur=null,Zr=null,Yr=null,Xl=!1,xa=!1,ga=0,Rx=0;function qr(){throw Error(b(321))}function Xu(rt,st){if(st===null)return!1;for(var pt=0;pt<st.length&&pt<rt.length;pt++)if(!Ps(rt[pt],st[pt]))return!1;return!0}function Ku(rt,st,pt,gt,bt,Rt){if(Bo=Rt,Ur=st,st.memoizedState=null,st.updateQueue=null,st.lanes=0,Wl.current=rt===null||rt.memoizedState===null?jx:Nx,rt=pt(gt,bt),xa){Rt=0;do{if(xa=!1,ga=0,25<=Rt)throw Error(b(301));Rt+=1,Yr=Zr=null,st.updateQueue=null,Wl.current=Px,rt=pt(gt,bt)}while(xa)}if(Wl.current=Zl,st=Zr!==null&&Zr.next!==null,Bo=0,Yr=Zr=Ur=null,Xl=!1,st)throw Error(b(300));return rt}function Yu(){var rt=ga!==0;return ga=0,rt}function Ws(){var rt={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Yr===null?Ur.memoizedState=Yr=rt:Yr=Yr.next=rt,Yr}function Ds(){if(Zr===null){var rt=Ur.alternate;rt=rt!==null?rt.memoizedState:null}else rt=Zr.next;var st=Yr===null?Ur.memoizedState:Yr.next;if(st!==null)Yr=st,Zr=rt;else{if(rt===null)throw Error(b(310));Zr=rt,rt={memoizedState:Zr.memoizedState,baseState:Zr.baseState,baseQueue:Zr.baseQueue,queue:Zr.queue,next:null},Yr===null?Ur.memoizedState=Yr=rt:Yr=Yr.next=rt}return Yr}function fo(rt,st){return typeof st=="function"?st(rt):st}function Kl(rt){var st=Ds(),pt=st.queue;if(pt===null)throw Error(b(311));pt.lastRenderedReducer=rt;var gt=Zr,bt=gt.baseQueue,Rt=pt.pending;if(Rt!==null){if(bt!==null){var $t=bt.next;bt.next=Rt.next,Rt.next=$t}gt.baseQueue=bt=Rt,pt.pending=null}if(bt!==null){Rt=bt.next,gt=gt.baseState;var en=$t=null,yn=null,In=Rt;do{var tr=In.lane;if((Bo&tr)===tr)yn!==null&&(yn=yn.next={lane:0,action:In.action,hasEagerState:In.hasEagerState,eagerState:In.eagerState,next:null}),gt=In.hasEagerState?In.eagerState:rt(gt,In.action);else{var fr={lane:tr,action:In.action,hasEagerState:In.hasEagerState,eagerState:In.eagerState,next:null};yn===null?(en=yn=fr,$t=gt):yn=yn.next=fr,Ur.lanes|=tr,Fo|=tr}In=In.next}while(In!==null&&In!==Rt);yn===null?$t=gt:yn.next=en,Ps(gt,st.memoizedState)||(ms=!0),st.memoizedState=gt,st.baseState=$t,st.baseQueue=yn,pt.lastRenderedState=gt}if(rt=pt.interleaved,rt!==null){bt=rt;do Rt=bt.lane,Ur.lanes|=Rt,Fo|=Rt,bt=bt.next;while(bt!==rt)}else bt===null&&(pt.lanes=0);return[st.memoizedState,pt.dispatch]}function Yl(rt){var st=Ds(),pt=st.queue;if(pt===null)throw Error(b(311));pt.lastRenderedReducer=rt;var gt=pt.dispatch,bt=pt.pending,Rt=st.memoizedState;if(bt!==null){pt.pending=null;var $t=bt=bt.next;do Rt=rt(Rt,$t.action),$t=$t.next;while($t!==bt);Ps(Rt,st.memoizedState)||(ms=!0),st.memoizedState=Rt,st.baseQueue===null&&(st.baseState=Rt),pt.lastRenderedState=Rt}return[Rt,gt]}function Wp(){}function Xp(rt,st){var pt=Ur,gt=Ds(),bt=st(),Rt=!Ps(gt.memoizedState,bt);if(Rt&&(gt.memoizedState=bt,ms=!0),gt=gt.queue,$a(Jp.bind(null,pt,gt,rt),[rt]),gt.getSnapshot!==st||Rt||Yr!==null&&Yr.memoizedState.tag&1){if(pt.flags|=2048,ba(9,Yp.bind(null,pt,gt,bt,st),void 0,null),Hr===null)throw Error(b(349));Bo&30||Kp(pt,st,bt)}return bt}function Kp(rt,st,pt){rt.flags|=16384,rt={getSnapshot:st,value:pt},st=Ur.updateQueue,st===null?(st={lastEffect:null,stores:null},Ur.updateQueue=st,st.stores=[rt]):(pt=st.stores,pt===null?st.stores=[rt]:pt.push(rt))}function Yp(rt,st,pt,gt){st.value=pt,st.getSnapshot=gt,Qp(st)&&bs(rt,1,-1)}function Jp(rt,st,pt){return pt(function(){Qp(st)&&bs(rt,1,-1)})}function Qp(rt){var st=rt.getSnapshot;rt=rt.value;try{var pt=st();return!Ps(rt,pt)}catch{return!0}}function Ju(rt){var st=Ws();return typeof rt=="function"&&(rt=rt()),st.memoizedState=st.baseState=rt,rt={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:fo,lastRenderedState:rt},st.queue=rt,rt=rt.dispatch=Tx.bind(null,Ur,rt),[st.memoizedState,rt]}function ba(rt,st,pt,gt){return rt={tag:rt,create:st,destroy:pt,deps:gt,next:null},st=Ur.updateQueue,st===null?(st={lastEffect:null,stores:null},Ur.updateQueue=st,st.lastEffect=rt.next=rt):(pt=st.lastEffect,pt===null?st.lastEffect=rt.next=rt:(gt=pt.next,pt.next=rt,rt.next=gt,st.lastEffect=rt)),rt}function Zp(){return Ds().memoizedState}function Jl(rt,st,pt,gt){var bt=Ws();Ur.flags|=rt,bt.memoizedState=ba(1|st,pt,void 0,gt===void 0?null:gt)}function Ql(rt,st,pt,gt){var bt=Ds();gt=gt===void 0?null:gt;var Rt=void 0;if(Zr!==null){var $t=Zr.memoizedState;if(Rt=$t.destroy,gt!==null&&Xu(gt,$t.deps)){bt.memoizedState=ba(st,pt,Rt,gt);return}}Ur.flags|=rt,bt.memoizedState=ba(1|st,pt,Rt,gt)}function Qu(rt,st){return Jl(8390656,8,rt,st)}function $a(rt,st){return Ql(2048,8,rt,st)}function qp(rt,st){return Ql(4,2,rt,st)}function _f(rt,st){return Ql(4,4,rt,st)}function em(rt,st){if(typeof st=="function")return rt=rt(),st(rt),function(){st(null)};if(st!=null)return rt=rt(),st.current=rt,function(){st.current=null}}function tm(rt,st,pt){return pt=pt!=null?pt.concat([rt]):null,Ql(4,4,em.bind(null,st,rt),pt)}function Zu(){}function nm(rt,st){var pt=Ds();st=st===void 0?null:st;var gt=pt.memoizedState;return gt!==null&&st!==null&&Xu(st,gt[1])?gt[0]:(pt.memoizedState=[rt,st],rt)}function rm(rt,st){var pt=Ds();st=st===void 0?null:st;var gt=pt.memoizedState;return gt!==null&&st!==null&&Xu(st,gt[1])?gt[0]:(rt=rt(),pt.memoizedState=[rt,st],rt)}function Ax(rt,st){var pt=Ar;Ar=pt!==0&&4>pt?pt:4,rt(!0);var gt=Ss.transition;Ss.transition={};try{rt(!1),st()}finally{Ar=pt,Ss.transition=gt}}function im(){return Ds().memoizedState}function Cx(rt,st,pt){var gt=eo(rt);pt={lane:gt,action:pt,hasEagerState:!1,eagerState:null,next:null},sm(rt)?om(st,pt):(am(rt,st,pt),pt=os(),rt=bs(rt,gt,pt),rt!==null&&lm(rt,st,gt))}function Tx(rt,st,pt){var gt=eo(rt),bt={lane:gt,action:pt,hasEagerState:!1,eagerState:null,next:null};if(sm(rt))om(st,bt);else{am(rt,st,bt);var Rt=rt.alternate;if(rt.lanes===0&&(Rt===null||Rt.lanes===0)&&(Rt=st.lastRenderedReducer,Rt!==null))try{var $t=st.lastRenderedState,en=Rt($t,pt);if(bt.hasEagerState=!0,bt.eagerState=en,Ps(en,$t))return}catch{}finally{}pt=os(),rt=bs(rt,gt,pt),rt!==null&&lm(rt,st,gt)}}function sm(rt){var st=rt.alternate;return rt===Ur||st!==null&&st===Ur}function om(rt,st){xa=Xl=!0;var pt=rt.pending;pt===null?st.next=st:(st.next=pt.next,pt.next=st),rt.pending=st}function am(rt,st,pt){Hr!==null&&rt.mode&1&&!(Sr&2)?(rt=st.interleaved,rt===null?(pt.next=pt,Ls===null?Ls=[st]:Ls.push(st)):(pt.next=rt.next,rt.next=pt),st.interleaved=pt):(rt=st.pending,rt===null?pt.next=pt:(pt.next=rt.next,rt.next=pt),st.pending=pt)}function lm(rt,st,pt){if(pt&4194240){var gt=st.lanes;gt&=rt.pendingLanes,pt|=gt,st.lanes=pt,Ru(rt,pt)}}var Zl={readContext:ys,useCallback:qr,useContext:qr,useEffect:qr,useImperativeHandle:qr,useInsertionEffect:qr,useLayoutEffect:qr,useMemo:qr,useReducer:qr,useRef:qr,useState:qr,useDebugValue:qr,useDeferredValue:qr,useTransition:qr,useMutableSource:qr,useSyncExternalStore:qr,useId:qr,unstable_isNewReconciler:!1},jx={readContext:ys,useCallback:function(rt,st){return Ws().memoizedState=[rt,st===void 0?null:st],rt},useContext:ys,useEffect:Qu,useImperativeHandle:function(rt,st,pt){return pt=pt!=null?pt.concat([rt]):null,Jl(4194308,4,em.bind(null,st,rt),pt)},useLayoutEffect:function(rt,st){return Jl(4194308,4,rt,st)},useInsertionEffect:function(rt,st){return Jl(4,2,rt,st)},useMemo:function(rt,st){var pt=Ws();return st=st===void 0?null:st,rt=rt(),pt.memoizedState=[rt,st],rt},useReducer:function(rt,st,pt){var gt=Ws();return st=pt!==void 0?pt(st):st,gt.memoizedState=gt.baseState=st,rt={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:rt,lastRenderedState:st},gt.queue=rt,rt=rt.dispatch=Cx.bind(null,Ur,rt),[gt.memoizedState,rt]},useRef:function(rt){var st=Ws();return rt={current:rt},st.memoizedState=rt},useState:Ju,useDebugValue:Zu,useDeferredValue:function(rt){var st=Ju(rt),pt=st[0],gt=st[1];return Qu(function(){var bt=Ss.transition;Ss.transition={};try{gt(rt)}finally{Ss.transition=bt}},[rt]),pt},useTransition:function(){var rt=Ju(!1),st=rt[0];return rt=Ax.bind(null,rt[1]),Ws().memoizedState=rt,[st,rt]},useMutableSource:function(){},useSyncExternalStore:function(rt,st,pt){var gt=Ur,bt=Ws();if(Fr){if(pt===void 0)throw Error(b(407));pt=pt()}else{if(pt=st(),Hr===null)throw Error(b(349));Bo&30||Kp(gt,st,pt)}bt.memoizedState=pt;var Rt={value:pt,getSnapshot:st};return bt.queue=Rt,Qu(Jp.bind(null,gt,Rt,rt),[rt]),gt.flags|=2048,ba(9,Yp.bind(null,gt,Rt,pt,st),void 0,null),pt},useId:function(){var rt=Ws(),st=Hr.identifierPrefix;if(Fr){var pt=$s,gt=Vs;pt=(gt&~(1<<32-wr(gt)-1)).toString(32)+pt,st=":"+st+"R"+pt,pt=ga++,0<pt&&(st+="H"+pt.toString(32)),st+=":"}else pt=Rx++,st=":"+st+"r"+pt.toString(32)+":";return rt.memoizedState=st},unstable_isNewReconciler:!1},Nx={readContext:ys,useCallback:nm,useContext:ys,useEffect:$a,useImperativeHandle:tm,useInsertionEffect:qp,useLayoutEffect:_f,useMemo:rm,useReducer:Kl,useRef:Zp,useState:function(){return Kl(fo)},useDebugValue:Zu,useDeferredValue:function(rt){var st=Kl(fo),pt=st[0],gt=st[1];return $a(function(){var bt=Ss.transition;Ss.transition={};try{gt(rt)}finally{Ss.transition=bt}},[rt]),pt},useTransition:function(){var rt=Kl(fo)[0],st=Ds().memoizedState;return[rt,st]},useMutableSource:Wp,useSyncExternalStore:Xp,useId:im,unstable_isNewReconciler:!1},Px={readContext:ys,useCallback:nm,useContext:ys,useEffect:$a,useImperativeHandle:tm,useInsertionEffect:qp,useLayoutEffect:_f,useMemo:rm,useReducer:Yl,useRef:Zp,useState:function(){return Yl(fo)},useDebugValue:Zu,useDeferredValue:function(rt){var st=Yl(fo),pt=st[0],gt=st[1];return $a(function(){var bt=Ss.transition;Ss.transition={};try{gt(rt)}finally{Ss.transition=bt}},[rt]),pt},useTransition:function(){var rt=Yl(fo)[0],st=Ds().memoizedState;return[rt,st]},useMutableSource:Wp,useSyncExternalStore:Xp,useId:im,unstable_isNewReconciler:!1};function qu(rt,st){try{var pt="",gt=st;do pt+=Mx(gt),gt=gt.return;while(gt);var bt=pt}catch(Rt){bt=`
Error generating stack: `+Rt.message+`
`+Rt.stack}return{value:rt,source:st,stack:bt}}function _d(rt,st){try{console.error(st.value)}catch(pt){setTimeout(function(){throw pt})}}var Ix=typeof WeakMap=="function"?WeakMap:Map;function cm(rt,st,pt){pt=Hs(-1,pt),pt.tag=3,pt.payload={element:null};var gt=st.value;return pt.callback=function(){fu||(fu=!0,xp=gt),_d(rt,st)},pt}function um(rt,st,pt){pt=Hs(-1,pt),pt.tag=3;var gt=rt.type.getDerivedStateFromError;if(typeof gt=="function"){var bt=st.value;pt.payload=function(){return gt(bt)},pt.callback=function(){_d(rt,st)}}var Rt=rt.stateNode;return Rt!==null&&typeof Rt.componentDidCatch=="function"&&(pt.callback=function(){_d(rt,st),typeof gt!="function"&&(Zs===null?Zs=new Set([this]):Zs.add(this));var $t=st.stack;this.componentDidCatch(st.value,{componentStack:$t!==null?$t:""})}),pt}function dm(rt,st,pt){var gt=rt.pingCache;if(gt===null){gt=rt.pingCache=new Ix;var bt=new Set;gt.set(st,bt)}else bt=gt.get(st),bt===void 0&&(bt=new Set,gt.set(st,bt));bt.has(pt)||(bt.add(pt),rt=Xx.bind(null,rt,st,pt),st.then(rt,rt))}function hm(rt){do{var st;if((st=rt.tag===13)&&(st=rt.memoizedState,st=st!==null?st.dehydrated!==null:!0),st)return rt;rt=rt.return}while(rt!==null);return null}function pm(rt,st,pt,gt,bt){return rt.mode&1?(rt.flags|=65536,rt.lanes=bt,rt):(rt===st?rt.flags|=65536:(rt.flags|=128,pt.flags|=131072,pt.flags&=-52805,pt.tag===1&&(pt.alternate===null?pt.tag=17:(st=Hs(-1,1),st.tag=2,Qs(pt,st))),pt.lanes|=1),rt)}function Fs(rt){rt.flags|=4}function fm(rt,st){if(rt!==null&&rt.child===st.child)return!0;if(st.flags&16)return!1;for(rt=st.child;rt!==null;){if(rt.flags&12854||rt.subtreeFlags&12854)return!1;rt=rt.sibling}return!0}var xl,yl,_c,eu;if(Bn)xl=function(rt,st){for(var pt=st.child;pt!==null;){if(pt.tag===5||pt.tag===6)Wt(rt,pt.stateNode);else if(pt.tag!==4&&pt.child!==null){pt.child.return=pt,pt=pt.child;continue}if(pt===st)break;for(;pt.sibling===null;){if(pt.return===null||pt.return===st)return;pt=pt.return}pt.sibling.return=pt.return,pt=pt.sibling}},yl=function(){},_c=function(rt,st,pt,gt,bt){if(rt=rt.memoizedProps,rt!==gt){var Rt=st.stateNode,$t=Bs(_s.current);pt=Bt(Rt,pt,rt,gt,bt,$t),(st.updateQueue=pt)&&Fs(st)}},eu=function(rt,st,pt,gt){pt!==gt&&Fs(st)};else if(gn){xl=function(rt,st,pt,gt){for(var bt=st.child;bt!==null;){if(bt.tag===5){var Rt=bt.stateNode;pt&&gt&&(Rt=yr(Rt,bt.type,bt.memoizedProps,bt)),Wt(rt,Rt)}else if(bt.tag===6)Rt=bt.stateNode,pt&&gt&&(Rt=Or(Rt,bt.memoizedProps,bt)),Wt(rt,Rt);else if(bt.tag!==4){if(bt.tag===22&&bt.memoizedState!==null)Rt=bt.child,Rt!==null&&(Rt.return=bt),xl(rt,bt,!0,!0);else if(bt.child!==null){bt.child.return=bt,bt=bt.child;continue}}if(bt===st)break;for(;bt.sibling===null;){if(bt.return===null||bt.return===st)return;bt=bt.return}bt.sibling.return=bt.return,bt=bt.sibling}};var mm=function(rt,st,pt,gt){for(var bt=st.child;bt!==null;){if(bt.tag===5){var Rt=bt.stateNode;pt&&gt&&(Rt=yr(Rt,bt.type,bt.memoizedProps,bt)),ur(rt,Rt)}else if(bt.tag===6)Rt=bt.stateNode,pt&&gt&&(Rt=Or(Rt,bt.memoizedProps,bt)),ur(rt,Rt);else if(bt.tag!==4){if(bt.tag===22&&bt.memoizedState!==null)Rt=bt.child,Rt!==null&&(Rt.return=bt),mm(rt,bt,!0,!0);else if(bt.child!==null){bt.child.return=bt,bt=bt.child;continue}}if(bt===st)break;for(;bt.sibling===null;){if(bt.return===null||bt.return===st)return;bt=bt.return}bt.sibling.return=bt.return,bt=bt.sibling}};yl=function(rt,st){var pt=st.stateNode;if(!fm(rt,st)){rt=pt.containerInfo;var gt=Gn(rt);mm(gt,st,!1,!1),pt.pendingChildren=gt,Fs(st),Mr(rt,gt)}},_c=function(rt,st,pt,gt,bt){var Rt=rt.stateNode,$t=rt.memoizedProps;if((rt=fm(rt,st))&&$t===gt)st.stateNode=Rt;else{var en=st.stateNode,yn=Bs(_s.current),In=null;$t!==gt&&(In=Bt(en,pt,$t,gt,bt,yn)),rt&&In===null?st.stateNode=Rt:(Rt=Vn(Rt,In,pt,$t,gt,st,rt,en),sn(Rt,pt,gt,bt,yn)&&Fs(st),st.stateNode=Rt,rt?Fs(st):xl(Rt,st,!1,!1))}},eu=function(rt,st,pt,gt){pt!==gt?(rt=Bs(Io.current),pt=Bs(_s.current),st.stateNode=cn(gt,rt,pt,st),Fs(st)):st.stateNode=rt.stateNode}}else yl=function(){},_c=function(){},eu=function(){};function El(rt,st){if(!Fr)switch(rt.tailMode){case"hidden":st=rt.tail;for(var pt=null;st!==null;)st.alternate!==null&&(pt=st),st=st.sibling;pt===null?rt.tail=null:pt.sibling=null;break;case"collapsed":pt=rt.tail;for(var gt=null;pt!==null;)pt.alternate!==null&&(gt=pt),pt=pt.sibling;gt===null?st||rt.tail===null?rt.tail=null:rt.tail.sibling=null:gt.sibling=null}}function _i(rt){var st=rt.alternate!==null&&rt.alternate.child===rt.child,pt=0,gt=0;if(st)for(var bt=rt.child;bt!==null;)pt|=bt.lanes|bt.childLanes,gt|=bt.subtreeFlags&14680064,gt|=bt.flags&14680064,bt.return=rt,bt=bt.sibling;else for(bt=rt.child;bt!==null;)pt|=bt.lanes|bt.childLanes,gt|=bt.subtreeFlags,gt|=bt.flags,bt.return=rt,bt=bt.sibling;return rt.subtreeFlags|=gt,rt.childLanes=pt,st}function Lx(rt,st,pt){var gt=st.pendingProps;switch(Ou(st),st.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return _i(st),null;case 1:return Lr(st.type)&&jr(),_i(st),null;case 3:return gt=st.stateNode,Lo(),Yn(hr),Yn(Dn),Wu(),gt.pendingContext&&(gt.context=gt.pendingContext,gt.pendingContext=null),(rt===null||rt.child===null)&&(Qo(st)?Fs(st):rt===null||rt.memoizedState.isDehydrated&&!(st.flags&256)||(st.flags|=1024,Cs!==null&&(vp(Cs),Cs=null))),yl(rt,st),_i(st),null;case 5:Vu(st),pt=Bs(Io.current);var bt=st.type;if(rt!==null&&st.stateNode!=null)_c(rt,st,bt,gt,pt),rt.ref!==st.ref&&(st.flags|=512,st.flags|=2097152);else{if(!gt){if(st.stateNode===null)throw Error(b(166));return _i(st),null}if(rt=Bs(_s.current),Qo(st)){if(!bn)throw Error(b(175));rt=Tt(st.stateNode,st.type,st.memoizedProps,pt,rt,st,!Jo),st.updateQueue=rt,rt!==null&&Fs(st)}else{var Rt=Pt(bt,gt,pt,rt,st);xl(Rt,st,!1,!1),st.stateNode=Rt,sn(Rt,bt,gt,pt,rt)&&Fs(st)}st.ref!==null&&(st.flags|=512,st.flags|=2097152)}return _i(st),null;case 6:if(rt&&st.stateNode!=null)eu(rt,st,rt.memoizedProps,gt);else{if(typeof gt!="string"&&st.stateNode===null)throw Error(b(166));if(rt=Bs(Io.current),pt=Bs(_s.current),Qo(st)){if(!bn)throw Error(b(176));if(rt=st.stateNode,gt=st.memoizedProps,(pt=Dt(rt,gt,st,!Jo))&&(bt=ps,bt!==null))switch(Rt=(bt.mode&1)!==0,bt.tag){case 3:Xt(bt.stateNode.containerInfo,rt,gt,Rt);break;case 5:rn(bt.type,bt.memoizedProps,bt.stateNode,rt,gt,Rt)}pt&&Fs(st)}else st.stateNode=cn(gt,rt,pt,st)}return _i(st),null;case 13:if(Yn(kr),gt=st.memoizedState,Fr&&fs!==null&&st.mode&1&&!(st.flags&128)){for(rt=fs;rt;)rt=ls(rt);return No(),st.flags|=98560,st}if(gt!==null&&gt.dehydrated!==null){if(gt=Qo(st),rt===null){if(!gt)throw Error(b(318));if(!bn)throw Error(b(344));if(rt=st.memoizedState,rt=rt!==null?rt.dehydrated:null,!rt)throw Error(b(317));Zt(rt,st)}else No(),!(st.flags&128)&&(st.memoizedState=null),st.flags|=4;return _i(st),null}return Cs!==null&&(vp(Cs),Cs=null),st.flags&128?(st.lanes=pt,st):(gt=gt!==null,pt=!1,rt===null?Qo(st):pt=rt.memoizedState!==null,gt&&!pt&&(st.child.flags|=8192,st.mode&1&&(rt===null||kr.current&1?$r===0&&($r=3):_p())),st.updateQueue!==null&&(st.flags|=4),_i(st),null);case 4:return Lo(),yl(rt,st),rt===null&&Jn(st.stateNode.containerInfo),_i(st),null;case 10:return Iu(st.type._context),_i(st),null;case 17:return Lr(st.type)&&jr(),_i(st),null;case 19:if(Yn(kr),bt=st.memoizedState,bt===null)return _i(st),null;if(gt=(st.flags&128)!==0,Rt=bt.rendering,Rt===null)if(gt)El(bt,!1);else{if($r!==0||rt!==null&&rt.flags&128)for(rt=st.child;rt!==null;){if(Rt=$l(rt),Rt!==null){for(st.flags|=128,El(bt,!1),rt=Rt.updateQueue,rt!==null&&(st.updateQueue=rt,st.flags|=4),st.subtreeFlags=0,rt=pt,gt=st.child;gt!==null;)pt=gt,bt=rt,pt.flags&=14680066,Rt=pt.alternate,Rt===null?(pt.childLanes=0,pt.lanes=bt,pt.child=null,pt.subtreeFlags=0,pt.memoizedProps=null,pt.memoizedState=null,pt.updateQueue=null,pt.dependencies=null,pt.stateNode=null):(pt.childLanes=Rt.childLanes,pt.lanes=Rt.lanes,pt.child=Rt.child,pt.subtreeFlags=0,pt.deletions=null,pt.memoizedProps=Rt.memoizedProps,pt.memoizedState=Rt.memoizedState,pt.updateQueue=Rt.updateQueue,pt.type=Rt.type,bt=Rt.dependencies,pt.dependencies=bt===null?null:{lanes:bt.lanes,firstContext:bt.firstContext}),gt=gt.sibling;return ar(kr,kr.current&1|2),st.child}rt=rt.sibling}bt.tail!==null&&Kr()>mp&&(st.flags|=128,gt=!0,El(bt,!1),st.lanes=4194304)}else{if(!gt)if(rt=$l(Rt),rt!==null){if(st.flags|=128,gt=!0,rt=rt.updateQueue,rt!==null&&(st.updateQueue=rt,st.flags|=4),El(bt,!0),bt.tail===null&&bt.tailMode==="hidden"&&!Rt.alternate&&!Fr)return _i(st),null}else 2*Kr()-bt.renderingStartTime>mp&&pt!==1073741824&&(st.flags|=128,gt=!0,El(bt,!1),st.lanes=4194304);bt.isBackwards?(Rt.sibling=st.child,st.child=Rt):(rt=bt.last,rt!==null?rt.sibling=Rt:st.child=Rt,bt.last=Rt)}return bt.tail!==null?(st=bt.tail,bt.rendering=st,bt.tail=st.sibling,bt.renderingStartTime=Kr(),st.sibling=null,rt=kr.current,ar(kr,gt?rt&1|2:rt&1),st):(_i(st),null);case 22:case 23:return Ep(),gt=st.memoizedState!==null,rt!==null&&rt.memoizedState!==null!==gt&&(st.flags|=8192),gt&&st.mode&1?xs&1073741824&&(_i(st),Bn&&st.subtreeFlags&6&&(st.flags|=8192)):_i(st),null;case 24:return null;case 25:return null}throw Error(b(156,st.tag))}var Bx=_e.ReactCurrentOwner,ms=!1;function ss(rt,st,pt,gt){st.child=rt===null?Vp(st,null,pt,gt):Po(st,rt.child,pt,gt)}function xm(rt,st,pt,gt,bt){pt=pt.render;var Rt=st.ref;return Co(st,bt),gt=Ku(rt,st,pt,gt,Rt,bt),pt=Yu(),rt!==null&&!ms?(st.updateQueue=rt.updateQueue,st.flags&=-2053,rt.lanes&=~bt,Xs(rt,st,bt)):(Fr&&pt&&ku(st),st.flags|=1,ss(rt,st,gt,bt),st.child)}function gm(rt,st,pt,gt,bt){if(rt===null){var Rt=pt.type;return typeof Rt=="function"&&!Sp(Rt)&&Rt.defaultProps===void 0&&pt.compare===null&&pt.defaultProps===void 0?(st.tag=15,st.type=Rt,ym(rt,st,Rt,gt,bt)):(rt=_u(pt.type,null,gt,st,st.mode,bt),rt.ref=st.ref,rt.return=st,st.child=rt)}if(Rt=rt.child,!(rt.lanes&bt)){var $t=Rt.memoizedProps;if(pt=pt.compare,pt=pt!==null?pt:Bl,pt($t,gt)&&rt.ref===st.ref)return Xs(rt,st,bt)}return st.flags|=1,rt=no(Rt,gt),rt.ref=st.ref,rt.return=st,st.child=rt}function ym(rt,st,pt,gt,bt){if(rt!==null&&Bl(rt.memoizedProps,gt)&&rt.ref===st.ref)if(ms=!1,(rt.lanes&bt)!==0)rt.flags&131072&&(ms=!0);else return st.lanes=rt.lanes,Xs(rt,st,bt);return _h(rt,st,pt,gt,bt)}function vm(rt,st,pt){var gt=st.pendingProps,bt=gt.children,Rt=rt!==null?rt.memoizedState:null;if(gt.mode==="hidden")if(!(st.mode&1))st.memoizedState={baseLanes:0,cachePool:null},ar(Do,xs),xs|=pt;else if(pt&1073741824)st.memoizedState={baseLanes:0,cachePool:null},gt=Rt!==null?Rt.baseLanes:pt,ar(Do,xs),xs|=gt;else return rt=Rt!==null?Rt.baseLanes|pt:pt,st.lanes=st.childLanes=1073741824,st.memoizedState={baseLanes:rt,cachePool:null},st.updateQueue=null,ar(Do,xs),xs|=rt,null;else Rt!==null?(gt=Rt.baseLanes|pt,st.memoizedState=null):gt=pt,ar(Do,xs),xs|=gt;return ss(rt,st,bt,pt),st.child}function Em(rt,st){var pt=st.ref;(rt===null&&pt!==null||rt!==null&&rt.ref!==pt)&&(st.flags|=512,st.flags|=2097152)}function _h(rt,st,pt,gt,bt){var Rt=Lr(pt)?lr:Dn.current;return Rt=Pr(st,Rt),Co(st,bt),pt=Ku(rt,st,pt,gt,Rt,bt),gt=Yu(),rt!==null&&!ms?(st.updateQueue=rt.updateQueue,st.flags&=-2053,rt.lanes&=~bt,Xs(rt,st,bt)):(Fr&&gt&&ku(st),st.flags|=1,ss(rt,st,pt,bt),st.child)}function _m(rt,st,pt,gt,bt){if(Lr(pt)){var Rt=!0;vr(st)}else Rt=!1;if(Co(st,bt),st.stateNode===null)rt!==null&&(rt.alternate=null,st.alternate=null,st.flags|=2),Dp(st,pt,gt),Fu(st,pt,gt,bt),gt=!0;else if(rt===null){var $t=st.stateNode,en=st.memoizedProps;$t.props=en;var yn=$t.context,In=pt.contextType;typeof In=="object"&&In!==null?In=ys(In):(In=Lr(pt)?lr:Dn.current,In=Pr(st,In));var tr=pt.getDerivedStateFromProps,fr=typeof tr=="function"||typeof $t.getSnapshotBeforeUpdate=="function";fr||typeof $t.UNSAFE_componentWillReceiveProps!="function"&&typeof $t.componentWillReceiveProps!="function"||(en!==gt||yn!==In)&&Fp(st,$t,gt,In),Js=!1;var dr=st.memoizedState;$t.state=dr,Ul(st,gt,$t,bt),yn=st.memoizedState,en!==gt||dr!==yn||hr.current||Js?(typeof tr=="function"&&(Du(st,pt,tr,gt),yn=st.memoizedState),(en=Js||Bp(st,pt,en,gt,dr,yn,In))?(fr||typeof $t.UNSAFE_componentWillMount!="function"&&typeof $t.componentWillMount!="function"||(typeof $t.componentWillMount=="function"&&$t.componentWillMount(),typeof $t.UNSAFE_componentWillMount=="function"&&$t.UNSAFE_componentWillMount()),typeof $t.componentDidMount=="function"&&(st.flags|=4194308)):(typeof $t.componentDidMount=="function"&&(st.flags|=4194308),st.memoizedProps=gt,st.memoizedState=yn),$t.props=gt,$t.state=yn,$t.context=In,gt=en):(typeof $t.componentDidMount=="function"&&(st.flags|=4194308),gt=!1)}else{$t=st.stateNode,Np(rt,st),en=st.memoizedProps,In=st.type===st.elementType?en:As(st.type,en),$t.props=In,fr=st.pendingProps,dr=$t.context,yn=pt.contextType,typeof yn=="object"&&yn!==null?yn=ys(yn):(yn=Lr(pt)?lr:Dn.current,yn=Pr(st,yn));var Br=pt.getDerivedStateFromProps;(tr=typeof Br=="function"||typeof $t.getSnapshotBeforeUpdate=="function")||typeof $t.UNSAFE_componentWillReceiveProps!="function"&&typeof $t.componentWillReceiveProps!="function"||(en!==fr||dr!==yn)&&Fp(st,$t,gt,yn),Js=!1,dr=st.memoizedState,$t.state=dr,Ul(st,gt,$t,bt);var cr=st.memoizedState;en!==fr||dr!==cr||hr.current||Js?(typeof Br=="function"&&(Du(st,pt,Br,gt),cr=st.memoizedState),(In=Js||Bp(st,pt,In,gt,dr,cr,yn)||!1)?(tr||typeof $t.UNSAFE_componentWillUpdate!="function"&&typeof $t.componentWillUpdate!="function"||(typeof $t.componentWillUpdate=="function"&&$t.componentWillUpdate(gt,cr,yn),typeof $t.UNSAFE_componentWillUpdate=="function"&&$t.UNSAFE_componentWillUpdate(gt,cr,yn)),typeof $t.componentDidUpdate=="function"&&(st.flags|=4),typeof $t.getSnapshotBeforeUpdate=="function"&&(st.flags|=1024)):(typeof $t.componentDidUpdate!="function"||en===rt.memoizedProps&&dr===rt.memoizedState||(st.flags|=4),typeof $t.getSnapshotBeforeUpdate!="function"||en===rt.memoizedProps&&dr===rt.memoizedState||(st.flags|=1024),st.memoizedProps=gt,st.memoizedState=cr),$t.props=gt,$t.state=cr,$t.context=yn,gt=In):(typeof $t.componentDidUpdate!="function"||en===rt.memoizedProps&&dr===rt.memoizedState||(st.flags|=4),typeof $t.getSnapshotBeforeUpdate!="function"||en===rt.memoizedProps&&dr===rt.memoizedState||(st.flags|=1024),gt=!1)}return ep(rt,st,pt,gt,Rt,bt)}function ep(rt,st,pt,gt,bt,Rt){Em(rt,st);var $t=(st.flags&128)!==0;if(!gt&&!$t)return bt&&br(st,pt,!1),Xs(rt,st,Rt);gt=st.stateNode,Bx.current=st;var en=$t&&typeof pt.getDerivedStateFromError!="function"?null:gt.render();return st.flags|=1,rt!==null&&$t?(st.child=Po(st,rt.child,null,Rt),st.child=Po(st,null,en,Rt)):ss(rt,st,en,Rt),st.memoizedState=gt.state,bt&&br(st,pt,!0),st.child}function Sm(rt){var st=rt.stateNode;st.pendingContext?Rr(rt,st.pendingContext,st.pendingContext!==st.context):st.context&&Rr(rt,st.context,!1),Hu(rt,st.containerInfo)}function bm(rt,st,pt,gt,bt){return No(),zu(bt),st.flags|=256,ss(rt,st,pt,gt),st.child}var tu={dehydrated:null,treeContext:null,retryLane:0};function nu(rt){return{baseLanes:rt,cachePool:null}}function wm(rt,st,pt){var gt=st.pendingProps,bt=kr.current,Rt=!1,$t=(st.flags&128)!==0,en;if((en=$t)||(en=rt!==null&&rt.memoizedState===null?!1:(bt&2)!==0),en?(Rt=!0,st.flags&=-129):(rt===null||rt.memoizedState!==null)&&(bt|=1),ar(kr,bt&1),rt===null)return Gu(st),rt=st.memoizedState,rt!==null&&(rt=rt.dehydrated,rt!==null)?(st.mode&1?Gs(rt)?st.lanes=8:st.lanes=1073741824:st.lanes=1,null):(bt=gt.children,rt=gt.fallback,Rt?(gt=st.mode,Rt=st.child,bt={mode:"hidden",children:bt},!(gt&1)&&Rt!==null?(Rt.childLanes=0,Rt.pendingProps=bt):Rt=Su(bt,gt,0,null),rt=Eo(rt,gt,pt,null),Rt.return=st,rt.return=st,Rt.sibling=rt,st.child=Rt,st.child.memoizedState=nu(pt),st.memoizedState=tu,rt):tp(st,bt));if(bt=rt.memoizedState,bt!==null){if(en=bt.dehydrated,en!==null){if($t)return st.flags&256?(st.flags&=-257,ru(rt,st,pt,Error(b(422)))):st.memoizedState!==null?(st.child=rt.child,st.flags|=128,null):(Rt=gt.fallback,bt=st.mode,gt=Su({mode:"visible",children:gt.children},bt,0,null),Rt=Eo(Rt,bt,pt,null),Rt.flags|=2,gt.return=st,Rt.return=st,gt.sibling=Rt,st.child=gt,st.mode&1&&Po(st,rt.child,null,pt),st.child.memoizedState=nu(pt),st.memoizedState=tu,Rt);if(!(st.mode&1))st=ru(rt,st,pt,null);else if(Gs(en))st=ru(rt,st,pt,Error(b(419)));else if(gt=(pt&rt.childLanes)!==0,ms||gt){if(gt=Hr,gt!==null){switch(pt&-pt){case 4:Rt=2;break;case 16:Rt=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:Rt=32;break;case 536870912:Rt=268435456;break;default:Rt=0}gt=Rt&(gt.suspendedLanes|pt)?0:Rt,gt!==0&&gt!==bt.retryLane&&(bt.retryLane=gt,bs(rt,gt,-1))}_p(),st=ru(rt,st,pt,Error(b(421)))}else rs(en)?(st.flags|=128,st.child=rt.child,st=Kx.bind(null,rt),js(en,st),st=null):(pt=bt.treeContext,bn&&(fs=Ys(en),ps=st,Fr=!0,Cs=null,Jo=!1,pt!==null&&(vs[Es++]=Vs,vs[Es++]=$s,vs[Es++]=ho,Vs=pt.id,$s=pt.overflow,ho=st)),st=tp(st,st.pendingProps.children),st.flags|=4096);return st}return Rt?(gt=Rm(rt,st,gt.children,gt.fallback,pt),Rt=st.child,bt=rt.child.memoizedState,Rt.memoizedState=bt===null?nu(pt):{baseLanes:bt.baseLanes|pt,cachePool:null},Rt.childLanes=rt.childLanes&~pt,st.memoizedState=tu,gt):(pt=Mm(rt,st,gt.children,pt),st.memoizedState=null,pt)}return Rt?(gt=Rm(rt,st,gt.children,gt.fallback,pt),Rt=st.child,bt=rt.child.memoizedState,Rt.memoizedState=bt===null?nu(pt):{baseLanes:bt.baseLanes|pt,cachePool:null},Rt.childLanes=rt.childLanes&~pt,st.memoizedState=tu,gt):(pt=Mm(rt,st,gt.children,pt),st.memoizedState=null,pt)}function tp(rt,st){return st=Su({mode:"visible",children:st},rt.mode,0,null),st.return=rt,rt.child=st}function Mm(rt,st,pt,gt){var bt=rt.child;return rt=bt.sibling,pt=no(bt,{mode:"visible",children:pt}),!(st.mode&1)&&(pt.lanes=gt),pt.return=st,pt.sibling=null,rt!==null&&(gt=st.deletions,gt===null?(st.deletions=[rt],st.flags|=16):gt.push(rt)),st.child=pt}function Rm(rt,st,pt,gt,bt){var Rt=st.mode;rt=rt.child;var $t=rt.sibling,en={mode:"hidden",children:pt};return!(Rt&1)&&st.child!==rt?(pt=st.child,pt.childLanes=0,pt.pendingProps=en,st.deletions=null):(pt=no(rt,en),pt.subtreeFlags=rt.subtreeFlags&14680064),$t!==null?gt=no($t,gt):(gt=Eo(gt,Rt,bt,null),gt.flags|=2),gt.return=st,pt.return=st,pt.sibling=gt,st.child=pt,gt}function ru(rt,st,pt,gt){return gt!==null&&zu(gt),Po(st,rt.child,null,pt),rt=tp(st,st.pendingProps.children),rt.flags|=2,st.memoizedState=null,rt}function Am(rt,st,pt){rt.lanes|=st;var gt=rt.alternate;gt!==null&&(gt.lanes|=st),Lu(rt.return,st,pt)}function np(rt,st,pt,gt,bt){var Rt=rt.memoizedState;Rt===null?rt.memoizedState={isBackwards:st,rendering:null,renderingStartTime:0,last:gt,tail:pt,tailMode:bt}:(Rt.isBackwards=st,Rt.rendering=null,Rt.renderingStartTime=0,Rt.last=gt,Rt.tail=pt,Rt.tailMode=bt)}function Cm(rt,st,pt){var gt=st.pendingProps,bt=gt.revealOrder,Rt=gt.tail;if(ss(rt,st,gt.children,pt),gt=kr.current,gt&2)gt=gt&1|2,st.flags|=128;else{if(rt!==null&&rt.flags&128)e:for(rt=st.child;rt!==null;){if(rt.tag===13)rt.memoizedState!==null&&Am(rt,pt,st);else if(rt.tag===19)Am(rt,pt,st);else if(rt.child!==null){rt.child.return=rt,rt=rt.child;continue}if(rt===st)break e;for(;rt.sibling===null;){if(rt.return===null||rt.return===st)break e;rt=rt.return}rt.sibling.return=rt.return,rt=rt.sibling}gt&=1}if(ar(kr,gt),!(st.mode&1))st.memoizedState=null;else switch(bt){case"forwards":for(pt=st.child,bt=null;pt!==null;)rt=pt.alternate,rt!==null&&$l(rt)===null&&(bt=pt),pt=pt.sibling;pt=bt,pt===null?(bt=st.child,st.child=null):(bt=pt.sibling,pt.sibling=null),np(st,!1,bt,pt,Rt);break;case"backwards":for(pt=null,bt=st.child,st.child=null;bt!==null;){if(rt=bt.alternate,rt!==null&&$l(rt)===null){st.child=bt;break}rt=bt.sibling,bt.sibling=pt,pt=bt,bt=rt}np(st,!0,pt,null,Rt);break;case"together":np(st,!1,null,null,void 0);break;default:st.memoizedState=null}return st.child}function Xs(rt,st,pt){if(rt!==null&&(st.dependencies=rt.dependencies),Fo|=st.lanes,!(pt&st.childLanes))return null;if(rt!==null&&st.child!==rt.child)throw Error(b(153));if(st.child!==null){for(rt=st.child,pt=no(rt,rt.pendingProps),st.child=pt,pt.return=st;rt.sibling!==null;)rt=rt.sibling,pt=pt.sibling=no(rt,rt.pendingProps),pt.return=st;pt.sibling=null}return st.child}function Dx(rt,st,pt){switch(st.tag){case 3:Sm(st),No();break;case 5:$p(st);break;case 1:Lr(st.type)&&vr(st);break;case 4:Hu(st,st.stateNode.containerInfo);break;case 10:jp(st,st.type._context,st.memoizedProps.value);break;case 13:var gt=st.memoizedState;if(gt!==null)return gt.dehydrated!==null?(ar(kr,kr.current&1),st.flags|=128,null):pt&st.child.childLanes?wm(rt,st,pt):(ar(kr,kr.current&1),rt=Xs(rt,st,pt),rt!==null?rt.sibling:null);ar(kr,kr.current&1);break;case 19:if(gt=(pt&st.childLanes)!==0,rt.flags&128){if(gt)return Cm(rt,st,pt);st.flags|=128}var bt=st.memoizedState;if(bt!==null&&(bt.rendering=null,bt.tail=null,bt.lastEffect=null),ar(kr,kr.current),gt)break;return null;case 22:case 23:return st.lanes=0,vm(rt,st,pt)}return Xs(rt,st,pt)}function Fx(rt,st){switch(Ou(st),st.tag){case 1:return Lr(st.type)&&jr(),rt=st.flags,rt&65536?(st.flags=rt&-65537|128,st):null;case 3:return Lo(),Yn(hr),Yn(Dn),Wu(),rt=st.flags,rt&65536&&!(rt&128)?(st.flags=rt&-65537|128,st):null;case 5:return Vu(st),null;case 13:if(Yn(kr),rt=st.memoizedState,rt!==null&&rt.dehydrated!==null){if(st.alternate===null)throw Error(b(340));No()}return rt=st.flags,rt&65536?(st.flags=rt&-65537|128,st):null;case 19:return Yn(kr),null;case 4:return Lo(),null;case 10:return Iu(st.type._context),null;case 22:case 23:return Ep(),null;case 24:return null;default:return null}}var iu=!1,mo=!1,kx=typeof WeakSet=="function"?WeakSet:Set,$n=null;function su(rt,st){var pt=rt.ref;if(pt!==null)if(typeof pt=="function")try{pt(null)}catch(gt){ds(rt,st,gt)}else pt.current=null}function rp(rt,st,pt){try{pt()}catch(gt){ds(rt,st,gt)}}var Tm=!1;function Ox(rt,st){for(Ut(rt.containerInfo),$n=st;$n!==null;)if(rt=$n,st=rt.child,(rt.subtreeFlags&1028)!==0&&st!==null)st.return=rt,$n=st;else for(;$n!==null;){rt=$n;try{var pt=rt.alternate;if(rt.flags&1024)switch(rt.tag){case 0:case 11:case 15:break;case 1:if(pt!==null){var gt=pt.memoizedProps,bt=pt.memoizedState,Rt=rt.stateNode,$t=Rt.getSnapshotBeforeUpdate(rt.elementType===rt.type?gt:As(rt.type,gt),bt);Rt.__reactInternalSnapshotBeforeUpdate=$t}break;case 3:Bn&&_n(rt.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(b(163))}}catch(en){ds(rt,rt.return,en)}if(st=rt.sibling,st!==null){st.return=rt.return,$n=st;break}$n=rt.return}return pt=Tm,Tm=!1,pt}function xo(rt,st,pt){var gt=st.updateQueue;if(gt=gt!==null?gt.lastEffect:null,gt!==null){var bt=gt=gt.next;do{if((bt.tag&rt)===rt){var Rt=bt.destroy;bt.destroy=void 0,Rt!==void 0&&rp(st,pt,Rt)}bt=bt.next}while(bt!==gt)}}function _l(rt,st){if(st=st.updateQueue,st=st!==null?st.lastEffect:null,st!==null){var pt=st=st.next;do{if((pt.tag&rt)===rt){var gt=pt.create;pt.destroy=gt()}pt=pt.next}while(pt!==st)}}function ip(rt){var st=rt.ref;if(st!==null){var pt=rt.stateNode;switch(rt.tag){case 5:rt=Ot(pt);break;default:rt=pt}typeof st=="function"?st(rt):st.current=rt}}function jm(rt,st,pt){if(Ns&&typeof Ns.onCommitFiberUnmount=="function")try{Ns.onCommitFiberUnmount(Il,st)}catch{}switch(st.tag){case 0:case 11:case 14:case 15:if(rt=st.updateQueue,rt!==null&&(rt=rt.lastEffect,rt!==null)){var gt=rt=rt.next;do{var bt=gt,Rt=bt.destroy;bt=bt.tag,Rt!==void 0&&(bt&2||bt&4)&&rp(st,pt,Rt),gt=gt.next}while(gt!==rt)}break;case 1:if(su(st,pt),rt=st.stateNode,typeof rt.componentWillUnmount=="function")try{rt.props=st.memoizedProps,rt.state=st.memoizedState,rt.componentWillUnmount()}catch($t){ds(st,pt,$t)}break;case 5:su(st,pt);break;case 4:Bn?Dm(rt,st,pt):gn&&gn&&(st=st.stateNode.containerInfo,pt=Gn(st),Ir(st,pt))}}function Nm(rt,st,pt){for(var gt=st;;)if(jm(rt,gt,pt),gt.child===null||Bn&&gt.tag===4){if(gt===st)break;for(;gt.sibling===null;){if(gt.return===null||gt.return===st)return;gt=gt.return}gt.sibling.return=gt.return,gt=gt.sibling}else gt.child.return=gt,gt=gt.child}function Pm(rt){var st=rt.alternate;st!==null&&(rt.alternate=null,Pm(st)),rt.child=null,rt.deletions=null,rt.sibling=null,rt.tag===5&&(st=rt.stateNode,st!==null&&kn(st)),rt.stateNode=null,rt.return=null,rt.dependencies=null,rt.memoizedProps=null,rt.memoizedState=null,rt.pendingProps=null,rt.stateNode=null,rt.updateQueue=null}function Im(rt){return rt.tag===5||rt.tag===3||rt.tag===4}function Lm(rt){e:for(;;){for(;rt.sibling===null;){if(rt.return===null||Im(rt.return))return null;rt=rt.return}for(rt.sibling.return=rt.return,rt=rt.sibling;rt.tag!==5&&rt.tag!==6&&rt.tag!==18;){if(rt.flags&2||rt.child===null||rt.tag===4)continue e;rt.child.return=rt,rt=rt.child}if(!(rt.flags&2))return rt.stateNode}}function Bm(rt){if(Bn){e:{for(var st=rt.return;st!==null;){if(Im(st))break e;st=st.return}throw Error(b(160))}var pt=st;switch(pt.tag){case 5:st=pt.stateNode,pt.flags&32&&(fn(st),pt.flags&=-33),pt=Lm(rt),op(rt,pt,st);break;case 3:case 4:st=pt.stateNode.containerInfo,pt=Lm(rt),sp(rt,pt,st);break;default:throw Error(b(161))}}}function sp(rt,st,pt){var gt=rt.tag;if(gt===5||gt===6)rt=rt.stateNode,st?er(pt,rt,st):zn(pt,rt);else if(gt!==4&&(rt=rt.child,rt!==null))for(sp(rt,st,pt),rt=rt.sibling;rt!==null;)sp(rt,st,pt),rt=rt.sibling}function op(rt,st,pt){var gt=rt.tag;if(gt===5||gt===6)rt=rt.stateNode,st?sr(pt,rt,st):Fn(pt,rt);else if(gt!==4&&(rt=rt.child,rt!==null))for(op(rt,st,pt),rt=rt.sibling;rt!==null;)op(rt,st,pt),rt=rt.sibling}function Dm(rt,st,pt){for(var gt=st,bt=!1,Rt,$t;;){if(!bt){bt=gt.return;e:for(;;){if(bt===null)throw Error(b(160));switch(Rt=bt.stateNode,bt.tag){case 5:$t=!1;break e;case 3:Rt=Rt.containerInfo,$t=!0;break e;case 4:Rt=Rt.containerInfo,$t=!0;break e}bt=bt.return}bt=!0}if(gt.tag===5||gt.tag===6)Nm(rt,gt,pt),$t?qt(Rt,gt.stateNode):Xn(Rt,gt.stateNode);else if(gt.tag===18)$t?Yt(Rt,gt.stateNode):Vt(Rt,gt.stateNode);else if(gt.tag===4){if(gt.child!==null){Rt=gt.stateNode.containerInfo,$t=!0,gt.child.return=gt,gt=gt.child;continue}}else if(jm(rt,gt,pt),gt.child!==null){gt.child.return=gt,gt=gt.child;continue}if(gt===st)break;for(;gt.sibling===null;){if(gt.return===null||gt.return===st)return;gt=gt.return,gt.tag===4&&(bt=!1)}gt.sibling.return=gt.return,gt=gt.sibling}}function ap(rt,st){if(Bn){switch(st.tag){case 0:case 11:case 14:case 15:xo(3,st,st.return),_l(3,st),xo(5,st,st.return);return;case 1:return;case 5:var pt=st.stateNode;if(pt!=null){var gt=st.memoizedProps;rt=rt!==null?rt.memoizedProps:gt;var bt=st.type,Rt=st.updateQueue;st.updateQueue=null,Rt!==null&&Qn(pt,Rt,bt,rt,gt,st)}return;case 6:if(st.stateNode===null)throw Error(b(162));pt=st.memoizedProps,xr(st.stateNode,rt!==null?rt.memoizedProps:pt,pt);return;case 3:bn&&rt!==null&&rt.memoizedState.isDehydrated&&mn(st.stateNode.containerInfo);return;case 12:return;case 13:ou(st);return;case 19:ou(st);return;case 17:return}throw Error(b(163))}switch(st.tag){case 0:case 11:case 14:case 15:xo(3,st,st.return),_l(3,st),xo(5,st,st.return);return;case 12:return;case 13:ou(st);return;case 19:ou(st);return;case 3:bn&&rt!==null&&rt.memoizedState.isDehydrated&&mn(st.stateNode.containerInfo);break;case 22:case 23:return}e:if(gn){switch(st.tag){case 1:case 5:case 6:break e;case 3:case 4:st=st.stateNode,Ir(st.containerInfo,st.pendingChildren);break e}throw Error(b(163))}}function ou(rt){var st=rt.updateQueue;if(st!==null){rt.updateQueue=null;var pt=rt.stateNode;pt===null&&(pt=rt.stateNode=new kx),st.forEach(function(gt){var bt=Yx.bind(null,rt,gt);pt.has(gt)||(pt.add(gt),gt.then(bt,bt))})}}function Ux(rt,st){for($n=st;$n!==null;){st=$n;var pt=st.deletions;if(pt!==null)for(var gt=0;gt<pt.length;gt++){var bt=pt[gt];try{var Rt=rt;Bn?Dm(Rt,bt,st):Nm(Rt,bt,st);var $t=bt.alternate;$t!==null&&($t.return=null),bt.return=null}catch(or){ds(bt,st,or)}}if(pt=st.child,st.subtreeFlags&12854&&pt!==null)pt.return=st,$n=pt;else for(;$n!==null;){st=$n;try{var en=st.flags;if(en&32&&Bn&&fn(st.stateNode),en&512){var yn=st.alternate;if(yn!==null){var In=yn.ref;In!==null&&(typeof In=="function"?In(null):In.current=null)}}if(en&8192)switch(st.tag){case 13:if(st.memoizedState!==null){var tr=st.alternate;(tr===null||tr.memoizedState===null)&&(fp=Kr())}break;case 22:var fr=st.memoizedState!==null,dr=st.alternate,Br=dr!==null&&dr.memoizedState!==null;if(pt=st,Bn){e:if(gt=pt,bt=fr,Rt=null,Bn)for(var cr=gt;;){if(cr.tag===5){if(Rt===null){Rt=cr;var es=cr.stateNode;bt?jn(es):an(cr.stateNode,cr.memoizedProps)}}else if(cr.tag===6){if(Rt===null){var Ms=cr.stateNode;bt?Qt(Ms):hn(Ms,cr.memoizedProps)}}else if((cr.tag!==22&&cr.tag!==23||cr.memoizedState===null||cr===gt)&&cr.child!==null){cr.child.return=cr,cr=cr.child;continue}if(cr===gt)break;for(;cr.sibling===null;){if(cr.return===null||cr.return===gt)break e;Rt===cr&&(Rt=null),cr=cr.return}Rt===cr&&(Rt=null),cr.sibling.return=cr.return,cr=cr.sibling}}if(fr&&!Br&&pt.mode&1){$n=pt;for(var un=pt.child;un!==null;){for(pt=$n=un;$n!==null;){gt=$n;var nn=gt.child;switch(gt.tag){case 0:case 11:case 14:case 15:xo(4,gt,gt.return);break;case 1:su(gt,gt.return);var pn=gt.stateNode;if(typeof pn.componentWillUnmount=="function"){var Kn=gt.return;try{pn.props=gt.memoizedProps,pn.state=gt.memoizedState,pn.componentWillUnmount()}catch(or){ds(gt,Kn,or)}}break;case 5:su(gt,gt.return);break;case 22:if(gt.memoizedState!==null){Om(pt);continue}}nn!==null?(nn.return=gt,$n=nn):Om(pt)}un=un.sibling}}}switch(en&4102){case 2:Bm(st),st.flags&=-3;break;case 6:Bm(st),st.flags&=-3,ap(st.alternate,st);break;case 4096:st.flags&=-4097;break;case 4100:st.flags&=-4097,ap(st.alternate,st);break;case 4:ap(st.alternate,st)}}catch(or){ds(st,st.return,or)}if(pt=st.sibling,pt!==null){pt.return=st.return,$n=pt;break}$n=st.return}}}function Gx(rt,st,pt){$n=rt,Fm(rt)}function Fm(rt,st,pt){for(var gt=(rt.mode&1)!==0;$n!==null;){var bt=$n,Rt=bt.child;if(bt.tag===22&&gt){var $t=bt.memoizedState!==null||iu;if(!$t){var en=bt.alternate,yn=en!==null&&en.memoizedState!==null||mo;en=iu;var In=mo;if(iu=$t,(mo=yn)&&!In)for($n=bt;$n!==null;)$t=$n,yn=$t.child,$t.tag===22&&$t.memoizedState!==null?Um(bt):yn!==null?(yn.return=$t,$n=yn):Um(bt);for(;Rt!==null;)$n=Rt,Fm(Rt),Rt=Rt.sibling;$n=bt,iu=en,mo=In}km(rt)}else bt.subtreeFlags&8772&&Rt!==null?(Rt.return=bt,$n=Rt):km(rt)}}function km(rt){for(;$n!==null;){var st=$n;if(st.flags&8772){var pt=st.alternate;try{if(st.flags&8772)switch(st.tag){case 0:case 11:case 15:mo||_l(5,st);break;case 1:var gt=st.stateNode;if(st.flags&4&&!mo)if(pt===null)gt.componentDidMount();else{var bt=st.elementType===st.type?pt.memoizedProps:As(st.type,pt.memoizedProps);gt.componentDidUpdate(bt,pt.memoizedState,gt.__reactInternalSnapshotBeforeUpdate)}var Rt=st.updateQueue;Rt!==null&&Ip(st,Rt,gt);break;case 3:var $t=st.updateQueue;if($t!==null){if(pt=null,st.child!==null)switch(st.child.tag){case 5:pt=Ot(st.child.stateNode);break;case 1:pt=st.child.stateNode}Ip(st,$t,pt)}break;case 5:var en=st.stateNode;pt===null&&st.flags&4&&Tn(en,st.type,st.memoizedProps,st);break;case 6:break;case 4:break;case 12:break;case 13:if(bn&&st.memoizedState===null){var yn=st.alternate;if(yn!==null){var In=yn.memoizedState;if(In!==null){var tr=In.dehydrated;tr!==null&&At(tr)}}}break;case 19:case 17:case 21:case 22:case 23:break;default:throw Error(b(163))}mo||st.flags&512&&ip(st)}catch(fr){ds(st,st.return,fr)}}if(st===rt){$n=null;break}if(pt=st.sibling,pt!==null){pt.return=st.return,$n=pt;break}$n=st.return}}function Om(rt){for(;$n!==null;){var st=$n;if(st===rt){$n=null;break}var pt=st.sibling;if(pt!==null){pt.return=st.return,$n=pt;break}$n=st.return}}function Um(rt){for(;$n!==null;){var st=$n;try{switch(st.tag){case 0:case 11:case 15:var pt=st.return;try{_l(4,st)}catch(yn){ds(st,pt,yn)}break;case 1:var gt=st.stateNode;if(typeof gt.componentDidMount=="function"){var bt=st.return;try{gt.componentDidMount()}catch(yn){ds(st,bt,yn)}}var Rt=st.return;try{ip(st)}catch(yn){ds(st,Rt,yn)}break;case 5:var $t=st.return;try{ip(st)}catch(yn){ds(st,$t,yn)}}}catch(yn){ds(st,st.return,yn)}if(st===rt){$n=null;break}var en=st.sibling;if(en!==null){en.return=st.return,$n=en;break}$n=st.return}}var au=0,lu=1,cu=2,uu=3,du=4;if(typeof Symbol=="function"&&Symbol.for){var Sl=Symbol.for;au=Sl("selector.component"),lu=Sl("selector.has_pseudo_class"),cu=Sl("selector.role"),uu=Sl("selector.test_id"),du=Sl("selector.text")}function lp(rt){var st=Kt(rt);if(st!=null){if(typeof st.memoizedProps["data-testname"]!="string")throw Error(b(364));return st}if(rt=zt(rt),rt===null)throw Error(b(362));return rt.stateNode.current}function cp(rt,st){switch(st.$$typeof){case au:if(rt.type===st.value)return!0;break;case lu:e:{st=st.value,rt=[rt,0];for(var pt=0;pt<rt.length;){var gt=rt[pt++],bt=rt[pt++],Rt=st[bt];if(gt.tag!==5||!xn(gt)){for(;Rt!=null&&cp(gt,Rt);)bt++,Rt=st[bt];if(bt===st.length){st=!0;break e}else for(gt=gt.child;gt!==null;)rt.push(gt,bt),gt=gt.sibling}}st=!1}return st;case cu:if(rt.tag===5&&wn(rt.stateNode,st.value))return!0;break;case du:if((rt.tag===5||rt.tag===6)&&(rt=on(rt),rt!==null&&0<=rt.indexOf(st.value)))return!0;break;case uu:if(rt.tag===5&&(rt=rt.memoizedProps["data-testname"],typeof rt=="string"&&rt.toLowerCase()===st.value.toLowerCase()))return!0;break;default:throw Error(b(365))}return!1}function up(rt){switch(rt.$$typeof){case au:return"<"+(wt(rt.value)||"Unknown")+">";case lu:return":has("+(up(rt)||"")+")";case cu:return'[role="'+rt.value+'"]';case du:return'"'+rt.value+'"';case uu:return'[data-testname="'+rt.value+'"]';default:throw Error(b(365))}}function Gm(rt,st){var pt=[];rt=[rt,0];for(var gt=0;gt<rt.length;){var bt=rt[gt++],Rt=rt[gt++],$t=st[Rt];if(bt.tag!==5||!xn(bt)){for(;$t!=null&&cp(bt,$t);)Rt++,$t=st[Rt];if(Rt===st.length)pt.push(bt);else for(bt=bt.child;bt!==null;)rt.push(bt,Rt),bt=bt.sibling}}return pt}function dp(rt,st){if(!Un)throw Error(b(363));rt=lp(rt),rt=Gm(rt,st),st=[],rt=Array.from(rt);for(var pt=0;pt<rt.length;){var gt=rt[pt++];if(gt.tag===5)xn(gt)||st.push(gt.stateNode);else for(gt=gt.child;gt!==null;)rt.push(gt),gt=gt.sibling}return st}var zx=Math.ceil,hu=_e.ReactCurrentDispatcher,hp=_e.ReactCurrentOwner,zr=_e.ReactCurrentBatchConfig,Sr=0,Hr=null,Vr=null,Qr=0,xs=0,Do=nr(0),$r=0,wl=null,Fo=0,pu=0,pp=0,Ml=null,cs=null,fp=0,mp=1/0;function ko(){mp=Kr()+500}var fu=!1,xp=null,Zs=null,mu=!1,qs=null,xu=0,Rl=0,gp=null,gu=-1,yu=0;function os(){return Sr&6?Kr():gu!==-1?gu:gu=Kr()}function eo(rt){return rt.mode&1?Sr&2&&Qr!==0?Qr&-Qr:wx.transition!==null?(yu===0&&(rt=Tl,Tl<<=1,!(Tl&4194240)&&(Tl=64),yu=rt),yu):(rt=Ar,rt!==0?rt:Cn()):1}function bs(rt,st,pt){if(50<Rl)throw Rl=0,gp=null,Error(b(185));var gt=vu(rt,st);return gt===null?null:(Yo(gt,st,pt),(!(Sr&2)||gt!==Hr)&&(gt===Hr&&(!(Sr&2)&&(pu|=st),$r===4&&to(gt,Qr)),us(gt,pt),st===1&&Sr===0&&!(rt.mode&1)&&(ko(),Ll&&Is())),gt)}function vu(rt,st){rt.lanes|=st;var pt=rt.alternate;for(pt!==null&&(pt.lanes|=st),pt=rt,rt=rt.return;rt!==null;)rt.childLanes|=st,pt=rt.alternate,pt!==null&&(pt.childLanes|=st),pt=rt,rt=rt.return;return pt.tag===3?pt.stateNode:null}function us(rt,st){var pt=rt.callbackNode;fx(rt,st);var gt=Pl(rt,rt===Hr?Qr:0);if(gt===0)pt!==null&&Cp(pt),rt.callbackNode=null,rt.callbackPriority=0;else if(st=gt&-gt,rt.callbackPriority!==st){if(pt!=null&&Cp(pt),st===1)rt.tag===0?bx(Hm.bind(null,rt)):Tp(Hm.bind(null,rt)),Nn?ir(function(){Sr===0&&Is()}):Au(Cu,Is),pt=null;else{switch(Ap(gt)){case 1:pt=Cu;break;case 4:pt=yx;break;case 16:pt=Tu;break;case 536870912:pt=vx;break;default:pt=Tu}pt=Zm(pt,zm.bind(null,rt))}rt.callbackPriority=st,rt.callbackNode=pt}}function zm(rt,st){if(gu=-1,yu=0,Sr&6)throw Error(b(327));var pt=rt.callbackNode;if(vo()&&rt.callbackNode!==pt)return null;var gt=Pl(rt,rt===Hr?Qr:0);if(gt===0)return null;if(gt&30||gt&rt.expiredLanes||st)st=Eu(rt,gt);else{st=gt;var bt=Sr;Sr|=2;var Rt=Wm();(Hr!==rt||Qr!==st)&&(ko(),go(rt,st));do try{$x();break}catch(en){$m(rt,en)}while(!0);Pu(),hu.current=Rt,Sr=bt,Vr!==null?st=0:(Hr=null,Qr=0,st=$r)}if(st!==0){if(st===2&&(bt=wu(rt),bt!==0&&(gt=bt,st=yp(rt,bt))),st===1)throw pt=wl,go(rt,0),to(rt,gt),us(rt,Kr()),pt;if(st===6)to(rt,gt);else{if(bt=rt.current.alternate,!(gt&30)&&!Hx(bt)&&(st=Eu(rt,gt),st===2&&(Rt=wu(rt),Rt!==0&&(gt=Rt,st=yp(rt,Rt))),st===1))throw pt=wl,go(rt,0),to(rt,gt),us(rt,Kr()),pt;switch(rt.finishedWork=bt,rt.finishedLanes=gt,st){case 0:case 1:throw Error(b(345));case 2:yo(rt,cs);break;case 3:if(to(rt,gt),(gt&130023424)===gt&&(st=fp+500-Kr(),10<st)){if(Pl(rt,0)!==0)break;if(bt=rt.suspendedLanes,(bt&gt)!==gt){os(),rt.pingedLanes|=rt.suspendedLanes&bt;break}rt.timeoutHandle=vn(yo.bind(null,rt,cs),st);break}yo(rt,cs);break;case 4:if(to(rt,gt),(gt&4194240)===gt)break;for(st=rt.eventTimes,bt=-1;0<gt;){var $t=31-wr(gt);Rt=1<<$t,$t=st[$t],$t>bt&&(bt=$t),gt&=~Rt}if(gt=bt,gt=Kr()-gt,gt=(120>gt?120:480>gt?480:1080>gt?1080:1920>gt?1920:3e3>gt?3e3:4320>gt?4320:1960*zx(gt/1960))-gt,10<gt){rt.timeoutHandle=vn(yo.bind(null,rt,cs),gt);break}yo(rt,cs);break;case 5:yo(rt,cs);break;default:throw Error(b(329))}}}return us(rt,Kr()),rt.callbackNode===pt?zm.bind(null,rt):null}function yp(rt,st){var pt=Ml;return rt.current.memoizedState.isDehydrated&&(go(rt,st).flags|=256),rt=Eu(rt,st),rt!==2&&(st=cs,cs=pt,st!==null&&vp(st)),rt}function vp(rt){cs===null?cs=rt:cs.push.apply(cs,rt)}function Hx(rt){for(var st=rt;;){if(st.flags&16384){var pt=st.updateQueue;if(pt!==null&&(pt=pt.stores,pt!==null))for(var gt=0;gt<pt.length;gt++){var bt=pt[gt],Rt=bt.getSnapshot;bt=bt.value;try{if(!Ps(Rt(),bt))return!1}catch{return!1}}}if(pt=st.child,st.subtreeFlags&16384&&pt!==null)pt.return=st,st=pt;else{if(st===rt)break;for(;st.sibling===null;){if(st.return===null||st.return===rt)return!0;st=st.return}st.sibling.return=st.return,st=st.sibling}}return!0}function to(rt,st){for(st&=~pp,st&=~pu,rt.suspendedLanes|=st,rt.pingedLanes&=~st,rt=rt.expirationTimes;0<st;){var pt=31-wr(st),gt=1<<pt;rt[pt]=-1,st&=~gt}}function Hm(rt){if(Sr&6)throw Error(b(327));vo();var st=Pl(rt,0);if(!(st&1))return us(rt,Kr()),null;var pt=Eu(rt,st);if(rt.tag!==0&&pt===2){var gt=wu(rt);gt!==0&&(st=gt,pt=yp(rt,gt))}if(pt===1)throw pt=wl,go(rt,0),to(rt,st),us(rt,Kr()),pt;if(pt===6)throw Error(b(345));return rt.finishedWork=rt.current.alternate,rt.finishedLanes=st,yo(rt,cs),us(rt,Kr()),null}function Vm(rt){qs!==null&&qs.tag===0&&!(Sr&6)&&vo();var st=Sr;Sr|=1;var pt=zr.transition,gt=Ar;try{if(zr.transition=null,Ar=1,rt)return rt()}finally{Ar=gt,zr.transition=pt,Sr=st,!(Sr&6)&&Is()}}function Ep(){xs=Do.current,Yn(Do)}function go(rt,st){rt.finishedWork=null,rt.finishedLanes=0;var pt=rt.timeoutHandle;if(pt!==rr&&(rt.timeoutHandle=rr,On(pt)),Vr!==null)for(pt=Vr.return;pt!==null;){var gt=pt;switch(Ou(gt),gt.tag){case 1:gt=gt.type.childContextTypes,gt!=null&&jr();break;case 3:Lo(),Yn(hr),Yn(Dn),Wu();break;case 5:Vu(gt);break;case 4:Lo();break;case 13:Yn(kr);break;case 19:Yn(kr);break;case 10:Iu(gt.type._context);break;case 22:case 23:Ep()}pt=pt.return}if(Hr=rt,Vr=rt=no(rt.current,null),Qr=xs=st,$r=0,wl=null,pp=pu=Fo=0,cs=Ml=null,Ls!==null){for(st=0;st<Ls.length;st++)if(pt=Ls[st],gt=pt.interleaved,gt!==null){pt.interleaved=null;var bt=gt.next,Rt=pt.pending;if(Rt!==null){var $t=Rt.next;Rt.next=bt,gt.next=$t}pt.pending=gt}Ls=null}return rt}function $m(rt,st){do{var pt=Vr;try{if(Pu(),Wl.current=Zl,Xl){for(var gt=Ur.memoizedState;gt!==null;){var bt=gt.queue;bt!==null&&(bt.pending=null),gt=gt.next}Xl=!1}if(Bo=0,Yr=Zr=Ur=null,xa=!1,ga=0,hp.current=null,pt===null||pt.return===null){$r=1,wl=st,Vr=null;break}e:{var Rt=rt,$t=pt.return,en=pt,yn=st;if(st=Qr,en.flags|=32768,yn!==null&&typeof yn=="object"&&typeof yn.then=="function"){var In=yn,tr=en,fr=tr.tag;if(!(tr.mode&1)&&(fr===0||fr===11||fr===15)){var dr=tr.alternate;dr?(tr.updateQueue=dr.updateQueue,tr.memoizedState=dr.memoizedState,tr.lanes=dr.lanes):(tr.updateQueue=null,tr.memoizedState=null)}var Br=hm($t);if(Br!==null){Br.flags&=-257,pm(Br,$t,en,Rt,st),Br.mode&1&&dm(Rt,In,st),st=Br,yn=In;var cr=st.updateQueue;if(cr===null){var es=new Set;es.add(yn),st.updateQueue=es}else cr.add(yn);break e}else{if(!(st&1)){dm(Rt,In,st),_p();break e}yn=Error(b(426))}}else if(Fr&&en.mode&1){var Ms=hm($t);if(Ms!==null){!(Ms.flags&65536)&&(Ms.flags|=256),pm(Ms,$t,en,Rt,st),zu(yn);break e}}Rt=yn,$r!==4&&($r=2),Ml===null?Ml=[Rt]:Ml.push(Rt),yn=qu(yn,en),en=$t;do{switch(en.tag){case 3:en.flags|=65536,st&=-st,en.lanes|=st;var un=cm(en,yn,st);Pp(en,un);break e;case 1:Rt=yn;var nn=en.type,pn=en.stateNode;if(!(en.flags&128)&&(typeof nn.getDerivedStateFromError=="function"||pn!==null&&typeof pn.componentDidCatch=="function"&&(Zs===null||!Zs.has(pn)))){en.flags|=65536,st&=-st,en.lanes|=st;var Kn=um(en,Rt,st);Pp(en,Kn);break e}}en=en.return}while(en!==null)}Km(pt)}catch(or){st=or,Vr===pt&&pt!==null&&(Vr=pt=pt.return);continue}break}while(!0)}function Wm(){var rt=hu.current;return hu.current=Zl,rt===null?Zl:rt}function _p(){($r===0||$r===3||$r===2)&&($r=4),Hr===null||!(Fo&268435455)&&!(pu&268435455)||to(Hr,Qr)}function Eu(rt,st){var pt=Sr;Sr|=2;var gt=Wm();Hr===rt&&Qr===st||go(rt,st);do try{Vx();break}catch(bt){$m(rt,bt)}while(!0);if(Pu(),Sr=pt,hu.current=gt,Vr!==null)throw Error(b(261));return Hr=null,Qr=0,$r}function Vx(){for(;Vr!==null;)Xm(Vr)}function $x(){for(;Vr!==null&&!xx();)Xm(Vr)}function Xm(rt){var st=Qm(rt.alternate,rt,xs);rt.memoizedProps=rt.pendingProps,st===null?Km(rt):Vr=st,hp.current=null}function Km(rt){var st=rt;do{var pt=st.alternate;if(rt=st.return,st.flags&32768){if(pt=Fx(pt,st),pt!==null){pt.flags&=32767,Vr=pt;return}if(rt!==null)rt.flags|=32768,rt.subtreeFlags=0,rt.deletions=null;else{$r=6,Vr=null;return}}else if(pt=Lx(pt,st,xs),pt!==null){Vr=pt;return}if(st=st.sibling,st!==null){Vr=st;return}Vr=st=rt}while(st!==null);$r===0&&($r=5)}function yo(rt,st){var pt=Ar,gt=zr.transition;try{zr.transition=null,Ar=1,Wx(rt,st,pt)}finally{zr.transition=gt,Ar=pt}return null}function Wx(rt,st,pt){do vo();while(qs!==null);if(Sr&6)throw Error(b(327));var gt=rt.finishedWork,bt=rt.finishedLanes;if(gt===null)return null;if(rt.finishedWork=null,rt.finishedLanes=0,gt===rt.current)throw Error(b(177));rt.callbackNode=null,rt.callbackPriority=0;var Rt=gt.lanes|gt.childLanes;if(mx(rt,Rt),rt===Hr&&(Vr=Hr=null,Qr=0),!(gt.subtreeFlags&2064)&&!(gt.flags&2064)||mu||(mu=!0,Zm(Tu,function(){return vo(),null})),Rt=(gt.flags&15990)!==0,gt.subtreeFlags&15990||Rt){Rt=zr.transition,zr.transition=null;var $t=Ar;Ar=1;var en=Sr;Sr|=4,hp.current=null,Ox(rt,gt),Ux(rt,gt),Gt(rt.containerInfo),rt.current=gt,Gx(gt),gx(),Sr=en,Ar=$t,zr.transition=Rt}else rt.current=gt;if(mu&&(mu=!1,qs=rt,xu=bt),Rt=rt.pendingLanes,Rt===0&&(Zs=null),Ex(gt.stateNode),us(rt,Kr()),st!==null)for(pt=rt.onRecoverableError,gt=0;gt<st.length;gt++)pt(st[gt]);if(fu)throw fu=!1,rt=xp,xp=null,rt;return xu&1&&rt.tag!==0&&vo(),Rt=rt.pendingLanes,Rt&1?rt===gp?Rl++:(Rl=0,gp=rt):Rl=0,Is(),null}function vo(){if(qs!==null){var rt=Ap(xu),st=zr.transition,pt=Ar;try{if(zr.transition=null,Ar=16>rt?16:rt,qs===null)var gt=!1;else{if(rt=qs,qs=null,xu=0,Sr&6)throw Error(b(331));var bt=Sr;for(Sr|=4,$n=rt.current;$n!==null;){var Rt=$n,$t=Rt.child;if($n.flags&16){var en=Rt.deletions;if(en!==null){for(var yn=0;yn<en.length;yn++){var In=en[yn];for($n=In;$n!==null;){var tr=$n;switch(tr.tag){case 0:case 11:case 15:xo(8,tr,Rt)}var fr=tr.child;if(fr!==null)fr.return=tr,$n=fr;else for(;$n!==null;){tr=$n;var dr=tr.sibling,Br=tr.return;if(Pm(tr),tr===In){$n=null;break}if(dr!==null){dr.return=Br,$n=dr;break}$n=Br}}}var cr=Rt.alternate;if(cr!==null){var es=cr.child;if(es!==null){cr.child=null;do{var Ms=es.sibling;es.sibling=null,es=Ms}while(es!==null)}}$n=Rt}}if(Rt.subtreeFlags&2064&&$t!==null)$t.return=Rt,$n=$t;else e:for(;$n!==null;){if(Rt=$n,Rt.flags&2048)switch(Rt.tag){case 0:case 11:case 15:xo(9,Rt,Rt.return)}var un=Rt.sibling;if(un!==null){un.return=Rt.return,$n=un;break e}$n=Rt.return}}var nn=rt.current;for($n=nn;$n!==null;){$t=$n;var pn=$t.child;if($t.subtreeFlags&2064&&pn!==null)pn.return=$t,$n=pn;else e:for($t=nn;$n!==null;){if(en=$n,en.flags&2048)try{switch(en.tag){case 0:case 11:case 15:_l(9,en)}}catch(or){ds(en,en.return,or)}if(en===$t){$n=null;break e}var Kn=en.sibling;if(Kn!==null){Kn.return=en.return,$n=Kn;break e}$n=en.return}}if(Sr=bt,Is(),Ns&&typeof Ns.onPostCommitFiberRoot=="function")try{Ns.onPostCommitFiberRoot(Il,rt)}catch{}gt=!0}return gt}finally{Ar=pt,zr.transition=st}}return!1}function Ym(rt,st,pt){st=qu(pt,st),st=cm(rt,st,1),Qs(rt,st),st=os(),rt=vu(rt,1),rt!==null&&(Yo(rt,1,st),us(rt,st))}function ds(rt,st,pt){if(rt.tag===3)Ym(rt,rt,pt);else for(;st!==null;){if(st.tag===3){Ym(st,rt,pt);break}else if(st.tag===1){var gt=st.stateNode;if(typeof st.type.getDerivedStateFromError=="function"||typeof gt.componentDidCatch=="function"&&(Zs===null||!Zs.has(gt))){rt=qu(pt,rt),rt=um(st,rt,1),Qs(st,rt),rt=os(),st=vu(st,1),st!==null&&(Yo(st,1,rt),us(st,rt));break}}st=st.return}}function Xx(rt,st,pt){var gt=rt.pingCache;gt!==null&&gt.delete(st),st=os(),rt.pingedLanes|=rt.suspendedLanes&pt,Hr===rt&&(Qr&pt)===pt&&($r===4||$r===3&&(Qr&130023424)===Qr&&500>Kr()-fp?go(rt,0):pp|=pt),us(rt,st)}function Jm(rt,st){st===0&&(rt.mode&1?(st=Nl,Nl<<=1,!(Nl&130023424)&&(Nl=4194304)):st=1);var pt=os();rt=vu(rt,st),rt!==null&&(Yo(rt,st,pt),us(rt,pt))}function Kx(rt){var st=rt.memoizedState,pt=0;st!==null&&(pt=st.retryLane),Jm(rt,pt)}function Yx(rt,st){var pt=0;switch(rt.tag){case 13:var gt=rt.stateNode,bt=rt.memoizedState;bt!==null&&(pt=bt.retryLane);break;case 19:gt=rt.stateNode;break;default:throw Error(b(314))}gt!==null&&gt.delete(st),Jm(rt,pt)}var Qm;Qm=function(rt,st,pt){if(rt!==null)if(rt.memoizedProps!==st.pendingProps||hr.current)ms=!0;else{if(!(rt.lanes&pt)&&!(st.flags&128))return ms=!1,Dx(rt,st,pt);ms=!!(rt.flags&131072)}else ms=!1,Fr&&st.flags&1048576&&kp(st,Hl,st.index);switch(st.lanes=0,st.tag){case 2:var gt=st.type;rt!==null&&(rt.alternate=null,st.alternate=null,st.flags|=2),rt=st.pendingProps;var bt=Pr(st,Dn.current);Co(st,pt),bt=Ku(null,st,gt,rt,bt,pt);var Rt=Yu();return st.flags|=1,typeof bt=="object"&&bt!==null&&typeof bt.render=="function"&&bt.$$typeof===void 0?(st.tag=1,st.memoizedState=null,st.updateQueue=null,Lr(gt)?(Rt=!0,vr(st)):Rt=!1,st.memoizedState=bt.state!==null&&bt.state!==void 0?bt.state:null,Bu(st),bt.updater=Gl,st.stateNode=bt,bt._reactInternals=st,Fu(st,gt,rt,pt),st=ep(null,st,gt,!0,Rt,pt)):(st.tag=0,Fr&&Rt&&ku(st),ss(null,st,bt,pt),st=st.child),st;case 16:gt=st.elementType;e:{switch(rt!==null&&(rt.alternate=null,st.alternate=null,st.flags|=2),rt=st.pendingProps,bt=gt._init,gt=bt(gt._payload),st.type=gt,bt=st.tag=Qx(gt),rt=As(gt,rt),bt){case 0:st=_h(null,st,gt,rt,pt);break e;case 1:st=_m(null,st,gt,rt,pt);break e;case 11:st=xm(null,st,gt,rt,pt);break e;case 14:st=gm(null,st,gt,As(gt.type,rt),pt);break e}throw Error(b(306,gt,""))}return st;case 0:return gt=st.type,bt=st.pendingProps,bt=st.elementType===gt?bt:As(gt,bt),_h(rt,st,gt,bt,pt);case 1:return gt=st.type,bt=st.pendingProps,bt=st.elementType===gt?bt:As(gt,bt),_m(rt,st,gt,bt,pt);case 3:e:{if(Sm(st),rt===null)throw Error(b(387));gt=st.pendingProps,Rt=st.memoizedState,bt=Rt.element,Np(rt,st),Ul(st,gt,null,pt);var $t=st.memoizedState;if(gt=$t.element,bn&&Rt.isDehydrated)if(Rt={element:gt,isDehydrated:!1,cache:$t.cache,transitions:$t.transitions},st.updateQueue.baseState=Rt,st.memoizedState=Rt,st.flags&256){bt=Error(b(423)),st=bm(rt,st,gt,pt,bt);break e}else if(gt!==bt){bt=Error(b(424)),st=bm(rt,st,gt,pt,bt);break e}else for(bn&&(fs=uo(st.stateNode.containerInfo),ps=st,Fr=!0,Cs=null,Jo=!1),pt=Vp(st,null,gt,pt),st.child=pt;pt;)pt.flags=pt.flags&-3|4096,pt=pt.sibling;else{if(No(),gt===bt){st=Xs(rt,st,pt);break e}ss(rt,st,gt,pt)}st=st.child}return st;case 5:return $p(st),rt===null&&Gu(st),gt=st.type,bt=st.pendingProps,Rt=rt!==null?rt.memoizedProps:null,$t=bt.children,tn(gt,bt)?$t=null:Rt!==null&&tn(gt,Rt)&&(st.flags|=32),Em(rt,st),ss(rt,st,$t,pt),st.child;case 6:return rt===null&&Gu(st),null;case 13:return wm(rt,st,pt);case 4:return Hu(st,st.stateNode.containerInfo),gt=st.pendingProps,rt===null?st.child=Po(st,null,gt,pt):ss(rt,st,gt,pt),st.child;case 11:return gt=st.type,bt=st.pendingProps,bt=st.elementType===gt?bt:As(gt,bt),xm(rt,st,gt,bt,pt);case 7:return ss(rt,st,st.pendingProps,pt),st.child;case 8:return ss(rt,st,st.pendingProps.children,pt),st.child;case 12:return ss(rt,st,st.pendingProps.children,pt),st.child;case 10:e:{if(gt=st.type._context,bt=st.pendingProps,Rt=st.memoizedProps,$t=bt.value,jp(st,gt,$t),Rt!==null)if(Ps(Rt.value,$t)){if(Rt.children===bt.children&&!hr.current){st=Xs(rt,st,pt);break e}}else for(Rt=st.child,Rt!==null&&(Rt.return=st);Rt!==null;){var en=Rt.dependencies;if(en!==null){$t=Rt.child;for(var yn=en.firstContext;yn!==null;){if(yn.context===gt){if(Rt.tag===1){yn=Hs(-1,pt&-pt),yn.tag=2;var In=Rt.updateQueue;if(In!==null){In=In.shared;var tr=In.pending;tr===null?yn.next=yn:(yn.next=tr.next,tr.next=yn),In.pending=yn}}Rt.lanes|=pt,yn=Rt.alternate,yn!==null&&(yn.lanes|=pt),Lu(Rt.return,pt,st),en.lanes|=pt;break}yn=yn.next}}else if(Rt.tag===10)$t=Rt.type===st.type?null:Rt.child;else if(Rt.tag===18){if($t=Rt.return,$t===null)throw Error(b(341));$t.lanes|=pt,en=$t.alternate,en!==null&&(en.lanes|=pt),Lu($t,pt,st),$t=Rt.sibling}else $t=Rt.child;if($t!==null)$t.return=Rt;else for($t=Rt;$t!==null;){if($t===st){$t=null;break}if(Rt=$t.sibling,Rt!==null){Rt.return=$t.return,$t=Rt;break}$t=$t.return}Rt=$t}ss(rt,st,bt.children,pt),st=st.child}return st;case 9:return bt=st.type,gt=st.pendingProps.children,Co(st,pt),bt=ys(bt),gt=gt(bt),st.flags|=1,ss(rt,st,gt,pt),st.child;case 14:return gt=st.type,bt=As(gt,st.pendingProps),bt=As(gt.type,bt),gm(rt,st,gt,bt,pt);case 15:return ym(rt,st,st.type,st.pendingProps,pt);case 17:return gt=st.type,bt=st.pendingProps,bt=st.elementType===gt?bt:As(gt,bt),rt!==null&&(rt.alternate=null,st.alternate=null,st.flags|=2),st.tag=1,Lr(gt)?(rt=!0,vr(st)):rt=!1,Co(st,pt),Dp(st,gt,bt),Fu(st,gt,bt,pt),ep(null,st,gt,!0,rt,pt);case 19:return Cm(rt,st,pt);case 22:return vm(rt,st,pt)}throw Error(b(156,st.tag))};function Zm(rt,st){return Au(rt,st)}function Jx(rt,st,pt,gt){this.tag=rt,this.key=pt,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=st,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=gt,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ws(rt,st,pt,gt){return new Jx(rt,st,pt,gt)}function Sp(rt){return rt=rt.prototype,!(!rt||!rt.isReactComponent)}function Qx(rt){if(typeof rt=="function")return Sp(rt)?1:0;if(rt!=null){if(rt=rt.$$typeof,rt===ft)return 11;if(rt===ht)return 14}return 2}function no(rt,st){var pt=rt.alternate;return pt===null?(pt=ws(rt.tag,st,rt.key,rt.mode),pt.elementType=rt.elementType,pt.type=rt.type,pt.stateNode=rt.stateNode,pt.alternate=rt,rt.alternate=pt):(pt.pendingProps=st,pt.type=rt.type,pt.flags=0,pt.subtreeFlags=0,pt.deletions=null),pt.flags=rt.flags&14680064,pt.childLanes=rt.childLanes,pt.lanes=rt.lanes,pt.child=rt.child,pt.memoizedProps=rt.memoizedProps,pt.memoizedState=rt.memoizedState,pt.updateQueue=rt.updateQueue,st=rt.dependencies,pt.dependencies=st===null?null:{lanes:st.lanes,firstContext:st.firstContext},pt.sibling=rt.sibling,pt.index=rt.index,pt.ref=rt.ref,pt}function _u(rt,st,pt,gt,bt,Rt){var $t=2;if(gt=rt,typeof rt=="function")Sp(rt)&&($t=1);else if(typeof rt=="string")$t=5;else e:switch(rt){case it:return Eo(pt.children,bt,Rt,st);case ot:$t=8,bt|=8;break;case at:return rt=ws(12,pt,st,bt|2),rt.elementType=at,rt.lanes=Rt,rt;case dt:return rt=ws(13,pt,st,bt),rt.elementType=dt,rt.lanes=Rt,rt;case lt:return rt=ws(19,pt,st,bt),rt.elementType=lt,rt.lanes=Rt,rt;case xt:return Su(pt,bt,Rt,st);default:if(typeof rt=="object"&&rt!==null)switch(rt.$$typeof){case ct:$t=10;break e;case ut:$t=9;break e;case ft:$t=11;break e;case ht:$t=14;break e;case mt:$t=16,gt=null;break e}throw Error(b(130,rt==null?rt:typeof rt,""))}return st=ws($t,pt,st,bt),st.elementType=rt,st.type=gt,st.lanes=Rt,st}function Eo(rt,st,pt,gt){return rt=ws(7,rt,gt,st),rt.lanes=pt,rt}function Su(rt,st,pt,gt){return rt=ws(22,rt,gt,st),rt.elementType=xt,rt.lanes=pt,rt.stateNode={},rt}function bp(rt,st,pt){return rt=ws(6,rt,null,st),rt.lanes=pt,rt}function wp(rt,st,pt){return st=ws(4,rt.children!==null?rt.children:[],rt.key,st),st.lanes=pt,st.stateNode={containerInfo:rt.containerInfo,pendingChildren:null,implementation:rt.implementation},st}function Zx(rt,st,pt,gt,bt){this.tag=st,this.containerInfo=rt,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=rr,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Mu(0),this.expirationTimes=Mu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Mu(0),this.identifierPrefix=gt,this.onRecoverableError=bt,bn&&(this.mutableSourceEagerHydrationData=null)}function qm(rt,st,pt,gt,bt,Rt,$t,en,yn){return rt=new Zx(rt,st,pt,en,yn),st===1?(st=1,Rt===!0&&(st|=8)):st=0,Rt=ws(3,null,null,st),rt.current=Rt,Rt.stateNode=rt,Rt.memoizedState={element:gt,isDehydrated:pt,cache:null,transitions:null},Bu(Rt),rt}function ex(rt){if(!rt)return qn;rt=rt._reactInternals;e:{if(_t(rt)!==rt||rt.tag!==1)throw Error(b(170));var st=rt;do{switch(st.tag){case 3:st=st.stateNode.context;break e;case 1:if(Lr(st.type)){st=st.stateNode.__reactInternalMemoizedMergedChildContext;break e}}st=st.return}while(st!==null);throw Error(b(171))}if(rt.tag===1){var pt=rt.type;if(Lr(pt))return pr(rt,pt,st)}return st}function tx(rt){var st=rt._reactInternals;if(st===void 0)throw typeof rt.render=="function"?Error(b(188)):(rt=Object.keys(rt).join(","),Error(b(268,rt)));return rt=jt(st),rt===null?null:rt.stateNode}function nx(rt,st){if(rt=rt.memoizedState,rt!==null&&rt.dehydrated!==null){var pt=rt.retryLane;rt.retryLane=pt!==0&&pt<st?pt:st}}function Mp(rt,st){nx(rt,st),(rt=rt.alternate)&&nx(rt,st)}function qx(rt){return rt=jt(rt),rt===null?null:rt.stateNode}function _g(){return null}return s.attemptContinuousHydration=function(rt){if(rt.tag===13){var st=os();bs(rt,134217728,st),Mp(rt,134217728)}},s.attemptHydrationAtCurrentPriority=function(rt){if(rt.tag===13){var st=os(),pt=eo(rt);bs(rt,pt,st),Mp(rt,pt)}},s.attemptSynchronousHydration=function(rt){switch(rt.tag){case 3:var st=rt.stateNode;if(st.current.memoizedState.isDehydrated){var pt=Ko(st.pendingLanes);pt!==0&&(Ru(st,pt|1),us(st,Kr()),!(Sr&6)&&(ko(),Is()))}break;case 13:var gt=os();Vm(function(){return bs(rt,1,gt)}),Mp(rt,1)}},s.batchedUpdates=function(rt,st){var pt=Sr;Sr|=1;try{return rt(st)}finally{Sr=pt,Sr===0&&(ko(),Ll&&Is())}},s.createComponentSelector=function(rt){return{$$typeof:au,value:rt}},s.createContainer=function(rt,st,pt,gt,bt,Rt,$t){return qm(rt,st,!1,null,pt,gt,bt,Rt,$t)},s.createHasPseudoClassSelector=function(rt){return{$$typeof:lu,value:rt}},s.createHydrationContainer=function(rt,st,pt,gt,bt,Rt,$t,en,yn){return rt=qm(pt,gt,!0,rt,bt,Rt,$t,en,yn),rt.context=ex(null),pt=rt.current,gt=os(),bt=eo(pt),Rt=Hs(gt,bt),Rt.callback=st??null,Qs(pt,Rt),rt.current.lanes=bt,Yo(rt,bt,gt),us(rt,gt),rt},s.createPortal=function(rt,st,pt){var gt=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:nt,key:gt==null?null:""+gt,children:rt,containerInfo:st,implementation:pt}},s.createRoleSelector=function(rt){return{$$typeof:cu,value:rt}},s.createTestNameSelector=function(rt){return{$$typeof:uu,value:rt}},s.createTextSelector=function(rt){return{$$typeof:du,value:rt}},s.deferredUpdates=function(rt){var st=Ar,pt=zr.transition;try{return zr.transition=null,Ar=16,rt()}finally{Ar=st,zr.transition=pt}},s.discreteUpdates=function(rt,st,pt,gt,bt){var Rt=Ar,$t=zr.transition;try{return zr.transition=null,Ar=1,rt(st,pt,gt,bt)}finally{Ar=Rt,zr.transition=$t,Sr===0&&ko()}},s.findAllNodes=dp,s.findBoundingRects=function(rt,st){if(!Un)throw Error(b(363));st=dp(rt,st),rt=[];for(var pt=0;pt<st.length;pt++)rt.push(It(st[pt]));for(st=rt.length-1;0<st;st--){pt=rt[st];for(var gt=pt.x,bt=gt+pt.width,Rt=pt.y,$t=Rt+pt.height,en=st-1;0<=en;en--)if(st!==en){var yn=rt[en],In=yn.x,tr=In+yn.width,fr=yn.y,dr=fr+yn.height;if(gt>=In&&Rt>=fr&&bt<=tr&&$t<=dr){rt.splice(st,1);break}else if(gt!==In||pt.width!==yn.width||dr<Rt||fr>$t){if(!(Rt!==fr||pt.height!==yn.height||tr<gt||In>bt)){In>gt&&(yn.width+=In-gt,yn.x=gt),tr<bt&&(yn.width=bt-In),rt.splice(st,1);break}}else{fr>Rt&&(yn.height+=fr-Rt,yn.y=Rt),dr<$t&&(yn.height=$t-fr),rt.splice(st,1);break}}}return rt},s.findHostInstance=tx,s.findHostInstanceWithNoPortals=function(rt){return rt=Mt(rt),rt=rt!==null?Nt(rt):null,rt===null?null:rt.stateNode},s.findHostInstanceWithWarning=function(rt){return tx(rt)},s.flushControlled=function(rt){var st=Sr;Sr|=1;var pt=zr.transition,gt=Ar;try{zr.transition=null,Ar=1,rt()}finally{Ar=gt,zr.transition=pt,Sr=st,Sr===0&&(ko(),Is())}},s.flushPassiveEffects=vo,s.flushSync=Vm,s.focusWithin=function(rt,st){if(!Un)throw Error(b(363));for(rt=lp(rt),st=Gm(rt,st),st=Array.from(st),rt=0;rt<st.length;){var pt=st[rt++];if(!xn(pt)){if(pt.tag===5&&En(pt.stateNode))return!0;for(pt=pt.child;pt!==null;)st.push(pt),pt=pt.sibling}}return!1},s.getCurrentUpdatePriority=function(){return Ar},s.getFindAllNodesFailureDescription=function(rt,st){if(!Un)throw Error(b(363));var pt=0,gt=[];rt=[lp(rt),0];for(var bt=0;bt<rt.length;){var Rt=rt[bt++],$t=rt[bt++],en=st[$t];if((Rt.tag!==5||!xn(Rt))&&(cp(Rt,en)&&(gt.push(up(en)),$t++,$t>pt&&(pt=$t)),$t<st.length))for(Rt=Rt.child;Rt!==null;)rt.push(Rt,$t),Rt=Rt.sibling}if(pt<st.length){for(rt=[];pt<st.length;pt++)rt.push(up(st[pt]));return`findAllNodes was able to match part of the selector:
  `+(gt.join(" > ")+`

No matching component was found for:
  `)+rt.join(" > ")}return null},s.getPublicRootInstance=function(rt){if(rt=rt.current,!rt.child)return null;switch(rt.child.tag){case 5:return Ot(rt.child.stateNode);default:return rt.child.stateNode}},s.injectIntoDevTools=function(rt){if(rt={bundleType:rt.bundleType,version:rt.version,rendererPackageName:rt.rendererPackageName,rendererConfig:rt.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:_e.ReactCurrentDispatcher,findHostInstanceByFiber:qx,findFiberByHostInstance:rt.findFiberByHostInstance||_g,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.0.0-fc46dba67-20220329"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")rt=!1;else{var st=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(st.isDisabled||!st.supportsFiber)rt=!0;else{try{Il=st.inject(rt),Ns=st}catch{}rt=!!st.checkDCE}}return rt},s.isAlreadyRendering=function(){return!1},s.observeVisibleRects=function(rt,st,pt,gt){if(!Un)throw Error(b(363));rt=dp(rt,st);var bt=Hn(rt,pt,gt).disconnect;return{disconnect:function(){bt()}}},s.registerMutableSourceForHydration=function(rt,st){var pt=st._getVersion;pt=pt(st._source),rt.mutableSourceEagerHydrationData==null?rt.mutableSourceEagerHydrationData=[st,pt]:rt.mutableSourceEagerHydrationData.push(st,pt)},s.runWithPriority=function(rt,st){var pt=Ar;try{return Ar=rt,st()}finally{Ar=pt}},s.shouldError=function(){return null},s.shouldSuspend=function(){return!1},s.updateContainer=function(rt,st,pt,gt){var bt=st.current,Rt=os(),$t=eo(bt);return pt=ex(pt),st.context===null?st.context=pt:st.pendingContext=pt,st=Hs(Rt,$t),st.payload={element:rt},gt=gt===void 0?null:gt,gt!==null&&(st.callback=gt),Qs(bt,st),rt=bs(bt,$t,Rt),rt!==null&&Ol(rt,bt,$t),$t},s};reactReconciler.exports=reactReconciler_production_min;var reactReconcilerExports=reactReconciler.exports;const Reconciler=getDefaultExportFromCjs(reactReconcilerExports);var scheduler={exports:{}},scheduler_production_min={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(o){function e(Ct,Ut){var Gt=Ct.length;Ct.push(Ut);e:for(;0<Gt;){var Pt=Gt-1>>>1,Wt=Ct[Pt];if(0<c(Wt,Ut))Ct[Pt]=Ut,Ct[Gt]=Wt,Gt=Pt;else break e}}function s(Ct){return Ct.length===0?null:Ct[0]}function a(Ct){if(Ct.length===0)return null;var Ut=Ct[0],Gt=Ct.pop();if(Gt!==Ut){Ct[0]=Gt;e:for(var Pt=0,Wt=Ct.length,sn=Wt>>>1;Pt<sn;){var Bt=2*(Pt+1)-1,tn=Ct[Bt],cn=Bt+1,vn=Ct[cn];if(0>c(tn,Gt))cn<Wt&&0>c(vn,tn)?(Ct[Pt]=vn,Ct[cn]=Gt,Pt=cn):(Ct[Pt]=tn,Ct[Bt]=Gt,Pt=Bt);else if(cn<Wt&&0>c(vn,Gt))Ct[Pt]=vn,Ct[cn]=Gt,Pt=cn;else break e}}return Ut}function c(Ct,Ut){var Gt=Ct.sortIndex-Ut.sortIndex;return Gt!==0?Gt:Ct.id-Ut.id}if(typeof performance=="object"&&typeof performance.now=="function"){var d=performance;o.unstable_now=function(){return d.now()}}else{var b=Date,_e=b.now();o.unstable_now=function(){return b.now()-_e}}var tt=[],nt=[],it=1,ot=null,at=3,ct=!1,ut=!1,ft=!1,dt=typeof setTimeout=="function"?setTimeout:null,lt=typeof clearTimeout=="function"?clearTimeout:null,ht=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function mt(Ct){for(var Ut=s(nt);Ut!==null;){if(Ut.callback===null)a(nt);else if(Ut.startTime<=Ct)a(nt),Ut.sortIndex=Ut.expirationTime,e(tt,Ut);else break;Ut=s(nt)}}function xt(Ct){if(ft=!1,mt(Ct),!ut)if(s(tt)!==null)ut=!0,Ot(St);else{var Ut=s(nt);Ut!==null&&Ht(xt,Ut.startTime-Ct)}}function St(Ct,Ut){ut=!1,ft&&(ft=!1,lt(Et),Et=-1),ct=!0;var Gt=at;try{for(mt(Ut),ot=s(tt);ot!==null&&(!(ot.expirationTime>Ut)||Ct&&!Mt());){var Pt=ot.callback;if(typeof Pt=="function"){ot.callback=null,at=ot.priorityLevel;var Wt=Pt(ot.expirationTime<=Ut);Ut=o.unstable_now(),typeof Wt=="function"?ot.callback=Wt:ot===s(tt)&&a(tt),mt(Ut)}else a(tt);ot=s(tt)}if(ot!==null)var sn=!0;else{var Bt=s(nt);Bt!==null&&Ht(xt,Bt.startTime-Ut),sn=!1}return sn}finally{ot=null,at=Gt,ct=!1}}var yt=!1,wt=null,Et=-1,_t=5,vt=-1;function Mt(){return!(o.unstable_now()-vt<_t)}function jt(){if(wt!==null){var Ct=o.unstable_now();vt=Ct;var Ut=!0;try{Ut=wt(!0,Ct)}finally{Ut?Lt():(yt=!1,wt=null)}}else yt=!1}var Lt;if(typeof ht=="function")Lt=function(){ht(jt)};else if(typeof MessageChannel<"u"){var Nt=new MessageChannel,kt=Nt.port2;Nt.port1.onmessage=jt,Lt=function(){kt.postMessage(null)}}else Lt=function(){dt(jt,0)};function Ot(Ct){wt=Ct,yt||(yt=!0,Lt())}function Ht(Ct,Ut){Et=dt(function(){Ct(o.unstable_now())},Ut)}o.unstable_IdlePriority=5,o.unstable_ImmediatePriority=1,o.unstable_LowPriority=4,o.unstable_NormalPriority=3,o.unstable_Profiling=null,o.unstable_UserBlockingPriority=2,o.unstable_cancelCallback=function(Ct){Ct.callback=null},o.unstable_continueExecution=function(){ut||ct||(ut=!0,Ot(St))},o.unstable_forceFrameRate=function(Ct){0>Ct||125<Ct?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_t=0<Ct?Math.floor(1e3/Ct):5},o.unstable_getCurrentPriorityLevel=function(){return at},o.unstable_getFirstCallbackNode=function(){return s(tt)},o.unstable_next=function(Ct){switch(at){case 1:case 2:case 3:var Ut=3;break;default:Ut=at}var Gt=at;at=Ut;try{return Ct()}finally{at=Gt}},o.unstable_pauseExecution=function(){},o.unstable_requestPaint=function(){},o.unstable_runWithPriority=function(Ct,Ut){switch(Ct){case 1:case 2:case 3:case 4:case 5:break;default:Ct=3}var Gt=at;at=Ct;try{return Ut()}finally{at=Gt}},o.unstable_scheduleCallback=function(Ct,Ut,Gt){var Pt=o.unstable_now();switch(typeof Gt=="object"&&Gt!==null?(Gt=Gt.delay,Gt=typeof Gt=="number"&&0<Gt?Pt+Gt:Pt):Gt=Pt,Ct){case 1:var Wt=-1;break;case 2:Wt=250;break;case 5:Wt=1073741823;break;case 4:Wt=1e4;break;default:Wt=5e3}return Wt=Gt+Wt,Ct={id:it++,callback:Ut,priorityLevel:Ct,startTime:Gt,expirationTime:Wt,sortIndex:-1},Gt>Pt?(Ct.sortIndex=Gt,e(nt,Ct),s(tt)===null&&Ct===s(nt)&&(ft?(lt(Et),Et=-1):ft=!0,Ht(xt,Gt-Pt))):(Ct.sortIndex=Wt,e(tt,Ct),ut||ct||(ut=!0,Ot(St))),Ct},o.unstable_shouldYield=Mt,o.unstable_wrapCallback=function(Ct){var Ut=at;return function(){var Gt=at;at=Ut;try{return Ct.apply(this,arguments)}finally{at=Gt}}}})(scheduler_production_min);scheduler.exports=scheduler_production_min;var schedulerExports=scheduler.exports;const catalogue={},extend=o=>void Object.assign(catalogue,o);function createRenderer(o,e){function s(it,{args:ot=[],attach:at,...ct},ut){let ft=`${it[0].toUpperCase()}${it.slice(1)}`,dt;if(it==="primitive"){if(ct.object===void 0)throw new Error("R3F: Primitives without 'object' are invalid!");const lt=ct.object;dt=prepare(lt,{type:it,root:ut,attach:at,primitive:!0})}else{const lt=catalogue[ft];if(!lt)throw new Error(`R3F: ${ft} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(ot))throw new Error("R3F: The args prop must be an array!");dt=prepare(new lt(...ot),{type:it,root:ut,attach:at,memoizedProps:{args:ot}})}return dt.__r3f.attach===void 0&&(dt.isBufferGeometry?dt.__r3f.attach="geometry":dt.isMaterial&&(dt.__r3f.attach="material")),ft!=="inject"&&applyProps$1(dt,ct),dt}function a(it,ot){let at=!1;if(ot){var ct,ut;(ct=ot.__r3f)!=null&&ct.attach?attach(it,ot,ot.__r3f.attach):ot.isObject3D&&it.isObject3D&&(it.add(ot),at=!0),at||(ut=it.__r3f)==null||ut.objects.push(ot),ot.__r3f||prepare(ot,{}),ot.__r3f.parent=it,updateInstance(ot),invalidateInstance(ot)}}function c(it,ot,at){let ct=!1;if(ot){var ut,ft;if((ut=ot.__r3f)!=null&&ut.attach)attach(it,ot,ot.__r3f.attach);else if(ot.isObject3D&&it.isObject3D){ot.parent=it,ot.dispatchEvent({type:"added"}),it.dispatchEvent({type:"childadded",child:ot});const dt=it.children.filter(ht=>ht!==ot),lt=dt.indexOf(at);it.children=[...dt.slice(0,lt),ot,...dt.slice(lt)],ct=!0}ct||(ft=it.__r3f)==null||ft.objects.push(ot),ot.__r3f||prepare(ot,{}),ot.__r3f.parent=it,updateInstance(ot),invalidateInstance(ot)}}function d(it,ot,at=!1){it&&[...it].forEach(ct=>b(ot,ct,at))}function b(it,ot,at){if(ot){var ct,ut,ft;if(ot.__r3f&&(ot.__r3f.parent=null),(ct=it.__r3f)!=null&&ct.objects&&(it.__r3f.objects=it.__r3f.objects.filter(xt=>xt!==ot)),(ut=ot.__r3f)!=null&&ut.attach)detach(it,ot,ot.__r3f.attach);else if(ot.isObject3D&&it.isObject3D){var dt;it.remove(ot),(dt=ot.__r3f)!=null&&dt.root&&removeInteractivity(findInitialRoot(ot),ot)}const ht=(ft=ot.__r3f)==null?void 0:ft.primitive,mt=!ht&&(at===void 0?ot.dispose!==null:at);if(!ht){var lt;d((lt=ot.__r3f)==null?void 0:lt.objects,ot,mt),d(ot.children,ot,mt)}if(delete ot.__r3f,mt&&ot.dispose&&ot.type!=="Scene"){const xt=()=>{try{ot.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT>"u"?schedulerExports.unstable_scheduleCallback(schedulerExports.unstable_IdlePriority,xt):xt()}invalidateInstance(it)}}function _e(it,ot,at,ct){var ut;const ft=(ut=it.__r3f)==null?void 0:ut.parent;if(!ft)return;const dt=s(ot,at,it.__r3f.root);if(it.children){for(const lt of it.children)lt.__r3f&&a(dt,lt);it.children=it.children.filter(lt=>!lt.__r3f)}it.__r3f.objects.forEach(lt=>a(dt,lt)),it.__r3f.objects=[],it.__r3f.autoRemovedBeforeAppend||b(ft,it),dt.parent&&(dt.__r3f.autoRemovedBeforeAppend=!0),a(ft,dt),dt.raycast&&dt.__r3f.eventCount&&findInitialRoot(dt).getState().internal.interaction.push(dt),[ct,ct.alternate].forEach(lt=>{lt!==null&&(lt.stateNode=dt,lt.ref&&(typeof lt.ref=="function"?lt.ref(dt):lt.ref.current=dt))})}const tt=()=>{};return{reconciler:Reconciler({createInstance:s,removeChild:b,appendChild:a,appendInitialChild:a,insertBefore:c,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(it,ot)=>{if(!ot)return;const at=it.getState().scene;at.__r3f&&(at.__r3f.root=it,a(at,ot))},removeChildFromContainer:(it,ot)=>{ot&&b(it.getState().scene,ot)},insertInContainerBefore:(it,ot,at)=>{if(!ot||!at)return;const ct=it.getState().scene;ct.__r3f&&c(ct,ot,at)},getRootHostContext:()=>null,getChildHostContext:it=>it,finalizeInitialChildren(it){var ot;return!!((ot=it==null?void 0:it.__r3f)!=null?ot:{}).handlers},prepareUpdate(it,ot,at,ct){var ut;if(((ut=it==null?void 0:it.__r3f)!=null?ut:{}).primitive&&ct.object&&ct.object!==it)return[!0];{const{args:dt=[],children:lt,...ht}=ct,{args:mt=[],children:xt,...St}=at;if(!Array.isArray(dt))throw new Error("R3F: the args prop must be an array!");if(dt.some((wt,Et)=>wt!==mt[Et]))return[!0];const yt=diffProps(it,ht,St,!0);return yt.changes.length?[!1,yt]:null}},commitUpdate(it,[ot,at],ct,ut,ft,dt){ot?_e(it,ct,ft,dt):applyProps$1(it,at)},commitMount(it,ot,at,ct){var ut;const ft=(ut=it.__r3f)!=null?ut:{};it.raycast&&ft.handlers&&ft.eventCount&&findInitialRoot(it).getState().internal.interaction.push(it)},getPublicInstance:it=>it,prepareForCommit:()=>null,preparePortalMount:it=>prepare(it.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(it){var ot;const{attach:at,parent:ct}=(ot=it.__r3f)!=null?ot:{};at&&ct&&detach(ct,it,at),it.isObject3D&&(it.visible=!1),invalidateInstance(it)},unhideInstance(it,ot){var at;const{attach:ct,parent:ut}=(at=it.__r3f)!=null?at:{};ct&&ut&&attach(ut,it,ct),(it.isObject3D&&ot.visible==null||ot.visible)&&(it.visible=!0),invalidateInstance(it)},createTextInstance:tt,hideTextInstance:tt,unhideTextInstance:tt,getCurrentEventPriority:()=>e?e():constantsExports.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:typeof performance<"u"&&is.fun(performance.now)?performance.now:is.fun(Date.now)?Date.now:()=>0,scheduleTimeout:is.fun(setTimeout)?setTimeout:void 0,cancelTimeout:is.fun(clearTimeout)?clearTimeout:void 0}),applyProps:applyProps$1}}var _window$document,_window$navigator;const hasColorSpace$1=o=>"colorSpace"in o||"outputColorSpace"in o,getColorManagement=()=>{var o;return(o=catalogue.ColorManagement)!=null?o:null},isOrthographicCamera=o=>o&&o.isOrthographicCamera,isRef$1=o=>o&&o.hasOwnProperty("current"),useIsomorphicLayoutEffect=typeof window<"u"&&((_window$document=window.document)!=null&&_window$document.createElement||((_window$navigator=window.navigator)==null?void 0:_window$navigator.product)==="ReactNative")?reactExports.useLayoutEffect:reactExports.useEffect;function useMutableCallback(o){const e=reactExports.useRef(o);return useIsomorphicLayoutEffect(()=>void(e.current=o),[o]),e}function Block({set:o}){return useIsomorphicLayoutEffect(()=>(o(new Promise(()=>null)),()=>o(!1)),[o]),null}class ErrorBoundary extends reactExports.Component{constructor(...e){super(...e),this.state={error:!1}}componentDidCatch(e){this.props.set(e)}render(){return this.state.error?null:this.props.children}}ErrorBoundary.getDerivedStateFromError=()=>({error:!0});const DEFAULT="__default",DEFAULTS=new Map,isDiffSet=o=>o&&!!o.memoized&&!!o.changes;function calculateDpr(o){var e;const s=typeof window<"u"?(e=window.devicePixelRatio)!=null?e:2:1;return Array.isArray(o)?Math.min(Math.max(o[0],s),o[1]):o}const getRootState=o=>{var e;return(e=o.__r3f)==null?void 0:e.root.getState()};function findInitialRoot(o){let e=o.__r3f.root;for(;e.getState().previousRoot;)e=e.getState().previousRoot;return e}const is={obj:o=>o===Object(o)&&!is.arr(o)&&typeof o!="function",fun:o=>typeof o=="function",str:o=>typeof o=="string",num:o=>typeof o=="number",boo:o=>typeof o=="boolean",und:o=>o===void 0,arr:o=>Array.isArray(o),equ(o,e,{arrays:s="shallow",objects:a="reference",strict:c=!0}={}){if(typeof o!=typeof e||!!o!=!!e)return!1;if(is.str(o)||is.num(o)||is.boo(o))return o===e;const d=is.obj(o);if(d&&a==="reference")return o===e;const b=is.arr(o);if(b&&s==="reference")return o===e;if((b||d)&&o===e)return!0;let _e;for(_e in o)if(!(_e in e))return!1;if(d&&s==="shallow"&&a==="shallow"){for(_e in c?e:o)if(!is.equ(o[_e],e[_e],{strict:c,objects:"reference"}))return!1}else for(_e in c?e:o)if(o[_e]!==e[_e])return!1;if(is.und(_e)){if(b&&o.length===0&&e.length===0||d&&Object.keys(o).length===0&&Object.keys(e).length===0)return!0;if(o!==e)return!1}return!0}};function buildGraph(o){const e={nodes:{},materials:{}};return o&&o.traverse(s=>{s.name&&(e.nodes[s.name]=s),s.material&&!e.materials[s.material.name]&&(e.materials[s.material.name]=s.material)}),e}function dispose(o){o.dispose&&o.type!=="Scene"&&o.dispose();for(const e in o)e.dispose==null||e.dispose(),delete o[e]}function prepare(o,e){const s=o;return s.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...e},o}function resolve(o,e){let s=o;if(e.includes("-")){const a=e.split("-"),c=a.pop();return s=a.reduce((d,b)=>d[b],o),{target:s,key:c}}else return{target:s,key:e}}const INDEX_REGEX=/-\d+$/;function attach(o,e,s){if(is.str(s)){if(INDEX_REGEX.test(s)){const d=s.replace(INDEX_REGEX,""),{target:b,key:_e}=resolve(o,d);Array.isArray(b[_e])||(b[_e]=[])}const{target:a,key:c}=resolve(o,s);e.__r3f.previousAttach=a[c],a[c]=e}else e.__r3f.previousAttach=s(o,e)}function detach(o,e,s){var a,c;if(is.str(s)){const{target:d,key:b}=resolve(o,s),_e=e.__r3f.previousAttach;_e===void 0?delete d[b]:d[b]=_e}else(a=e.__r3f)==null||a.previousAttach==null||a.previousAttach(o,e);(c=e.__r3f)==null||delete c.previousAttach}function diffProps(o,{children:e,key:s,ref:a,...c},{children:d,key:b,ref:_e,...tt}={},nt=!1){const it=o.__r3f,ot=Object.entries(c),at=[];if(nt){const ut=Object.keys(tt);for(let ft=0;ft<ut.length;ft++)c.hasOwnProperty(ut[ft])||ot.unshift([ut[ft],DEFAULT+"remove"])}ot.forEach(([ut,ft])=>{var dt;if((dt=o.__r3f)!=null&&dt.primitive&&ut==="object"||is.equ(ft,tt[ut]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(ut))return at.push([ut,ft,!0,[]]);let lt=[];ut.includes("-")&&(lt=ut.split("-")),at.push([ut,ft,!1,lt]);for(const ht in c){const mt=c[ht];ht.startsWith(`${ut}-`)&&at.push([ht,mt,!1,ht.split("-")])}});const ct={...c};return it!=null&&it.memoizedProps&&it!=null&&it.memoizedProps.args&&(ct.args=it.memoizedProps.args),it!=null&&it.memoizedProps&&it!=null&&it.memoizedProps.attach&&(ct.attach=it.memoizedProps.attach),{memoized:ct,changes:at}}const __DEV__=typeof process<"u"&&!1;function applyProps$1(o,e){var s;const a=o.__r3f,c=a==null?void 0:a.root,d=c==null||c.getState==null?void 0:c.getState(),{memoized:b,changes:_e}=isDiffSet(e)?e:diffProps(o,e),tt=a==null?void 0:a.eventCount;o.__r3f&&(o.__r3f.memoizedProps=b);for(let at=0;at<_e.length;at++){let[ct,ut,ft,dt]=_e[at];if(hasColorSpace$1(o)){const xt="srgb",St="srgb-linear";ct==="encoding"?(ct="colorSpace",ut=ut===3001?xt:St):ct==="outputEncoding"&&(ct="outputColorSpace",ut=ut===3001?xt:St)}let lt=o,ht=lt[ct];if(dt.length&&(ht=dt.reduce((mt,xt)=>mt[xt],o),!(ht&&ht.set))){const[mt,...xt]=dt.reverse();lt=xt.reverse().reduce((St,yt)=>St[yt],o),ct=mt}if(ut===DEFAULT+"remove")if(lt.constructor){let mt=DEFAULTS.get(lt.constructor);mt||(mt=new lt.constructor,DEFAULTS.set(lt.constructor,mt)),ut=mt[ct]}else ut=0;if(ft&&a)ut?a.handlers[ct]=ut:delete a.handlers[ct],a.eventCount=Object.keys(a.handlers).length;else if(ht&&ht.set&&(ht.copy||ht instanceof Layers)){if(Array.isArray(ut))ht.fromArray?ht.fromArray(ut):ht.set(...ut);else if(ht.copy&&ut&&ut.constructor&&(__DEV__?ht.constructor.name===ut.constructor.name:ht.constructor===ut.constructor))ht.copy(ut);else if(ut!==void 0){var nt;const mt=(nt=ht)==null?void 0:nt.isColor;!mt&&ht.setScalar?ht.setScalar(ut):ht instanceof Layers&&ut instanceof Layers?ht.mask=ut.mask:ht.set(ut),!getColorManagement()&&d&&!d.linear&&mt&&ht.convertSRGBToLinear()}}else{var it;if(lt[ct]=ut,(it=lt[ct])!=null&&it.isTexture&&lt[ct].format===RGBAFormat&&lt[ct].type===UnsignedByteType&&d){const mt=lt[ct];hasColorSpace$1(mt)&&hasColorSpace$1(d.gl)?mt.colorSpace=d.gl.outputColorSpace:mt.encoding=d.gl.outputEncoding}}invalidateInstance(o)}if(a&&a.parent&&o.raycast&&tt!==a.eventCount){const at=findInitialRoot(o).getState().internal,ct=at.interaction.indexOf(o);ct>-1&&at.interaction.splice(ct,1),a.eventCount&&at.interaction.push(o)}return!(_e.length===1&&_e[0][0]==="onUpdate")&&_e.length&&(s=o.__r3f)!=null&&s.parent&&updateInstance(o),o}function invalidateInstance(o){var e,s;const a=(e=o.__r3f)==null||(s=e.root)==null||s.getState==null?void 0:s.getState();a&&a.internal.frames===0&&a.invalidate()}function updateInstance(o){o.onUpdate==null||o.onUpdate(o)}function updateCamera(o,e){o.manual||(isOrthographicCamera(o)?(o.left=e.width/-2,o.right=e.width/2,o.top=e.height/2,o.bottom=e.height/-2):o.aspect=e.width/e.height,o.updateProjectionMatrix(),o.updateMatrixWorld())}function makeId(o){return(o.eventObject||o.object).uuid+"/"+o.index+o.instanceId}function getEventPriority(){var o;const e=typeof self<"u"&&self||typeof window<"u"&&window;if(!e)return constantsExports.DefaultEventPriority;switch((o=e.event)==null?void 0:o.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return constantsExports.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return constantsExports.ContinuousEventPriority;default:return constantsExports.DefaultEventPriority}}function releaseInternalPointerCapture(o,e,s,a){const c=s.get(e);c&&(s.delete(e),s.size===0&&(o.delete(a),c.target.releasePointerCapture(a)))}function removeInteractivity(o,e){const{internal:s}=o.getState();s.interaction=s.interaction.filter(a=>a!==e),s.initialHits=s.initialHits.filter(a=>a!==e),s.hovered.forEach((a,c)=>{(a.eventObject===e||a.object===e)&&s.hovered.delete(c)}),s.capturedMap.forEach((a,c)=>{releaseInternalPointerCapture(s.capturedMap,e,a,c)})}function createEvents(o){function e(tt){const{internal:nt}=o.getState(),it=tt.offsetX-nt.initialClick[0],ot=tt.offsetY-nt.initialClick[1];return Math.round(Math.sqrt(it*it+ot*ot))}function s(tt){return tt.filter(nt=>["Move","Over","Enter","Out","Leave"].some(it=>{var ot;return(ot=nt.__r3f)==null?void 0:ot.handlers["onPointer"+it]}))}function a(tt,nt){const it=o.getState(),ot=new Set,at=[],ct=nt?nt(it.internal.interaction):it.internal.interaction;for(let lt=0;lt<ct.length;lt++){const ht=getRootState(ct[lt]);ht&&(ht.raycaster.camera=void 0)}it.previousRoot||it.events.compute==null||it.events.compute(tt,it);function ut(lt){const ht=getRootState(lt);if(!ht||!ht.events.enabled||ht.raycaster.camera===null)return[];if(ht.raycaster.camera===void 0){var mt;ht.events.compute==null||ht.events.compute(tt,ht,(mt=ht.previousRoot)==null?void 0:mt.getState()),ht.raycaster.camera===void 0&&(ht.raycaster.camera=null)}return ht.raycaster.camera?ht.raycaster.intersectObject(lt,!0):[]}let ft=ct.flatMap(ut).sort((lt,ht)=>{const mt=getRootState(lt.object),xt=getRootState(ht.object);return!mt||!xt?lt.distance-ht.distance:xt.events.priority-mt.events.priority||lt.distance-ht.distance}).filter(lt=>{const ht=makeId(lt);return ot.has(ht)?!1:(ot.add(ht),!0)});it.events.filter&&(ft=it.events.filter(ft,it));for(const lt of ft){let ht=lt.object;for(;ht;){var dt;(dt=ht.__r3f)!=null&&dt.eventCount&&at.push({...lt,eventObject:ht}),ht=ht.parent}}if("pointerId"in tt&&it.internal.capturedMap.has(tt.pointerId))for(let lt of it.internal.capturedMap.get(tt.pointerId).values())ot.has(makeId(lt.intersection))||at.push(lt.intersection);return at}function c(tt,nt,it,ot){const at=o.getState();if(tt.length){const ct={stopped:!1};for(const ut of tt){const ft=getRootState(ut.object)||at,{raycaster:dt,pointer:lt,camera:ht,internal:mt}=ft,xt=new Vector3(lt.x,lt.y,0).unproject(ht),St=vt=>{var Mt,jt;return(Mt=(jt=mt.capturedMap.get(vt))==null?void 0:jt.has(ut.eventObject))!=null?Mt:!1},yt=vt=>{const Mt={intersection:ut,target:nt.target};mt.capturedMap.has(vt)?mt.capturedMap.get(vt).set(ut.eventObject,Mt):mt.capturedMap.set(vt,new Map([[ut.eventObject,Mt]])),nt.target.setPointerCapture(vt)},wt=vt=>{const Mt=mt.capturedMap.get(vt);Mt&&releaseInternalPointerCapture(mt.capturedMap,ut.eventObject,Mt,vt)};let Et={};for(let vt in nt){let Mt=nt[vt];typeof Mt!="function"&&(Et[vt]=Mt)}let _t={...ut,...Et,pointer:lt,intersections:tt,stopped:ct.stopped,delta:it,unprojectedPoint:xt,ray:dt.ray,camera:ht,stopPropagation(){const vt="pointerId"in nt&&mt.capturedMap.get(nt.pointerId);if((!vt||vt.has(ut.eventObject))&&(_t.stopped=ct.stopped=!0,mt.hovered.size&&Array.from(mt.hovered.values()).find(Mt=>Mt.eventObject===ut.eventObject))){const Mt=tt.slice(0,tt.indexOf(ut));d([...Mt,ut])}},target:{hasPointerCapture:St,setPointerCapture:yt,releasePointerCapture:wt},currentTarget:{hasPointerCapture:St,setPointerCapture:yt,releasePointerCapture:wt},nativeEvent:nt};if(ot(_t),ct.stopped===!0)break}}return tt}function d(tt){const{internal:nt}=o.getState();for(const it of nt.hovered.values())if(!tt.length||!tt.find(ot=>ot.object===it.object&&ot.index===it.index&&ot.instanceId===it.instanceId)){const at=it.eventObject.__r3f,ct=at==null?void 0:at.handlers;if(nt.hovered.delete(makeId(it)),at!=null&&at.eventCount){const ut={...it,intersections:tt};ct.onPointerOut==null||ct.onPointerOut(ut),ct.onPointerLeave==null||ct.onPointerLeave(ut)}}}function b(tt,nt){for(let it=0;it<nt.length;it++){const ot=nt[it].__r3f;ot==null||ot.handlers.onPointerMissed==null||ot.handlers.onPointerMissed(tt)}}function _e(tt){switch(tt){case"onPointerLeave":case"onPointerCancel":return()=>d([]);case"onLostPointerCapture":return nt=>{const{internal:it}=o.getState();"pointerId"in nt&&it.capturedMap.has(nt.pointerId)&&requestAnimationFrame(()=>{it.capturedMap.has(nt.pointerId)&&(it.capturedMap.delete(nt.pointerId),d([]))})}}return function(it){const{onPointerMissed:ot,internal:at}=o.getState();at.lastEvent.current=it;const ct=tt==="onPointerMove",ut=tt==="onClick"||tt==="onContextMenu"||tt==="onDoubleClick",dt=a(it,ct?s:void 0),lt=ut?e(it):0;tt==="onPointerDown"&&(at.initialClick=[it.offsetX,it.offsetY],at.initialHits=dt.map(mt=>mt.eventObject)),ut&&!dt.length&&lt<=2&&(b(it,at.interaction),ot&&ot(it)),ct&&d(dt);function ht(mt){const xt=mt.eventObject,St=xt.__r3f,yt=St==null?void 0:St.handlers;if(St!=null&&St.eventCount)if(ct){if(yt.onPointerOver||yt.onPointerEnter||yt.onPointerOut||yt.onPointerLeave){const wt=makeId(mt),Et=at.hovered.get(wt);Et?Et.stopped&&mt.stopPropagation():(at.hovered.set(wt,mt),yt.onPointerOver==null||yt.onPointerOver(mt),yt.onPointerEnter==null||yt.onPointerEnter(mt))}yt.onPointerMove==null||yt.onPointerMove(mt)}else{const wt=yt[tt];wt?(!ut||at.initialHits.includes(xt))&&(b(it,at.interaction.filter(Et=>!at.initialHits.includes(Et))),wt(mt)):ut&&at.initialHits.includes(xt)&&b(it,at.interaction.filter(Et=>!at.initialHits.includes(Et)))}}c(dt,it,lt,ht)}}return{handlePointer:_e}}const privateKeys=["set","get","setSize","setFrameloop","setDpr","events","invalidate","advance","size","viewport"],isRenderer=o=>!!(o!=null&&o.render),context$1=reactExports.createContext(null),createStore$1=(o,e)=>{const s=create$2((_e,tt)=>{const nt=new Vector3,it=new Vector3,ot=new Vector3;function at(lt=tt().camera,ht=it,mt=tt().size){const{width:xt,height:St,top:yt,left:wt}=mt,Et=xt/St;ht.isVector3?ot.copy(ht):ot.set(...ht);const _t=lt.getWorldPosition(nt).distanceTo(ot);if(isOrthographicCamera(lt))return{width:xt/lt.zoom,height:St/lt.zoom,top:yt,left:wt,factor:1,distance:_t,aspect:Et};{const vt=lt.fov*Math.PI/180,Mt=2*Math.tan(vt/2)*_t,jt=Mt*(xt/St);return{width:jt,height:Mt,top:yt,left:wt,factor:xt/jt,distance:_t,aspect:Et}}}let ct;const ut=lt=>_e(ht=>({performance:{...ht.performance,current:lt}})),ft=new Vector2;return{set:_e,get:tt,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:(lt=1)=>o(tt(),lt),advance:(lt,ht)=>e(lt,ht,tt()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new Clock,pointer:ft,mouse:ft,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const lt=tt();ct&&clearTimeout(ct),lt.performance.current!==lt.performance.min&&ut(lt.performance.min),ct=setTimeout(()=>ut(tt().performance.max),lt.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:at},setEvents:lt=>_e(ht=>({...ht,events:{...ht.events,...lt}})),setSize:(lt,ht,mt,xt,St)=>{const yt=tt().camera,wt={width:lt,height:ht,top:xt||0,left:St||0,updateStyle:mt};_e(Et=>({size:wt,viewport:{...Et.viewport,...at(yt,it,wt)}}))},setDpr:lt=>_e(ht=>{const mt=calculateDpr(lt);return{viewport:{...ht.viewport,dpr:mt,initialDpr:ht.viewport.initialDpr||mt}}}),setFrameloop:(lt="always")=>{const ht=tt().clock;ht.stop(),ht.elapsedTime=0,lt!=="never"&&(ht.start(),ht.elapsedTime=0),_e(()=>({frameloop:lt}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:reactExports.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(lt,ht,mt)=>{const xt=tt().internal;return xt.priority=xt.priority+(ht>0?1:0),xt.subscribers.push({ref:lt,priority:ht,store:mt}),xt.subscribers=xt.subscribers.sort((St,yt)=>St.priority-yt.priority),()=>{const St=tt().internal;St!=null&&St.subscribers&&(St.priority=St.priority-(ht>0?1:0),St.subscribers=St.subscribers.filter(yt=>yt.ref!==lt))}}}}}),a=s.getState();let c=a.size,d=a.viewport.dpr,b=a.camera;return s.subscribe(()=>{const{camera:_e,size:tt,viewport:nt,gl:it,set:ot}=s.getState();if(tt.width!==c.width||tt.height!==c.height||nt.dpr!==d){var at;c=tt,d=nt.dpr,updateCamera(_e,tt),it.setPixelRatio(nt.dpr);const ct=(at=tt.updateStyle)!=null?at:typeof HTMLCanvasElement<"u"&&it.domElement instanceof HTMLCanvasElement;it.setSize(tt.width,tt.height,ct)}_e!==b&&(b=_e,ot(ct=>({viewport:{...ct.viewport,...ct.viewport.getCurrentViewport(_e)}})))}),s.subscribe(_e=>o(_e)),s};let i$1,globalEffects=new Set,globalAfterEffects=new Set,globalTailEffects=new Set;function run(o,e){if(o.size)for(const{callback:s}of o.values())s(e)}function flushGlobalEffects(o,e){switch(o){case"before":return run(globalEffects,e);case"after":return run(globalAfterEffects,e);case"tail":return run(globalTailEffects,e)}}let subscribers,subscription;function render$1(o,e,s){let a=e.clock.getDelta();for(e.frameloop==="never"&&typeof o=="number"&&(a=o-e.clock.elapsedTime,e.clock.oldTime=e.clock.elapsedTime,e.clock.elapsedTime=o),subscribers=e.internal.subscribers,i$1=0;i$1<subscribers.length;i$1++)subscription=subscribers[i$1],subscription.ref.current(subscription.store.getState(),a,s);return!e.internal.priority&&e.gl.render&&e.gl.render(e.scene,e.camera),e.internal.frames=Math.max(0,e.internal.frames-1),e.frameloop==="always"?1:e.internal.frames}function createLoop(o){let e=!1,s=!1,a,c,d;function b(nt){c=requestAnimationFrame(b),e=!0,a=0,flushGlobalEffects("before",nt),s=!0;for(const ot of o.values()){var it;d=ot.store.getState(),d.internal.active&&(d.frameloop==="always"||d.internal.frames>0)&&!((it=d.gl.xr)!=null&&it.isPresenting)&&(a+=render$1(nt,d))}if(s=!1,flushGlobalEffects("after",nt),a===0)return flushGlobalEffects("tail",nt),e=!1,cancelAnimationFrame(c)}function _e(nt,it=1){var ot;if(!nt)return o.forEach(at=>_e(at.store.getState(),it));(ot=nt.gl.xr)!=null&&ot.isPresenting||!nt.internal.active||nt.frameloop==="never"||(it>1?nt.internal.frames=Math.min(60,nt.internal.frames+it):s?nt.internal.frames=2:nt.internal.frames=1,e||(e=!0,requestAnimationFrame(b)))}function tt(nt,it=!0,ot,at){if(it&&flushGlobalEffects("before",nt),ot)render$1(nt,ot,at);else for(const ct of o.values())render$1(nt,ct.store.getState());it&&flushGlobalEffects("after",nt)}return{loop:b,invalidate:_e,advance:tt}}function useStore$1(){const o=reactExports.useContext(context$1);if(!o)throw new Error("R3F: Hooks can only be used within the Canvas component!");return o}function useThree(o=s=>s,e){return useStore$1()(o,e)}function useFrame(o,e=0){const s=useStore$1(),a=s.getState().internal.subscribe,c=useMutableCallback(o);return useIsomorphicLayoutEffect(()=>a(c,e,s),[e,a,s]),null}const memoizedLoaders=new WeakMap;function loadingFn(o,e){return function(s,...a){let c=memoizedLoaders.get(s);return c||(c=new s,memoizedLoaders.set(s,c)),o&&o(c),Promise.all(a.map(d=>new Promise((b,_e)=>c.load(d,tt=>{tt.scene&&Object.assign(tt,buildGraph(tt.scene)),b(tt)},e,tt=>_e(new Error(`Could not load ${d}: ${tt==null?void 0:tt.message}`))))))}}function useLoader(o,e,s,a){const c=Array.isArray(e)?e:[e],d=suspend(loadingFn(s,a),[o,...c],{equal:is.equ});return Array.isArray(e)?d:d[0]}useLoader.preload=function(o,e,s){const a=Array.isArray(e)?e:[e];return preload(loadingFn(s),[o,...a])};useLoader.clear=function(o,e){const s=Array.isArray(e)?e:[e];return clear([o,...s])};const roots=new Map,{invalidate,advance}=createLoop(roots),{reconciler,applyProps}=createRenderer(roots,getEventPriority),shallowLoose={objects:"shallow",strict:!1},createRendererInstance=(o,e)=>{const s=typeof o=="function"?o(e):o;return isRenderer(s)?s:new WebGLRenderer({powerPreference:"high-performance",canvas:e,antialias:!0,alpha:!0,...o})};function computeInitialSize(o,e){const s=typeof HTMLCanvasElement<"u"&&o instanceof HTMLCanvasElement;if(e){const{width:a,height:c,top:d,left:b,updateStyle:_e=s}=e;return{width:a,height:c,top:d,left:b,updateStyle:_e}}else if(typeof HTMLCanvasElement<"u"&&o instanceof HTMLCanvasElement&&o.parentElement){const{width:a,height:c,top:d,left:b}=o.parentElement.getBoundingClientRect();return{width:a,height:c,top:d,left:b,updateStyle:s}}else if(typeof OffscreenCanvas<"u"&&o instanceof OffscreenCanvas)return{width:o.width,height:o.height,top:0,left:0,updateStyle:s};return{width:0,height:0,top:0,left:0}}function createRoot(o){const e=roots.get(o),s=e==null?void 0:e.fiber,a=e==null?void 0:e.store;e&&console.warn("R3F.createRoot should only be called once!");const c=typeof reportError=="function"?reportError:console.error,d=a||createStore$1(invalidate,advance),b=s||reconciler.createContainer(d,constantsExports.ConcurrentRoot,null,!1,null,"",c,null);e||roots.set(o,{fiber:b,store:d});let _e,tt=!1,nt;return{configure(it={}){let{gl:ot,size:at,scene:ct,events:ut,onCreated:ft,shadows:dt=!1,linear:lt=!1,flat:ht=!1,legacy:mt=!1,orthographic:xt=!1,frameloop:St="always",dpr:yt=[1,2],performance:wt,raycaster:Et,camera:_t,onPointerMissed:vt}=it,Mt=d.getState(),jt=Mt.gl;Mt.gl||Mt.set({gl:jt=createRendererInstance(ot,o)});let Lt=Mt.raycaster;Lt||Mt.set({raycaster:Lt=new Raycaster});const{params:Nt,...kt}=Et||{};if(is.equ(kt,Lt,shallowLoose)||applyProps(Lt,{...kt}),is.equ(Nt,Lt.params,shallowLoose)||applyProps(Lt,{params:{...Lt.params,...Nt}}),!Mt.camera||Mt.camera===nt&&!is.equ(nt,_t,shallowLoose)){nt=_t;const Gt=_t instanceof Camera,Pt=Gt?_t:xt?new OrthographicCamera$1(0,0,0,0,.1,1e3):new PerspectiveCamera(75,0,.1,1e3);Gt||(Pt.position.z=5,_t&&(applyProps(Pt,_t),("aspect"in _t||"left"in _t||"right"in _t||"bottom"in _t||"top"in _t)&&(Pt.manual=!0,Pt.updateProjectionMatrix())),!Mt.camera&&!(_t!=null&&_t.rotation)&&Pt.lookAt(0,0,0)),Mt.set({camera:Pt}),Lt.camera=Pt}if(!Mt.scene){let Gt;ct!=null&&ct.isScene?Gt=ct:(Gt=new Scene,ct&&applyProps(Gt,ct)),Mt.set({scene:prepare(Gt)})}if(!Mt.xr){var Ot;const Gt=(sn,Bt)=>{const tn=d.getState();tn.frameloop!=="never"&&advance(sn,!0,tn,Bt)},Pt=()=>{const sn=d.getState();sn.gl.xr.enabled=sn.gl.xr.isPresenting,sn.gl.xr.setAnimationLoop(sn.gl.xr.isPresenting?Gt:null),sn.gl.xr.isPresenting||invalidate(sn)},Wt={connect(){const sn=d.getState().gl;sn.xr.addEventListener("sessionstart",Pt),sn.xr.addEventListener("sessionend",Pt)},disconnect(){const sn=d.getState().gl;sn.xr.removeEventListener("sessionstart",Pt),sn.xr.removeEventListener("sessionend",Pt)}};typeof((Ot=jt.xr)==null?void 0:Ot.addEventListener)=="function"&&Wt.connect(),Mt.set({xr:Wt})}if(jt.shadowMap){const Gt=jt.shadowMap.enabled,Pt=jt.shadowMap.type;if(jt.shadowMap.enabled=!!dt,is.boo(dt))jt.shadowMap.type=PCFSoftShadowMap;else if(is.str(dt)){var Ht;const Wt={basic:BasicShadowMap,percentage:PCFShadowMap,soft:PCFSoftShadowMap,variance:VSMShadowMap};jt.shadowMap.type=(Ht=Wt[dt])!=null?Ht:PCFSoftShadowMap}else is.obj(dt)&&Object.assign(jt.shadowMap,dt);(Gt!==jt.shadowMap.enabled||Pt!==jt.shadowMap.type)&&(jt.shadowMap.needsUpdate=!0)}const Ct=getColorManagement();Ct&&("enabled"in Ct?Ct.enabled=!mt:"legacyMode"in Ct&&(Ct.legacyMode=mt)),tt||applyProps(jt,{outputEncoding:lt?3e3:3001,toneMapping:ht?NoToneMapping:ACESFilmicToneMapping}),Mt.legacy!==mt&&Mt.set(()=>({legacy:mt})),Mt.linear!==lt&&Mt.set(()=>({linear:lt})),Mt.flat!==ht&&Mt.set(()=>({flat:ht})),ot&&!is.fun(ot)&&!isRenderer(ot)&&!is.equ(ot,jt,shallowLoose)&&applyProps(jt,ot),ut&&!Mt.events.handlers&&Mt.set({events:ut(d)});const Ut=computeInitialSize(o,at);return is.equ(Ut,Mt.size,shallowLoose)||Mt.setSize(Ut.width,Ut.height,Ut.updateStyle,Ut.top,Ut.left),yt&&Mt.viewport.dpr!==calculateDpr(yt)&&Mt.setDpr(yt),Mt.frameloop!==St&&Mt.setFrameloop(St),Mt.onPointerMissed||Mt.set({onPointerMissed:vt}),wt&&!is.equ(wt,Mt.performance,shallowLoose)&&Mt.set(Gt=>({performance:{...Gt.performance,...wt}})),_e=ft,tt=!0,this},render(it){return tt||this.configure(),reconciler.updateContainer(jsxRuntimeExports.jsx(Provider,{store:d,children:it,onCreated:_e,rootElement:o}),b,null,()=>{}),d},unmount(){unmountComponentAtNode(o)}}}function Provider({store:o,children:e,onCreated:s,rootElement:a}){return useIsomorphicLayoutEffect(()=>{const c=o.getState();c.set(d=>({internal:{...d.internal,active:!0}})),s&&s(c),o.getState().events.connected||c.events.connect==null||c.events.connect(a)},[]),jsxRuntimeExports.jsx(context$1.Provider,{value:o,children:e})}function unmountComponentAtNode(o,e){const s=roots.get(o),a=s==null?void 0:s.fiber;if(a){const c=s==null?void 0:s.store.getState();c&&(c.internal.active=!1),reconciler.updateContainer(null,a,null,()=>{c&&setTimeout(()=>{try{var d,b,_e,tt;c.events.disconnect==null||c.events.disconnect(),(d=c.gl)==null||(b=d.renderLists)==null||b.dispose==null||b.dispose(),(_e=c.gl)==null||_e.forceContextLoss==null||_e.forceContextLoss(),(tt=c.gl)!=null&&tt.xr&&c.xr.disconnect(),dispose(c),roots.delete(o)}catch{}},500)})}}function createPortal(o,e,s){return jsxRuntimeExports.jsx(Portal,{children:o,container:e,state:s},e.uuid)}function Portal({state:o={},children:e,container:s}){const{events:a,size:c,...d}=o,b=useStore$1(),[_e]=reactExports.useState(()=>new Raycaster),[tt]=reactExports.useState(()=>new Vector2),nt=reactExports.useCallback((ot,at)=>{const ct={...ot};Object.keys(ot).forEach(ft=>{(privateKeys.includes(ft)||ot[ft]!==at[ft]&&at[ft])&&delete ct[ft]});let ut;if(at&&c){const ft=at.camera;ut=ot.viewport.getCurrentViewport(ft,new Vector3,c),ft!==ot.camera&&updateCamera(ft,c)}return{...ct,scene:s,raycaster:_e,pointer:tt,mouse:tt,previousRoot:b,events:{...ot.events,...at==null?void 0:at.events,...a},size:{...ot.size,...c},viewport:{...ot.viewport,...ut},...d}},[o]),[it]=reactExports.useState(()=>{const ot=b.getState();return create$2((ct,ut)=>({...ot,scene:s,raycaster:_e,pointer:tt,mouse:tt,previousRoot:b,events:{...ot.events,...a},size:{...ot.size,...c},...d,set:ct,get:ut,setEvents:ft=>ct(dt=>({...dt,events:{...dt.events,...ft}}))}))});return reactExports.useEffect(()=>{const ot=b.subscribe(at=>it.setState(ct=>nt(at,ct)));return()=>{ot()}},[nt]),reactExports.useEffect(()=>{it.setState(ot=>nt(b.getState(),ot))},[nt]),reactExports.useEffect(()=>()=>{it.destroy()},[]),jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:reconciler.createPortal(jsxRuntimeExports.jsx(context$1.Provider,{value:it,children:e}),it,null)})}reconciler.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:reactExports.version});const DOM_EVENTS={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function createPointerEvents(o){const{handlePointer:e}=createEvents(o);return{priority:1,enabled:!0,compute(s,a,c){a.pointer.set(s.offsetX/a.size.width*2-1,-(s.offsetY/a.size.height)*2+1),a.raycaster.setFromCamera(a.pointer,a.camera)},connected:void 0,handlers:Object.keys(DOM_EVENTS).reduce((s,a)=>({...s,[a]:e(a)}),{}),update:()=>{var s;const{events:a,internal:c}=o.getState();(s=c.lastEvent)!=null&&s.current&&a.handlers&&a.handlers.onPointerMove(c.lastEvent.current)},connect:s=>{var a;const{set:c,events:d}=o.getState();d.disconnect==null||d.disconnect(),c(b=>({events:{...b.events,connected:s}})),Object.entries((a=d.handlers)!=null?a:[]).forEach(([b,_e])=>{const[tt,nt]=DOM_EVENTS[b];s.addEventListener(tt,_e,{passive:nt})})},disconnect:()=>{const{set:s,events:a}=o.getState();if(a.connected){var c;Object.entries((c=a.handlers)!=null?c:[]).forEach(([d,b])=>{if(a&&a.connected instanceof HTMLElement){const[_e]=DOM_EVENTS[d];a.connected.removeEventListener(_e,b)}}),s(d=>({events:{...d.events,connected:void 0}}))}}}}function g(o,e){let s;return(...a)=>{window.clearTimeout(s),s=window.setTimeout(()=>o(...a),e)}}function j({debounce:o,scroll:e,polyfill:s,offsetSize:a}={debounce:0,scroll:!1,offsetSize:!1}){const c=s||(typeof window>"u"?class{}:window.ResizeObserver);if(!c)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[d,b]=reactExports.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),_e=reactExports.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:d,orientationHandler:null}),tt=o?typeof o=="number"?o:o.scroll:null,nt=o?typeof o=="number"?o:o.resize:null,it=reactExports.useRef(!1);reactExports.useEffect(()=>(it.current=!0,()=>void(it.current=!1)));const[ot,at,ct]=reactExports.useMemo(()=>{const lt=()=>{if(!_e.current.element)return;const{left:ht,top:mt,width:xt,height:St,bottom:yt,right:wt,x:Et,y:_t}=_e.current.element.getBoundingClientRect(),vt={left:ht,top:mt,width:xt,height:St,bottom:yt,right:wt,x:Et,y:_t};_e.current.element instanceof HTMLElement&&a&&(vt.height=_e.current.element.offsetHeight,vt.width=_e.current.element.offsetWidth),Object.freeze(vt),it.current&&!D$1(_e.current.lastBounds,vt)&&b(_e.current.lastBounds=vt)};return[lt,nt?g(lt,nt):lt,tt?g(lt,tt):lt]},[b,a,tt,nt]);function ut(){_e.current.scrollContainers&&(_e.current.scrollContainers.forEach(lt=>lt.removeEventListener("scroll",ct,!0)),_e.current.scrollContainers=null),_e.current.resizeObserver&&(_e.current.resizeObserver.disconnect(),_e.current.resizeObserver=null),_e.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",_e.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",_e.current.orientationHandler))}function ft(){_e.current.element&&(_e.current.resizeObserver=new c(ct),_e.current.resizeObserver.observe(_e.current.element),e&&_e.current.scrollContainers&&_e.current.scrollContainers.forEach(lt=>lt.addEventListener("scroll",ct,{capture:!0,passive:!0})),_e.current.orientationHandler=()=>{ct()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",_e.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",_e.current.orientationHandler))}const dt=lt=>{!lt||lt===_e.current.element||(ut(),_e.current.element=lt,_e.current.scrollContainers=E(lt),ft())};return X(ct,!!e),W(at),reactExports.useEffect(()=>{ut(),ft()},[e,ct,at]),reactExports.useEffect(()=>ut,[]),[dt,d,ot]}function W(o){reactExports.useEffect(()=>{const e=o;return window.addEventListener("resize",e),()=>void window.removeEventListener("resize",e)},[o])}function X(o,e){reactExports.useEffect(()=>{if(e){const s=o;return window.addEventListener("scroll",s,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",s,!0)}},[o,e])}function E(o){const e=[];if(!o||o===document.body)return e;const{overflow:s,overflowX:a,overflowY:c}=window.getComputedStyle(o);return[s,a,c].some(d=>d==="auto"||d==="scroll")&&e.push(o),[...e,...E(o.parentElement)]}const k$1=["x","y","top","bottom","left","right","width","height"],D$1=(o,e)=>k$1.every(s=>o[s]===e[s]);var __defProp$5=Object.defineProperty,__defProps=Object.defineProperties,__getOwnPropDescs=Object.getOwnPropertyDescriptors,__getOwnPropSymbols=Object.getOwnPropertySymbols,__hasOwnProp=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__defNormalProp$5=(o,e,s)=>e in o?__defProp$5(o,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):o[e]=s,__spreadValues=(o,e)=>{for(var s in e||(e={}))__hasOwnProp.call(e,s)&&__defNormalProp$5(o,s,e[s]);if(__getOwnPropSymbols)for(var s of __getOwnPropSymbols(e))__propIsEnum.call(e,s)&&__defNormalProp$5(o,s,e[s]);return o},__spreadProps=(o,e)=>__defProps(o,__getOwnPropDescs(e)),_a$1,_b$1;typeof window<"u"&&((_a$1=window.document)!=null&&_a$1.createElement||((_b$1=window.navigator)==null?void 0:_b$1.product)==="ReactNative")?reactExports.useLayoutEffect:reactExports.useEffect;function traverseFiber(o,e,s){if(!o)return;if(s(o)===!0)return o;let a=o.child;for(;a;){const c=traverseFiber(a,e,s);if(c)return c;a=a.sibling}}function wrapContext(o){try{return Object.defineProperties(o,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return o}}const error=console.error;console.error=function(){const o=[...arguments].join("");if(o!=null&&o.startsWith("Warning:")&&o.includes("useContext")){console.error=error;return}return error.apply(this,arguments)};const FiberContext=wrapContext(reactExports.createContext(null));class FiberProvider extends reactExports.Component{render(){return reactExports.createElement(FiberContext.Provider,{value:this._reactInternals},this.props.children)}}function useFiber(){const o=reactExports.useContext(FiberContext);if(o===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=reactExports.useId();return reactExports.useMemo(()=>{for(const a of[o,o==null?void 0:o.alternate]){if(!a)continue;const c=traverseFiber(a,!1,d=>{let b=d.memoizedState;for(;b;){if(b.memoizedState===e)return!0;b=b.next}});if(c)return c}},[o,e])}function useContextMap(){const o=useFiber(),[e]=reactExports.useState(()=>new Map);e.clear();let s=o;for(;s;){if(s.type&&typeof s.type=="object"){const c=s.type._context===void 0&&s.type.Provider===s.type?s.type:s.type._context;c&&c!==FiberContext&&!e.has(c)&&e.set(c,reactExports.useContext(wrapContext(c)))}s=s.return}return e}function useContextBridge(){const o=useContextMap();return reactExports.useMemo(()=>Array.from(o.keys()).reduce((e,s)=>a=>reactExports.createElement(e,null,reactExports.createElement(s.Provider,__spreadProps(__spreadValues({},a),{value:o.get(s)}))),e=>reactExports.createElement(FiberProvider,__spreadValues({},e))),[o])}const CanvasImpl=reactExports.forwardRef(function({children:e,fallback:s,resize:a,style:c,gl:d,events:b=createPointerEvents,eventSource:_e,eventPrefix:tt,shadows:nt,linear:it,flat:ot,legacy:at,orthographic:ct,frameloop:ut,dpr:ft,performance:dt,raycaster:lt,camera:ht,scene:mt,onPointerMissed:xt,onCreated:St,...yt},wt){reactExports.useMemo(()=>extend(THREE),[]);const Et=useContextBridge(),[_t,vt]=j({scroll:!0,debounce:{scroll:50,resize:0},...a}),Mt=reactExports.useRef(null),jt=reactExports.useRef(null);reactExports.useImperativeHandle(wt,()=>Mt.current);const Lt=useMutableCallback(xt),[Nt,kt]=reactExports.useState(!1),[Ot,Ht]=reactExports.useState(!1);if(Nt)throw Nt;if(Ot)throw Ot;const Ct=reactExports.useRef(null);useIsomorphicLayoutEffect(()=>{const Gt=Mt.current;vt.width>0&&vt.height>0&&Gt&&(Ct.current||(Ct.current=createRoot(Gt)),Ct.current.configure({gl:d,events:b,shadows:nt,linear:it,flat:ot,legacy:at,orthographic:ct,frameloop:ut,dpr:ft,performance:dt,raycaster:lt,camera:ht,scene:mt,size:vt,onPointerMissed:(...Pt)=>Lt.current==null?void 0:Lt.current(...Pt),onCreated:Pt=>{Pt.events.connect==null||Pt.events.connect(_e?isRef$1(_e)?_e.current:_e:jt.current),tt&&Pt.setEvents({compute:(Wt,sn)=>{const Bt=Wt[tt+"X"],tn=Wt[tt+"Y"];sn.pointer.set(Bt/sn.size.width*2-1,-(tn/sn.size.height)*2+1),sn.raycaster.setFromCamera(sn.pointer,sn.camera)}}),St==null||St(Pt)}}),Ct.current.render(jsxRuntimeExports.jsx(Et,{children:jsxRuntimeExports.jsx(ErrorBoundary,{set:Ht,children:jsxRuntimeExports.jsx(reactExports.Suspense,{fallback:jsxRuntimeExports.jsx(Block,{set:kt}),children:e??null})})})))}),reactExports.useEffect(()=>{const Gt=Mt.current;if(Gt)return()=>unmountComponentAtNode(Gt)},[]);const Ut=_e?"none":"auto";return jsxRuntimeExports.jsx("div",{ref:jt,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:Ut,...c},...yt,children:jsxRuntimeExports.jsx("div",{ref:_t,style:{width:"100%",height:"100%"},children:jsxRuntimeExports.jsx("canvas",{ref:Mt,style:{display:"block"},children:s})})})}),Canvas=reactExports.forwardRef(function(e,s){return jsxRuntimeExports.jsx(FiberProvider,{children:jsxRuntimeExports.jsx(CanvasImpl,{...e,ref:s})})});function _extends(){return _extends=Object.assign?Object.assign.bind():function(o){for(var e=1;e<arguments.length;e++){var s=arguments[e];for(var a in s)({}).hasOwnProperty.call(s,a)&&(o[a]=s[a])}return o},_extends.apply(null,arguments)}const v1=new Vector3,v2=new Vector3,v3=new Vector3,v4=new Vector2;function defaultCalculatePosition(o,e,s){const a=v1.setFromMatrixPosition(o.matrixWorld);a.project(e);const c=s.width/2,d=s.height/2;return[a.x*c+c,-(a.y*d)+d]}function isObjectBehindCamera(o,e){const s=v1.setFromMatrixPosition(o.matrixWorld),a=v2.setFromMatrixPosition(e.matrixWorld),c=s.sub(a),d=e.getWorldDirection(v3);return c.angleTo(d)>Math.PI/2}function isObjectVisible(o,e,s,a){const c=v1.setFromMatrixPosition(o.matrixWorld),d=c.clone();d.project(e),v4.set(d.x,d.y),s.setFromCamera(v4,e);const b=s.intersectObjects(a,!0);if(b.length){const _e=b[0].distance;return c.distanceTo(s.ray.origin)<_e}return!0}function objectScale(o,e){if(e instanceof OrthographicCamera$1)return e.zoom;if(e instanceof PerspectiveCamera){const s=v1.setFromMatrixPosition(o.matrixWorld),a=v2.setFromMatrixPosition(e.matrixWorld),c=e.fov*Math.PI/180,d=s.distanceTo(a);return 1/(2*Math.tan(c/2)*d)}else return 1}function objectZIndex(o,e,s){if(e instanceof PerspectiveCamera||e instanceof OrthographicCamera$1){const a=v1.setFromMatrixPosition(o.matrixWorld),c=v2.setFromMatrixPosition(e.matrixWorld),d=a.distanceTo(c),b=(s[1]-s[0])/(e.far-e.near),_e=s[1]-b*e.far;return Math.round(b*d+_e)}}const epsilon=o=>Math.abs(o)<1e-10?0:o;function getCSSMatrix(o,e,s=""){let a="matrix3d(";for(let c=0;c!==16;c++)a+=epsilon(e[c]*o.elements[c])+(c!==15?",":")");return s+a}const getCameraCSSMatrix=(o=>e=>getCSSMatrix(e,o))([1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1]),getObjectCSSMatrix=(o=>(e,s)=>getCSSMatrix(e,o(s),"translate(-50%,-50%)"))(o=>[1/o,1/o,1/o,1,-1/o,-1/o,-1/o,-1,1/o,1/o,1/o,1,1,1,1,1]);function isRefObject(o){return o&&typeof o=="object"&&"current"in o}const Html=reactExports.forwardRef(({children:o,eps:e=.001,style:s,className:a,prepend:c,center:d,fullscreen:b,portal:_e,distanceFactor:tt,sprite:nt=!1,transform:it=!1,occlude:ot,onOcclude:at,castShadow:ct,receiveShadow:ut,material:ft,geometry:dt,zIndexRange:lt=[16777271,0],calculatePosition:ht=defaultCalculatePosition,as:mt="div",wrapperClass:xt,pointerEvents:St="auto",...yt},wt)=>{const{gl:Et,camera:_t,scene:vt,size:Mt,raycaster:jt,events:Lt,viewport:Nt}=useThree(),[kt]=reactExports.useState(()=>document.createElement(mt)),Ot=reactExports.useRef(),Ht=reactExports.useRef(null),Ct=reactExports.useRef(0),Ut=reactExports.useRef([0,0]),Gt=reactExports.useRef(null),Pt=reactExports.useRef(null),Wt=(_e==null?void 0:_e.current)||Lt.connected||Et.domElement.parentNode,sn=reactExports.useRef(null),Bt=reactExports.useRef(!1),tn=reactExports.useMemo(()=>ot&&ot!=="blending"||Array.isArray(ot)&&ot.length&&isRefObject(ot[0]),[ot]);reactExports.useLayoutEffect(()=>{const Wn=Et.domElement;ot&&ot==="blending"?(Wn.style.zIndex=`${Math.floor(lt[0]/2)}`,Wn.style.position="absolute",Wn.style.pointerEvents="none"):(Wn.style.zIndex=null,Wn.style.position=null,Wn.style.pointerEvents=null)},[ot]),reactExports.useLayoutEffect(()=>{if(Ht.current){const Wn=Ot.current=createRoot$1(kt);if(vt.updateMatrixWorld(),it)kt.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{const Bn=ht(Ht.current,_t,Mt);kt.style.cssText=`position:absolute;top:0;left:0;transform:translate3d(${Bn[0]}px,${Bn[1]}px,0);transform-origin:0 0;`}return Wt&&(c?Wt.prepend(kt):Wt.appendChild(kt)),()=>{Wt&&Wt.removeChild(kt),Wn.unmount()}}},[Wt,it]),reactExports.useLayoutEffect(()=>{xt&&(kt.className=xt)},[xt]);const cn=reactExports.useMemo(()=>it?{position:"absolute",top:0,left:0,width:Mt.width,height:Mt.height,transformStyle:"preserve-3d",pointerEvents:"none"}:{position:"absolute",transform:d?"translate3d(-50%,-50%,0)":"none",...b&&{top:-Mt.height/2,left:-Mt.width/2,width:Mt.width,height:Mt.height},...s},[s,d,b,Mt,it]),vn=reactExports.useMemo(()=>({position:"absolute",pointerEvents:St}),[St]);reactExports.useLayoutEffect(()=>{if(Bt.current=!1,it){var Wn;(Wn=Ot.current)==null||Wn.render(reactExports.createElement("div",{ref:Gt,style:cn},reactExports.createElement("div",{ref:Pt,style:vn},reactExports.createElement("div",{ref:wt,className:a,style:s,children:o}))))}else{var Bn;(Bn=Ot.current)==null||Bn.render(reactExports.createElement("div",{ref:wt,style:cn,className:a,children:o}))}});const On=reactExports.useRef(!0);useFrame(Wn=>{if(Ht.current){_t.updateMatrixWorld(),Ht.current.updateWorldMatrix(!0,!1);const Bn=it?Ut.current:ht(Ht.current,_t,Mt);if(it||Math.abs(Ct.current-_t.zoom)>e||Math.abs(Ut.current[0]-Bn[0])>e||Math.abs(Ut.current[1]-Bn[1])>e){const gn=isObjectBehindCamera(Ht.current,_t);let bn=!1;tn&&(Array.isArray(ot)?bn=ot.map(kn=>kn.current):ot!=="blending"&&(bn=[vt]));const Kt=On.current;if(bn){const kn=isObjectVisible(Ht.current,_t,jt,bn);On.current=kn&&!gn}else On.current=!gn;Kt!==On.current&&(at?at(!On.current):kt.style.display=On.current?"block":"none");const Jn=Math.floor(lt[0]/2),Cn=ot?tn?[lt[0],Jn]:[Jn-1,0]:lt;if(kt.style.zIndex=`${objectZIndex(Ht.current,_t,Cn)}`,it){const[kn,Nn]=[Mt.width/2,Mt.height/2],ir=_t.projectionMatrix.elements[5]*Nn,{isOrthographicCamera:Un,top:zt,left:It,bottom:on,right:xn}=_t,wn=getCameraCSSMatrix(_t.matrixWorldInverse),En=Un?`scale(${ir})translate(${epsilon(-(xn+It)/2)}px,${epsilon((zt+on)/2)}px)`:`translateZ(${ir}px)`;let Hn=Ht.current.matrixWorld;nt&&(Hn=_t.matrixWorldInverse.clone().transpose().copyPosition(Hn).scale(Ht.current.scale),Hn.elements[3]=Hn.elements[7]=Hn.elements[11]=0,Hn.elements[15]=1),kt.style.width=Mt.width+"px",kt.style.height=Mt.height+"px",kt.style.perspective=Un?"":`${ir}px`,Gt.current&&Pt.current&&(Gt.current.style.transform=`${En}${wn}translate(${kn}px,${Nn}px)`,Pt.current.style.transform=getObjectCSSMatrix(Hn,1/((tt||10)/400)))}else{const kn=tt===void 0?1:objectScale(Ht.current,_t)*tt;kt.style.transform=`translate3d(${Bn[0]}px,${Bn[1]}px,0) scale(${kn})`}Ut.current=Bn,Ct.current=_t.zoom}}if(!tn&&sn.current&&!Bt.current)if(it){if(Gt.current){const Bn=Gt.current.children[0];if(Bn!=null&&Bn.clientWidth&&Bn!=null&&Bn.clientHeight){const{isOrthographicCamera:gn}=_t;if(gn||dt)yt.scale&&(Array.isArray(yt.scale)?yt.scale instanceof Vector3?sn.current.scale.copy(yt.scale.clone().divideScalar(1)):sn.current.scale.set(1/yt.scale[0],1/yt.scale[1],1/yt.scale[2]):sn.current.scale.setScalar(1/yt.scale));else{const bn=(tt||10)/400,Kt=Bn.clientWidth*bn,Jn=Bn.clientHeight*bn;sn.current.scale.set(Kt,Jn,1)}Bt.current=!0}}}else{const Bn=kt.children[0];if(Bn!=null&&Bn.clientWidth&&Bn!=null&&Bn.clientHeight){const gn=1/Nt.factor,bn=Bn.clientWidth*gn,Kt=Bn.clientHeight*gn;sn.current.scale.set(bn,Kt,1),Bt.current=!0}sn.current.lookAt(Wn.camera.position)}});const rr=reactExports.useMemo(()=>({vertexShader:it?void 0:`
          /*
            This shader is from the THREE's SpriteMaterial.
            We need to turn the backing plane into a Sprite
            (make it always face the camera) if "transfrom"
            is false.
          */
          #include <common>

          void main() {
            vec2 center = vec2(0., 1.);
            float rotation = 0.0;

            // This is somewhat arbitrary, but it seems to work well
            // Need to figure out how to derive this dynamically if it even matters
            float size = 0.03;

            vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
            vec2 scale;
            scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
            scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );

            bool isPerspective = isPerspectiveMatrix( projectionMatrix );
            if ( isPerspective ) scale *= - mvPosition.z;

            vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;
            vec2 rotatedPosition;
            rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
            rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
            mvPosition.xy += rotatedPosition;

            gl_Position = projectionMatrix * mvPosition;
          }
      `,fragmentShader:`
        void main() {
          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
        }
      `}),[it]);return reactExports.createElement("group",_extends({},yt,{ref:Ht}),ot&&!tn&&reactExports.createElement("mesh",{castShadow:ct,receiveShadow:ut,ref:sn},dt||reactExports.createElement("planeGeometry",null),ft||reactExports.createElement("shaderMaterial",{side:DoubleSide,vertexShader:rr.vertexShader,fragmentShader:rr.fragmentShader})))}),createStoreImpl=o=>{let e;const s=new Set,a=(nt,it)=>{const ot=typeof nt=="function"?nt(e):nt;if(!Object.is(ot,e)){const at=e;e=it??(typeof ot!="object"||ot===null)?ot:Object.assign({},e,ot),s.forEach(ct=>ct(e,at))}},c=()=>e,_e={setState:a,getState:c,getInitialState:()=>tt,subscribe:nt=>(s.add(nt),()=>s.delete(nt))},tt=e=o(a,c,_e);return _e},createStore=o=>o?createStoreImpl(o):createStoreImpl,identity=o=>o;function useStore(o,e=identity){const s=React.useSyncExternalStore(o.subscribe,()=>e(o.getState()),()=>e(o.getInitialState()));return React.useDebugValue(s),s}const createImpl=o=>{const e=createStore(o),s=a=>useStore(e,a);return Object.assign(s,e),s},create$1=o=>o?createImpl(o):createImpl,subscribeWithSelectorImpl=o=>(e,s,a)=>{const c=a.subscribe;return a.subscribe=(b,_e,tt)=>{let nt=b;if(_e){const it=(tt==null?void 0:tt.equalityFn)||Object.is;let ot=b(a.getState());nt=at=>{const ct=b(at);if(!it(ot,ct)){const ut=ot;_e(ot=ct,ut)}},tt!=null&&tt.fireImmediately&&_e(ot,ot)}return c(nt)},o(e,s,a)},subscribeWithSelector=subscribeWithSelectorImpl,context=reactExports.createContext(null);function KeyboardControls({map:o,children:e,onChange:s,domElement:a}){const c=o.map(tt=>tt.name+tt.keys).join("-"),d=reactExports.useMemo(()=>create$1(subscribeWithSelector(()=>o.reduce((tt,nt)=>({...tt,[nt.name]:!1}),{}))),[c]),b=reactExports.useMemo(()=>[d.subscribe,d.getState,d],[c]),_e=d.setState;return reactExports.useEffect(()=>{const nt=o.map(({name:ct,keys:ut,up:ft})=>({keys:ut,up:ft,fn:dt=>{_e({[ct]:dt}),s&&s(ct,dt,b[1]())}})).reduce((ct,{keys:ut,fn:ft,up:dt=!0})=>(ut.forEach(lt=>ct[lt]={fn:ft,pressed:!1,up:dt}),ct),{}),it=({key:ct,code:ut})=>{const ft=nt[ct]||nt[ut];if(!ft)return;const{fn:dt,pressed:lt,up:ht}=ft;ft.pressed=!0,(ht||!lt)&&dt(!0)},ot=({key:ct,code:ut})=>{const ft=nt[ct]||nt[ut];if(!ft)return;const{fn:dt,up:lt}=ft;ft.pressed=!1,lt&&dt(!1)},at=a||window;return at.addEventListener("keydown",it,{passive:!0}),at.addEventListener("keyup",ot,{passive:!0}),()=>{at.removeEventListener("keydown",it),at.removeEventListener("keyup",ot)}},[a,c]),reactExports.createElement(context.Provider,{value:b,children:e})}function useKeyboardControls(o){const[e,s,a]=reactExports.useContext(context);return[e,s]}const version$1=parseInt(REVISION.replace(/\D+/g,""));function toTrianglesDrawMode(o,e){if(e===TrianglesDrawMode)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),o;if(e===TriangleFanDrawMode||e===TriangleStripDrawMode){let s=o.getIndex();if(s===null){const b=[],_e=o.getAttribute("position");if(_e!==void 0){for(let tt=0;tt<_e.count;tt++)b.push(tt);o.setIndex(b),s=o.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),o}const a=s.count-2,c=[];if(s)if(e===TriangleFanDrawMode)for(let b=1;b<=a;b++)c.push(s.getX(0)),c.push(s.getX(b)),c.push(s.getX(b+1));else for(let b=0;b<a;b++)b%2===0?(c.push(s.getX(b)),c.push(s.getX(b+1)),c.push(s.getX(b+2))):(c.push(s.getX(b+2)),c.push(s.getX(b+1)),c.push(s.getX(b)));c.length/3!==a&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const d=o.clone();return d.setIndex(c),d.clearGroups(),d}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),o}var u8=Uint8Array,u16=Uint16Array,u32=Uint32Array,fleb=new u8([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),fdeb=new u8([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),clim=new u8([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),freb=function(o,e){for(var s=new u16(31),a=0;a<31;++a)s[a]=e+=1<<o[a-1];for(var c=new u32(s[30]),a=1;a<30;++a)for(var d=s[a];d<s[a+1];++d)c[d]=d-s[a]<<5|a;return[s,c]},_a=freb(fleb,2),fl=_a[0],revfl=_a[1];fl[28]=258,revfl[258]=28;var _b=freb(fdeb,0),fd=_b[0],rev=new u16(32768);for(var i=0;i<32768;++i){var x=(i&43690)>>>1|(i&21845)<<1;x=(x&52428)>>>2|(x&13107)<<2,x=(x&61680)>>>4|(x&3855)<<4,rev[i]=((x&65280)>>>8|(x&255)<<8)>>>1}var hMap=function(o,e,s){for(var a=o.length,c=0,d=new u16(e);c<a;++c)++d[o[c]-1];var b=new u16(e);for(c=0;c<e;++c)b[c]=b[c-1]+d[c-1]<<1;var _e;if(s){_e=new u16(1<<e);var tt=15-e;for(c=0;c<a;++c)if(o[c])for(var nt=c<<4|o[c],it=e-o[c],ot=b[o[c]-1]++<<it,at=ot|(1<<it)-1;ot<=at;++ot)_e[rev[ot]>>>tt]=nt}else for(_e=new u16(a),c=0;c<a;++c)o[c]&&(_e[c]=rev[b[o[c]-1]++]>>>15-o[c]);return _e},flt=new u8(288);for(var i=0;i<144;++i)flt[i]=8;for(var i=144;i<256;++i)flt[i]=9;for(var i=256;i<280;++i)flt[i]=7;for(var i=280;i<288;++i)flt[i]=8;var fdt=new u8(32);for(var i=0;i<32;++i)fdt[i]=5;var flrm=hMap(flt,9,1),fdrm=hMap(fdt,5,1),max=function(o){for(var e=o[0],s=1;s<o.length;++s)o[s]>e&&(e=o[s]);return e},bits=function(o,e,s){var a=e/8|0;return(o[a]|o[a+1]<<8)>>(e&7)&s},bits16=function(o,e){var s=e/8|0;return(o[s]|o[s+1]<<8|o[s+2]<<16)>>(e&7)},shft=function(o){return(o/8|0)+(o&7&&1)},slc=function(o,e,s){(s==null||s>o.length)&&(s=o.length);var a=new(o instanceof u16?u16:o instanceof u32?u32:u8)(s-e);return a.set(o.subarray(e,s)),a},inflt=function(o,e,s){var a=o.length;if(!a||s&&!s.l&&a<5)return e||new u8(0);var c=!e||s,d=!s||s.i;s||(s={}),e||(e=new u8(a*3));var b=function(cn){var vn=e.length;if(cn>vn){var On=new u8(Math.max(vn*2,cn));On.set(e),e=On}},_e=s.f||0,tt=s.p||0,nt=s.b||0,it=s.l,ot=s.d,at=s.m,ct=s.n,ut=a*8;do{if(!it){s.f=_e=bits(o,tt,1);var ft=bits(o,tt+1,3);if(tt+=3,ft)if(ft==1)it=flrm,ot=fdrm,at=9,ct=5;else if(ft==2){var mt=bits(o,tt,31)+257,xt=bits(o,tt+10,15)+4,St=mt+bits(o,tt+5,31)+1;tt+=14;for(var yt=new u8(St),wt=new u8(19),Et=0;Et<xt;++Et)wt[clim[Et]]=bits(o,tt+Et*3,7);tt+=xt*3;for(var _t=max(wt),vt=(1<<_t)-1,Mt=hMap(wt,_t,1),Et=0;Et<St;){var jt=Mt[bits(o,tt,vt)];tt+=jt&15;var dt=jt>>>4;if(dt<16)yt[Et++]=dt;else{var Lt=0,Nt=0;for(dt==16?(Nt=3+bits(o,tt,3),tt+=2,Lt=yt[Et-1]):dt==17?(Nt=3+bits(o,tt,7),tt+=3):dt==18&&(Nt=11+bits(o,tt,127),tt+=7);Nt--;)yt[Et++]=Lt}}var kt=yt.subarray(0,mt),Ot=yt.subarray(mt);at=max(kt),ct=max(Ot),it=hMap(kt,at,1),ot=hMap(Ot,ct,1)}else throw"invalid block type";else{var dt=shft(tt)+4,lt=o[dt-4]|o[dt-3]<<8,ht=dt+lt;if(ht>a){if(d)throw"unexpected EOF";break}c&&b(nt+lt),e.set(o.subarray(dt,ht),nt),s.b=nt+=lt,s.p=tt=ht*8;continue}if(tt>ut){if(d)throw"unexpected EOF";break}}c&&b(nt+131072);for(var Ht=(1<<at)-1,Ct=(1<<ct)-1,Ut=tt;;Ut=tt){var Lt=it[bits16(o,tt)&Ht],Gt=Lt>>>4;if(tt+=Lt&15,tt>ut){if(d)throw"unexpected EOF";break}if(!Lt)throw"invalid length/literal";if(Gt<256)e[nt++]=Gt;else if(Gt==256){Ut=tt,it=null;break}else{var Pt=Gt-254;if(Gt>264){var Et=Gt-257,Wt=fleb[Et];Pt=bits(o,tt,(1<<Wt)-1)+fl[Et],tt+=Wt}var sn=ot[bits16(o,tt)&Ct],Bt=sn>>>4;if(!sn)throw"invalid distance";tt+=sn&15;var Ot=fd[Bt];if(Bt>3){var Wt=fdeb[Bt];Ot+=bits16(o,tt)&(1<<Wt)-1,tt+=Wt}if(tt>ut){if(d)throw"unexpected EOF";break}c&&b(nt+131072);for(var tn=nt+Pt;nt<tn;nt+=4)e[nt]=e[nt-Ot],e[nt+1]=e[nt+1-Ot],e[nt+2]=e[nt+2-Ot],e[nt+3]=e[nt+3-Ot];nt=tn}}s.l=it,s.p=Ut,s.b=nt,it&&(_e=1,s.m=at,s.d=ot,s.n=ct)}while(!_e);return nt==e.length?e:slc(e,0,nt)},et=new u8(0),zlv=function(o){if((o[0]&15)!=8||o[0]>>>4>7||(o[0]<<8|o[1])%31)throw"invalid zlib data";if(o[1]&32)throw"invalid zlib data: preset dictionaries not supported"};function unzlibSync(o,e){return inflt((zlv(o),o.subarray(2,-4)),e)}var td=typeof TextDecoder<"u"&&new TextDecoder,tds=0;try{td.decode(et,{stream:!0}),tds=1}catch{}var __defProp$4=Object.defineProperty,__defNormalProp$4=(o,e,s)=>e in o?__defProp$4(o,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):o[e]=s,__publicField$4=(o,e,s)=>(__defNormalProp$4(o,typeof e!="symbol"?e+"":e,s),s);const Sky$1=(()=>{const o={uniforms:{turbidity:{value:2},rayleigh:{value:1},mieCoefficient:{value:.005},mieDirectionalG:{value:.8},sunPosition:{value:new Vector3},up:{value:new Vector3(0,1,0)}},vertexShader:`
      uniform vec3 sunPosition;
      uniform float rayleigh;
      uniform float turbidity;
      uniform float mieCoefficient;
      uniform vec3 up;

      varying vec3 vWorldPosition;
      varying vec3 vSunDirection;
      varying float vSunfade;
      varying vec3 vBetaR;
      varying vec3 vBetaM;
      varying float vSunE;

      // constants for atmospheric scattering
      const float e = 2.71828182845904523536028747135266249775724709369995957;
      const float pi = 3.141592653589793238462643383279502884197169;

      // wavelength of used primaries, according to preetham
      const vec3 lambda = vec3( 680E-9, 550E-9, 450E-9 );
      // this pre-calcuation replaces older TotalRayleigh(vec3 lambda) function:
      // (8.0 * pow(pi, 3.0) * pow(pow(n, 2.0) - 1.0, 2.0) * (6.0 + 3.0 * pn)) / (3.0 * N * pow(lambda, vec3(4.0)) * (6.0 - 7.0 * pn))
      const vec3 totalRayleigh = vec3( 5.804542996261093E-6, 1.3562911419845635E-5, 3.0265902468824876E-5 );

      // mie stuff
      // K coefficient for the primaries
      const float v = 4.0;
      const vec3 K = vec3( 0.686, 0.678, 0.666 );
      // MieConst = pi * pow( ( 2.0 * pi ) / lambda, vec3( v - 2.0 ) ) * K
      const vec3 MieConst = vec3( 1.8399918514433978E14, 2.7798023919660528E14, 4.0790479543861094E14 );

      // earth shadow hack
      // cutoffAngle = pi / 1.95;
      const float cutoffAngle = 1.6110731556870734;
      const float steepness = 1.5;
      const float EE = 1000.0;

      float sunIntensity( float zenithAngleCos ) {
        zenithAngleCos = clamp( zenithAngleCos, -1.0, 1.0 );
        return EE * max( 0.0, 1.0 - pow( e, -( ( cutoffAngle - acos( zenithAngleCos ) ) / steepness ) ) );
      }

      vec3 totalMie( float T ) {
        float c = ( 0.2 * T ) * 10E-18;
        return 0.434 * c * MieConst;
      }

      void main() {

        vec4 worldPosition = modelMatrix * vec4( position, 1.0 );
        vWorldPosition = worldPosition.xyz;

        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        gl_Position.z = gl_Position.w; // set z to camera.far

        vSunDirection = normalize( sunPosition );

        vSunE = sunIntensity( dot( vSunDirection, up ) );

        vSunfade = 1.0 - clamp( 1.0 - exp( ( sunPosition.y / 450000.0 ) ), 0.0, 1.0 );

        float rayleighCoefficient = rayleigh - ( 1.0 * ( 1.0 - vSunfade ) );

      // extinction (absorbtion + out scattering)
      // rayleigh coefficients
        vBetaR = totalRayleigh * rayleighCoefficient;

      // mie coefficients
        vBetaM = totalMie( turbidity ) * mieCoefficient;

      }
    `,fragmentShader:`
      varying vec3 vWorldPosition;
      varying vec3 vSunDirection;
      varying float vSunfade;
      varying vec3 vBetaR;
      varying vec3 vBetaM;
      varying float vSunE;

      uniform float mieDirectionalG;
      uniform vec3 up;

      const vec3 cameraPos = vec3( 0.0, 0.0, 0.0 );

      // constants for atmospheric scattering
      const float pi = 3.141592653589793238462643383279502884197169;

      const float n = 1.0003; // refractive index of air
      const float N = 2.545E25; // number of molecules per unit volume for air at 288.15K and 1013mb (sea level -45 celsius)

      // optical length at zenith for molecules
      const float rayleighZenithLength = 8.4E3;
      const float mieZenithLength = 1.25E3;
      // 66 arc seconds -> degrees, and the cosine of that
      const float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;

      // 3.0 / ( 16.0 * pi )
      const float THREE_OVER_SIXTEENPI = 0.05968310365946075;
      // 1.0 / ( 4.0 * pi )
      const float ONE_OVER_FOURPI = 0.07957747154594767;

      float rayleighPhase( float cosTheta ) {
        return THREE_OVER_SIXTEENPI * ( 1.0 + pow( cosTheta, 2.0 ) );
      }

      float hgPhase( float cosTheta, float g ) {
        float g2 = pow( g, 2.0 );
        float inverse = 1.0 / pow( 1.0 - 2.0 * g * cosTheta + g2, 1.5 );
        return ONE_OVER_FOURPI * ( ( 1.0 - g2 ) * inverse );
      }

      void main() {

        vec3 direction = normalize( vWorldPosition - cameraPos );

      // optical length
      // cutoff angle at 90 to avoid singularity in next formula.
        float zenithAngle = acos( max( 0.0, dot( up, direction ) ) );
        float inverse = 1.0 / ( cos( zenithAngle ) + 0.15 * pow( 93.885 - ( ( zenithAngle * 180.0 ) / pi ), -1.253 ) );
        float sR = rayleighZenithLength * inverse;
        float sM = mieZenithLength * inverse;

      // combined extinction factor
        vec3 Fex = exp( -( vBetaR * sR + vBetaM * sM ) );

      // in scattering
        float cosTheta = dot( direction, vSunDirection );

        float rPhase = rayleighPhase( cosTheta * 0.5 + 0.5 );
        vec3 betaRTheta = vBetaR * rPhase;

        float mPhase = hgPhase( cosTheta, mieDirectionalG );
        vec3 betaMTheta = vBetaM * mPhase;

        vec3 Lin = pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * ( 1.0 - Fex ), vec3( 1.5 ) );
        Lin *= mix( vec3( 1.0 ), pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * Fex, vec3( 1.0 / 2.0 ) ), clamp( pow( 1.0 - dot( up, vSunDirection ), 5.0 ), 0.0, 1.0 ) );

      // nightsky
        float theta = acos( direction.y ); // elevation --> y-axis, [-pi/2, pi/2]
        float phi = atan( direction.z, direction.x ); // azimuth --> x-axis [-pi/2, pi/2]
        vec2 uv = vec2( phi, theta ) / vec2( 2.0 * pi, pi ) + vec2( 0.5, 0.0 );
        vec3 L0 = vec3( 0.1 ) * Fex;

      // composition + solar disc
        float sundisk = smoothstep( sunAngularDiameterCos, sunAngularDiameterCos + 0.00002, cosTheta );
        L0 += ( vSunE * 19000.0 * Fex ) * sundisk;

        vec3 texColor = ( Lin + L0 ) * 0.04 + vec3( 0.0, 0.0003, 0.00075 );

        vec3 retColor = pow( texColor, vec3( 1.0 / ( 1.2 + ( 1.2 * vSunfade ) ) ) );

        gl_FragColor = vec4( retColor, 1.0 );

      #include <tonemapping_fragment>
      #include <${version$1>=154?"colorspace_fragment":"encodings_fragment"}>

      }
    `},e=new ShaderMaterial({name:"SkyShader",fragmentShader:o.fragmentShader,vertexShader:o.vertexShader,uniforms:UniformsUtils.clone(o.uniforms),side:BackSide,depthWrite:!1});class s extends Mesh{constructor(){super(new BoxGeometry(1,1,1),e)}}return __publicField$4(s,"SkyShader",o),__publicField$4(s,"material",e),s})(),isCubeTexture=o=>o&&o.isCubeTexture;class GroundProjectedEnv extends Mesh{constructor(e,s){var a,c;const d=isCubeTexture(e),_e=((c=d?(a=e.image[0])==null?void 0:a.width:e.image.width)!=null?c:1024)/4,tt=Math.floor(Math.log2(_e)),nt=Math.pow(2,tt),it=3*Math.max(nt,16*7),ot=4*nt,at=[d?"#define ENVMAP_TYPE_CUBE":"",`#define CUBEUV_TEXEL_WIDTH ${1/it}`,`#define CUBEUV_TEXEL_HEIGHT ${1/ot}`,`#define CUBEUV_MAX_MIP ${tt}.0`],ct=`
        varying vec3 vWorldPosition;
        void main() 
        {
            vec4 worldPosition = ( modelMatrix * vec4( position, 1.0 ) );
            vWorldPosition = worldPosition.xyz;
            
            gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        }
        `,ut=at.join(`
`)+`
        #define ENVMAP_TYPE_CUBE_UV
        varying vec3 vWorldPosition;
        uniform float radius;
        uniform float height;
        uniform float angle;
        #ifdef ENVMAP_TYPE_CUBE
            uniform samplerCube map;
        #else
            uniform sampler2D map;
        #endif
        // From: https://www.shadertoy.com/view/4tsBD7
        float diskIntersectWithBackFaceCulling( vec3 ro, vec3 rd, vec3 c, vec3 n, float r ) 
        {
            float d = dot ( rd, n );
            
            if( d > 0.0 ) { return 1e6; }
            
            vec3  o = ro - c;
            float t = - dot( n, o ) / d;
            vec3  q = o + rd * t;
            
            return ( dot( q, q ) < r * r ) ? t : 1e6;
        }
        // From: https://www.iquilezles.org/www/articles/intersectors/intersectors.htm
        float sphereIntersect( vec3 ro, vec3 rd, vec3 ce, float ra ) 
        {
            vec3 oc = ro - ce;
            float b = dot( oc, rd );
            float c = dot( oc, oc ) - ra * ra;
            float h = b * b - c;
            
            if( h < 0.0 ) { return -1.0; }
            
            h = sqrt( h );
            
            return - b + h;
        }
        vec3 project() 
        {
            vec3 p = normalize( vWorldPosition );
            vec3 camPos = cameraPosition;
            camPos.y -= height;
            float intersection = sphereIntersect( camPos, p, vec3( 0.0 ), radius );
            if( intersection > 0.0 ) {
                
                vec3 h = vec3( 0.0, - height, 0.0 );
                float intersection2 = diskIntersectWithBackFaceCulling( camPos, p, h, vec3( 0.0, 1.0, 0.0 ), radius );
                p = ( camPos + min( intersection, intersection2 ) * p ) / radius;
            } else {
                p = vec3( 0.0, 1.0, 0.0 );
            }
            return p;
        }
        #include <common>
        #include <cube_uv_reflection_fragment>
        void main() 
        {
            vec3 projectedWorldPosition = project();
            
            #ifdef ENVMAP_TYPE_CUBE
                vec3 outcolor = textureCube( map, projectedWorldPosition ).rgb;
            #else
                vec3 direction = normalize( projectedWorldPosition );
                vec2 uv = equirectUv( direction );
                vec3 outcolor = texture2D( map, uv ).rgb;
            #endif
            gl_FragColor = vec4( outcolor, 1.0 );
            #include <tonemapping_fragment>
            #include <${version$1>=154?"colorspace_fragment":"encodings_fragment"}>
        }
        `,ft={map:{value:e},height:{value:(s==null?void 0:s.height)||15},radius:{value:(s==null?void 0:s.radius)||100}},dt=new IcosahedronGeometry(1,16),lt=new ShaderMaterial({uniforms:ft,fragmentShader:ut,vertexShader:ct,side:DoubleSide});super(dt,lt)}set radius(e){this.material.uniforms.radius.value=e}get radius(){return this.material.uniforms.radius.value}set height(e){this.material.uniforms.height.value=e}get height(){return this.material.uniforms.height.value}}var __defProp$3=Object.defineProperty,__defNormalProp$3=(o,e,s)=>e in o?__defProp$3(o,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):o[e]=s,__publicField$3=(o,e,s)=>(__defNormalProp$3(o,e+"",s),s);class EventDispatcher{constructor(){__publicField$3(this,"_listeners")}addEventListener(e,s){this._listeners===void 0&&(this._listeners={});const a=this._listeners;a[e]===void 0&&(a[e]=[]),a[e].indexOf(s)===-1&&a[e].push(s)}hasEventListener(e,s){if(this._listeners===void 0)return!1;const a=this._listeners;return a[e]!==void 0&&a[e].indexOf(s)!==-1}removeEventListener(e,s){if(this._listeners===void 0)return;const c=this._listeners[e];if(c!==void 0){const d=c.indexOf(s);d!==-1&&c.splice(d,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const a=this._listeners[e.type];if(a!==void 0){e.target=this;const c=a.slice(0);for(let d=0,b=c.length;d<b;d++)c[d].call(this,e);e.target=null}}}var __defProp$2=Object.defineProperty,__defNormalProp$2=(o,e,s)=>e in o?__defProp$2(o,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):o[e]=s,__publicField$2=(o,e,s)=>(__defNormalProp$2(o,typeof e!="symbol"?e+"":e,s),s);let TransformControls$1=class extends Object3D{constructor(e,s){super(),__publicField$2(this,"isTransformControls",!0),__publicField$2(this,"visible",!1),__publicField$2(this,"domElement"),__publicField$2(this,"raycaster",new Raycaster),__publicField$2(this,"gizmo"),__publicField$2(this,"plane"),__publicField$2(this,"tempVector",new Vector3),__publicField$2(this,"tempVector2",new Vector3),__publicField$2(this,"tempQuaternion",new Quaternion),__publicField$2(this,"unit",{X:new Vector3(1,0,0),Y:new Vector3(0,1,0),Z:new Vector3(0,0,1)}),__publicField$2(this,"pointStart",new Vector3),__publicField$2(this,"pointEnd",new Vector3),__publicField$2(this,"offset",new Vector3),__publicField$2(this,"rotationAxis",new Vector3),__publicField$2(this,"startNorm",new Vector3),__publicField$2(this,"endNorm",new Vector3),__publicField$2(this,"rotationAngle",0),__publicField$2(this,"cameraPosition",new Vector3),__publicField$2(this,"cameraQuaternion",new Quaternion),__publicField$2(this,"cameraScale",new Vector3),__publicField$2(this,"parentPosition",new Vector3),__publicField$2(this,"parentQuaternion",new Quaternion),__publicField$2(this,"parentQuaternionInv",new Quaternion),__publicField$2(this,"parentScale",new Vector3),__publicField$2(this,"worldPositionStart",new Vector3),__publicField$2(this,"worldQuaternionStart",new Quaternion),__publicField$2(this,"worldScaleStart",new Vector3),__publicField$2(this,"worldPosition",new Vector3),__publicField$2(this,"worldQuaternion",new Quaternion),__publicField$2(this,"worldQuaternionInv",new Quaternion),__publicField$2(this,"worldScale",new Vector3),__publicField$2(this,"eye",new Vector3),__publicField$2(this,"positionStart",new Vector3),__publicField$2(this,"quaternionStart",new Quaternion),__publicField$2(this,"scaleStart",new Vector3),__publicField$2(this,"camera"),__publicField$2(this,"object"),__publicField$2(this,"enabled",!0),__publicField$2(this,"axis",null),__publicField$2(this,"mode","translate"),__publicField$2(this,"translationSnap",null),__publicField$2(this,"rotationSnap",null),__publicField$2(this,"scaleSnap",null),__publicField$2(this,"space","world"),__publicField$2(this,"size",1),__publicField$2(this,"dragging",!1),__publicField$2(this,"showX",!0),__publicField$2(this,"showY",!0),__publicField$2(this,"showZ",!0),__publicField$2(this,"changeEvent",{type:"change"}),__publicField$2(this,"mouseDownEvent",{type:"mouseDown",mode:this.mode}),__publicField$2(this,"mouseUpEvent",{type:"mouseUp",mode:this.mode}),__publicField$2(this,"objectChangeEvent",{type:"objectChange"}),__publicField$2(this,"intersectObjectWithRay",(c,d,b)=>{const _e=d.intersectObject(c,!0);for(let tt=0;tt<_e.length;tt++)if(_e[tt].object.visible||b)return _e[tt];return!1}),__publicField$2(this,"attach",c=>(this.object=c,this.visible=!0,this)),__publicField$2(this,"detach",()=>(this.object=void 0,this.visible=!1,this.axis=null,this)),__publicField$2(this,"reset",()=>this.enabled?(this.dragging&&this.object!==void 0&&(this.object.position.copy(this.positionStart),this.object.quaternion.copy(this.quaternionStart),this.object.scale.copy(this.scaleStart),this.dispatchEvent(this.changeEvent),this.dispatchEvent(this.objectChangeEvent),this.pointStart.copy(this.pointEnd)),this):this),__publicField$2(this,"updateMatrixWorld",()=>{this.object!==void 0&&(this.object.updateMatrixWorld(),this.object.parent===null?console.error("TransformControls: The attached 3D object must be a part of the scene graph."):this.object.parent.matrixWorld.decompose(this.parentPosition,this.parentQuaternion,this.parentScale),this.object.matrixWorld.decompose(this.worldPosition,this.worldQuaternion,this.worldScale),this.parentQuaternionInv.copy(this.parentQuaternion).invert(),this.worldQuaternionInv.copy(this.worldQuaternion).invert()),this.camera.updateMatrixWorld(),this.camera.matrixWorld.decompose(this.cameraPosition,this.cameraQuaternion,this.cameraScale),this.eye.copy(this.cameraPosition).sub(this.worldPosition).normalize(),super.updateMatrixWorld()}),__publicField$2(this,"pointerHover",c=>{if(this.object===void 0||this.dragging===!0)return;this.raycaster.setFromCamera(c,this.camera);const d=this.intersectObjectWithRay(this.gizmo.picker[this.mode],this.raycaster);d?this.axis=d.object.name:this.axis=null}),__publicField$2(this,"pointerDown",c=>{if(!(this.object===void 0||this.dragging===!0||c.button!==0)&&this.axis!==null){this.raycaster.setFromCamera(c,this.camera);const d=this.intersectObjectWithRay(this.plane,this.raycaster,!0);if(d){let b=this.space;if(this.mode==="scale"?b="local":(this.axis==="E"||this.axis==="XYZE"||this.axis==="XYZ")&&(b="world"),b==="local"&&this.mode==="rotate"){const _e=this.rotationSnap;this.axis==="X"&&_e&&(this.object.rotation.x=Math.round(this.object.rotation.x/_e)*_e),this.axis==="Y"&&_e&&(this.object.rotation.y=Math.round(this.object.rotation.y/_e)*_e),this.axis==="Z"&&_e&&(this.object.rotation.z=Math.round(this.object.rotation.z/_e)*_e)}this.object.updateMatrixWorld(),this.object.parent&&this.object.parent.updateMatrixWorld(),this.positionStart.copy(this.object.position),this.quaternionStart.copy(this.object.quaternion),this.scaleStart.copy(this.object.scale),this.object.matrixWorld.decompose(this.worldPositionStart,this.worldQuaternionStart,this.worldScaleStart),this.pointStart.copy(d.point).sub(this.worldPositionStart)}this.dragging=!0,this.mouseDownEvent.mode=this.mode,this.dispatchEvent(this.mouseDownEvent)}}),__publicField$2(this,"pointerMove",c=>{const d=this.axis,b=this.mode,_e=this.object;let tt=this.space;if(b==="scale"?tt="local":(d==="E"||d==="XYZE"||d==="XYZ")&&(tt="world"),_e===void 0||d===null||this.dragging===!1||c.button!==-1)return;this.raycaster.setFromCamera(c,this.camera);const nt=this.intersectObjectWithRay(this.plane,this.raycaster,!0);if(nt){if(this.pointEnd.copy(nt.point).sub(this.worldPositionStart),b==="translate")this.offset.copy(this.pointEnd).sub(this.pointStart),tt==="local"&&d!=="XYZ"&&this.offset.applyQuaternion(this.worldQuaternionInv),d.indexOf("X")===-1&&(this.offset.x=0),d.indexOf("Y")===-1&&(this.offset.y=0),d.indexOf("Z")===-1&&(this.offset.z=0),tt==="local"&&d!=="XYZ"?this.offset.applyQuaternion(this.quaternionStart).divide(this.parentScale):this.offset.applyQuaternion(this.parentQuaternionInv).divide(this.parentScale),_e.position.copy(this.offset).add(this.positionStart),this.translationSnap&&(tt==="local"&&(_e.position.applyQuaternion(this.tempQuaternion.copy(this.quaternionStart).invert()),d.search("X")!==-1&&(_e.position.x=Math.round(_e.position.x/this.translationSnap)*this.translationSnap),d.search("Y")!==-1&&(_e.position.y=Math.round(_e.position.y/this.translationSnap)*this.translationSnap),d.search("Z")!==-1&&(_e.position.z=Math.round(_e.position.z/this.translationSnap)*this.translationSnap),_e.position.applyQuaternion(this.quaternionStart)),tt==="world"&&(_e.parent&&_e.position.add(this.tempVector.setFromMatrixPosition(_e.parent.matrixWorld)),d.search("X")!==-1&&(_e.position.x=Math.round(_e.position.x/this.translationSnap)*this.translationSnap),d.search("Y")!==-1&&(_e.position.y=Math.round(_e.position.y/this.translationSnap)*this.translationSnap),d.search("Z")!==-1&&(_e.position.z=Math.round(_e.position.z/this.translationSnap)*this.translationSnap),_e.parent&&_e.position.sub(this.tempVector.setFromMatrixPosition(_e.parent.matrixWorld))));else if(b==="scale"){if(d.search("XYZ")!==-1){let it=this.pointEnd.length()/this.pointStart.length();this.pointEnd.dot(this.pointStart)<0&&(it*=-1),this.tempVector2.set(it,it,it)}else this.tempVector.copy(this.pointStart),this.tempVector2.copy(this.pointEnd),this.tempVector.applyQuaternion(this.worldQuaternionInv),this.tempVector2.applyQuaternion(this.worldQuaternionInv),this.tempVector2.divide(this.tempVector),d.search("X")===-1&&(this.tempVector2.x=1),d.search("Y")===-1&&(this.tempVector2.y=1),d.search("Z")===-1&&(this.tempVector2.z=1);_e.scale.copy(this.scaleStart).multiply(this.tempVector2),this.scaleSnap&&this.object&&(d.search("X")!==-1&&(this.object.scale.x=Math.round(_e.scale.x/this.scaleSnap)*this.scaleSnap||this.scaleSnap),d.search("Y")!==-1&&(_e.scale.y=Math.round(_e.scale.y/this.scaleSnap)*this.scaleSnap||this.scaleSnap),d.search("Z")!==-1&&(_e.scale.z=Math.round(_e.scale.z/this.scaleSnap)*this.scaleSnap||this.scaleSnap))}else if(b==="rotate"){this.offset.copy(this.pointEnd).sub(this.pointStart);const it=20/this.worldPosition.distanceTo(this.tempVector.setFromMatrixPosition(this.camera.matrixWorld));d==="E"?(this.rotationAxis.copy(this.eye),this.rotationAngle=this.pointEnd.angleTo(this.pointStart),this.startNorm.copy(this.pointStart).normalize(),this.endNorm.copy(this.pointEnd).normalize(),this.rotationAngle*=this.endNorm.cross(this.startNorm).dot(this.eye)<0?1:-1):d==="XYZE"?(this.rotationAxis.copy(this.offset).cross(this.eye).normalize(),this.rotationAngle=this.offset.dot(this.tempVector.copy(this.rotationAxis).cross(this.eye))*it):(d==="X"||d==="Y"||d==="Z")&&(this.rotationAxis.copy(this.unit[d]),this.tempVector.copy(this.unit[d]),tt==="local"&&this.tempVector.applyQuaternion(this.worldQuaternion),this.rotationAngle=this.offset.dot(this.tempVector.cross(this.eye).normalize())*it),this.rotationSnap&&(this.rotationAngle=Math.round(this.rotationAngle/this.rotationSnap)*this.rotationSnap),tt==="local"&&d!=="E"&&d!=="XYZE"?(_e.quaternion.copy(this.quaternionStart),_e.quaternion.multiply(this.tempQuaternion.setFromAxisAngle(this.rotationAxis,this.rotationAngle)).normalize()):(this.rotationAxis.applyQuaternion(this.parentQuaternionInv),_e.quaternion.copy(this.tempQuaternion.setFromAxisAngle(this.rotationAxis,this.rotationAngle)),_e.quaternion.multiply(this.quaternionStart).normalize())}this.dispatchEvent(this.changeEvent),this.dispatchEvent(this.objectChangeEvent)}}),__publicField$2(this,"pointerUp",c=>{c.button===0&&(this.dragging&&this.axis!==null&&(this.mouseUpEvent.mode=this.mode,this.dispatchEvent(this.mouseUpEvent)),this.dragging=!1,this.axis=null)}),__publicField$2(this,"getPointer",c=>{var d;if(this.domElement&&((d=this.domElement.ownerDocument)!=null&&d.pointerLockElement))return{x:0,y:0,button:c.button};{const b=c.changedTouches?c.changedTouches[0]:c,_e=this.domElement.getBoundingClientRect();return{x:(b.clientX-_e.left)/_e.width*2-1,y:-(b.clientY-_e.top)/_e.height*2+1,button:c.button}}}),__publicField$2(this,"onPointerHover",c=>{if(this.enabled)switch(c.pointerType){case"mouse":case"pen":this.pointerHover(this.getPointer(c));break}}),__publicField$2(this,"onPointerDown",c=>{!this.enabled||!this.domElement||(this.domElement.style.touchAction="none",this.domElement.ownerDocument.addEventListener("pointermove",this.onPointerMove),this.pointerHover(this.getPointer(c)),this.pointerDown(this.getPointer(c)))}),__publicField$2(this,"onPointerMove",c=>{this.enabled&&this.pointerMove(this.getPointer(c))}),__publicField$2(this,"onPointerUp",c=>{!this.enabled||!this.domElement||(this.domElement.style.touchAction="",this.domElement.ownerDocument.removeEventListener("pointermove",this.onPointerMove),this.pointerUp(this.getPointer(c)))}),__publicField$2(this,"getMode",()=>this.mode),__publicField$2(this,"setMode",c=>{this.mode=c}),__publicField$2(this,"setTranslationSnap",c=>{this.translationSnap=c}),__publicField$2(this,"setRotationSnap",c=>{this.rotationSnap=c}),__publicField$2(this,"setScaleSnap",c=>{this.scaleSnap=c}),__publicField$2(this,"setSize",c=>{this.size=c}),__publicField$2(this,"setSpace",c=>{this.space=c}),__publicField$2(this,"update",()=>{console.warn("THREE.TransformControls: update function has no more functionality and therefore has been deprecated.")}),__publicField$2(this,"connect",c=>{c===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.domElement=c,this.domElement.addEventListener("pointerdown",this.onPointerDown),this.domElement.addEventListener("pointermove",this.onPointerHover),this.domElement.ownerDocument.addEventListener("pointerup",this.onPointerUp)}),__publicField$2(this,"dispose",()=>{var c,d,b,_e,tt,nt;(c=this.domElement)==null||c.removeEventListener("pointerdown",this.onPointerDown),(d=this.domElement)==null||d.removeEventListener("pointermove",this.onPointerHover),(_e=(b=this.domElement)==null?void 0:b.ownerDocument)==null||_e.removeEventListener("pointermove",this.onPointerMove),(nt=(tt=this.domElement)==null?void 0:tt.ownerDocument)==null||nt.removeEventListener("pointerup",this.onPointerUp),this.traverse(it=>{const ot=it;ot.geometry&&ot.geometry.dispose(),ot.material&&ot.material.dispose()})}),this.domElement=s,this.camera=e,this.gizmo=new TransformControlsGizmo,this.add(this.gizmo),this.plane=new TransformControlsPlane,this.add(this.plane);const a=(c,d)=>{let b=d;Object.defineProperty(this,c,{get:function(){return b!==void 0?b:d},set:function(_e){b!==_e&&(b=_e,this.plane[c]=_e,this.gizmo[c]=_e,this.dispatchEvent({type:c+"-changed",value:_e}),this.dispatchEvent(this.changeEvent))}}),this[c]=d,this.plane[c]=d,this.gizmo[c]=d};a("camera",this.camera),a("object",this.object),a("enabled",this.enabled),a("axis",this.axis),a("mode",this.mode),a("translationSnap",this.translationSnap),a("rotationSnap",this.rotationSnap),a("scaleSnap",this.scaleSnap),a("space",this.space),a("size",this.size),a("dragging",this.dragging),a("showX",this.showX),a("showY",this.showY),a("showZ",this.showZ),a("worldPosition",this.worldPosition),a("worldPositionStart",this.worldPositionStart),a("worldQuaternion",this.worldQuaternion),a("worldQuaternionStart",this.worldQuaternionStart),a("cameraPosition",this.cameraPosition),a("cameraQuaternion",this.cameraQuaternion),a("pointStart",this.pointStart),a("pointEnd",this.pointEnd),a("rotationAxis",this.rotationAxis),a("rotationAngle",this.rotationAngle),a("eye",this.eye),s!==void 0&&this.connect(s)}};class TransformControlsGizmo extends Object3D{constructor(){super(),__publicField$2(this,"isTransformControlsGizmo",!0),__publicField$2(this,"type","TransformControlsGizmo"),__publicField$2(this,"tempVector",new Vector3(0,0,0)),__publicField$2(this,"tempEuler",new Euler),__publicField$2(this,"alignVector",new Vector3(0,1,0)),__publicField$2(this,"zeroVector",new Vector3(0,0,0)),__publicField$2(this,"lookAtMatrix",new Matrix4),__publicField$2(this,"tempQuaternion",new Quaternion),__publicField$2(this,"tempQuaternion2",new Quaternion),__publicField$2(this,"identityQuaternion",new Quaternion),__publicField$2(this,"unitX",new Vector3(1,0,0)),__publicField$2(this,"unitY",new Vector3(0,1,0)),__publicField$2(this,"unitZ",new Vector3(0,0,1)),__publicField$2(this,"gizmo"),__publicField$2(this,"picker"),__publicField$2(this,"helper"),__publicField$2(this,"rotationAxis",new Vector3),__publicField$2(this,"cameraPosition",new Vector3),__publicField$2(this,"worldPositionStart",new Vector3),__publicField$2(this,"worldQuaternionStart",new Quaternion),__publicField$2(this,"worldPosition",new Vector3),__publicField$2(this,"worldQuaternion",new Quaternion),__publicField$2(this,"eye",new Vector3),__publicField$2(this,"camera",null),__publicField$2(this,"enabled",!0),__publicField$2(this,"axis",null),__publicField$2(this,"mode","translate"),__publicField$2(this,"space","world"),__publicField$2(this,"size",1),__publicField$2(this,"dragging",!1),__publicField$2(this,"showX",!0),__publicField$2(this,"showY",!0),__publicField$2(this,"showZ",!0),__publicField$2(this,"updateMatrixWorld",()=>{let Gt=this.space;this.mode==="scale"&&(Gt="local");const Pt=Gt==="local"?this.worldQuaternion:this.identityQuaternion;this.gizmo.translate.visible=this.mode==="translate",this.gizmo.rotate.visible=this.mode==="rotate",this.gizmo.scale.visible=this.mode==="scale",this.helper.translate.visible=this.mode==="translate",this.helper.rotate.visible=this.mode==="rotate",this.helper.scale.visible=this.mode==="scale";let Wt=[];Wt=Wt.concat(this.picker[this.mode].children),Wt=Wt.concat(this.gizmo[this.mode].children),Wt=Wt.concat(this.helper[this.mode].children);for(let sn=0;sn<Wt.length;sn++){const Bt=Wt[sn];Bt.visible=!0,Bt.rotation.set(0,0,0),Bt.position.copy(this.worldPosition);let tn;if(this.camera.isOrthographicCamera?tn=(this.camera.top-this.camera.bottom)/this.camera.zoom:tn=this.worldPosition.distanceTo(this.cameraPosition)*Math.min(1.9*Math.tan(Math.PI*this.camera.fov/360)/this.camera.zoom,7),Bt.scale.set(1,1,1).multiplyScalar(tn*this.size/7),Bt.tag==="helper"){Bt.visible=!1,Bt.name==="AXIS"?(Bt.position.copy(this.worldPositionStart),Bt.visible=!!this.axis,this.axis==="X"&&(this.tempQuaternion.setFromEuler(this.tempEuler.set(0,0,0)),Bt.quaternion.copy(Pt).multiply(this.tempQuaternion),Math.abs(this.alignVector.copy(this.unitX).applyQuaternion(Pt).dot(this.eye))>.9&&(Bt.visible=!1)),this.axis==="Y"&&(this.tempQuaternion.setFromEuler(this.tempEuler.set(0,0,Math.PI/2)),Bt.quaternion.copy(Pt).multiply(this.tempQuaternion),Math.abs(this.alignVector.copy(this.unitY).applyQuaternion(Pt).dot(this.eye))>.9&&(Bt.visible=!1)),this.axis==="Z"&&(this.tempQuaternion.setFromEuler(this.tempEuler.set(0,Math.PI/2,0)),Bt.quaternion.copy(Pt).multiply(this.tempQuaternion),Math.abs(this.alignVector.copy(this.unitZ).applyQuaternion(Pt).dot(this.eye))>.9&&(Bt.visible=!1)),this.axis==="XYZE"&&(this.tempQuaternion.setFromEuler(this.tempEuler.set(0,Math.PI/2,0)),this.alignVector.copy(this.rotationAxis),Bt.quaternion.setFromRotationMatrix(this.lookAtMatrix.lookAt(this.zeroVector,this.alignVector,this.unitY)),Bt.quaternion.multiply(this.tempQuaternion),Bt.visible=this.dragging),this.axis==="E"&&(Bt.visible=!1)):Bt.name==="START"?(Bt.position.copy(this.worldPositionStart),Bt.visible=this.dragging):Bt.name==="END"?(Bt.position.copy(this.worldPosition),Bt.visible=this.dragging):Bt.name==="DELTA"?(Bt.position.copy(this.worldPositionStart),Bt.quaternion.copy(this.worldQuaternionStart),this.tempVector.set(1e-10,1e-10,1e-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1),this.tempVector.applyQuaternion(this.worldQuaternionStart.clone().invert()),Bt.scale.copy(this.tempVector),Bt.visible=this.dragging):(Bt.quaternion.copy(Pt),this.dragging?Bt.position.copy(this.worldPositionStart):Bt.position.copy(this.worldPosition),this.axis&&(Bt.visible=this.axis.search(Bt.name)!==-1));continue}Bt.quaternion.copy(Pt),this.mode==="translate"||this.mode==="scale"?((Bt.name==="X"||Bt.name==="XYZX")&&Math.abs(this.alignVector.copy(this.unitX).applyQuaternion(Pt).dot(this.eye))>.99&&(Bt.scale.set(1e-10,1e-10,1e-10),Bt.visible=!1),(Bt.name==="Y"||Bt.name==="XYZY")&&Math.abs(this.alignVector.copy(this.unitY).applyQuaternion(Pt).dot(this.eye))>.99&&(Bt.scale.set(1e-10,1e-10,1e-10),Bt.visible=!1),(Bt.name==="Z"||Bt.name==="XYZZ")&&Math.abs(this.alignVector.copy(this.unitZ).applyQuaternion(Pt).dot(this.eye))>.99&&(Bt.scale.set(1e-10,1e-10,1e-10),Bt.visible=!1),Bt.name==="XY"&&Math.abs(this.alignVector.copy(this.unitZ).applyQuaternion(Pt).dot(this.eye))<.2&&(Bt.scale.set(1e-10,1e-10,1e-10),Bt.visible=!1),Bt.name==="YZ"&&Math.abs(this.alignVector.copy(this.unitX).applyQuaternion(Pt).dot(this.eye))<.2&&(Bt.scale.set(1e-10,1e-10,1e-10),Bt.visible=!1),Bt.name==="XZ"&&Math.abs(this.alignVector.copy(this.unitY).applyQuaternion(Pt).dot(this.eye))<.2&&(Bt.scale.set(1e-10,1e-10,1e-10),Bt.visible=!1),Bt.name.search("X")!==-1&&(this.alignVector.copy(this.unitX).applyQuaternion(Pt).dot(this.eye)<0?Bt.tag==="fwd"?Bt.visible=!1:Bt.scale.x*=-1:Bt.tag==="bwd"&&(Bt.visible=!1)),Bt.name.search("Y")!==-1&&(this.alignVector.copy(this.unitY).applyQuaternion(Pt).dot(this.eye)<0?Bt.tag==="fwd"?Bt.visible=!1:Bt.scale.y*=-1:Bt.tag==="bwd"&&(Bt.visible=!1)),Bt.name.search("Z")!==-1&&(this.alignVector.copy(this.unitZ).applyQuaternion(Pt).dot(this.eye)<0?Bt.tag==="fwd"?Bt.visible=!1:Bt.scale.z*=-1:Bt.tag==="bwd"&&(Bt.visible=!1))):this.mode==="rotate"&&(this.tempQuaternion2.copy(Pt),this.alignVector.copy(this.eye).applyQuaternion(this.tempQuaternion.copy(Pt).invert()),Bt.name.search("E")!==-1&&Bt.quaternion.setFromRotationMatrix(this.lookAtMatrix.lookAt(this.eye,this.zeroVector,this.unitY)),Bt.name==="X"&&(this.tempQuaternion.setFromAxisAngle(this.unitX,Math.atan2(-this.alignVector.y,this.alignVector.z)),this.tempQuaternion.multiplyQuaternions(this.tempQuaternion2,this.tempQuaternion),Bt.quaternion.copy(this.tempQuaternion)),Bt.name==="Y"&&(this.tempQuaternion.setFromAxisAngle(this.unitY,Math.atan2(this.alignVector.x,this.alignVector.z)),this.tempQuaternion.multiplyQuaternions(this.tempQuaternion2,this.tempQuaternion),Bt.quaternion.copy(this.tempQuaternion)),Bt.name==="Z"&&(this.tempQuaternion.setFromAxisAngle(this.unitZ,Math.atan2(this.alignVector.y,this.alignVector.x)),this.tempQuaternion.multiplyQuaternions(this.tempQuaternion2,this.tempQuaternion),Bt.quaternion.copy(this.tempQuaternion))),Bt.visible=Bt.visible&&(Bt.name.indexOf("X")===-1||this.showX),Bt.visible=Bt.visible&&(Bt.name.indexOf("Y")===-1||this.showY),Bt.visible=Bt.visible&&(Bt.name.indexOf("Z")===-1||this.showZ),Bt.visible=Bt.visible&&(Bt.name.indexOf("E")===-1||this.showX&&this.showY&&this.showZ),Bt.material.tempOpacity=Bt.material.tempOpacity||Bt.material.opacity,Bt.material.tempColor=Bt.material.tempColor||Bt.material.color.clone(),Bt.material.color.copy(Bt.material.tempColor),Bt.material.opacity=Bt.material.tempOpacity,this.enabled?this.axis&&(Bt.name===this.axis?(Bt.material.opacity=1,Bt.material.color.lerp(new Color(1,1,1),.5)):this.axis.split("").some(function(cn){return Bt.name===cn})?(Bt.material.opacity=1,Bt.material.color.lerp(new Color(1,1,1),.5)):(Bt.material.opacity*=.25,Bt.material.color.lerp(new Color(1,1,1),.5))):(Bt.material.opacity*=.5,Bt.material.color.lerp(new Color(1,1,1),.5))}super.updateMatrixWorld()});const e=new MeshBasicMaterial({depthTest:!1,depthWrite:!1,transparent:!0,side:DoubleSide,fog:!1,toneMapped:!1}),s=new LineBasicMaterial({depthTest:!1,depthWrite:!1,transparent:!0,linewidth:1,fog:!1,toneMapped:!1}),a=e.clone();a.opacity=.15;const c=e.clone();c.opacity=.33;const d=e.clone();d.color.set(16711680);const b=e.clone();b.color.set(65280);const _e=e.clone();_e.color.set(255);const tt=e.clone();tt.opacity=.25;const nt=tt.clone();nt.color.set(16776960);const it=tt.clone();it.color.set(65535);const ot=tt.clone();ot.color.set(16711935),e.clone().color.set(16776960);const ct=s.clone();ct.color.set(16711680);const ut=s.clone();ut.color.set(65280);const ft=s.clone();ft.color.set(255);const dt=s.clone();dt.color.set(65535);const lt=s.clone();lt.color.set(16711935);const ht=s.clone();ht.color.set(16776960);const mt=s.clone();mt.color.set(7895160);const xt=ht.clone();xt.opacity=.25;const St=new CylinderGeometry(0,.05,.2,12,1,!1),yt=new BoxGeometry(.125,.125,.125),wt=new BufferGeometry;wt.setAttribute("position",new Float32BufferAttribute([0,0,0,1,0,0],3));const Et=(Gt,Pt)=>{const Wt=new BufferGeometry,sn=[];for(let Bt=0;Bt<=64*Pt;++Bt)sn.push(0,Math.cos(Bt/32*Math.PI)*Gt,Math.sin(Bt/32*Math.PI)*Gt);return Wt.setAttribute("position",new Float32BufferAttribute(sn,3)),Wt},_t=()=>{const Gt=new BufferGeometry;return Gt.setAttribute("position",new Float32BufferAttribute([0,0,0,1,1,1],3)),Gt},vt={X:[[new Mesh(St,d),[1,0,0],[0,0,-Math.PI/2],null,"fwd"],[new Mesh(St,d),[1,0,0],[0,0,Math.PI/2],null,"bwd"],[new Line(wt,ct)]],Y:[[new Mesh(St,b),[0,1,0],null,null,"fwd"],[new Mesh(St,b),[0,1,0],[Math.PI,0,0],null,"bwd"],[new Line(wt,ut),null,[0,0,Math.PI/2]]],Z:[[new Mesh(St,_e),[0,0,1],[Math.PI/2,0,0],null,"fwd"],[new Mesh(St,_e),[0,0,1],[-Math.PI/2,0,0],null,"bwd"],[new Line(wt,ft),null,[0,-Math.PI/2,0]]],XYZ:[[new Mesh(new OctahedronGeometry(.1,0),tt.clone()),[0,0,0],[0,0,0]]],XY:[[new Mesh(new PlaneGeometry(.295,.295),nt.clone()),[.15,.15,0]],[new Line(wt,ht),[.18,.3,0],null,[.125,1,1]],[new Line(wt,ht),[.3,.18,0],[0,0,Math.PI/2],[.125,1,1]]],YZ:[[new Mesh(new PlaneGeometry(.295,.295),it.clone()),[0,.15,.15],[0,Math.PI/2,0]],[new Line(wt,dt),[0,.18,.3],[0,0,Math.PI/2],[.125,1,1]],[new Line(wt,dt),[0,.3,.18],[0,-Math.PI/2,0],[.125,1,1]]],XZ:[[new Mesh(new PlaneGeometry(.295,.295),ot.clone()),[.15,0,.15],[-Math.PI/2,0,0]],[new Line(wt,lt),[.18,0,.3],null,[.125,1,1]],[new Line(wt,lt),[.3,0,.18],[0,-Math.PI/2,0],[.125,1,1]]]},Mt={X:[[new Mesh(new CylinderGeometry(.2,0,1,4,1,!1),a),[.6,0,0],[0,0,-Math.PI/2]]],Y:[[new Mesh(new CylinderGeometry(.2,0,1,4,1,!1),a),[0,.6,0]]],Z:[[new Mesh(new CylinderGeometry(.2,0,1,4,1,!1),a),[0,0,.6],[Math.PI/2,0,0]]],XYZ:[[new Mesh(new OctahedronGeometry(.2,0),a)]],XY:[[new Mesh(new PlaneGeometry(.4,.4),a),[.2,.2,0]]],YZ:[[new Mesh(new PlaneGeometry(.4,.4),a),[0,.2,.2],[0,Math.PI/2,0]]],XZ:[[new Mesh(new PlaneGeometry(.4,.4),a),[.2,0,.2],[-Math.PI/2,0,0]]]},jt={START:[[new Mesh(new OctahedronGeometry(.01,2),c),null,null,null,"helper"]],END:[[new Mesh(new OctahedronGeometry(.01,2),c),null,null,null,"helper"]],DELTA:[[new Line(_t(),c),null,null,null,"helper"]],X:[[new Line(wt,c.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new Line(wt,c.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new Line(wt,c.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},Lt={X:[[new Line(Et(1,.5),ct)],[new Mesh(new OctahedronGeometry(.04,0),d),[0,0,.99],null,[1,3,1]]],Y:[[new Line(Et(1,.5),ut),null,[0,0,-Math.PI/2]],[new Mesh(new OctahedronGeometry(.04,0),b),[0,0,.99],null,[3,1,1]]],Z:[[new Line(Et(1,.5),ft),null,[0,Math.PI/2,0]],[new Mesh(new OctahedronGeometry(.04,0),_e),[.99,0,0],null,[1,3,1]]],E:[[new Line(Et(1.25,1),xt),null,[0,Math.PI/2,0]],[new Mesh(new CylinderGeometry(.03,0,.15,4,1,!1),xt),[1.17,0,0],[0,0,-Math.PI/2],[1,1,.001]],[new Mesh(new CylinderGeometry(.03,0,.15,4,1,!1),xt),[-1.17,0,0],[0,0,Math.PI/2],[1,1,.001]],[new Mesh(new CylinderGeometry(.03,0,.15,4,1,!1),xt),[0,-1.17,0],[Math.PI,0,0],[1,1,.001]],[new Mesh(new CylinderGeometry(.03,0,.15,4,1,!1),xt),[0,1.17,0],[0,0,0],[1,1,.001]]],XYZE:[[new Line(Et(1,1),mt),null,[0,Math.PI/2,0]]]},Nt={AXIS:[[new Line(wt,c.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]]},kt={X:[[new Mesh(new TorusGeometry(1,.1,4,24),a),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new Mesh(new TorusGeometry(1,.1,4,24),a),[0,0,0],[Math.PI/2,0,0]]],Z:[[new Mesh(new TorusGeometry(1,.1,4,24),a),[0,0,0],[0,0,-Math.PI/2]]],E:[[new Mesh(new TorusGeometry(1.25,.1,2,24),a)]],XYZE:[[new Mesh(new SphereGeometry(.7,10,8),a)]]},Ot={X:[[new Mesh(yt,d),[.8,0,0],[0,0,-Math.PI/2]],[new Line(wt,ct),null,null,[.8,1,1]]],Y:[[new Mesh(yt,b),[0,.8,0]],[new Line(wt,ut),null,[0,0,Math.PI/2],[.8,1,1]]],Z:[[new Mesh(yt,_e),[0,0,.8],[Math.PI/2,0,0]],[new Line(wt,ft),null,[0,-Math.PI/2,0],[.8,1,1]]],XY:[[new Mesh(yt,nt),[.85,.85,0],null,[2,2,.2]],[new Line(wt,ht),[.855,.98,0],null,[.125,1,1]],[new Line(wt,ht),[.98,.855,0],[0,0,Math.PI/2],[.125,1,1]]],YZ:[[new Mesh(yt,it),[0,.85,.85],null,[.2,2,2]],[new Line(wt,dt),[0,.855,.98],[0,0,Math.PI/2],[.125,1,1]],[new Line(wt,dt),[0,.98,.855],[0,-Math.PI/2,0],[.125,1,1]]],XZ:[[new Mesh(yt,ot),[.85,0,.85],null,[2,.2,2]],[new Line(wt,lt),[.855,0,.98],null,[.125,1,1]],[new Line(wt,lt),[.98,0,.855],[0,-Math.PI/2,0],[.125,1,1]]],XYZX:[[new Mesh(new BoxGeometry(.125,.125,.125),tt.clone()),[1.1,0,0]]],XYZY:[[new Mesh(new BoxGeometry(.125,.125,.125),tt.clone()),[0,1.1,0]]],XYZZ:[[new Mesh(new BoxGeometry(.125,.125,.125),tt.clone()),[0,0,1.1]]]},Ht={X:[[new Mesh(new CylinderGeometry(.2,0,.8,4,1,!1),a),[.5,0,0],[0,0,-Math.PI/2]]],Y:[[new Mesh(new CylinderGeometry(.2,0,.8,4,1,!1),a),[0,.5,0]]],Z:[[new Mesh(new CylinderGeometry(.2,0,.8,4,1,!1),a),[0,0,.5],[Math.PI/2,0,0]]],XY:[[new Mesh(yt,a),[.85,.85,0],null,[3,3,.2]]],YZ:[[new Mesh(yt,a),[0,.85,.85],null,[.2,3,3]]],XZ:[[new Mesh(yt,a),[.85,0,.85],null,[3,.2,3]]],XYZX:[[new Mesh(new BoxGeometry(.2,.2,.2),a),[1.1,0,0]]],XYZY:[[new Mesh(new BoxGeometry(.2,.2,.2),a),[0,1.1,0]]],XYZZ:[[new Mesh(new BoxGeometry(.2,.2,.2),a),[0,0,1.1]]]},Ct={X:[[new Line(wt,c.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new Line(wt,c.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new Line(wt,c.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},Ut=Gt=>{const Pt=new Object3D;for(let Wt in Gt)for(let sn=Gt[Wt].length;sn--;){const Bt=Gt[Wt][sn][0].clone(),tn=Gt[Wt][sn][1],cn=Gt[Wt][sn][2],vn=Gt[Wt][sn][3],On=Gt[Wt][sn][4];Bt.name=Wt,Bt.tag=On,tn&&Bt.position.set(tn[0],tn[1],tn[2]),cn&&Bt.rotation.set(cn[0],cn[1],cn[2]),vn&&Bt.scale.set(vn[0],vn[1],vn[2]),Bt.updateMatrix();const rr=Bt.geometry.clone();rr.applyMatrix4(Bt.matrix),Bt.geometry=rr,Bt.renderOrder=1/0,Bt.position.set(0,0,0),Bt.rotation.set(0,0,0),Bt.scale.set(1,1,1),Pt.add(Bt)}return Pt};this.gizmo={},this.picker={},this.helper={},this.add(this.gizmo.translate=Ut(vt)),this.add(this.gizmo.rotate=Ut(Lt)),this.add(this.gizmo.scale=Ut(Ot)),this.add(this.picker.translate=Ut(Mt)),this.add(this.picker.rotate=Ut(kt)),this.add(this.picker.scale=Ut(Ht)),this.add(this.helper.translate=Ut(jt)),this.add(this.helper.rotate=Ut(Nt)),this.add(this.helper.scale=Ut(Ct)),this.picker.translate.visible=!1,this.picker.rotate.visible=!1,this.picker.scale.visible=!1}}class TransformControlsPlane extends Mesh{constructor(){super(new PlaneGeometry(1e5,1e5,2,2),new MeshBasicMaterial({visible:!1,wireframe:!0,side:DoubleSide,transparent:!0,opacity:.1,toneMapped:!1})),__publicField$2(this,"isTransformControlsPlane",!0),__publicField$2(this,"type","TransformControlsPlane"),__publicField$2(this,"unitX",new Vector3(1,0,0)),__publicField$2(this,"unitY",new Vector3(0,1,0)),__publicField$2(this,"unitZ",new Vector3(0,0,1)),__publicField$2(this,"tempVector",new Vector3),__publicField$2(this,"dirVector",new Vector3),__publicField$2(this,"alignVector",new Vector3),__publicField$2(this,"tempMatrix",new Matrix4),__publicField$2(this,"identityQuaternion",new Quaternion),__publicField$2(this,"cameraQuaternion",new Quaternion),__publicField$2(this,"worldPosition",new Vector3),__publicField$2(this,"worldQuaternion",new Quaternion),__publicField$2(this,"eye",new Vector3),__publicField$2(this,"axis",null),__publicField$2(this,"mode","translate"),__publicField$2(this,"space","world"),__publicField$2(this,"updateMatrixWorld",()=>{let e=this.space;switch(this.position.copy(this.worldPosition),this.mode==="scale"&&(e="local"),this.unitX.set(1,0,0).applyQuaternion(e==="local"?this.worldQuaternion:this.identityQuaternion),this.unitY.set(0,1,0).applyQuaternion(e==="local"?this.worldQuaternion:this.identityQuaternion),this.unitZ.set(0,0,1).applyQuaternion(e==="local"?this.worldQuaternion:this.identityQuaternion),this.alignVector.copy(this.unitY),this.mode){case"translate":case"scale":switch(this.axis){case"X":this.alignVector.copy(this.eye).cross(this.unitX),this.dirVector.copy(this.unitX).cross(this.alignVector);break;case"Y":this.alignVector.copy(this.eye).cross(this.unitY),this.dirVector.copy(this.unitY).cross(this.alignVector);break;case"Z":this.alignVector.copy(this.eye).cross(this.unitZ),this.dirVector.copy(this.unitZ).cross(this.alignVector);break;case"XY":this.dirVector.copy(this.unitZ);break;case"YZ":this.dirVector.copy(this.unitX);break;case"XZ":this.alignVector.copy(this.unitZ),this.dirVector.copy(this.unitY);break;case"XYZ":case"E":this.dirVector.set(0,0,0);break}break;case"rotate":default:this.dirVector.set(0,0,0)}this.dirVector.length()===0?this.quaternion.copy(this.cameraQuaternion):(this.tempMatrix.lookAt(this.tempVector.set(0,0,0),this.dirVector,this.alignVector),this.quaternion.setFromRotationMatrix(this.tempMatrix)),super.updateMatrixWorld()})}}var __defProp$1=Object.defineProperty,__defNormalProp$1=(o,e,s)=>e in o?__defProp$1(o,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):o[e]=s,__publicField$1=(o,e,s)=>(__defNormalProp$1(o,typeof e!="symbol"?e+"":e,s),s);const _euler=new Euler(0,0,0,"YXZ"),_vector=new Vector3,_changeEvent={type:"change"},_lockEvent={type:"lock"},_unlockEvent={type:"unlock"},_PI_2=Math.PI/2;let PointerLockControls$1=class extends EventDispatcher{constructor(e,s){super(),__publicField$1(this,"camera"),__publicField$1(this,"domElement"),__publicField$1(this,"isLocked"),__publicField$1(this,"minPolarAngle"),__publicField$1(this,"maxPolarAngle"),__publicField$1(this,"pointerSpeed"),__publicField$1(this,"onMouseMove",a=>{!this.domElement||this.isLocked===!1||(_euler.setFromQuaternion(this.camera.quaternion),_euler.y-=a.movementX*.002*this.pointerSpeed,_euler.x-=a.movementY*.002*this.pointerSpeed,_euler.x=Math.max(_PI_2-this.maxPolarAngle,Math.min(_PI_2-this.minPolarAngle,_euler.x)),this.camera.quaternion.setFromEuler(_euler),this.dispatchEvent(_changeEvent))}),__publicField$1(this,"onPointerlockChange",()=>{this.domElement&&(this.domElement.ownerDocument.pointerLockElement===this.domElement?(this.dispatchEvent(_lockEvent),this.isLocked=!0):(this.dispatchEvent(_unlockEvent),this.isLocked=!1))}),__publicField$1(this,"onPointerlockError",()=>{console.error("THREE.PointerLockControls: Unable to use Pointer Lock API")}),__publicField$1(this,"connect",a=>{this.domElement=a||this.domElement,this.domElement&&(this.domElement.ownerDocument.addEventListener("mousemove",this.onMouseMove),this.domElement.ownerDocument.addEventListener("pointerlockchange",this.onPointerlockChange),this.domElement.ownerDocument.addEventListener("pointerlockerror",this.onPointerlockError))}),__publicField$1(this,"disconnect",()=>{this.domElement&&(this.domElement.ownerDocument.removeEventListener("mousemove",this.onMouseMove),this.domElement.ownerDocument.removeEventListener("pointerlockchange",this.onPointerlockChange),this.domElement.ownerDocument.removeEventListener("pointerlockerror",this.onPointerlockError))}),__publicField$1(this,"dispose",()=>{this.disconnect()}),__publicField$1(this,"getObject",()=>this.camera),__publicField$1(this,"direction",new Vector3(0,0,-1)),__publicField$1(this,"getDirection",a=>a.copy(this.direction).applyQuaternion(this.camera.quaternion)),__publicField$1(this,"moveForward",a=>{_vector.setFromMatrixColumn(this.camera.matrix,0),_vector.crossVectors(this.camera.up,_vector),this.camera.position.addScaledVector(_vector,a)}),__publicField$1(this,"moveRight",a=>{_vector.setFromMatrixColumn(this.camera.matrix,0),this.camera.position.addScaledVector(_vector,a)}),__publicField$1(this,"lock",()=>{this.domElement&&this.domElement.requestPointerLock()}),__publicField$1(this,"unlock",()=>{this.domElement&&this.domElement.ownerDocument.exitPointerLock()}),this.camera=e,this.domElement=s,this.isLocked=!1,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.pointerSpeed=1,s&&this.connect(s)}};var __defProp=Object.defineProperty,__defNormalProp=(o,e,s)=>e in o?__defProp(o,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):o[e]=s,__publicField=(o,e,s)=>(__defNormalProp(o,typeof e!="symbol"?e+"":e,s),s);const _ray=new Ray,_plane=new Plane,TILT_LIMIT=Math.cos(70*(Math.PI/180)),moduloWrapAround=(o,e)=>(o%e+e)%e;let OrbitControls$1=class extends EventDispatcher{constructor(e,s){super(),__publicField(this,"object"),__publicField(this,"domElement"),__publicField(this,"enabled",!0),__publicField(this,"target",new Vector3),__publicField(this,"minDistance",0),__publicField(this,"maxDistance",1/0),__publicField(this,"minZoom",0),__publicField(this,"maxZoom",1/0),__publicField(this,"minPolarAngle",0),__publicField(this,"maxPolarAngle",Math.PI),__publicField(this,"minAzimuthAngle",-1/0),__publicField(this,"maxAzimuthAngle",1/0),__publicField(this,"enableDamping",!1),__publicField(this,"dampingFactor",.05),__publicField(this,"enableZoom",!0),__publicField(this,"zoomSpeed",1),__publicField(this,"enableRotate",!0),__publicField(this,"rotateSpeed",1),__publicField(this,"enablePan",!0),__publicField(this,"panSpeed",1),__publicField(this,"screenSpacePanning",!0),__publicField(this,"keyPanSpeed",7),__publicField(this,"zoomToCursor",!1),__publicField(this,"autoRotate",!1),__publicField(this,"autoRotateSpeed",2),__publicField(this,"reverseOrbit",!1),__publicField(this,"reverseHorizontalOrbit",!1),__publicField(this,"reverseVerticalOrbit",!1),__publicField(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),__publicField(this,"mouseButtons",{LEFT:MOUSE.ROTATE,MIDDLE:MOUSE.DOLLY,RIGHT:MOUSE.PAN}),__publicField(this,"touches",{ONE:TOUCH.ROTATE,TWO:TOUCH.DOLLY_PAN}),__publicField(this,"target0"),__publicField(this,"position0"),__publicField(this,"zoom0"),__publicField(this,"_domElementKeyEvents",null),__publicField(this,"getPolarAngle"),__publicField(this,"getAzimuthalAngle"),__publicField(this,"setPolarAngle"),__publicField(this,"setAzimuthalAngle"),__publicField(this,"getDistance"),__publicField(this,"getZoomScale"),__publicField(this,"listenToKeyEvents"),__publicField(this,"stopListenToKeyEvents"),__publicField(this,"saveState"),__publicField(this,"reset"),__publicField(this,"update"),__publicField(this,"connect"),__publicField(this,"dispose"),__publicField(this,"dollyIn"),__publicField(this,"dollyOut"),__publicField(this,"getScale"),__publicField(this,"setScale"),this.object=e,this.domElement=s,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>it.phi,this.getAzimuthalAngle=()=>it.theta,this.setPolarAngle=qt=>{let fn=moduloWrapAround(qt,2*Math.PI),jn=it.phi;jn<0&&(jn+=2*Math.PI),fn<0&&(fn+=2*Math.PI);let Qt=Math.abs(fn-jn);2*Math.PI-Qt<Qt&&(fn<jn?fn+=2*Math.PI:jn+=2*Math.PI),ot.phi=fn-jn,a.update()},this.setAzimuthalAngle=qt=>{let fn=moduloWrapAround(qt,2*Math.PI),jn=it.theta;jn<0&&(jn+=2*Math.PI),fn<0&&(fn+=2*Math.PI);let Qt=Math.abs(fn-jn);2*Math.PI-Qt<Qt&&(fn<jn?fn+=2*Math.PI:jn+=2*Math.PI),ot.theta=fn-jn,a.update()},this.getDistance=()=>a.object.position.distanceTo(a.target),this.listenToKeyEvents=qt=>{qt.addEventListener("keydown",Fn),this._domElementKeyEvents=qt},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",Fn),this._domElementKeyEvents=null},this.saveState=()=>{a.target0.copy(a.target),a.position0.copy(a.object.position),a.zoom0=a.object.zoom},this.reset=()=>{a.target.copy(a.target0),a.object.position.copy(a.position0),a.object.zoom=a.zoom0,a.object.updateProjectionMatrix(),a.dispatchEvent(c),a.update(),tt=_e.NONE},this.update=(()=>{const qt=new Vector3,fn=new Vector3(0,1,0),jn=new Quaternion().setFromUnitVectors(e.up,fn),Qt=jn.clone().invert(),an=new Vector3,hn=new Quaternion,_n=2*Math.PI;return function(){const Gn=a.object.position;jn.setFromUnitVectors(e.up,fn),Qt.copy(jn).invert(),qt.copy(Gn).sub(a.target),qt.applyQuaternion(jn),it.setFromVector3(qt),a.autoRotate&&tt===_e.NONE&&Nt(jt()),a.enableDamping?(it.theta+=ot.theta*a.dampingFactor,it.phi+=ot.phi*a.dampingFactor):(it.theta+=ot.theta,it.phi+=ot.phi);let ur=a.minAzimuthAngle,Mr=a.maxAzimuthAngle;isFinite(ur)&&isFinite(Mr)&&(ur<-Math.PI?ur+=_n:ur>Math.PI&&(ur-=_n),Mr<-Math.PI?Mr+=_n:Mr>Math.PI&&(Mr-=_n),ur<=Mr?it.theta=Math.max(ur,Math.min(Mr,it.theta)):it.theta=it.theta>(ur+Mr)/2?Math.max(ur,it.theta):Math.min(Mr,it.theta)),it.phi=Math.max(a.minPolarAngle,Math.min(a.maxPolarAngle,it.phi)),it.makeSafe(),a.enableDamping===!0?a.target.addScaledVector(ct,a.dampingFactor):a.target.add(ct),a.zoomToCursor&&_t||a.object.isOrthographicCamera?it.radius=sn(it.radius):it.radius=sn(it.radius*at),qt.setFromSpherical(it),qt.applyQuaternion(Qt),Gn.copy(a.target).add(qt),a.object.matrixAutoUpdate||a.object.updateMatrix(),a.object.lookAt(a.target),a.enableDamping===!0?(ot.theta*=1-a.dampingFactor,ot.phi*=1-a.dampingFactor,ct.multiplyScalar(1-a.dampingFactor)):(ot.set(0,0,0),ct.set(0,0,0));let Ir=!1;if(a.zoomToCursor&&_t){let yr=null;if(a.object instanceof PerspectiveCamera&&a.object.isPerspectiveCamera){const Or=qt.length();yr=sn(Or*at);const Wr=Or-yr;a.object.position.addScaledVector(wt,Wr),a.object.updateMatrixWorld()}else if(a.object.isOrthographicCamera){const Or=new Vector3(Et.x,Et.y,0);Or.unproject(a.object),a.object.zoom=Math.max(a.minZoom,Math.min(a.maxZoom,a.object.zoom/at)),a.object.updateProjectionMatrix(),Ir=!0;const Wr=new Vector3(Et.x,Et.y,0);Wr.unproject(a.object),a.object.position.sub(Wr).add(Or),a.object.updateMatrixWorld(),yr=qt.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),a.zoomToCursor=!1;yr!==null&&(a.screenSpacePanning?a.target.set(0,0,-1).transformDirection(a.object.matrix).multiplyScalar(yr).add(a.object.position):(_ray.origin.copy(a.object.position),_ray.direction.set(0,0,-1).transformDirection(a.object.matrix),Math.abs(a.object.up.dot(_ray.direction))<TILT_LIMIT?e.lookAt(a.target):(_plane.setFromNormalAndCoplanarPoint(a.object.up,a.target),_ray.intersectPlane(_plane,a.target))))}else a.object instanceof OrthographicCamera$1&&a.object.isOrthographicCamera&&(Ir=at!==1,Ir&&(a.object.zoom=Math.max(a.minZoom,Math.min(a.maxZoom,a.object.zoom/at)),a.object.updateProjectionMatrix()));return at=1,_t=!1,Ir||an.distanceToSquared(a.object.position)>nt||8*(1-hn.dot(a.object.quaternion))>nt?(a.dispatchEvent(c),an.copy(a.object.position),hn.copy(a.object.quaternion),Ir=!1,!0):!1}})(),this.connect=qt=>{a.domElement=qt,a.domElement.style.touchAction="none",a.domElement.addEventListener("contextmenu",Tn),a.domElement.addEventListener("pointerdown",It),a.domElement.addEventListener("pointercancel",xn),a.domElement.addEventListener("wheel",Hn)},this.dispose=()=>{var qt,fn,jn,Qt,an,hn;a.domElement&&(a.domElement.style.touchAction="auto"),(qt=a.domElement)==null||qt.removeEventListener("contextmenu",Tn),(fn=a.domElement)==null||fn.removeEventListener("pointerdown",It),(jn=a.domElement)==null||jn.removeEventListener("pointercancel",xn),(Qt=a.domElement)==null||Qt.removeEventListener("wheel",Hn),(an=a.domElement)==null||an.ownerDocument.removeEventListener("pointermove",on),(hn=a.domElement)==null||hn.ownerDocument.removeEventListener("pointerup",xn),a._domElementKeyEvents!==null&&a._domElementKeyEvents.removeEventListener("keydown",Fn)};const a=this,c={type:"change"},d={type:"start"},b={type:"end"},_e={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let tt=_e.NONE;const nt=1e-6,it=new Spherical,ot=new Spherical;let at=1;const ct=new Vector3,ut=new Vector2,ft=new Vector2,dt=new Vector2,lt=new Vector2,ht=new Vector2,mt=new Vector2,xt=new Vector2,St=new Vector2,yt=new Vector2,wt=new Vector3,Et=new Vector2;let _t=!1;const vt=[],Mt={};function jt(){return 2*Math.PI/60/60*a.autoRotateSpeed}function Lt(){return Math.pow(.95,a.zoomSpeed)}function Nt(qt){a.reverseOrbit||a.reverseHorizontalOrbit?ot.theta+=qt:ot.theta-=qt}function kt(qt){a.reverseOrbit||a.reverseVerticalOrbit?ot.phi+=qt:ot.phi-=qt}const Ot=(()=>{const qt=new Vector3;return function(jn,Qt){qt.setFromMatrixColumn(Qt,0),qt.multiplyScalar(-jn),ct.add(qt)}})(),Ht=(()=>{const qt=new Vector3;return function(jn,Qt){a.screenSpacePanning===!0?qt.setFromMatrixColumn(Qt,1):(qt.setFromMatrixColumn(Qt,0),qt.crossVectors(a.object.up,qt)),qt.multiplyScalar(jn),ct.add(qt)}})(),Ct=(()=>{const qt=new Vector3;return function(jn,Qt){const an=a.domElement;if(an&&a.object instanceof PerspectiveCamera&&a.object.isPerspectiveCamera){const hn=a.object.position;qt.copy(hn).sub(a.target);let _n=qt.length();_n*=Math.tan(a.object.fov/2*Math.PI/180),Ot(2*jn*_n/an.clientHeight,a.object.matrix),Ht(2*Qt*_n/an.clientHeight,a.object.matrix)}else an&&a.object instanceof OrthographicCamera$1&&a.object.isOrthographicCamera?(Ot(jn*(a.object.right-a.object.left)/a.object.zoom/an.clientWidth,a.object.matrix),Ht(Qt*(a.object.top-a.object.bottom)/a.object.zoom/an.clientHeight,a.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),a.enablePan=!1)}})();function Ut(qt){a.object instanceof PerspectiveCamera&&a.object.isPerspectiveCamera||a.object instanceof OrthographicCamera$1&&a.object.isOrthographicCamera?at=qt:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),a.enableZoom=!1)}function Gt(qt){Ut(at/qt)}function Pt(qt){Ut(at*qt)}function Wt(qt){if(!a.zoomToCursor||!a.domElement)return;_t=!0;const fn=a.domElement.getBoundingClientRect(),jn=qt.clientX-fn.left,Qt=qt.clientY-fn.top,an=fn.width,hn=fn.height;Et.x=jn/an*2-1,Et.y=-(Qt/hn)*2+1,wt.set(Et.x,Et.y,1).unproject(a.object).sub(a.object.position).normalize()}function sn(qt){return Math.max(a.minDistance,Math.min(a.maxDistance,qt))}function Bt(qt){ut.set(qt.clientX,qt.clientY)}function tn(qt){Wt(qt),xt.set(qt.clientX,qt.clientY)}function cn(qt){lt.set(qt.clientX,qt.clientY)}function vn(qt){ft.set(qt.clientX,qt.clientY),dt.subVectors(ft,ut).multiplyScalar(a.rotateSpeed);const fn=a.domElement;fn&&(Nt(2*Math.PI*dt.x/fn.clientHeight),kt(2*Math.PI*dt.y/fn.clientHeight)),ut.copy(ft),a.update()}function On(qt){St.set(qt.clientX,qt.clientY),yt.subVectors(St,xt),yt.y>0?Gt(Lt()):yt.y<0&&Pt(Lt()),xt.copy(St),a.update()}function rr(qt){ht.set(qt.clientX,qt.clientY),mt.subVectors(ht,lt).multiplyScalar(a.panSpeed),Ct(mt.x,mt.y),lt.copy(ht),a.update()}function Wn(qt){Wt(qt),qt.deltaY<0?Pt(Lt()):qt.deltaY>0&&Gt(Lt()),a.update()}function Bn(qt){let fn=!1;switch(qt.code){case a.keys.UP:Ct(0,a.keyPanSpeed),fn=!0;break;case a.keys.BOTTOM:Ct(0,-a.keyPanSpeed),fn=!0;break;case a.keys.LEFT:Ct(a.keyPanSpeed,0),fn=!0;break;case a.keys.RIGHT:Ct(-a.keyPanSpeed,0),fn=!0;break}fn&&(qt.preventDefault(),a.update())}function gn(){if(vt.length==1)ut.set(vt[0].pageX,vt[0].pageY);else{const qt=.5*(vt[0].pageX+vt[1].pageX),fn=.5*(vt[0].pageY+vt[1].pageY);ut.set(qt,fn)}}function bn(){if(vt.length==1)lt.set(vt[0].pageX,vt[0].pageY);else{const qt=.5*(vt[0].pageX+vt[1].pageX),fn=.5*(vt[0].pageY+vt[1].pageY);lt.set(qt,fn)}}function Kt(){const qt=vt[0].pageX-vt[1].pageX,fn=vt[0].pageY-vt[1].pageY,jn=Math.sqrt(qt*qt+fn*fn);xt.set(0,jn)}function Jn(){a.enableZoom&&Kt(),a.enablePan&&bn()}function Cn(){a.enableZoom&&Kt(),a.enableRotate&&gn()}function kn(qt){if(vt.length==1)ft.set(qt.pageX,qt.pageY);else{const jn=Xn(qt),Qt=.5*(qt.pageX+jn.x),an=.5*(qt.pageY+jn.y);ft.set(Qt,an)}dt.subVectors(ft,ut).multiplyScalar(a.rotateSpeed);const fn=a.domElement;fn&&(Nt(2*Math.PI*dt.x/fn.clientHeight),kt(2*Math.PI*dt.y/fn.clientHeight)),ut.copy(ft)}function Nn(qt){if(vt.length==1)ht.set(qt.pageX,qt.pageY);else{const fn=Xn(qt),jn=.5*(qt.pageX+fn.x),Qt=.5*(qt.pageY+fn.y);ht.set(jn,Qt)}mt.subVectors(ht,lt).multiplyScalar(a.panSpeed),Ct(mt.x,mt.y),lt.copy(ht)}function ir(qt){const fn=Xn(qt),jn=qt.pageX-fn.x,Qt=qt.pageY-fn.y,an=Math.sqrt(jn*jn+Qt*Qt);St.set(0,an),yt.set(0,Math.pow(St.y/xt.y,a.zoomSpeed)),Gt(yt.y),xt.copy(St)}function Un(qt){a.enableZoom&&ir(qt),a.enablePan&&Nn(qt)}function zt(qt){a.enableZoom&&ir(qt),a.enableRotate&&kn(qt)}function It(qt){var fn,jn;a.enabled!==!1&&(vt.length===0&&((fn=a.domElement)==null||fn.ownerDocument.addEventListener("pointermove",on),(jn=a.domElement)==null||jn.ownerDocument.addEventListener("pointerup",xn)),Qn(qt),qt.pointerType==="touch"?zn(qt):wn(qt))}function on(qt){a.enabled!==!1&&(qt.pointerType==="touch"?xr(qt):En(qt))}function xn(qt){var fn,jn,Qt;sr(qt),vt.length===0&&((fn=a.domElement)==null||fn.releasePointerCapture(qt.pointerId),(jn=a.domElement)==null||jn.ownerDocument.removeEventListener("pointermove",on),(Qt=a.domElement)==null||Qt.ownerDocument.removeEventListener("pointerup",xn)),a.dispatchEvent(b),tt=_e.NONE}function wn(qt){let fn;switch(qt.button){case 0:fn=a.mouseButtons.LEFT;break;case 1:fn=a.mouseButtons.MIDDLE;break;case 2:fn=a.mouseButtons.RIGHT;break;default:fn=-1}switch(fn){case MOUSE.DOLLY:if(a.enableZoom===!1)return;tn(qt),tt=_e.DOLLY;break;case MOUSE.ROTATE:if(qt.ctrlKey||qt.metaKey||qt.shiftKey){if(a.enablePan===!1)return;cn(qt),tt=_e.PAN}else{if(a.enableRotate===!1)return;Bt(qt),tt=_e.ROTATE}break;case MOUSE.PAN:if(qt.ctrlKey||qt.metaKey||qt.shiftKey){if(a.enableRotate===!1)return;Bt(qt),tt=_e.ROTATE}else{if(a.enablePan===!1)return;cn(qt),tt=_e.PAN}break;default:tt=_e.NONE}tt!==_e.NONE&&a.dispatchEvent(d)}function En(qt){if(a.enabled!==!1)switch(tt){case _e.ROTATE:if(a.enableRotate===!1)return;vn(qt);break;case _e.DOLLY:if(a.enableZoom===!1)return;On(qt);break;case _e.PAN:if(a.enablePan===!1)return;rr(qt);break}}function Hn(qt){a.enabled===!1||a.enableZoom===!1||tt!==_e.NONE&&tt!==_e.ROTATE||(qt.preventDefault(),a.dispatchEvent(d),Wn(qt),a.dispatchEvent(b))}function Fn(qt){a.enabled===!1||a.enablePan===!1||Bn(qt)}function zn(qt){switch(er(qt),vt.length){case 1:switch(a.touches.ONE){case TOUCH.ROTATE:if(a.enableRotate===!1)return;gn(),tt=_e.TOUCH_ROTATE;break;case TOUCH.PAN:if(a.enablePan===!1)return;bn(),tt=_e.TOUCH_PAN;break;default:tt=_e.NONE}break;case 2:switch(a.touches.TWO){case TOUCH.DOLLY_PAN:if(a.enableZoom===!1&&a.enablePan===!1)return;Jn(),tt=_e.TOUCH_DOLLY_PAN;break;case TOUCH.DOLLY_ROTATE:if(a.enableZoom===!1&&a.enableRotate===!1)return;Cn(),tt=_e.TOUCH_DOLLY_ROTATE;break;default:tt=_e.NONE}break;default:tt=_e.NONE}tt!==_e.NONE&&a.dispatchEvent(d)}function xr(qt){switch(er(qt),tt){case _e.TOUCH_ROTATE:if(a.enableRotate===!1)return;kn(qt),a.update();break;case _e.TOUCH_PAN:if(a.enablePan===!1)return;Nn(qt),a.update();break;case _e.TOUCH_DOLLY_PAN:if(a.enableZoom===!1&&a.enablePan===!1)return;Un(qt),a.update();break;case _e.TOUCH_DOLLY_ROTATE:if(a.enableZoom===!1&&a.enableRotate===!1)return;zt(qt),a.update();break;default:tt=_e.NONE}}function Tn(qt){a.enabled!==!1&&qt.preventDefault()}function Qn(qt){vt.push(qt)}function sr(qt){delete Mt[qt.pointerId];for(let fn=0;fn<vt.length;fn++)if(vt[fn].pointerId==qt.pointerId){vt.splice(fn,1);return}}function er(qt){let fn=Mt[qt.pointerId];fn===void 0&&(fn=new Vector2,Mt[qt.pointerId]=fn),fn.set(qt.pageX,qt.pageY)}function Xn(qt){const fn=qt.pointerId===vt[0].pointerId?vt[1]:vt[0];return Mt[fn.pointerId]}this.dollyIn=(qt=Lt())=>{Pt(qt),a.update()},this.dollyOut=(qt=Lt())=>{Gt(qt),a.update()},this.getScale=()=>at,this.setScale=qt=>{Ut(qt),a.update()},this.getZoomScale=()=>Lt(),s!==void 0&&this.connect(s),this.update()}};function decodeText(o){if(typeof TextDecoder<"u")return new TextDecoder().decode(o);let e="";for(let s=0,a=o.length;s<a;s++)e+=String.fromCharCode(o[s]);try{return decodeURIComponent(escape(e))}catch{return e}}const SRGBColorSpace="srgb",LinearSRGBColorSpace="srgb-linear",sRGBEncoding$1=3001,LinearEncoding$1=3e3;class GLTFLoader extends Loader{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(s){return new GLTFMaterialsClearcoatExtension(s)}),this.register(function(s){return new GLTFMaterialsDispersionExtension(s)}),this.register(function(s){return new GLTFTextureBasisUExtension(s)}),this.register(function(s){return new GLTFTextureWebPExtension(s)}),this.register(function(s){return new GLTFTextureAVIFExtension(s)}),this.register(function(s){return new GLTFMaterialsSheenExtension(s)}),this.register(function(s){return new GLTFMaterialsTransmissionExtension(s)}),this.register(function(s){return new GLTFMaterialsVolumeExtension(s)}),this.register(function(s){return new GLTFMaterialsIorExtension(s)}),this.register(function(s){return new GLTFMaterialsEmissiveStrengthExtension(s)}),this.register(function(s){return new GLTFMaterialsSpecularExtension(s)}),this.register(function(s){return new GLTFMaterialsIridescenceExtension(s)}),this.register(function(s){return new GLTFMaterialsAnisotropyExtension(s)}),this.register(function(s){return new GLTFMaterialsBumpExtension(s)}),this.register(function(s){return new GLTFLightsExtension(s)}),this.register(function(s){return new GLTFMeshoptCompression(s)}),this.register(function(s){return new GLTFMeshGpuInstancing(s)})}load(e,s,a,c){const d=this;let b;if(this.resourcePath!=="")b=this.resourcePath;else if(this.path!==""){const nt=LoaderUtils.extractUrlBase(e);b=LoaderUtils.resolveURL(nt,this.path)}else b=LoaderUtils.extractUrlBase(e);this.manager.itemStart(e);const _e=function(nt){c?c(nt):console.error(nt),d.manager.itemError(e),d.manager.itemEnd(e)},tt=new FileLoader(this.manager);tt.setPath(this.path),tt.setResponseType("arraybuffer"),tt.setRequestHeader(this.requestHeader),tt.setWithCredentials(this.withCredentials),tt.load(e,function(nt){try{d.parse(nt,b,function(it){s(it),d.manager.itemEnd(e)},_e)}catch(it){_e(it)}},a,_e)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,s,a,c){let d;const b={},_e={};if(typeof e=="string")d=JSON.parse(e);else if(e instanceof ArrayBuffer)if(decodeText(new Uint8Array(e.slice(0,4)))===BINARY_EXTENSION_HEADER_MAGIC){try{b[EXTENSIONS.KHR_BINARY_GLTF]=new GLTFBinaryExtension(e)}catch(it){c&&c(it);return}d=JSON.parse(b[EXTENSIONS.KHR_BINARY_GLTF].content)}else d=JSON.parse(decodeText(new Uint8Array(e)));else d=e;if(d.asset===void 0||d.asset.version[0]<2){c&&c(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const tt=new GLTFParser(d,{path:s||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});tt.fileLoader.setRequestHeader(this.requestHeader);for(let nt=0;nt<this.pluginCallbacks.length;nt++){const it=this.pluginCallbacks[nt](tt);it.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),_e[it.name]=it,b[it.name]=!0}if(d.extensionsUsed)for(let nt=0;nt<d.extensionsUsed.length;++nt){const it=d.extensionsUsed[nt],ot=d.extensionsRequired||[];switch(it){case EXTENSIONS.KHR_MATERIALS_UNLIT:b[it]=new GLTFMaterialsUnlitExtension;break;case EXTENSIONS.KHR_DRACO_MESH_COMPRESSION:b[it]=new GLTFDracoMeshCompressionExtension(d,this.dracoLoader);break;case EXTENSIONS.KHR_TEXTURE_TRANSFORM:b[it]=new GLTFTextureTransformExtension;break;case EXTENSIONS.KHR_MESH_QUANTIZATION:b[it]=new GLTFMeshQuantizationExtension;break;default:ot.indexOf(it)>=0&&_e[it]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+it+'".')}}tt.setExtensions(b),tt.setPlugins(_e),tt.parse(a,c)}parseAsync(e,s){const a=this;return new Promise(function(c,d){a.parse(e,s,c,d)})}}function GLTFRegistry(){let o={};return{get:function(e){return o[e]},add:function(e,s){o[e]=s},remove:function(e){delete o[e]},removeAll:function(){o={}}}}const EXTENSIONS={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class GLTFLightsExtension{constructor(e){this.parser=e,this.name=EXTENSIONS.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,s=this.parser.json.nodes||[];for(let a=0,c=s.length;a<c;a++){const d=s[a];d.extensions&&d.extensions[this.name]&&d.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,d.extensions[this.name].light)}}_loadLight(e){const s=this.parser,a="light:"+e;let c=s.cache.get(a);if(c)return c;const d=s.json,tt=((d.extensions&&d.extensions[this.name]||{}).lights||[])[e];let nt;const it=new Color(16777215);tt.color!==void 0&&it.setRGB(tt.color[0],tt.color[1],tt.color[2],LinearSRGBColorSpace);const ot=tt.range!==void 0?tt.range:0;switch(tt.type){case"directional":nt=new DirectionalLight(it),nt.target.position.set(0,0,-1),nt.add(nt.target);break;case"point":nt=new PointLight(it),nt.distance=ot;break;case"spot":nt=new SpotLight(it),nt.distance=ot,tt.spot=tt.spot||{},tt.spot.innerConeAngle=tt.spot.innerConeAngle!==void 0?tt.spot.innerConeAngle:0,tt.spot.outerConeAngle=tt.spot.outerConeAngle!==void 0?tt.spot.outerConeAngle:Math.PI/4,nt.angle=tt.spot.outerConeAngle,nt.penumbra=1-tt.spot.innerConeAngle/tt.spot.outerConeAngle,nt.target.position.set(0,0,-1),nt.add(nt.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+tt.type)}return nt.position.set(0,0,0),nt.decay=2,assignExtrasToUserData(nt,tt),tt.intensity!==void 0&&(nt.intensity=tt.intensity),nt.name=s.createUniqueName(tt.name||"light_"+e),c=Promise.resolve(nt),s.cache.add(a,c),c}getDependency(e,s){if(e==="light")return this._loadLight(s)}createNodeAttachment(e){const s=this,a=this.parser,d=a.json.nodes[e],_e=(d.extensions&&d.extensions[this.name]||{}).light;return _e===void 0?null:this._loadLight(_e).then(function(tt){return a._getNodeRef(s.cache,_e,tt)})}}class GLTFMaterialsUnlitExtension{constructor(){this.name=EXTENSIONS.KHR_MATERIALS_UNLIT}getMaterialType(){return MeshBasicMaterial}extendParams(e,s,a){const c=[];e.color=new Color(1,1,1),e.opacity=1;const d=s.pbrMetallicRoughness;if(d){if(Array.isArray(d.baseColorFactor)){const b=d.baseColorFactor;e.color.setRGB(b[0],b[1],b[2],LinearSRGBColorSpace),e.opacity=b[3]}d.baseColorTexture!==void 0&&c.push(a.assignTexture(e,"map",d.baseColorTexture,SRGBColorSpace))}return Promise.all(c)}}class GLTFMaterialsEmissiveStrengthExtension{constructor(e){this.parser=e,this.name=EXTENSIONS.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,s){const c=this.parser.json.materials[e];if(!c.extensions||!c.extensions[this.name])return Promise.resolve();const d=c.extensions[this.name].emissiveStrength;return d!==void 0&&(s.emissiveIntensity=d),Promise.resolve()}}class GLTFMaterialsClearcoatExtension{constructor(e){this.parser=e,this.name=EXTENSIONS.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const a=this.parser.json.materials[e];return!a.extensions||!a.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(e,s){const a=this.parser,c=a.json.materials[e];if(!c.extensions||!c.extensions[this.name])return Promise.resolve();const d=[],b=c.extensions[this.name];if(b.clearcoatFactor!==void 0&&(s.clearcoat=b.clearcoatFactor),b.clearcoatTexture!==void 0&&d.push(a.assignTexture(s,"clearcoatMap",b.clearcoatTexture)),b.clearcoatRoughnessFactor!==void 0&&(s.clearcoatRoughness=b.clearcoatRoughnessFactor),b.clearcoatRoughnessTexture!==void 0&&d.push(a.assignTexture(s,"clearcoatRoughnessMap",b.clearcoatRoughnessTexture)),b.clearcoatNormalTexture!==void 0&&(d.push(a.assignTexture(s,"clearcoatNormalMap",b.clearcoatNormalTexture)),b.clearcoatNormalTexture.scale!==void 0)){const _e=b.clearcoatNormalTexture.scale;s.clearcoatNormalScale=new Vector2(_e,_e)}return Promise.all(d)}}class GLTFMaterialsDispersionExtension{constructor(e){this.parser=e,this.name=EXTENSIONS.KHR_MATERIALS_DISPERSION}getMaterialType(e){const a=this.parser.json.materials[e];return!a.extensions||!a.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(e,s){const c=this.parser.json.materials[e];if(!c.extensions||!c.extensions[this.name])return Promise.resolve();const d=c.extensions[this.name];return s.dispersion=d.dispersion!==void 0?d.dispersion:0,Promise.resolve()}}class GLTFMaterialsIridescenceExtension{constructor(e){this.parser=e,this.name=EXTENSIONS.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const a=this.parser.json.materials[e];return!a.extensions||!a.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(e,s){const a=this.parser,c=a.json.materials[e];if(!c.extensions||!c.extensions[this.name])return Promise.resolve();const d=[],b=c.extensions[this.name];return b.iridescenceFactor!==void 0&&(s.iridescence=b.iridescenceFactor),b.iridescenceTexture!==void 0&&d.push(a.assignTexture(s,"iridescenceMap",b.iridescenceTexture)),b.iridescenceIor!==void 0&&(s.iridescenceIOR=b.iridescenceIor),s.iridescenceThicknessRange===void 0&&(s.iridescenceThicknessRange=[100,400]),b.iridescenceThicknessMinimum!==void 0&&(s.iridescenceThicknessRange[0]=b.iridescenceThicknessMinimum),b.iridescenceThicknessMaximum!==void 0&&(s.iridescenceThicknessRange[1]=b.iridescenceThicknessMaximum),b.iridescenceThicknessTexture!==void 0&&d.push(a.assignTexture(s,"iridescenceThicknessMap",b.iridescenceThicknessTexture)),Promise.all(d)}}class GLTFMaterialsSheenExtension{constructor(e){this.parser=e,this.name=EXTENSIONS.KHR_MATERIALS_SHEEN}getMaterialType(e){const a=this.parser.json.materials[e];return!a.extensions||!a.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(e,s){const a=this.parser,c=a.json.materials[e];if(!c.extensions||!c.extensions[this.name])return Promise.resolve();const d=[];s.sheenColor=new Color(0,0,0),s.sheenRoughness=0,s.sheen=1;const b=c.extensions[this.name];if(b.sheenColorFactor!==void 0){const _e=b.sheenColorFactor;s.sheenColor.setRGB(_e[0],_e[1],_e[2],LinearSRGBColorSpace)}return b.sheenRoughnessFactor!==void 0&&(s.sheenRoughness=b.sheenRoughnessFactor),b.sheenColorTexture!==void 0&&d.push(a.assignTexture(s,"sheenColorMap",b.sheenColorTexture,SRGBColorSpace)),b.sheenRoughnessTexture!==void 0&&d.push(a.assignTexture(s,"sheenRoughnessMap",b.sheenRoughnessTexture)),Promise.all(d)}}class GLTFMaterialsTransmissionExtension{constructor(e){this.parser=e,this.name=EXTENSIONS.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const a=this.parser.json.materials[e];return!a.extensions||!a.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(e,s){const a=this.parser,c=a.json.materials[e];if(!c.extensions||!c.extensions[this.name])return Promise.resolve();const d=[],b=c.extensions[this.name];return b.transmissionFactor!==void 0&&(s.transmission=b.transmissionFactor),b.transmissionTexture!==void 0&&d.push(a.assignTexture(s,"transmissionMap",b.transmissionTexture)),Promise.all(d)}}class GLTFMaterialsVolumeExtension{constructor(e){this.parser=e,this.name=EXTENSIONS.KHR_MATERIALS_VOLUME}getMaterialType(e){const a=this.parser.json.materials[e];return!a.extensions||!a.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(e,s){const a=this.parser,c=a.json.materials[e];if(!c.extensions||!c.extensions[this.name])return Promise.resolve();const d=[],b=c.extensions[this.name];s.thickness=b.thicknessFactor!==void 0?b.thicknessFactor:0,b.thicknessTexture!==void 0&&d.push(a.assignTexture(s,"thicknessMap",b.thicknessTexture)),s.attenuationDistance=b.attenuationDistance||1/0;const _e=b.attenuationColor||[1,1,1];return s.attenuationColor=new Color().setRGB(_e[0],_e[1],_e[2],LinearSRGBColorSpace),Promise.all(d)}}class GLTFMaterialsIorExtension{constructor(e){this.parser=e,this.name=EXTENSIONS.KHR_MATERIALS_IOR}getMaterialType(e){const a=this.parser.json.materials[e];return!a.extensions||!a.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(e,s){const c=this.parser.json.materials[e];if(!c.extensions||!c.extensions[this.name])return Promise.resolve();const d=c.extensions[this.name];return s.ior=d.ior!==void 0?d.ior:1.5,Promise.resolve()}}class GLTFMaterialsSpecularExtension{constructor(e){this.parser=e,this.name=EXTENSIONS.KHR_MATERIALS_SPECULAR}getMaterialType(e){const a=this.parser.json.materials[e];return!a.extensions||!a.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(e,s){const a=this.parser,c=a.json.materials[e];if(!c.extensions||!c.extensions[this.name])return Promise.resolve();const d=[],b=c.extensions[this.name];s.specularIntensity=b.specularFactor!==void 0?b.specularFactor:1,b.specularTexture!==void 0&&d.push(a.assignTexture(s,"specularIntensityMap",b.specularTexture));const _e=b.specularColorFactor||[1,1,1];return s.specularColor=new Color().setRGB(_e[0],_e[1],_e[2],LinearSRGBColorSpace),b.specularColorTexture!==void 0&&d.push(a.assignTexture(s,"specularColorMap",b.specularColorTexture,SRGBColorSpace)),Promise.all(d)}}class GLTFMaterialsBumpExtension{constructor(e){this.parser=e,this.name=EXTENSIONS.EXT_MATERIALS_BUMP}getMaterialType(e){const a=this.parser.json.materials[e];return!a.extensions||!a.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(e,s){const a=this.parser,c=a.json.materials[e];if(!c.extensions||!c.extensions[this.name])return Promise.resolve();const d=[],b=c.extensions[this.name];return s.bumpScale=b.bumpFactor!==void 0?b.bumpFactor:1,b.bumpTexture!==void 0&&d.push(a.assignTexture(s,"bumpMap",b.bumpTexture)),Promise.all(d)}}class GLTFMaterialsAnisotropyExtension{constructor(e){this.parser=e,this.name=EXTENSIONS.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const a=this.parser.json.materials[e];return!a.extensions||!a.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(e,s){const a=this.parser,c=a.json.materials[e];if(!c.extensions||!c.extensions[this.name])return Promise.resolve();const d=[],b=c.extensions[this.name];return b.anisotropyStrength!==void 0&&(s.anisotropy=b.anisotropyStrength),b.anisotropyRotation!==void 0&&(s.anisotropyRotation=b.anisotropyRotation),b.anisotropyTexture!==void 0&&d.push(a.assignTexture(s,"anisotropyMap",b.anisotropyTexture)),Promise.all(d)}}class GLTFTextureBasisUExtension{constructor(e){this.parser=e,this.name=EXTENSIONS.KHR_TEXTURE_BASISU}loadTexture(e){const s=this.parser,a=s.json,c=a.textures[e];if(!c.extensions||!c.extensions[this.name])return null;const d=c.extensions[this.name],b=s.options.ktx2Loader;if(!b){if(a.extensionsRequired&&a.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return s.loadTextureImage(e,d.source,b)}}class GLTFTextureWebPExtension{constructor(e){this.parser=e,this.name=EXTENSIONS.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const s=this.name,a=this.parser,c=a.json,d=c.textures[e];if(!d.extensions||!d.extensions[s])return null;const b=d.extensions[s],_e=c.images[b.source];let tt=a.textureLoader;if(_e.uri){const nt=a.options.manager.getHandler(_e.uri);nt!==null&&(tt=nt)}return this.detectSupport().then(function(nt){if(nt)return a.loadTextureImage(e,b.source,tt);if(c.extensionsRequired&&c.extensionsRequired.indexOf(s)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return a.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const s=new Image;s.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",s.onload=s.onerror=function(){e(s.height===1)}})),this.isSupported}}class GLTFTextureAVIFExtension{constructor(e){this.parser=e,this.name=EXTENSIONS.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const s=this.name,a=this.parser,c=a.json,d=c.textures[e];if(!d.extensions||!d.extensions[s])return null;const b=d.extensions[s],_e=c.images[b.source];let tt=a.textureLoader;if(_e.uri){const nt=a.options.manager.getHandler(_e.uri);nt!==null&&(tt=nt)}return this.detectSupport().then(function(nt){if(nt)return a.loadTextureImage(e,b.source,tt);if(c.extensionsRequired&&c.extensionsRequired.indexOf(s)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return a.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const s=new Image;s.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",s.onload=s.onerror=function(){e(s.height===1)}})),this.isSupported}}class GLTFMeshoptCompression{constructor(e){this.name=EXTENSIONS.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const s=this.parser.json,a=s.bufferViews[e];if(a.extensions&&a.extensions[this.name]){const c=a.extensions[this.name],d=this.parser.getDependency("buffer",c.buffer),b=this.parser.options.meshoptDecoder;if(!b||!b.supported){if(s.extensionsRequired&&s.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return d.then(function(_e){const tt=c.byteOffset||0,nt=c.byteLength||0,it=c.count,ot=c.byteStride,at=new Uint8Array(_e,tt,nt);return b.decodeGltfBufferAsync?b.decodeGltfBufferAsync(it,ot,at,c.mode,c.filter).then(function(ct){return ct.buffer}):b.ready.then(function(){const ct=new ArrayBuffer(it*ot);return b.decodeGltfBuffer(new Uint8Array(ct),it,ot,at,c.mode,c.filter),ct})})}else return null}}class GLTFMeshGpuInstancing{constructor(e){this.name=EXTENSIONS.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const s=this.parser.json,a=s.nodes[e];if(!a.extensions||!a.extensions[this.name]||a.mesh===void 0)return null;const c=s.meshes[a.mesh];for(const nt of c.primitives)if(nt.mode!==WEBGL_CONSTANTS.TRIANGLES&&nt.mode!==WEBGL_CONSTANTS.TRIANGLE_STRIP&&nt.mode!==WEBGL_CONSTANTS.TRIANGLE_FAN&&nt.mode!==void 0)return null;const b=a.extensions[this.name].attributes,_e=[],tt={};for(const nt in b)_e.push(this.parser.getDependency("accessor",b[nt]).then(it=>(tt[nt]=it,tt[nt])));return _e.length<1?null:(_e.push(this.parser.createNodeMesh(e)),Promise.all(_e).then(nt=>{const it=nt.pop(),ot=it.isGroup?it.children:[it],at=nt[0].count,ct=[];for(const ut of ot){const ft=new Matrix4,dt=new Vector3,lt=new Quaternion,ht=new Vector3(1,1,1),mt=new InstancedMesh(ut.geometry,ut.material,at);for(let xt=0;xt<at;xt++)tt.TRANSLATION&&dt.fromBufferAttribute(tt.TRANSLATION,xt),tt.ROTATION&&lt.fromBufferAttribute(tt.ROTATION,xt),tt.SCALE&&ht.fromBufferAttribute(tt.SCALE,xt),mt.setMatrixAt(xt,ft.compose(dt,lt,ht));for(const xt in tt)if(xt==="_COLOR_0"){const St=tt[xt];mt.instanceColor=new InstancedBufferAttribute(St.array,St.itemSize,St.normalized)}else xt!=="TRANSLATION"&&xt!=="ROTATION"&&xt!=="SCALE"&&ut.geometry.setAttribute(xt,tt[xt]);Object3D.prototype.copy.call(mt,ut),this.parser.assignFinalMaterial(mt),ct.push(mt)}return it.isGroup?(it.clear(),it.add(...ct),it):ct[0]}))}}const BINARY_EXTENSION_HEADER_MAGIC="glTF",BINARY_EXTENSION_HEADER_LENGTH=12,BINARY_EXTENSION_CHUNK_TYPES={JSON:1313821514,BIN:5130562};class GLTFBinaryExtension{constructor(e){this.name=EXTENSIONS.KHR_BINARY_GLTF,this.content=null,this.body=null;const s=new DataView(e,0,BINARY_EXTENSION_HEADER_LENGTH);if(this.header={magic:decodeText(new Uint8Array(e.slice(0,4))),version:s.getUint32(4,!0),length:s.getUint32(8,!0)},this.header.magic!==BINARY_EXTENSION_HEADER_MAGIC)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const a=this.header.length-BINARY_EXTENSION_HEADER_LENGTH,c=new DataView(e,BINARY_EXTENSION_HEADER_LENGTH);let d=0;for(;d<a;){const b=c.getUint32(d,!0);d+=4;const _e=c.getUint32(d,!0);if(d+=4,_e===BINARY_EXTENSION_CHUNK_TYPES.JSON){const tt=new Uint8Array(e,BINARY_EXTENSION_HEADER_LENGTH+d,b);this.content=decodeText(tt)}else if(_e===BINARY_EXTENSION_CHUNK_TYPES.BIN){const tt=BINARY_EXTENSION_HEADER_LENGTH+d;this.body=e.slice(tt,tt+b)}d+=b}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class GLTFDracoMeshCompressionExtension{constructor(e,s){if(!s)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=EXTENSIONS.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=s,this.dracoLoader.preload()}decodePrimitive(e,s){const a=this.json,c=this.dracoLoader,d=e.extensions[this.name].bufferView,b=e.extensions[this.name].attributes,_e={},tt={},nt={};for(const it in b){const ot=ATTRIBUTES[it]||it.toLowerCase();_e[ot]=b[it]}for(const it in e.attributes){const ot=ATTRIBUTES[it]||it.toLowerCase();if(b[it]!==void 0){const at=a.accessors[e.attributes[it]],ct=WEBGL_COMPONENT_TYPES[at.componentType];nt[ot]=ct.name,tt[ot]=at.normalized===!0}}return s.getDependency("bufferView",d).then(function(it){return new Promise(function(ot,at){c.decodeDracoFile(it,function(ct){for(const ut in ct.attributes){const ft=ct.attributes[ut],dt=tt[ut];dt!==void 0&&(ft.normalized=dt)}ot(ct)},_e,nt,LinearSRGBColorSpace,at)})})}}class GLTFTextureTransformExtension{constructor(){this.name=EXTENSIONS.KHR_TEXTURE_TRANSFORM}extendTexture(e,s){return(s.texCoord===void 0||s.texCoord===e.channel)&&s.offset===void 0&&s.rotation===void 0&&s.scale===void 0||(e=e.clone(),s.texCoord!==void 0&&(e.channel=s.texCoord),s.offset!==void 0&&e.offset.fromArray(s.offset),s.rotation!==void 0&&(e.rotation=s.rotation),s.scale!==void 0&&e.repeat.fromArray(s.scale),e.needsUpdate=!0),e}}class GLTFMeshQuantizationExtension{constructor(){this.name=EXTENSIONS.KHR_MESH_QUANTIZATION}}class GLTFCubicSplineInterpolant extends Interpolant{constructor(e,s,a,c){super(e,s,a,c)}copySampleValue_(e){const s=this.resultBuffer,a=this.sampleValues,c=this.valueSize,d=e*c*3+c;for(let b=0;b!==c;b++)s[b]=a[d+b];return s}interpolate_(e,s,a,c){const d=this.resultBuffer,b=this.sampleValues,_e=this.valueSize,tt=_e*2,nt=_e*3,it=c-s,ot=(a-s)/it,at=ot*ot,ct=at*ot,ut=e*nt,ft=ut-nt,dt=-2*ct+3*at,lt=ct-at,ht=1-dt,mt=lt-at+ot;for(let xt=0;xt!==_e;xt++){const St=b[ft+xt+_e],yt=b[ft+xt+tt]*it,wt=b[ut+xt+_e],Et=b[ut+xt]*it;d[xt]=ht*St+mt*yt+dt*wt+lt*Et}return d}}const _q=new Quaternion;class GLTFCubicSplineQuaternionInterpolant extends GLTFCubicSplineInterpolant{interpolate_(e,s,a,c){const d=super.interpolate_(e,s,a,c);return _q.fromArray(d).normalize().toArray(d),d}}const WEBGL_CONSTANTS={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},WEBGL_COMPONENT_TYPES={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},WEBGL_FILTERS={9728:NearestFilter,9729:LinearFilter,9984:NearestMipmapNearestFilter,9985:LinearMipmapNearestFilter,9986:NearestMipmapLinearFilter,9987:LinearMipmapLinearFilter},WEBGL_WRAPPINGS={33071:ClampToEdgeWrapping,33648:MirroredRepeatWrapping,10497:RepeatWrapping},WEBGL_TYPE_SIZES={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},ATTRIBUTES={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",...version$1>=152?{TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3"}:{TEXCOORD_0:"uv",TEXCOORD_1:"uv2"},COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},PATH_PROPERTIES={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},INTERPOLATION={CUBICSPLINE:void 0,LINEAR:InterpolateLinear,STEP:InterpolateDiscrete},ALPHA_MODES={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function createDefaultMaterial(o){return o.DefaultMaterial===void 0&&(o.DefaultMaterial=new MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:FrontSide})),o.DefaultMaterial}function addUnknownExtensionsToUserData(o,e,s){for(const a in s.extensions)o[a]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[a]=s.extensions[a])}function assignExtrasToUserData(o,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(o.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function addMorphTargets(o,e,s){let a=!1,c=!1,d=!1;for(let nt=0,it=e.length;nt<it;nt++){const ot=e[nt];if(ot.POSITION!==void 0&&(a=!0),ot.NORMAL!==void 0&&(c=!0),ot.COLOR_0!==void 0&&(d=!0),a&&c&&d)break}if(!a&&!c&&!d)return Promise.resolve(o);const b=[],_e=[],tt=[];for(let nt=0,it=e.length;nt<it;nt++){const ot=e[nt];if(a){const at=ot.POSITION!==void 0?s.getDependency("accessor",ot.POSITION):o.attributes.position;b.push(at)}if(c){const at=ot.NORMAL!==void 0?s.getDependency("accessor",ot.NORMAL):o.attributes.normal;_e.push(at)}if(d){const at=ot.COLOR_0!==void 0?s.getDependency("accessor",ot.COLOR_0):o.attributes.color;tt.push(at)}}return Promise.all([Promise.all(b),Promise.all(_e),Promise.all(tt)]).then(function(nt){const it=nt[0],ot=nt[1],at=nt[2];return a&&(o.morphAttributes.position=it),c&&(o.morphAttributes.normal=ot),d&&(o.morphAttributes.color=at),o.morphTargetsRelative=!0,o})}function updateMorphTargets(o,e){if(o.updateMorphTargets(),e.weights!==void 0)for(let s=0,a=e.weights.length;s<a;s++)o.morphTargetInfluences[s]=e.weights[s];if(e.extras&&Array.isArray(e.extras.targetNames)){const s=e.extras.targetNames;if(o.morphTargetInfluences.length===s.length){o.morphTargetDictionary={};for(let a=0,c=s.length;a<c;a++)o.morphTargetDictionary[s[a]]=a}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function createPrimitiveKey(o){let e;const s=o.extensions&&o.extensions[EXTENSIONS.KHR_DRACO_MESH_COMPRESSION];if(s?e="draco:"+s.bufferView+":"+s.indices+":"+createAttributesKey(s.attributes):e=o.indices+":"+createAttributesKey(o.attributes)+":"+o.mode,o.targets!==void 0)for(let a=0,c=o.targets.length;a<c;a++)e+=":"+createAttributesKey(o.targets[a]);return e}function createAttributesKey(o){let e="";const s=Object.keys(o).sort();for(let a=0,c=s.length;a<c;a++)e+=s[a]+":"+o[s[a]]+";";return e}function getNormalizedComponentScale(o){switch(o){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function getImageURIMimeType(o){return o.search(/\.jpe?g($|\?)/i)>0||o.search(/^data\:image\/jpeg/)===0?"image/jpeg":o.search(/\.webp($|\?)/i)>0||o.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const _identityMatrix=new Matrix4;class GLTFParser{constructor(e={},s={}){this.json=e,this.extensions={},this.plugins={},this.options=s,this.cache=new GLTFRegistry,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let a=!1,c=!1,d=-1;typeof navigator<"u"&&typeof navigator.userAgent<"u"&&(a=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,c=navigator.userAgent.indexOf("Firefox")>-1,d=c?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||a||c&&d<98?this.textureLoader=new TextureLoader(this.options.manager):this.textureLoader=new ImageBitmapLoader(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new FileLoader(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,s){const a=this,c=this.json,d=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(b){return b._markDefs&&b._markDefs()}),Promise.all(this._invokeAll(function(b){return b.beforeRoot&&b.beforeRoot()})).then(function(){return Promise.all([a.getDependencies("scene"),a.getDependencies("animation"),a.getDependencies("camera")])}).then(function(b){const _e={scene:b[0][c.scene||0],scenes:b[0],animations:b[1],cameras:b[2],asset:c.asset,parser:a,userData:{}};return addUnknownExtensionsToUserData(d,_e,c),assignExtrasToUserData(_e,c),Promise.all(a._invokeAll(function(tt){return tt.afterRoot&&tt.afterRoot(_e)})).then(function(){for(const tt of _e.scenes)tt.updateMatrixWorld();e(_e)})}).catch(s)}_markDefs(){const e=this.json.nodes||[],s=this.json.skins||[],a=this.json.meshes||[];for(let c=0,d=s.length;c<d;c++){const b=s[c].joints;for(let _e=0,tt=b.length;_e<tt;_e++)e[b[_e]].isBone=!0}for(let c=0,d=e.length;c<d;c++){const b=e[c];b.mesh!==void 0&&(this._addNodeRef(this.meshCache,b.mesh),b.skin!==void 0&&(a[b.mesh].isSkinnedMesh=!0)),b.camera!==void 0&&this._addNodeRef(this.cameraCache,b.camera)}}_addNodeRef(e,s){s!==void 0&&(e.refs[s]===void 0&&(e.refs[s]=e.uses[s]=0),e.refs[s]++)}_getNodeRef(e,s,a){if(e.refs[s]<=1)return a;const c=a.clone(),d=(b,_e)=>{const tt=this.associations.get(b);tt!=null&&this.associations.set(_e,tt);for(const[nt,it]of b.children.entries())d(it,_e.children[nt])};return d(a,c),c.name+="_instance_"+e.uses[s]++,c}_invokeOne(e){const s=Object.values(this.plugins);s.push(this);for(let a=0;a<s.length;a++){const c=e(s[a]);if(c)return c}return null}_invokeAll(e){const s=Object.values(this.plugins);s.unshift(this);const a=[];for(let c=0;c<s.length;c++){const d=e(s[c]);d&&a.push(d)}return a}getDependency(e,s){const a=e+":"+s;let c=this.cache.get(a);if(!c){switch(e){case"scene":c=this.loadScene(s);break;case"node":c=this._invokeOne(function(d){return d.loadNode&&d.loadNode(s)});break;case"mesh":c=this._invokeOne(function(d){return d.loadMesh&&d.loadMesh(s)});break;case"accessor":c=this.loadAccessor(s);break;case"bufferView":c=this._invokeOne(function(d){return d.loadBufferView&&d.loadBufferView(s)});break;case"buffer":c=this.loadBuffer(s);break;case"material":c=this._invokeOne(function(d){return d.loadMaterial&&d.loadMaterial(s)});break;case"texture":c=this._invokeOne(function(d){return d.loadTexture&&d.loadTexture(s)});break;case"skin":c=this.loadSkin(s);break;case"animation":c=this._invokeOne(function(d){return d.loadAnimation&&d.loadAnimation(s)});break;case"camera":c=this.loadCamera(s);break;default:if(c=this._invokeOne(function(d){return d!=this&&d.getDependency&&d.getDependency(e,s)}),!c)throw new Error("Unknown type: "+e);break}this.cache.add(a,c)}return c}getDependencies(e){let s=this.cache.get(e);if(!s){const a=this,c=this.json[e+(e==="mesh"?"es":"s")]||[];s=Promise.all(c.map(function(d,b){return a.getDependency(e,b)})),this.cache.add(e,s)}return s}loadBuffer(e){const s=this.json.buffers[e],a=this.fileLoader;if(s.type&&s.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+s.type+" buffer type is not supported.");if(s.uri===void 0&&e===0)return Promise.resolve(this.extensions[EXTENSIONS.KHR_BINARY_GLTF].body);const c=this.options;return new Promise(function(d,b){a.load(LoaderUtils.resolveURL(s.uri,c.path),d,void 0,function(){b(new Error('THREE.GLTFLoader: Failed to load buffer "'+s.uri+'".'))})})}loadBufferView(e){const s=this.json.bufferViews[e];return this.getDependency("buffer",s.buffer).then(function(a){const c=s.byteLength||0,d=s.byteOffset||0;return a.slice(d,d+c)})}loadAccessor(e){const s=this,a=this.json,c=this.json.accessors[e];if(c.bufferView===void 0&&c.sparse===void 0){const b=WEBGL_TYPE_SIZES[c.type],_e=WEBGL_COMPONENT_TYPES[c.componentType],tt=c.normalized===!0,nt=new _e(c.count*b);return Promise.resolve(new BufferAttribute(nt,b,tt))}const d=[];return c.bufferView!==void 0?d.push(this.getDependency("bufferView",c.bufferView)):d.push(null),c.sparse!==void 0&&(d.push(this.getDependency("bufferView",c.sparse.indices.bufferView)),d.push(this.getDependency("bufferView",c.sparse.values.bufferView))),Promise.all(d).then(function(b){const _e=b[0],tt=WEBGL_TYPE_SIZES[c.type],nt=WEBGL_COMPONENT_TYPES[c.componentType],it=nt.BYTES_PER_ELEMENT,ot=it*tt,at=c.byteOffset||0,ct=c.bufferView!==void 0?a.bufferViews[c.bufferView].byteStride:void 0,ut=c.normalized===!0;let ft,dt;if(ct&&ct!==ot){const lt=Math.floor(at/ct),ht="InterleavedBuffer:"+c.bufferView+":"+c.componentType+":"+lt+":"+c.count;let mt=s.cache.get(ht);mt||(ft=new nt(_e,lt*ct,c.count*ct/it),mt=new InterleavedBuffer(ft,ct/it),s.cache.add(ht,mt)),dt=new InterleavedBufferAttribute(mt,tt,at%ct/it,ut)}else _e===null?ft=new nt(c.count*tt):ft=new nt(_e,at,c.count*tt),dt=new BufferAttribute(ft,tt,ut);if(c.sparse!==void 0){const lt=WEBGL_TYPE_SIZES.SCALAR,ht=WEBGL_COMPONENT_TYPES[c.sparse.indices.componentType],mt=c.sparse.indices.byteOffset||0,xt=c.sparse.values.byteOffset||0,St=new ht(b[1],mt,c.sparse.count*lt),yt=new nt(b[2],xt,c.sparse.count*tt);_e!==null&&(dt=new BufferAttribute(dt.array.slice(),dt.itemSize,dt.normalized));for(let wt=0,Et=St.length;wt<Et;wt++){const _t=St[wt];if(dt.setX(_t,yt[wt*tt]),tt>=2&&dt.setY(_t,yt[wt*tt+1]),tt>=3&&dt.setZ(_t,yt[wt*tt+2]),tt>=4&&dt.setW(_t,yt[wt*tt+3]),tt>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return dt})}loadTexture(e){const s=this.json,a=this.options,d=s.textures[e].source,b=s.images[d];let _e=this.textureLoader;if(b.uri){const tt=a.manager.getHandler(b.uri);tt!==null&&(_e=tt)}return this.loadTextureImage(e,d,_e)}loadTextureImage(e,s,a){const c=this,d=this.json,b=d.textures[e],_e=d.images[s],tt=(_e.uri||_e.bufferView)+":"+b.sampler;if(this.textureCache[tt])return this.textureCache[tt];const nt=this.loadImageSource(s,a).then(function(it){it.flipY=!1,it.name=b.name||_e.name||"",it.name===""&&typeof _e.uri=="string"&&_e.uri.startsWith("data:image/")===!1&&(it.name=_e.uri);const at=(d.samplers||{})[b.sampler]||{};return it.magFilter=WEBGL_FILTERS[at.magFilter]||LinearFilter,it.minFilter=WEBGL_FILTERS[at.minFilter]||LinearMipmapLinearFilter,it.wrapS=WEBGL_WRAPPINGS[at.wrapS]||RepeatWrapping,it.wrapT=WEBGL_WRAPPINGS[at.wrapT]||RepeatWrapping,c.associations.set(it,{textures:e}),it}).catch(function(){return null});return this.textureCache[tt]=nt,nt}loadImageSource(e,s){const a=this,c=this.json,d=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(ot=>ot.clone());const b=c.images[e],_e=self.URL||self.webkitURL;let tt=b.uri||"",nt=!1;if(b.bufferView!==void 0)tt=a.getDependency("bufferView",b.bufferView).then(function(ot){nt=!0;const at=new Blob([ot],{type:b.mimeType});return tt=_e.createObjectURL(at),tt});else if(b.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const it=Promise.resolve(tt).then(function(ot){return new Promise(function(at,ct){let ut=at;s.isImageBitmapLoader===!0&&(ut=function(ft){const dt=new Texture(ft);dt.needsUpdate=!0,at(dt)}),s.load(LoaderUtils.resolveURL(ot,d.path),ut,void 0,ct)})}).then(function(ot){return nt===!0&&_e.revokeObjectURL(tt),assignExtrasToUserData(ot,b),ot.userData.mimeType=b.mimeType||getImageURIMimeType(b.uri),ot}).catch(function(ot){throw console.error("THREE.GLTFLoader: Couldn't load texture",tt),ot});return this.sourceCache[e]=it,it}assignTexture(e,s,a,c){const d=this;return this.getDependency("texture",a.index).then(function(b){if(!b)return null;if(a.texCoord!==void 0&&a.texCoord>0&&(b=b.clone(),b.channel=a.texCoord),d.extensions[EXTENSIONS.KHR_TEXTURE_TRANSFORM]){const _e=a.extensions!==void 0?a.extensions[EXTENSIONS.KHR_TEXTURE_TRANSFORM]:void 0;if(_e){const tt=d.associations.get(b);b=d.extensions[EXTENSIONS.KHR_TEXTURE_TRANSFORM].extendTexture(b,_e),d.associations.set(b,tt)}}return c!==void 0&&(typeof c=="number"&&(c=c===sRGBEncoding$1?SRGBColorSpace:LinearSRGBColorSpace),"colorSpace"in b?b.colorSpace=c:b.encoding=c===SRGBColorSpace?sRGBEncoding$1:LinearEncoding$1),e[s]=b,b})}assignFinalMaterial(e){const s=e.geometry;let a=e.material;const c=s.attributes.tangent===void 0,d=s.attributes.color!==void 0,b=s.attributes.normal===void 0;if(e.isPoints){const _e="PointsMaterial:"+a.uuid;let tt=this.cache.get(_e);tt||(tt=new PointsMaterial,Material.prototype.copy.call(tt,a),tt.color.copy(a.color),tt.map=a.map,tt.sizeAttenuation=!1,this.cache.add(_e,tt)),a=tt}else if(e.isLine){const _e="LineBasicMaterial:"+a.uuid;let tt=this.cache.get(_e);tt||(tt=new LineBasicMaterial,Material.prototype.copy.call(tt,a),tt.color.copy(a.color),tt.map=a.map,this.cache.add(_e,tt)),a=tt}if(c||d||b){let _e="ClonedMaterial:"+a.uuid+":";c&&(_e+="derivative-tangents:"),d&&(_e+="vertex-colors:"),b&&(_e+="flat-shading:");let tt=this.cache.get(_e);tt||(tt=a.clone(),d&&(tt.vertexColors=!0),b&&(tt.flatShading=!0),c&&(tt.normalScale&&(tt.normalScale.y*=-1),tt.clearcoatNormalScale&&(tt.clearcoatNormalScale.y*=-1)),this.cache.add(_e,tt),this.associations.set(tt,this.associations.get(a))),a=tt}e.material=a}getMaterialType(){return MeshStandardMaterial}loadMaterial(e){const s=this,a=this.json,c=this.extensions,d=a.materials[e];let b;const _e={},tt=d.extensions||{},nt=[];if(tt[EXTENSIONS.KHR_MATERIALS_UNLIT]){const ot=c[EXTENSIONS.KHR_MATERIALS_UNLIT];b=ot.getMaterialType(),nt.push(ot.extendParams(_e,d,s))}else{const ot=d.pbrMetallicRoughness||{};if(_e.color=new Color(1,1,1),_e.opacity=1,Array.isArray(ot.baseColorFactor)){const at=ot.baseColorFactor;_e.color.setRGB(at[0],at[1],at[2],LinearSRGBColorSpace),_e.opacity=at[3]}ot.baseColorTexture!==void 0&&nt.push(s.assignTexture(_e,"map",ot.baseColorTexture,SRGBColorSpace)),_e.metalness=ot.metallicFactor!==void 0?ot.metallicFactor:1,_e.roughness=ot.roughnessFactor!==void 0?ot.roughnessFactor:1,ot.metallicRoughnessTexture!==void 0&&(nt.push(s.assignTexture(_e,"metalnessMap",ot.metallicRoughnessTexture)),nt.push(s.assignTexture(_e,"roughnessMap",ot.metallicRoughnessTexture))),b=this._invokeOne(function(at){return at.getMaterialType&&at.getMaterialType(e)}),nt.push(Promise.all(this._invokeAll(function(at){return at.extendMaterialParams&&at.extendMaterialParams(e,_e)})))}d.doubleSided===!0&&(_e.side=DoubleSide);const it=d.alphaMode||ALPHA_MODES.OPAQUE;if(it===ALPHA_MODES.BLEND?(_e.transparent=!0,_e.depthWrite=!1):(_e.transparent=!1,it===ALPHA_MODES.MASK&&(_e.alphaTest=d.alphaCutoff!==void 0?d.alphaCutoff:.5)),d.normalTexture!==void 0&&b!==MeshBasicMaterial&&(nt.push(s.assignTexture(_e,"normalMap",d.normalTexture)),_e.normalScale=new Vector2(1,1),d.normalTexture.scale!==void 0)){const ot=d.normalTexture.scale;_e.normalScale.set(ot,ot)}if(d.occlusionTexture!==void 0&&b!==MeshBasicMaterial&&(nt.push(s.assignTexture(_e,"aoMap",d.occlusionTexture)),d.occlusionTexture.strength!==void 0&&(_e.aoMapIntensity=d.occlusionTexture.strength)),d.emissiveFactor!==void 0&&b!==MeshBasicMaterial){const ot=d.emissiveFactor;_e.emissive=new Color().setRGB(ot[0],ot[1],ot[2],LinearSRGBColorSpace)}return d.emissiveTexture!==void 0&&b!==MeshBasicMaterial&&nt.push(s.assignTexture(_e,"emissiveMap",d.emissiveTexture,SRGBColorSpace)),Promise.all(nt).then(function(){const ot=new b(_e);return d.name&&(ot.name=d.name),assignExtrasToUserData(ot,d),s.associations.set(ot,{materials:e}),d.extensions&&addUnknownExtensionsToUserData(c,ot,d),ot})}createUniqueName(e){const s=PropertyBinding.sanitizeNodeName(e||"");return s in this.nodeNamesUsed?s+"_"+ ++this.nodeNamesUsed[s]:(this.nodeNamesUsed[s]=0,s)}loadGeometries(e){const s=this,a=this.extensions,c=this.primitiveCache;function d(_e){return a[EXTENSIONS.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(_e,s).then(function(tt){return addPrimitiveAttributes(tt,_e,s)})}const b=[];for(let _e=0,tt=e.length;_e<tt;_e++){const nt=e[_e],it=createPrimitiveKey(nt),ot=c[it];if(ot)b.push(ot.promise);else{let at;nt.extensions&&nt.extensions[EXTENSIONS.KHR_DRACO_MESH_COMPRESSION]?at=d(nt):at=addPrimitiveAttributes(new BufferGeometry,nt,s),c[it]={primitive:nt,promise:at},b.push(at)}}return Promise.all(b)}loadMesh(e){const s=this,a=this.json,c=this.extensions,d=a.meshes[e],b=d.primitives,_e=[];for(let tt=0,nt=b.length;tt<nt;tt++){const it=b[tt].material===void 0?createDefaultMaterial(this.cache):this.getDependency("material",b[tt].material);_e.push(it)}return _e.push(s.loadGeometries(b)),Promise.all(_e).then(function(tt){const nt=tt.slice(0,tt.length-1),it=tt[tt.length-1],ot=[];for(let ct=0,ut=it.length;ct<ut;ct++){const ft=it[ct],dt=b[ct];let lt;const ht=nt[ct];if(dt.mode===WEBGL_CONSTANTS.TRIANGLES||dt.mode===WEBGL_CONSTANTS.TRIANGLE_STRIP||dt.mode===WEBGL_CONSTANTS.TRIANGLE_FAN||dt.mode===void 0)lt=d.isSkinnedMesh===!0?new SkinnedMesh(ft,ht):new Mesh(ft,ht),lt.isSkinnedMesh===!0&&lt.normalizeSkinWeights(),dt.mode===WEBGL_CONSTANTS.TRIANGLE_STRIP?lt.geometry=toTrianglesDrawMode(lt.geometry,TriangleStripDrawMode):dt.mode===WEBGL_CONSTANTS.TRIANGLE_FAN&&(lt.geometry=toTrianglesDrawMode(lt.geometry,TriangleFanDrawMode));else if(dt.mode===WEBGL_CONSTANTS.LINES)lt=new LineSegments(ft,ht);else if(dt.mode===WEBGL_CONSTANTS.LINE_STRIP)lt=new Line(ft,ht);else if(dt.mode===WEBGL_CONSTANTS.LINE_LOOP)lt=new LineLoop(ft,ht);else if(dt.mode===WEBGL_CONSTANTS.POINTS)lt=new Points(ft,ht);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+dt.mode);Object.keys(lt.geometry.morphAttributes).length>0&&updateMorphTargets(lt,d),lt.name=s.createUniqueName(d.name||"mesh_"+e),assignExtrasToUserData(lt,d),dt.extensions&&addUnknownExtensionsToUserData(c,lt,dt),s.assignFinalMaterial(lt),ot.push(lt)}for(let ct=0,ut=ot.length;ct<ut;ct++)s.associations.set(ot[ct],{meshes:e,primitives:ct});if(ot.length===1)return d.extensions&&addUnknownExtensionsToUserData(c,ot[0],d),ot[0];const at=new Group;d.extensions&&addUnknownExtensionsToUserData(c,at,d),s.associations.set(at,{meshes:e});for(let ct=0,ut=ot.length;ct<ut;ct++)at.add(ot[ct]);return at})}loadCamera(e){let s;const a=this.json.cameras[e],c=a[a.type];if(!c){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return a.type==="perspective"?s=new PerspectiveCamera(MathUtils.radToDeg(c.yfov),c.aspectRatio||1,c.znear||1,c.zfar||2e6):a.type==="orthographic"&&(s=new OrthographicCamera$1(-c.xmag,c.xmag,c.ymag,-c.ymag,c.znear,c.zfar)),a.name&&(s.name=this.createUniqueName(a.name)),assignExtrasToUserData(s,a),Promise.resolve(s)}loadSkin(e){const s=this.json.skins[e],a=[];for(let c=0,d=s.joints.length;c<d;c++)a.push(this._loadNodeShallow(s.joints[c]));return s.inverseBindMatrices!==void 0?a.push(this.getDependency("accessor",s.inverseBindMatrices)):a.push(null),Promise.all(a).then(function(c){const d=c.pop(),b=c,_e=[],tt=[];for(let nt=0,it=b.length;nt<it;nt++){const ot=b[nt];if(ot){_e.push(ot);const at=new Matrix4;d!==null&&at.fromArray(d.array,nt*16),tt.push(at)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',s.joints[nt])}return new Skeleton(_e,tt)})}loadAnimation(e){const s=this.json,a=this,c=s.animations[e],d=c.name?c.name:"animation_"+e,b=[],_e=[],tt=[],nt=[],it=[];for(let ot=0,at=c.channels.length;ot<at;ot++){const ct=c.channels[ot],ut=c.samplers[ct.sampler],ft=ct.target,dt=ft.node,lt=c.parameters!==void 0?c.parameters[ut.input]:ut.input,ht=c.parameters!==void 0?c.parameters[ut.output]:ut.output;ft.node!==void 0&&(b.push(this.getDependency("node",dt)),_e.push(this.getDependency("accessor",lt)),tt.push(this.getDependency("accessor",ht)),nt.push(ut),it.push(ft))}return Promise.all([Promise.all(b),Promise.all(_e),Promise.all(tt),Promise.all(nt),Promise.all(it)]).then(function(ot){const at=ot[0],ct=ot[1],ut=ot[2],ft=ot[3],dt=ot[4],lt=[];for(let ht=0,mt=at.length;ht<mt;ht++){const xt=at[ht],St=ct[ht],yt=ut[ht],wt=ft[ht],Et=dt[ht];if(xt===void 0)continue;xt.updateMatrix&&xt.updateMatrix();const _t=a._createAnimationTracks(xt,St,yt,wt,Et);if(_t)for(let vt=0;vt<_t.length;vt++)lt.push(_t[vt])}return new AnimationClip(d,void 0,lt)})}createNodeMesh(e){const s=this.json,a=this,c=s.nodes[e];return c.mesh===void 0?null:a.getDependency("mesh",c.mesh).then(function(d){const b=a._getNodeRef(a.meshCache,c.mesh,d);return c.weights!==void 0&&b.traverse(function(_e){if(_e.isMesh)for(let tt=0,nt=c.weights.length;tt<nt;tt++)_e.morphTargetInfluences[tt]=c.weights[tt]}),b})}loadNode(e){const s=this.json,a=this,c=s.nodes[e],d=a._loadNodeShallow(e),b=[],_e=c.children||[];for(let nt=0,it=_e.length;nt<it;nt++)b.push(a.getDependency("node",_e[nt]));const tt=c.skin===void 0?Promise.resolve(null):a.getDependency("skin",c.skin);return Promise.all([d,Promise.all(b),tt]).then(function(nt){const it=nt[0],ot=nt[1],at=nt[2];at!==null&&it.traverse(function(ct){ct.isSkinnedMesh&&ct.bind(at,_identityMatrix)});for(let ct=0,ut=ot.length;ct<ut;ct++)it.add(ot[ct]);return it})}_loadNodeShallow(e){const s=this.json,a=this.extensions,c=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];const d=s.nodes[e],b=d.name?c.createUniqueName(d.name):"",_e=[],tt=c._invokeOne(function(nt){return nt.createNodeMesh&&nt.createNodeMesh(e)});return tt&&_e.push(tt),d.camera!==void 0&&_e.push(c.getDependency("camera",d.camera).then(function(nt){return c._getNodeRef(c.cameraCache,d.camera,nt)})),c._invokeAll(function(nt){return nt.createNodeAttachment&&nt.createNodeAttachment(e)}).forEach(function(nt){_e.push(nt)}),this.nodeCache[e]=Promise.all(_e).then(function(nt){let it;if(d.isBone===!0?it=new Bone:nt.length>1?it=new Group:nt.length===1?it=nt[0]:it=new Object3D,it!==nt[0])for(let ot=0,at=nt.length;ot<at;ot++)it.add(nt[ot]);if(d.name&&(it.userData.name=d.name,it.name=b),assignExtrasToUserData(it,d),d.extensions&&addUnknownExtensionsToUserData(a,it,d),d.matrix!==void 0){const ot=new Matrix4;ot.fromArray(d.matrix),it.applyMatrix4(ot)}else d.translation!==void 0&&it.position.fromArray(d.translation),d.rotation!==void 0&&it.quaternion.fromArray(d.rotation),d.scale!==void 0&&it.scale.fromArray(d.scale);return c.associations.has(it)||c.associations.set(it,{}),c.associations.get(it).nodes=e,it}),this.nodeCache[e]}loadScene(e){const s=this.extensions,a=this.json.scenes[e],c=this,d=new Group;a.name&&(d.name=c.createUniqueName(a.name)),assignExtrasToUserData(d,a),a.extensions&&addUnknownExtensionsToUserData(s,d,a);const b=a.nodes||[],_e=[];for(let tt=0,nt=b.length;tt<nt;tt++)_e.push(c.getDependency("node",b[tt]));return Promise.all(_e).then(function(tt){for(let it=0,ot=tt.length;it<ot;it++)d.add(tt[it]);const nt=it=>{const ot=new Map;for(const[at,ct]of c.associations)(at instanceof Material||at instanceof Texture)&&ot.set(at,ct);return it.traverse(at=>{const ct=c.associations.get(at);ct!=null&&ot.set(at,ct)}),ot};return c.associations=nt(d),d})}_createAnimationTracks(e,s,a,c,d){const b=[],_e=e.name?e.name:e.uuid,tt=[];PATH_PROPERTIES[d.path]===PATH_PROPERTIES.weights?e.traverse(function(at){at.morphTargetInfluences&&tt.push(at.name?at.name:at.uuid)}):tt.push(_e);let nt;switch(PATH_PROPERTIES[d.path]){case PATH_PROPERTIES.weights:nt=NumberKeyframeTrack;break;case PATH_PROPERTIES.rotation:nt=QuaternionKeyframeTrack;break;case PATH_PROPERTIES.position:case PATH_PROPERTIES.scale:nt=VectorKeyframeTrack;break;default:switch(a.itemSize){case 1:nt=NumberKeyframeTrack;break;case 2:case 3:default:nt=VectorKeyframeTrack;break}break}const it=c.interpolation!==void 0?INTERPOLATION[c.interpolation]:InterpolateLinear,ot=this._getArrayFromAccessor(a);for(let at=0,ct=tt.length;at<ct;at++){const ut=new nt(tt[at]+"."+PATH_PROPERTIES[d.path],s.array,ot,it);c.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(ut),b.push(ut)}return b}_getArrayFromAccessor(e){let s=e.array;if(e.normalized){const a=getNormalizedComponentScale(s.constructor),c=new Float32Array(s.length);for(let d=0,b=s.length;d<b;d++)c[d]=s[d]*a;s=c}return s}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(a){const c=this instanceof QuaternionKeyframeTrack?GLTFCubicSplineQuaternionInterpolant:GLTFCubicSplineInterpolant;return new c(this.times,this.values,this.getValueSize()/3,a)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function computeBounds(o,e,s){const a=e.attributes,c=new Box3;if(a.POSITION!==void 0){const _e=s.json.accessors[a.POSITION],tt=_e.min,nt=_e.max;if(tt!==void 0&&nt!==void 0){if(c.set(new Vector3(tt[0],tt[1],tt[2]),new Vector3(nt[0],nt[1],nt[2])),_e.normalized){const it=getNormalizedComponentScale(WEBGL_COMPONENT_TYPES[_e.componentType]);c.min.multiplyScalar(it),c.max.multiplyScalar(it)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const d=e.targets;if(d!==void 0){const _e=new Vector3,tt=new Vector3;for(let nt=0,it=d.length;nt<it;nt++){const ot=d[nt];if(ot.POSITION!==void 0){const at=s.json.accessors[ot.POSITION],ct=at.min,ut=at.max;if(ct!==void 0&&ut!==void 0){if(tt.setX(Math.max(Math.abs(ct[0]),Math.abs(ut[0]))),tt.setY(Math.max(Math.abs(ct[1]),Math.abs(ut[1]))),tt.setZ(Math.max(Math.abs(ct[2]),Math.abs(ut[2]))),at.normalized){const ft=getNormalizedComponentScale(WEBGL_COMPONENT_TYPES[at.componentType]);tt.multiplyScalar(ft)}_e.max(tt)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}c.expandByVector(_e)}o.boundingBox=c;const b=new Sphere;c.getCenter(b.center),b.radius=c.min.distanceTo(c.max)/2,o.boundingSphere=b}function addPrimitiveAttributes(o,e,s){const a=e.attributes,c=[];function d(b,_e){return s.getDependency("accessor",b).then(function(tt){o.setAttribute(_e,tt)})}for(const b in a){const _e=ATTRIBUTES[b]||b.toLowerCase();_e in o.attributes||c.push(d(a[b],_e))}if(e.indices!==void 0&&!o.index){const b=s.getDependency("accessor",e.indices).then(function(_e){o.setIndex(_e)});c.push(b)}return assignExtrasToUserData(o,e),computeBounds(o,e,s),Promise.all(c).then(function(){return e.targets!==void 0?addMorphTargets(o,e.targets,s):o})}class RGBELoader extends DataTextureLoader{constructor(e){super(e),this.type=HalfFloatType}parse(e){const b=function(Et,_t){switch(Et){case 1:throw new Error("THREE.RGBELoader: Read Error: "+(_t||""));case 2:throw new Error("THREE.RGBELoader: Write Error: "+(_t||""));case 3:throw new Error("THREE.RGBELoader: Bad File Format: "+(_t||""));default:case 4:throw new Error("THREE.RGBELoader: Memory Error: "+(_t||""))}},it=`
`,ot=function(Et,_t,vt){_t=_t||1024;let jt=Et.pos,Lt=-1,Nt=0,kt="",Ot=String.fromCharCode.apply(null,new Uint16Array(Et.subarray(jt,jt+128)));for(;0>(Lt=Ot.indexOf(it))&&Nt<_t&&jt<Et.byteLength;)kt+=Ot,Nt+=Ot.length,jt+=128,Ot+=String.fromCharCode.apply(null,new Uint16Array(Et.subarray(jt,jt+128)));return-1<Lt?(Et.pos+=Nt+Lt+1,kt+Ot.slice(0,Lt)):!1},at=function(Et){const _t=/^#\?(\S+)/,vt=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,Mt=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,jt=/^\s*FORMAT=(\S+)\s*$/,Lt=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,Nt={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let kt,Ot;for((Et.pos>=Et.byteLength||!(kt=ot(Et)))&&b(1,"no header found"),(Ot=kt.match(_t))||b(3,"bad initial token"),Nt.valid|=1,Nt.programtype=Ot[1],Nt.string+=kt+`
`;kt=ot(Et),kt!==!1;){if(Nt.string+=kt+`
`,kt.charAt(0)==="#"){Nt.comments+=kt+`
`;continue}if((Ot=kt.match(vt))&&(Nt.gamma=parseFloat(Ot[1])),(Ot=kt.match(Mt))&&(Nt.exposure=parseFloat(Ot[1])),(Ot=kt.match(jt))&&(Nt.valid|=2,Nt.format=Ot[1]),(Ot=kt.match(Lt))&&(Nt.valid|=4,Nt.height=parseInt(Ot[1],10),Nt.width=parseInt(Ot[2],10)),Nt.valid&2&&Nt.valid&4)break}return Nt.valid&2||b(3,"missing format specifier"),Nt.valid&4||b(3,"missing image size specifier"),Nt},ct=function(Et,_t,vt){const Mt=_t;if(Mt<8||Mt>32767||Et[0]!==2||Et[1]!==2||Et[2]&128)return new Uint8Array(Et);Mt!==(Et[2]<<8|Et[3])&&b(3,"wrong scanline width");const jt=new Uint8Array(4*_t*vt);jt.length||b(4,"unable to allocate buffer space");let Lt=0,Nt=0;const kt=4*Mt,Ot=new Uint8Array(4),Ht=new Uint8Array(kt);let Ct=vt;for(;Ct>0&&Nt<Et.byteLength;){Nt+4>Et.byteLength&&b(1),Ot[0]=Et[Nt++],Ot[1]=Et[Nt++],Ot[2]=Et[Nt++],Ot[3]=Et[Nt++],(Ot[0]!=2||Ot[1]!=2||(Ot[2]<<8|Ot[3])!=Mt)&&b(3,"bad rgbe scanline format");let Ut=0,Gt;for(;Ut<kt&&Nt<Et.byteLength;){Gt=Et[Nt++];const Wt=Gt>128;if(Wt&&(Gt-=128),(Gt===0||Ut+Gt>kt)&&b(3,"bad scanline data"),Wt){const sn=Et[Nt++];for(let Bt=0;Bt<Gt;Bt++)Ht[Ut++]=sn}else Ht.set(Et.subarray(Nt,Nt+Gt),Ut),Ut+=Gt,Nt+=Gt}const Pt=Mt;for(let Wt=0;Wt<Pt;Wt++){let sn=0;jt[Lt]=Ht[Wt+sn],sn+=Mt,jt[Lt+1]=Ht[Wt+sn],sn+=Mt,jt[Lt+2]=Ht[Wt+sn],sn+=Mt,jt[Lt+3]=Ht[Wt+sn],Lt+=4}Ct--}return jt},ut=function(Et,_t,vt,Mt){const jt=Et[_t+3],Lt=Math.pow(2,jt-128)/255;vt[Mt+0]=Et[_t+0]*Lt,vt[Mt+1]=Et[_t+1]*Lt,vt[Mt+2]=Et[_t+2]*Lt,vt[Mt+3]=1},ft=function(Et,_t,vt,Mt){const jt=Et[_t+3],Lt=Math.pow(2,jt-128)/255;vt[Mt+0]=DataUtils.toHalfFloat(Math.min(Et[_t+0]*Lt,65504)),vt[Mt+1]=DataUtils.toHalfFloat(Math.min(Et[_t+1]*Lt,65504)),vt[Mt+2]=DataUtils.toHalfFloat(Math.min(Et[_t+2]*Lt,65504)),vt[Mt+3]=DataUtils.toHalfFloat(1)},dt=new Uint8Array(e);dt.pos=0;const lt=at(dt),ht=lt.width,mt=lt.height,xt=ct(dt.subarray(dt.pos),ht,mt);let St,yt,wt;switch(this.type){case FloatType:wt=xt.length/4;const Et=new Float32Array(wt*4);for(let vt=0;vt<wt;vt++)ut(xt,vt*4,Et,vt*4);St=Et,yt=FloatType;break;case HalfFloatType:wt=xt.length/4;const _t=new Uint16Array(wt*4);for(let vt=0;vt<wt;vt++)ft(xt,vt*4,_t,vt*4);St=_t,yt=HalfFloatType;break;default:throw new Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:ht,height:mt,data:St,header:lt.string,gamma:lt.gamma,exposure:lt.exposure,type:yt}}setDataType(e){return this.type=e,this}load(e,s,a,c){function d(b,_e){switch(b.type){case FloatType:case HalfFloatType:"colorSpace"in b?b.colorSpace="srgb-linear":b.encoding=3e3,b.minFilter=LinearFilter,b.magFilter=LinearFilter,b.generateMipmaps=!1,b.flipY=!0;break}s&&s(b,_e)}return super.load(e,d,a,c)}}const hasColorSpace=version$1>=152;class EXRLoader extends DataTextureLoader{constructor(e){super(e),this.type=HalfFloatType}parse(e){const _t=Math.pow(2.7182818,2.2);function vt(Tt,Dt){for(var Zt=0,dn=0;dn<65536;++dn)(dn==0||Tt[dn>>3]&1<<(dn&7))&&(Dt[Zt++]=dn);for(var mn=Zt-1;Zt<65536;)Dt[Zt++]=0;return mn}function Mt(Tt){for(var Dt=0;Dt<16384;Dt++)Tt[Dt]={},Tt[Dt].len=0,Tt[Dt].lit=0,Tt[Dt].p=null}const jt={l:0,c:0,lc:0};function Lt(Tt,Dt,Zt,dn,mn){for(;Zt<Tt;)Dt=Dt<<8|Xn(dn,mn),Zt+=8;Zt-=Tt,jt.l=Dt>>Zt&(1<<Tt)-1,jt.c=Dt,jt.lc=Zt}const Nt=new Array(59);function kt(Tt){for(var Dt=0;Dt<=58;++Dt)Nt[Dt]=0;for(var Dt=0;Dt<65537;++Dt)Nt[Tt[Dt]]+=1;for(var Zt=0,Dt=58;Dt>0;--Dt){var dn=Zt+Nt[Dt]>>1;Nt[Dt]=Zt,Zt=dn}for(var Dt=0;Dt<65537;++Dt){var mn=Tt[Dt];mn>0&&(Tt[Dt]=mn|Nt[mn]++<<6)}}function Ot(Tt,Dt,Zt,dn,mn,At,Vt){for(var Yt=Zt,Jt=0,Xt=0;mn<=At;mn++){if(Yt.value-Zt.value>dn)return!1;Lt(6,Jt,Xt,Tt,Yt);var rn=jt.l;if(Jt=jt.c,Xt=jt.lc,Vt[mn]=rn,rn==63){if(Yt.value-Zt.value>dn)throw"Something wrong with hufUnpackEncTable";Lt(8,Jt,Xt,Tt,Yt);var ln=jt.l+6;if(Jt=jt.c,Xt=jt.lc,mn+ln>At+1)throw"Something wrong with hufUnpackEncTable";for(;ln--;)Vt[mn++]=0;mn--}else if(rn>=59){var ln=rn-59+2;if(mn+ln>At+1)throw"Something wrong with hufUnpackEncTable";for(;ln--;)Vt[mn++]=0;mn--}}kt(Vt)}function Ht(Tt){return Tt&63}function Ct(Tt){return Tt>>6}function Ut(Tt,Dt,Zt,dn){for(;Dt<=Zt;Dt++){var mn=Ct(Tt[Dt]),At=Ht(Tt[Dt]);if(mn>>At)throw"Invalid table entry";if(At>14){var Vt=dn[mn>>At-14];if(Vt.len)throw"Invalid table entry";if(Vt.lit++,Vt.p){var Yt=Vt.p;Vt.p=new Array(Vt.lit);for(var Jt=0;Jt<Vt.lit-1;++Jt)Vt.p[Jt]=Yt[Jt]}else Vt.p=new Array(1);Vt.p[Vt.lit-1]=Dt}else if(At)for(var Xt=0,Jt=1<<14-At;Jt>0;Jt--){var Vt=dn[(mn<<14-At)+Xt];if(Vt.len||Vt.p)throw"Invalid table entry";Vt.len=At,Vt.lit=Dt,Xt++}}return!0}const Gt={c:0,lc:0};function Pt(Tt,Dt,Zt,dn){Tt=Tt<<8|Xn(Zt,dn),Dt+=8,Gt.c=Tt,Gt.lc=Dt}const Wt={c:0,lc:0};function sn(Tt,Dt,Zt,dn,mn,At,Vt,Yt,Jt,Xt){if(Tt==Dt){dn<8&&(Pt(Zt,dn,mn,Vt),Zt=Gt.c,dn=Gt.lc),dn-=8;var rn=Zt>>dn,rn=new Uint8Array([rn])[0];if(Jt.value+rn>Xt)return!1;for(var ln=Yt[Jt.value-1];rn-- >0;)Yt[Jt.value++]=ln}else if(Jt.value<Xt)Yt[Jt.value++]=Tt;else return!1;Wt.c=Zt,Wt.lc=dn}function Bt(Tt){return Tt&65535}function tn(Tt){var Dt=Bt(Tt);return Dt>32767?Dt-65536:Dt}const cn={a:0,b:0};function vn(Tt,Dt){var Zt=tn(Tt),dn=tn(Dt),mn=dn,At=Zt+(mn&1)+(mn>>1),Vt=At,Yt=At-mn;cn.a=Vt,cn.b=Yt}function On(Tt,Dt){var Zt=Bt(Tt),dn=Bt(Dt),mn=Zt-(dn>>1)&65535,At=dn+mn-32768&65535;cn.a=At,cn.b=mn}function rr(Tt,Dt,Zt,dn,mn,At,Vt){for(var Yt=Vt<16384,Jt=Zt>mn?mn:Zt,Xt=1,rn;Xt<=Jt;)Xt<<=1;for(Xt>>=1,rn=Xt,Xt>>=1;Xt>=1;){for(var ln=0,Pn=ln+At*(mn-rn),Sn=At*Xt,Rn=At*rn,Ln=dn*Xt,An=dn*rn,Zn,nr,Yn,ar;ln<=Pn;ln+=Rn){for(var qn=ln,Dn=ln+dn*(Zt-rn);qn<=Dn;qn+=An){var hr=qn+Ln,lr=qn+Sn,Pr=lr+Ln;Yt?(vn(Tt[qn+Dt],Tt[lr+Dt]),Zn=cn.a,Yn=cn.b,vn(Tt[hr+Dt],Tt[Pr+Dt]),nr=cn.a,ar=cn.b,vn(Zn,nr),Tt[qn+Dt]=cn.a,Tt[hr+Dt]=cn.b,vn(Yn,ar),Tt[lr+Dt]=cn.a,Tt[Pr+Dt]=cn.b):(On(Tt[qn+Dt],Tt[lr+Dt]),Zn=cn.a,Yn=cn.b,On(Tt[hr+Dt],Tt[Pr+Dt]),nr=cn.a,ar=cn.b,On(Zn,nr),Tt[qn+Dt]=cn.a,Tt[hr+Dt]=cn.b,On(Yn,ar),Tt[lr+Dt]=cn.a,Tt[Pr+Dt]=cn.b)}if(Zt&Xt){var lr=qn+Sn;Yt?vn(Tt[qn+Dt],Tt[lr+Dt]):On(Tt[qn+Dt],Tt[lr+Dt]),Zn=cn.a,Tt[lr+Dt]=cn.b,Tt[qn+Dt]=Zn}}if(mn&Xt)for(var qn=ln,Dn=ln+dn*(Zt-rn);qn<=Dn;qn+=An){var hr=qn+Ln;Yt?vn(Tt[qn+Dt],Tt[hr+Dt]):On(Tt[qn+Dt],Tt[hr+Dt]),Zn=cn.a,Tt[hr+Dt]=cn.b,Tt[qn+Dt]=Zn}rn=Xt,Xt>>=1}return ln}function Wn(Tt,Dt,Zt,dn,mn,At,Vt,Yt,Jt,Xt){for(var rn=0,ln=0,Pn=Yt,Sn=Math.trunc(mn.value+(At+7)/8);mn.value<Sn;)for(Pt(rn,ln,Zt,mn),rn=Gt.c,ln=Gt.lc;ln>=14;){var Rn=rn>>ln-14&16383,Ln=Dt[Rn];if(Ln.len)ln-=Ln.len,sn(Ln.lit,Vt,rn,ln,Zt,dn,mn,Jt,Xt,Pn),rn=Wt.c,ln=Wt.lc;else{if(!Ln.p)throw"hufDecode issues";var An;for(An=0;An<Ln.lit;An++){for(var Zn=Ht(Tt[Ln.p[An]]);ln<Zn&&mn.value<Sn;)Pt(rn,ln,Zt,mn),rn=Gt.c,ln=Gt.lc;if(ln>=Zn&&Ct(Tt[Ln.p[An]])==(rn>>ln-Zn&(1<<Zn)-1)){ln-=Zn,sn(Ln.p[An],Vt,rn,ln,Zt,dn,mn,Jt,Xt,Pn),rn=Wt.c,ln=Wt.lc;break}}if(An==Ln.lit)throw"hufDecode issues"}}var nr=8-At&7;for(rn>>=nr,ln-=nr;ln>0;){var Ln=Dt[rn<<14-ln&16383];if(Ln.len)ln-=Ln.len,sn(Ln.lit,Vt,rn,ln,Zt,dn,mn,Jt,Xt,Pn),rn=Wt.c,ln=Wt.lc;else throw"hufDecode issues"}return!0}function Bn(Tt,Dt,Zt,dn,mn,At){var Vt={value:0},Yt=Zt.value,Jt=er(Dt,Zt),Xt=er(Dt,Zt);Zt.value+=4;var rn=er(Dt,Zt);if(Zt.value+=4,Jt<0||Jt>=65537||Xt<0||Xt>=65537)throw"Something wrong with HUF_ENCSIZE";var ln=new Array(65537),Pn=new Array(16384);Mt(Pn);var Sn=dn-(Zt.value-Yt);if(Ot(Tt,Dt,Zt,Sn,Jt,Xt,ln),rn>8*(dn-(Zt.value-Yt)))throw"Something wrong with hufUncompress";Ut(ln,Jt,Xt,Pn),Wn(ln,Pn,Tt,Dt,Zt,rn,Xt,At,mn,Vt)}function gn(Tt,Dt,Zt){for(var dn=0;dn<Zt;++dn)Dt[dn]=Tt[Dt[dn]]}function bn(Tt){for(var Dt=1;Dt<Tt.length;Dt++){var Zt=Tt[Dt-1]+Tt[Dt]-128;Tt[Dt]=Zt}}function Kt(Tt,Dt){for(var Zt=0,dn=Math.floor((Tt.length+1)/2),mn=0,At=Tt.length-1;!(mn>At||(Dt[mn++]=Tt[Zt++],mn>At));)Dt[mn++]=Tt[dn++]}function Jn(Tt){for(var Dt=Tt.byteLength,Zt=new Array,dn=0,mn=new DataView(Tt);Dt>0;){var At=mn.getInt8(dn++);if(At<0){var Vt=-At;Dt-=Vt+1;for(var Yt=0;Yt<Vt;Yt++)Zt.push(mn.getUint8(dn++))}else{var Vt=At;Dt-=2;for(var Jt=mn.getUint8(dn++),Yt=0;Yt<Vt+1;Yt++)Zt.push(Jt)}}return Zt}function Cn(Tt,Dt,Zt,dn,mn,At){var hr=new DataView(At.buffer),Vt=Zt[Tt.idx[0]].width,Yt=Zt[Tt.idx[0]].height,Jt=3,Xt=Math.floor(Vt/8),rn=Math.ceil(Vt/8),ln=Math.ceil(Yt/8),Pn=Vt-(rn-1)*8,Sn=Yt-(ln-1)*8,Rn={value:0},Ln=new Array(Jt),An=new Array(Jt),Zn=new Array(Jt),nr=new Array(Jt),Yn=new Array(Jt);for(let Rr=0;Rr<Jt;++Rr)Yn[Rr]=Dt[Tt.idx[Rr]],Ln[Rr]=Rr<1?0:Ln[Rr-1]+rn*ln,An[Rr]=new Float32Array(64),Zn[Rr]=new Uint16Array(64),nr[Rr]=new Uint16Array(rn*64);for(let Rr=0;Rr<ln;++Rr){var ar=8;Rr==ln-1&&(ar=Sn);var qn=8;for(let vr=0;vr<rn;++vr){vr==rn-1&&(qn=Pn);for(let br=0;br<Jt;++br)Zn[br].fill(0),Zn[br][0]=mn[Ln[br]++],kn(Rn,dn,Zn[br]),Nn(Zn[br],An[br]),ir(An[br]);Un(An);for(let br=0;br<Jt;++br)zt(An[br],nr[br],vr*64)}let pr=0;for(let vr=0;vr<Jt;++vr){const br=Zt[Tt.idx[vr]].type;for(let wr=8*Rr;wr<8*Rr+ar;++wr){pr=Yn[vr][wr];for(let Xr=0;Xr<Xt;++Xr){const Dr=Xr*64+(wr&7)*8;hr.setUint16(pr+0*2*br,nr[vr][Dr+0],!0),hr.setUint16(pr+1*2*br,nr[vr][Dr+1],!0),hr.setUint16(pr+2*2*br,nr[vr][Dr+2],!0),hr.setUint16(pr+3*2*br,nr[vr][Dr+3],!0),hr.setUint16(pr+4*2*br,nr[vr][Dr+4],!0),hr.setUint16(pr+5*2*br,nr[vr][Dr+5],!0),hr.setUint16(pr+6*2*br,nr[vr][Dr+6],!0),hr.setUint16(pr+7*2*br,nr[vr][Dr+7],!0),pr+=8*2*br}}if(Xt!=rn)for(let wr=8*Rr;wr<8*Rr+ar;++wr){const Xr=Yn[vr][wr]+8*Xt*2*br,Dr=Xt*64+(wr&7)*8;for(let hs=0;hs<qn;++hs)hr.setUint16(Xr+hs*2*br,nr[vr][Dr+hs],!0)}}}for(var Dn=new Uint16Array(Vt),hr=new DataView(At.buffer),lr=0;lr<Jt;++lr){Zt[Tt.idx[lr]].decoded=!0;var Pr=Zt[Tt.idx[lr]].type;if(Zt[lr].type==2)for(var Lr=0;Lr<Yt;++Lr){const Rr=Yn[lr][Lr];for(var jr=0;jr<Vt;++jr)Dn[jr]=hr.getUint16(Rr+jr*2*Pr,!0);for(var jr=0;jr<Vt;++jr)hr.setFloat32(Rr+jr*2*Pr,an(Dn[jr]),!0)}}}function kn(Tt,Dt,Zt){for(var dn,mn=1;mn<64;)dn=Dt[Tt.value],dn==65280?mn=64:dn>>8==255?mn+=dn&255:(Zt[mn]=dn,mn++),Tt.value++}function Nn(Tt,Dt){Dt[0]=an(Tt[0]),Dt[1]=an(Tt[1]),Dt[2]=an(Tt[5]),Dt[3]=an(Tt[6]),Dt[4]=an(Tt[14]),Dt[5]=an(Tt[15]),Dt[6]=an(Tt[27]),Dt[7]=an(Tt[28]),Dt[8]=an(Tt[2]),Dt[9]=an(Tt[4]),Dt[10]=an(Tt[7]),Dt[11]=an(Tt[13]),Dt[12]=an(Tt[16]),Dt[13]=an(Tt[26]),Dt[14]=an(Tt[29]),Dt[15]=an(Tt[42]),Dt[16]=an(Tt[3]),Dt[17]=an(Tt[8]),Dt[18]=an(Tt[12]),Dt[19]=an(Tt[17]),Dt[20]=an(Tt[25]),Dt[21]=an(Tt[30]),Dt[22]=an(Tt[41]),Dt[23]=an(Tt[43]),Dt[24]=an(Tt[9]),Dt[25]=an(Tt[11]),Dt[26]=an(Tt[18]),Dt[27]=an(Tt[24]),Dt[28]=an(Tt[31]),Dt[29]=an(Tt[40]),Dt[30]=an(Tt[44]),Dt[31]=an(Tt[53]),Dt[32]=an(Tt[10]),Dt[33]=an(Tt[19]),Dt[34]=an(Tt[23]),Dt[35]=an(Tt[32]),Dt[36]=an(Tt[39]),Dt[37]=an(Tt[45]),Dt[38]=an(Tt[52]),Dt[39]=an(Tt[54]),Dt[40]=an(Tt[20]),Dt[41]=an(Tt[22]),Dt[42]=an(Tt[33]),Dt[43]=an(Tt[38]),Dt[44]=an(Tt[46]),Dt[45]=an(Tt[51]),Dt[46]=an(Tt[55]),Dt[47]=an(Tt[60]),Dt[48]=an(Tt[21]),Dt[49]=an(Tt[34]),Dt[50]=an(Tt[37]),Dt[51]=an(Tt[47]),Dt[52]=an(Tt[50]),Dt[53]=an(Tt[56]),Dt[54]=an(Tt[59]),Dt[55]=an(Tt[61]),Dt[56]=an(Tt[35]),Dt[57]=an(Tt[36]),Dt[58]=an(Tt[48]),Dt[59]=an(Tt[49]),Dt[60]=an(Tt[57]),Dt[61]=an(Tt[58]),Dt[62]=an(Tt[62]),Dt[63]=an(Tt[63])}function ir(Tt){const Dt=.5*Math.cos(.7853975),Zt=.5*Math.cos(3.14159/16),dn=.5*Math.cos(3.14159/8),mn=.5*Math.cos(3*3.14159/16),At=.5*Math.cos(5*3.14159/16),Vt=.5*Math.cos(3*3.14159/8),Yt=.5*Math.cos(7*3.14159/16);for(var Jt=new Array(4),Xt=new Array(4),rn=new Array(4),ln=new Array(4),Pn=0;Pn<8;++Pn){var Sn=Pn*8;Jt[0]=dn*Tt[Sn+2],Jt[1]=Vt*Tt[Sn+2],Jt[2]=dn*Tt[Sn+6],Jt[3]=Vt*Tt[Sn+6],Xt[0]=Zt*Tt[Sn+1]+mn*Tt[Sn+3]+At*Tt[Sn+5]+Yt*Tt[Sn+7],Xt[1]=mn*Tt[Sn+1]-Yt*Tt[Sn+3]-Zt*Tt[Sn+5]-At*Tt[Sn+7],Xt[2]=At*Tt[Sn+1]-Zt*Tt[Sn+3]+Yt*Tt[Sn+5]+mn*Tt[Sn+7],Xt[3]=Yt*Tt[Sn+1]-At*Tt[Sn+3]+mn*Tt[Sn+5]-Zt*Tt[Sn+7],rn[0]=Dt*(Tt[Sn+0]+Tt[Sn+4]),rn[3]=Dt*(Tt[Sn+0]-Tt[Sn+4]),rn[1]=Jt[0]+Jt[3],rn[2]=Jt[1]-Jt[2],ln[0]=rn[0]+rn[1],ln[1]=rn[3]+rn[2],ln[2]=rn[3]-rn[2],ln[3]=rn[0]-rn[1],Tt[Sn+0]=ln[0]+Xt[0],Tt[Sn+1]=ln[1]+Xt[1],Tt[Sn+2]=ln[2]+Xt[2],Tt[Sn+3]=ln[3]+Xt[3],Tt[Sn+4]=ln[3]-Xt[3],Tt[Sn+5]=ln[2]-Xt[2],Tt[Sn+6]=ln[1]-Xt[1],Tt[Sn+7]=ln[0]-Xt[0]}for(var Rn=0;Rn<8;++Rn)Jt[0]=dn*Tt[16+Rn],Jt[1]=Vt*Tt[16+Rn],Jt[2]=dn*Tt[48+Rn],Jt[3]=Vt*Tt[48+Rn],Xt[0]=Zt*Tt[8+Rn]+mn*Tt[24+Rn]+At*Tt[40+Rn]+Yt*Tt[56+Rn],Xt[1]=mn*Tt[8+Rn]-Yt*Tt[24+Rn]-Zt*Tt[40+Rn]-At*Tt[56+Rn],Xt[2]=At*Tt[8+Rn]-Zt*Tt[24+Rn]+Yt*Tt[40+Rn]+mn*Tt[56+Rn],Xt[3]=Yt*Tt[8+Rn]-At*Tt[24+Rn]+mn*Tt[40+Rn]-Zt*Tt[56+Rn],rn[0]=Dt*(Tt[Rn]+Tt[32+Rn]),rn[3]=Dt*(Tt[Rn]-Tt[32+Rn]),rn[1]=Jt[0]+Jt[3],rn[2]=Jt[1]-Jt[2],ln[0]=rn[0]+rn[1],ln[1]=rn[3]+rn[2],ln[2]=rn[3]-rn[2],ln[3]=rn[0]-rn[1],Tt[0+Rn]=ln[0]+Xt[0],Tt[8+Rn]=ln[1]+Xt[1],Tt[16+Rn]=ln[2]+Xt[2],Tt[24+Rn]=ln[3]+Xt[3],Tt[32+Rn]=ln[3]-Xt[3],Tt[40+Rn]=ln[2]-Xt[2],Tt[48+Rn]=ln[1]-Xt[1],Tt[56+Rn]=ln[0]-Xt[0]}function Un(Tt){for(var Dt=0;Dt<64;++Dt){var Zt=Tt[0][Dt],dn=Tt[1][Dt],mn=Tt[2][Dt];Tt[0][Dt]=Zt+1.5747*mn,Tt[1][Dt]=Zt-.1873*dn-.4682*mn,Tt[2][Dt]=Zt+1.8556*dn}}function zt(Tt,Dt,Zt){for(var dn=0;dn<64;++dn)Dt[Zt+dn]=DataUtils.toHalfFloat(It(Tt[dn]))}function It(Tt){return Tt<=1?Math.sign(Tt)*Math.pow(Math.abs(Tt),2.2):Math.sign(Tt)*Math.pow(_t,Math.abs(Tt)-1)}function on(Tt){return new DataView(Tt.array.buffer,Tt.offset.value,Tt.size)}function xn(Tt){var Dt=Tt.viewer.buffer.slice(Tt.offset.value,Tt.offset.value+Tt.size),Zt=new Uint8Array(Jn(Dt)),dn=new Uint8Array(Zt.length);return bn(Zt),Kt(Zt,dn),new DataView(dn.buffer)}function wn(Tt){var Dt=Tt.array.slice(Tt.offset.value,Tt.offset.value+Tt.size),Zt=unzlibSync(Dt),dn=new Uint8Array(Zt.length);return bn(Zt),Kt(Zt,dn),new DataView(dn.buffer)}function En(Tt){for(var Dt=Tt.viewer,Zt={value:Tt.offset.value},dn=new Uint16Array(Tt.width*Tt.scanlineBlockSize*(Tt.channels*Tt.type)),mn=new Uint8Array(8192),At=0,Vt=new Array(Tt.channels),Yt=0;Yt<Tt.channels;Yt++)Vt[Yt]={},Vt[Yt].start=At,Vt[Yt].end=Vt[Yt].start,Vt[Yt].nx=Tt.width,Vt[Yt].ny=Tt.lines,Vt[Yt].size=Tt.type,At+=Vt[Yt].nx*Vt[Yt].ny*Vt[Yt].size;var Jt=hn(Dt,Zt),Xt=hn(Dt,Zt);if(Xt>=8192)throw"Something is wrong with PIZ_COMPRESSION BITMAP_SIZE";if(Jt<=Xt)for(var Yt=0;Yt<Xt-Jt+1;Yt++)mn[Yt+Jt]=qt(Dt,Zt);var rn=new Uint16Array(65536),ln=vt(mn,rn),Pn=er(Dt,Zt);Bn(Tt.array,Dt,Zt,Pn,dn,At);for(var Yt=0;Yt<Tt.channels;++Yt)for(var Sn=Vt[Yt],Rn=0;Rn<Vt[Yt].size;++Rn)rr(dn,Sn.start+Rn,Sn.nx,Sn.size,Sn.ny,Sn.nx*Sn.size,ln);gn(rn,dn,At);for(var Ln=0,An=new Uint8Array(dn.buffer.byteLength),Zn=0;Zn<Tt.lines;Zn++)for(var nr=0;nr<Tt.channels;nr++){var Sn=Vt[nr],Yn=Sn.nx*Sn.size,ar=new Uint8Array(dn.buffer,Sn.end*2,Yn*2);An.set(ar,Ln),Ln+=Yn*2,Sn.end+=Yn}return new DataView(An.buffer)}function Hn(Tt){var Dt=Tt.array.slice(Tt.offset.value,Tt.offset.value+Tt.size),Zt=unzlibSync(Dt);const dn=Tt.lines*Tt.channels*Tt.width,mn=Tt.type==1?new Uint16Array(dn):new Uint32Array(dn);let At=0,Vt=0;const Yt=new Array(4);for(let Jt=0;Jt<Tt.lines;Jt++)for(let Xt=0;Xt<Tt.channels;Xt++){let rn=0;switch(Tt.type){case 1:Yt[0]=At,Yt[1]=Yt[0]+Tt.width,At=Yt[1]+Tt.width;for(let ln=0;ln<Tt.width;++ln){const Pn=Zt[Yt[0]++]<<8|Zt[Yt[1]++];rn+=Pn,mn[Vt]=rn,Vt++}break;case 2:Yt[0]=At,Yt[1]=Yt[0]+Tt.width,Yt[2]=Yt[1]+Tt.width,At=Yt[2]+Tt.width;for(let ln=0;ln<Tt.width;++ln){const Pn=Zt[Yt[0]++]<<24|Zt[Yt[1]++]<<16|Zt[Yt[2]++]<<8;rn+=Pn,mn[Vt]=rn,Vt++}break}}return new DataView(mn.buffer)}function Fn(Tt){var Dt=Tt.viewer,Zt={value:Tt.offset.value},dn=new Uint8Array(Tt.width*Tt.lines*(Tt.channels*Tt.type*2)),mn={version:fn(Dt,Zt),unknownUncompressedSize:fn(Dt,Zt),unknownCompressedSize:fn(Dt,Zt),acCompressedSize:fn(Dt,Zt),dcCompressedSize:fn(Dt,Zt),rleCompressedSize:fn(Dt,Zt),rleUncompressedSize:fn(Dt,Zt),rleRawSize:fn(Dt,Zt),totalAcUncompressedCount:fn(Dt,Zt),totalDcUncompressedCount:fn(Dt,Zt),acCompression:fn(Dt,Zt)};if(mn.version<2)throw"EXRLoader.parse: "+ls.compression+" version "+mn.version+" is unsupported";for(var At=new Array,Vt=hn(Dt,Zt)-2;Vt>0;){var Yt=zn(Dt.buffer,Zt),Jt=qt(Dt,Zt),Xt=Jt>>2&3,rn=(Jt>>4)-1,ln=new Int8Array([rn])[0],Pn=qt(Dt,Zt);At.push({name:Yt,index:ln,type:Pn,compression:Xt}),Vt-=Yt.length+3}for(var Sn=ls.channels,Rn=new Array(Tt.channels),Ln=0;Ln<Tt.channels;++Ln){var An=Rn[Ln]={},Zn=Sn[Ln];An.name=Zn.name,An.compression=0,An.decoded=!1,An.type=Zn.pixelType,An.pLinear=Zn.pLinear,An.width=Tt.width,An.height=Tt.lines}for(var nr={idx:new Array(3)},Yn=0;Yn<Tt.channels;++Yn)for(var An=Rn[Yn],Ln=0;Ln<At.length;++Ln){var ar=At[Ln];An.name==ar.name&&(An.compression=ar.compression,ar.index>=0&&(nr.idx[ar.index]=Yn),An.offset=Yn)}if(mn.acCompressedSize>0)switch(mn.acCompression){case 0:var hr=new Uint16Array(mn.totalAcUncompressedCount);Bn(Tt.array,Dt,Zt,mn.acCompressedSize,hr,mn.totalAcUncompressedCount);break;case 1:var qn=Tt.array.slice(Zt.value,Zt.value+mn.totalAcUncompressedCount),Dn=unzlibSync(qn),hr=new Uint16Array(Dn.buffer);Zt.value+=mn.totalAcUncompressedCount;break}if(mn.dcCompressedSize>0){var lr={array:Tt.array,offset:Zt,size:mn.dcCompressedSize},Pr=new Uint16Array(wn(lr).buffer);Zt.value+=mn.dcCompressedSize}if(mn.rleRawSize>0){var qn=Tt.array.slice(Zt.value,Zt.value+mn.rleCompressedSize),Dn=unzlibSync(qn),Lr=Jn(Dn.buffer);Zt.value+=mn.rleCompressedSize}for(var jr=0,Rr=new Array(Rn.length),Ln=0;Ln<Rr.length;++Ln)Rr[Ln]=new Array;for(var pr=0;pr<Tt.lines;++pr)for(var vr=0;vr<Rn.length;++vr)Rr[vr].push(jr),jr+=Rn[vr].width*Tt.type*2;Cn(nr,Rr,Rn,hr,Pr,dn);for(var Ln=0;Ln<Rn.length;++Ln){var An=Rn[Ln];if(!An.decoded)switch(An.compression){case 2:for(var br=0,wr=0,pr=0;pr<Tt.lines;++pr){for(var Xr=Rr[Ln][br],Dr=0;Dr<An.width;++Dr){for(var hs=0;hs<2*An.type;++hs)dn[Xr++]=Lr[wr+hs*An.width*An.height];wr++}br++}break;case 1:default:throw"EXRLoader.parse: unsupported channel compression"}}return new DataView(dn.buffer)}function zn(Tt,Dt){for(var Zt=new Uint8Array(Tt),dn=0;Zt[Dt.value+dn]!=0;)dn+=1;var mn=new TextDecoder().decode(Zt.slice(Dt.value,Dt.value+dn));return Dt.value=Dt.value+dn+1,mn}function xr(Tt,Dt,Zt){var dn=new TextDecoder().decode(new Uint8Array(Tt).slice(Dt.value,Dt.value+Zt));return Dt.value=Dt.value+Zt,dn}function Tn(Tt,Dt){var Zt=sr(Tt,Dt),dn=er(Tt,Dt);return[Zt,dn]}function Qn(Tt,Dt){var Zt=er(Tt,Dt),dn=er(Tt,Dt);return[Zt,dn]}function sr(Tt,Dt){var Zt=Tt.getInt32(Dt.value,!0);return Dt.value=Dt.value+4,Zt}function er(Tt,Dt){var Zt=Tt.getUint32(Dt.value,!0);return Dt.value=Dt.value+4,Zt}function Xn(Tt,Dt){var Zt=Tt[Dt.value];return Dt.value=Dt.value+1,Zt}function qt(Tt,Dt){var Zt=Tt.getUint8(Dt.value);return Dt.value=Dt.value+1,Zt}const fn=function(Tt,Dt){let Zt;return"getBigInt64"in DataView.prototype?Zt=Number(Tt.getBigInt64(Dt.value,!0)):Zt=Tt.getUint32(Dt.value+4,!0)+Number(Tt.getUint32(Dt.value,!0)<<32),Dt.value+=8,Zt};function jn(Tt,Dt){var Zt=Tt.getFloat32(Dt.value,!0);return Dt.value+=4,Zt}function Qt(Tt,Dt){return DataUtils.toHalfFloat(jn(Tt,Dt))}function an(Tt){var Dt=(Tt&31744)>>10,Zt=Tt&1023;return(Tt>>15?-1:1)*(Dt?Dt===31?Zt?NaN:1/0:Math.pow(2,Dt-15)*(1+Zt/1024):6103515625e-14*(Zt/1024))}function hn(Tt,Dt){var Zt=Tt.getUint16(Dt.value,!0);return Dt.value+=2,Zt}function _n(Tt,Dt){return an(hn(Tt,Dt))}function Vn(Tt,Dt,Zt,dn){for(var mn=Zt.value,At=[];Zt.value<mn+dn-1;){var Vt=zn(Dt,Zt),Yt=sr(Tt,Zt),Jt=qt(Tt,Zt);Zt.value+=3;var Xt=sr(Tt,Zt),rn=sr(Tt,Zt);At.push({name:Vt,pixelType:Yt,pLinear:Jt,xSampling:Xt,ySampling:rn})}return Zt.value+=1,At}function Gn(Tt,Dt){var Zt=jn(Tt,Dt),dn=jn(Tt,Dt),mn=jn(Tt,Dt),At=jn(Tt,Dt),Vt=jn(Tt,Dt),Yt=jn(Tt,Dt),Jt=jn(Tt,Dt),Xt=jn(Tt,Dt);return{redX:Zt,redY:dn,greenX:mn,greenY:At,blueX:Vt,blueY:Yt,whiteX:Jt,whiteY:Xt}}function ur(Tt,Dt){var Zt=["NO_COMPRESSION","RLE_COMPRESSION","ZIPS_COMPRESSION","ZIP_COMPRESSION","PIZ_COMPRESSION","PXR24_COMPRESSION","B44_COMPRESSION","B44A_COMPRESSION","DWAA_COMPRESSION","DWAB_COMPRESSION"],dn=qt(Tt,Dt);return Zt[dn]}function Mr(Tt,Dt){var Zt=er(Tt,Dt),dn=er(Tt,Dt),mn=er(Tt,Dt),At=er(Tt,Dt);return{xMin:Zt,yMin:dn,xMax:mn,yMax:At}}function Ir(Tt,Dt){var Zt=["INCREASING_Y"],dn=qt(Tt,Dt);return Zt[dn]}function yr(Tt,Dt){var Zt=jn(Tt,Dt),dn=jn(Tt,Dt);return[Zt,dn]}function Or(Tt,Dt){var Zt=jn(Tt,Dt),dn=jn(Tt,Dt),mn=jn(Tt,Dt);return[Zt,dn,mn]}function Wr(Tt,Dt,Zt,dn,mn){if(dn==="string"||dn==="stringvector"||dn==="iccProfile")return xr(Dt,Zt,mn);if(dn==="chlist")return Vn(Tt,Dt,Zt,mn);if(dn==="chromaticities")return Gn(Tt,Zt);if(dn==="compression")return ur(Tt,Zt);if(dn==="box2i")return Mr(Tt,Zt);if(dn==="lineOrder")return Ir(Tt,Zt);if(dn==="float")return jn(Tt,Zt);if(dn==="v2f")return yr(Tt,Zt);if(dn==="v3f")return Or(Tt,Zt);if(dn==="int")return sr(Tt,Zt);if(dn==="rational")return Tn(Tt,Zt);if(dn==="timecode")return Qn(Tt,Zt);if(dn==="preview")return Zt.value+=mn,"skipped";Zt.value+=mn}function Mo(Tt,Dt,Zt){const dn={};if(Tt.getUint32(0,!0)!=20000630)throw"THREE.EXRLoader: provided file doesn't appear to be in OpenEXR format.";dn.version=Tt.getUint8(4);const mn=Tt.getUint8(5);dn.spec={singleTile:!!(mn&2),longName:!!(mn&4),deepFormat:!!(mn&8),multiPart:!!(mn&16)},Zt.value=8;for(var At=!0;At;){var Vt=zn(Dt,Zt);if(Vt==0)At=!1;else{var Yt=zn(Dt,Zt),Jt=er(Tt,Zt),Xt=Wr(Tt,Dt,Zt,Yt,Jt);Xt===void 0?console.warn(`EXRLoader.parse: skipped unknown header attribute type '${Yt}'.`):dn[Vt]=Xt}}if(mn&-5)throw console.error("EXRHeader:",dn),"THREE.EXRLoader: provided file is currently unsupported.";return dn}function Ro(Tt,Dt,Zt,dn,mn){const At={size:0,viewer:Dt,array:Zt,offset:dn,width:Tt.dataWindow.xMax-Tt.dataWindow.xMin+1,height:Tt.dataWindow.yMax-Tt.dataWindow.yMin+1,channels:Tt.channels.length,bytesPerLine:null,lines:null,inputSize:null,type:Tt.channels[0].pixelType,uncompress:null,getter:null,format:null,[hasColorSpace?"colorSpace":"encoding"]:null};switch(Tt.compression){case"NO_COMPRESSION":At.lines=1,At.uncompress=on;break;case"RLE_COMPRESSION":At.lines=1,At.uncompress=xn;break;case"ZIPS_COMPRESSION":At.lines=1,At.uncompress=wn;break;case"ZIP_COMPRESSION":At.lines=16,At.uncompress=wn;break;case"PIZ_COMPRESSION":At.lines=32,At.uncompress=En;break;case"PXR24_COMPRESSION":At.lines=16,At.uncompress=Hn;break;case"DWAA_COMPRESSION":At.lines=32,At.uncompress=Fn;break;case"DWAB_COMPRESSION":At.lines=256,At.uncompress=Fn;break;default:throw"EXRLoader.parse: "+Tt.compression+" is unsupported"}if(At.scanlineBlockSize=At.lines,At.type==1)switch(mn){case FloatType:At.getter=_n,At.inputSize=2;break;case HalfFloatType:At.getter=hn,At.inputSize=2;break}else if(At.type==2)switch(mn){case FloatType:At.getter=jn,At.inputSize=4;break;case HalfFloatType:At.getter=Qt,At.inputSize=4}else throw"EXRLoader.parse: unsupported pixelType "+At.type+" for "+Tt.compression+".";At.blockCount=(Tt.dataWindow.yMax+1)/At.scanlineBlockSize;for(var Vt=0;Vt<At.blockCount;Vt++)fn(Dt,dn);At.outputChannels=At.channels==3?4:At.channels;const Yt=At.width*At.height*At.outputChannels;switch(mn){case FloatType:At.byteArray=new Float32Array(Yt),At.channels<At.outputChannels&&At.byteArray.fill(1,0,Yt);break;case HalfFloatType:At.byteArray=new Uint16Array(Yt),At.channels<At.outputChannels&&At.byteArray.fill(15360,0,Yt);break;default:console.error("THREE.EXRLoader: unsupported type: ",mn);break}return At.bytesPerLine=At.width*At.inputSize*At.channels,At.outputChannels==4?At.format=RGBAFormat:At.format=RedFormat,hasColorSpace?At.colorSpace="srgb-linear":At.encoding=3e3,At}const rs=new DataView(e),Gs=new Uint8Array(e),js={value:0},ls=Mo(rs,e,js),gr=Ro(ls,rs,Gs,js,this.type),uo={value:0},Ys={R:0,G:1,B:2,A:3,Y:0};for(let Tt=0;Tt<gr.height/gr.scanlineBlockSize;Tt++){const Dt=er(rs,js);gr.size=er(rs,js),gr.lines=Dt+gr.scanlineBlockSize>gr.height?gr.height-Dt:gr.scanlineBlockSize;const dn=gr.size<gr.lines*gr.bytesPerLine?gr.uncompress(gr):on(gr);js.value+=gr.size;for(let mn=0;mn<gr.scanlineBlockSize;mn++){const At=mn+Tt*gr.scanlineBlockSize;if(At>=gr.height)break;for(let Vt=0;Vt<gr.channels;Vt++){const Yt=Ys[ls.channels[Vt].name];for(let Jt=0;Jt<gr.width;Jt++){uo.value=(mn*(gr.channels*gr.width)+Vt*gr.width+Jt)*gr.inputSize;const Xt=(gr.height-1-At)*(gr.width*gr.outputChannels)+Jt*gr.outputChannels+Yt;gr.byteArray[Xt]=gr.getter(dn,uo)}}}}return{header:ls,width:gr.width,height:gr.height,data:gr.byteArray,format:gr.format,[hasColorSpace?"colorSpace":"encoding"]:gr[hasColorSpace?"colorSpace":"encoding"],type:this.type}}setDataType(e){return this.type=e,this}load(e,s,a,c){function d(b,_e){hasColorSpace?b.colorSpace=_e.colorSpace:b.encoding=_e.encoding,b.minFilter=LinearFilter,b.magFilter=LinearFilter,b.generateMipmaps=!1,b.flipY=!1,s&&s(b,_e)}return super.load(e,d,a,c)}}const _taskCache=new WeakMap;class DRACOLoader extends Loader{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,s,a,c){const d=new FileLoader(this.manager);d.setPath(this.path),d.setResponseType("arraybuffer"),d.setRequestHeader(this.requestHeader),d.setWithCredentials(this.withCredentials),d.load(e,b=>{const _e={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(b,_e).then(s).catch(c)},a,c)}decodeDracoFile(e,s,a,c){const d={attributeIDs:a||this.defaultAttributeIDs,attributeTypes:c||this.defaultAttributeTypes,useUniqueIDs:!!a};this.decodeGeometry(e,d).then(s)}decodeGeometry(e,s){for(const tt in s.attributeTypes){const nt=s.attributeTypes[tt];nt.BYTES_PER_ELEMENT!==void 0&&(s.attributeTypes[tt]=nt.name)}const a=JSON.stringify(s);if(_taskCache.has(e)){const tt=_taskCache.get(e);if(tt.key===a)return tt.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let c;const d=this.workerNextTaskID++,b=e.byteLength,_e=this._getWorker(d,b).then(tt=>(c=tt,new Promise((nt,it)=>{c._callbacks[d]={resolve:nt,reject:it},c.postMessage({type:"decode",id:d,taskConfig:s,buffer:e},[e])}))).then(tt=>this._createGeometry(tt.geometry));return _e.catch(()=>!0).then(()=>{c&&d&&this._releaseTask(c,d)}),_taskCache.set(e,{key:a,promise:_e}),_e}_createGeometry(e){const s=new BufferGeometry;e.index&&s.setIndex(new BufferAttribute(e.index.array,1));for(let a=0;a<e.attributes.length;a++){const c=e.attributes[a],d=c.name,b=c.array,_e=c.itemSize;s.setAttribute(d,new BufferAttribute(b,_e))}return s}_loadLibrary(e,s){const a=new FileLoader(this.manager);return a.setPath(this.decoderPath),a.setResponseType(s),a.setWithCredentials(this.withCredentials),new Promise((c,d)=>{a.load(e,c,void 0,d)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",s=[];return e?s.push(this._loadLibrary("draco_decoder.js","text")):(s.push(this._loadLibrary("draco_wasm_wrapper.js","text")),s.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(s).then(a=>{const c=a[0];e||(this.decoderConfig.wasmBinary=a[1]);const d=DRACOWorker.toString(),b=["/* draco decoder */",c,"","/* worker */",d.substring(d.indexOf("{")+1,d.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([b]))}),this.decoderPending}_getWorker(e,s){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const c=new Worker(this.workerSourceURL);c._callbacks={},c._taskCosts={},c._taskLoad=0,c.postMessage({type:"init",decoderConfig:this.decoderConfig}),c.onmessage=function(d){const b=d.data;switch(b.type){case"decode":c._callbacks[b.id].resolve(b);break;case"error":c._callbacks[b.id].reject(b);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+b.type+'"')}},this.workerPool.push(c)}else this.workerPool.sort(function(c,d){return c._taskLoad>d._taskLoad?-1:1});const a=this.workerPool[this.workerPool.length-1];return a._taskCosts[e]=s,a._taskLoad+=s,a})}_releaseTask(e,s){e._taskLoad-=e._taskCosts[s],delete e._callbacks[s],delete e._taskCosts[s]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this}}function DRACOWorker(){let o,e;onmessage=function(b){const _e=b.data;switch(_e.type){case"init":o=_e.decoderConfig,e=new Promise(function(it){o.onModuleLoaded=function(ot){it({draco:ot})},DracoDecoderModule(o)});break;case"decode":const tt=_e.buffer,nt=_e.taskConfig;e.then(it=>{const ot=it.draco,at=new ot.Decoder,ct=new ot.DecoderBuffer;ct.Init(new Int8Array(tt),tt.byteLength);try{const ut=s(ot,at,ct,nt),ft=ut.attributes.map(dt=>dt.array.buffer);ut.index&&ft.push(ut.index.array.buffer),self.postMessage({type:"decode",id:_e.id,geometry:ut},ft)}catch(ut){console.error(ut),self.postMessage({type:"error",id:_e.id,error:ut.message})}finally{ot.destroy(ct),ot.destroy(at)}});break}};function s(b,_e,tt,nt){const it=nt.attributeIDs,ot=nt.attributeTypes;let at,ct;const ut=_e.GetEncodedGeometryType(tt);if(ut===b.TRIANGULAR_MESH)at=new b.Mesh,ct=_e.DecodeBufferToMesh(tt,at);else if(ut===b.POINT_CLOUD)at=new b.PointCloud,ct=_e.DecodeBufferToPointCloud(tt,at);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!ct.ok()||at.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+ct.error_msg());const ft={index:null,attributes:[]};for(const dt in it){const lt=self[ot[dt]];let ht,mt;if(nt.useUniqueIDs)mt=it[dt],ht=_e.GetAttributeByUniqueId(at,mt);else{if(mt=_e.GetAttributeId(at,b[it[dt]]),mt===-1)continue;ht=_e.GetAttribute(at,mt)}ft.attributes.push(c(b,_e,at,dt,lt,ht))}return ut===b.TRIANGULAR_MESH&&(ft.index=a(b,_e,at)),b.destroy(at),ft}function a(b,_e,tt){const it=tt.num_faces()*3,ot=it*4,at=b._malloc(ot);_e.GetTrianglesUInt32Array(tt,ot,at);const ct=new Uint32Array(b.HEAPF32.buffer,at,it).slice();return b._free(at),{array:ct,itemSize:1}}function c(b,_e,tt,nt,it,ot){const at=ot.num_components(),ut=tt.num_points()*at,ft=ut*it.BYTES_PER_ELEMENT,dt=d(b,it),lt=b._malloc(ft);_e.GetAttributeDataArrayForAllPoints(tt,ot,dt,ft,lt);const ht=new it(b.HEAPF32.buffer,lt,ut).slice();return b._free(lt),{name:nt,array:ht,itemSize:at}}function d(b,_e){switch(_e){case Float32Array:return b.DT_FLOAT32;case Int8Array:return b.DT_INT8;case Int16Array:return b.DT_INT16;case Int32Array:return b.DT_INT32;case Uint8Array:return b.DT_UINT8;case Uint16Array:return b.DT_UINT16;case Uint32Array:return b.DT_UINT32}}}let generated;const MeshoptDecoder=()=>{if(generated)return generated;const o="B9h9z9tFBBBF8fL9gBB9gLaaaaaFa9gEaaaB9gFaFa9gEaaaFaEMcBFFFGGGEIIILF9wFFFLEFBFKNFaFCx/IFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBF8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBGy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBEn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBIi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBKI9z9iqlBOc+x8ycGBM/qQFTa8jUUUUBCU/EBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAGTkUUUBRNCUoBAG9uC/wgBZHKCUGAKCUG9JyRVAECFJRICBRcGXEXAcAF9PQFAVAFAclAcAVJAF9JyRMGXGXAG9FQBAMCbJHKC9wZRSAKCIrCEJCGrRQANCUGJRfCBRbAIRTEXGXAOATlAQ9PQBCBRISEMATAQJRIGXAS9FQBCBRtCBREEXGXAOAIlCi9PQBCBRISLMANCU/CBJAEJRKGXGXGXGXGXATAECKrJ2BBAtCKZrCEZfIBFGEBMAKhB83EBAKCNJhB83EBSEMAKAI2BIAI2BBHmCKrHYAYCE6HYy86BBAKCFJAICIJAYJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCGJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCEJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCIJAYAmJHY2BBAI2BFHmCKrHPAPCE6HPy86BBAKCLJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCKJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCOJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCNJAYAmJHY2BBAI2BGHmCKrHPAPCE6HPy86BBAKCVJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCcJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCMJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCSJAYAmJHm2BBAI2BEHICKrHYAYCE6HYy86BBAKCQJAmAYJHm2BBAICIrCEZHYAYCE6HYy86BBAKCfJAmAYJHm2BBAICGrCEZHYAYCE6HYy86BBAKCbJAmAYJHK2BBAICEZHIAICE6HIy86BBAKAIJRISGMAKAI2BNAI2BBHmCIrHYAYCb6HYy86BBAKCFJAICNJAYJHY2BBAmCbZHmAmCb6Hmy86BBAKCGJAYAmJHm2BBAI2BFHYCIrHPAPCb6HPy86BBAKCEJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCIJAmAYJHm2BBAI2BGHYCIrHPAPCb6HPy86BBAKCLJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCKJAmAYJHm2BBAI2BEHYCIrHPAPCb6HPy86BBAKCOJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCNJAmAYJHm2BBAI2BIHYCIrHPAPCb6HPy86BBAKCVJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCcJAmAYJHm2BBAI2BLHYCIrHPAPCb6HPy86BBAKCMJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCSJAmAYJHm2BBAI2BKHYCIrHPAPCb6HPy86BBAKCQJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCfJAmAYJHm2BBAI2BOHICIrHYAYCb6HYy86BBAKCbJAmAYJHK2BBAICbZHIAICb6HIy86BBAKAIJRISFMAKAI8pBB83BBAKCNJAICNJ8pBB83BBAICTJRIMAtCGJRtAECTJHEAS9JQBMMGXAIQBCBRISEMGXAM9FQBANAbJ2BBRtCBRKAfREEXAEANCU/CBJAKJ2BBHTCFrCBATCFZl9zAtJHt86BBAEAGJREAKCFJHKAM9HQBMMAfCFJRfAIRTAbCFJHbAG9HQBMMABAcAG9sJANCUGJAMAG9sTkUUUBpANANCUGJAMCaJAG9sJAGTkUUUBpMAMCBAIyAcJRcAIQBMC9+RKSFMCBC99AOAIlAGCAAGCA9Ly6yRKMALCU/EBJ8kUUUUBAKM+OmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUFT+JUUUBpALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM+lLKFaF99GaG99FaG99GXGXAGCI9HQBAF9FQFEXGXGX9DBBB8/9DBBB+/ABCGJHG1BB+yAB1BBHE+yHI+L+TABCFJHL1BBHK+yHO+L+THN9DBBBB9gHVyAN9DBB/+hANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE86BBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG86BBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG86BBABCIJRBAFCaJHFQBSGMMAF9FQBEXGXGX9DBBB8/9DBBB+/ABCIJHG8uFB+yAB8uFBHE+yHI+L+TABCGJHL8uFBHK+yHO+L+THN9DBBBB9gHVyAN9DB/+g6ANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE87FBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG87FBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG87FBABCNJRBAFCaJHFQBMMM/SEIEaE99EaF99GXAF9FQBCBREABRIEXGXGX9D/zI818/AICKJ8uFBHLCEq+y+VHKAI8uFB+y+UHO9DB/+g6+U9DBBB8/9DBBB+/AO9DBBBB9gy+SHN+L9DBBB9P9d9FQBAN+oRVSFMCUUUU94RVMAICIJ8uFBRcAICGJ8uFBRMABALCFJCEZAEqCFWJAV87FBGXGXAKAM+y+UHN9DB/+g6+U9DBBB8/9DBBB+/AN9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRMSFMCUUUU94RMMABALCGJCEZAEqCFWJAM87FBGXGXAKAc+y+UHK9DB/+g6+U9DBBB8/9DBBB+/AK9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRcSFMCUUUU94RcMABALCaJCEZAEqCFWJAc87FBGXGX9DBBU8/AOAO+U+TANAN+U+TAKAK+U+THO9DBBBBAO9DBBBB9gy+R9DB/+g6+U9DBBB8/+SHO+L9DBBB9P9d9FQBAO+oRcSFMCUUUU94RcMABALCEZAEqCFWJAc87FBAICNJRIAECIJREAFCaJHFQBMMM9JBGXAGCGrAF9sHF9FQBEXABAB8oGBHGCNWCN91+yAGCi91CnWCUUU/8EJ+++U84GBABCIJRBAFCaJHFQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEM/lFFFaGXGXAFABqCEZ9FQBABRESFMGXGXAGCT9PQBABRESFMABREEXAEAF8oGBjGBAECIJAFCIJ8oGBjGBAECNJAFCNJ8oGBjGBAECSJAFCSJ8oGBjGBAECTJREAFCTJRFAGC9wJHGCb9LQBMMAGCI9JQBEXAEAF8oGBjGBAFCIJRFAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF2BB86BBAECFJREAFCFJRFAGCaJHGQBMMABMoFFGaGXGXABCEZ9FQBABRESFMAFCgFZC+BwsN9sRIGXGXAGCT9PQBABRESFMABREEXAEAIjGBAECSJAIjGBAECNJAIjGBAECIJAIjGBAECTJREAGC9wJHGCb9LQBMMAGCI9JQBEXAEAIjGBAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF86BBAECFJREAGCaJHGQBMMABMMMFBCUNMIT9kBB",e="B9h9z9tFBBBFiI9gBB9gLaaaaaFa9gEaaaB9gFaFaEMcBBFBFFGGGEILF9wFFFLEFBFKNFaFCx/aFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBG8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBIy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBKi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBOn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBNI9z9iqlBVc+N9IcIBTEM9+FLa8jUUUUBCTlRBCBRFEXCBRGCBREEXABCNJAGJAECUaAFAGrCFZHIy86BBAEAIJREAGCFJHGCN9HQBMAFCx+YUUBJAE86BBAFCEWCxkUUBJAB8pEN83EBAFCFJHFCUG9HQBMMk8lLbaE97F9+FaL978jUUUUBCU/KBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAG/8cBBCUoBAG9uC/wgBZHKCUGAKCUG9JyRNAECFJRKCBRVGXEXAVAF9PQFANAFAVlAVANJAF9JyRcGXGXAG9FQBAcCbJHIC9wZHMCE9sRSAMCFWRQAICIrCEJCGrRfCBRbEXAKRTCBRtGXEXGXAOATlAf9PQBCBRKSLMALCU/CBJAtAM9sJRmATAfJRKCBREGXAMCoB9JQBAOAKlC/gB9JQBCBRIEXAmAIJREGXGXGXGXGXATAICKrJ2BBHYCEZfIBFGEBMAECBDtDMIBSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIBAKCTJRKMGXGXGXGXGXAYCGrCEZfIBFGEBMAECBDtDMITSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMITAKCTJRKMGXGXGXGXGXAYCIrCEZfIBFGEBMAECBDtDMIASEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIAAKCTJRKMGXGXGXGXGXAYCKrfIBFGEBMAECBDtDMI8wSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCIJAeDeBJAYCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCNJAeDeBJAYCx+YUUBJ2BBJRKSFMAEAKDBBBDMI8wAKCTJRKMAICoBJREAICUFJAM9LQFAERIAOAKlC/fB9LQBMMGXAEAM9PQBAECErRIEXGXAOAKlCi9PQBCBRKSOMAmAEJRYGXGXGXGXGXATAECKrJ2BBAICKZrCEZfIBFGEBMAYCBDtDMIBSEMAYAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAYAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAYAKDBBBDMIBAKCTJRKMAICGJRIAECTJHEAM9JQBMMGXAK9FQBAKRTAtCFJHtCI6QGSFMMCBRKSEMGXAM9FQBALCUGJAbJREALAbJDBGBReCBRYEXAEALCU/CBJAYJHIDBIBHdCFD9tAdCFDbHPD9OD9hD9RHdAIAMJDBIBH8ZCFD9tA8ZAPD9OD9hD9RH8ZDQBTFtGmEYIPLdKeOnHpAIAQJDBIBHyCFD9tAyAPD9OD9hD9RHyAIASJDBIBH8cCFD9tA8cAPD9OD9hD9RH8cDQBTFtGmEYIPLdKeOnH8dDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGEAeD9uHeDyBjGBAEAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeApA8dDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNiV8ZcpMyS8cQ8df8eb8fHdAyA8cDQNiV8ZcpMyS8cQ8df8eb8fH8ZDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJREAYCTJHYAM9JQBMMAbCIJHbAG9JQBMMABAVAG9sJALCUGJAcAG9s/8cBBALALCUGJAcCaJAG9sJAG/8cBBMAcCBAKyAVJRVAKQBMC9+RKSFMCBC99AOAKlAGCAAGCA9Ly6yRKMALCU/KBJ8kUUUUBAKMNBT+BUUUBM+KmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUF/8MBALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM/dLEK97FaF97GXGXAGCI9HQBAF9FQFCBRGEXABABDBBBHECiD+rFCiD+sFD/6FHIAECND+rFCiD+sFD/6FAID/gFAECTD+rFCiD+sFD/6FHLD/gFD/kFD/lFHKCBDtD+2FHOAICUUUU94DtHND9OD9RD/kFHI9DBB/+hDYAIAID/mFAKAKD/mFALAOALAND9OD9RD/kFHIAID/mFD/kFD/kFD/jFD/nFHLD/mF9DBBX9LDYHOD/kFCgFDtD9OAECUUU94DtD9OD9QAIALD/mFAOD/kFCND+rFCU/+EDtD9OD9QAKALD/mFAOD/kFCTD+rFCUU/8ODtD9OD9QDMBBABCTJRBAGCIJHGAF9JQBSGMMAF9FQBCBRGEXABCTJHVAVDBBBHECBDtHOCUU98D8cFCUU98D8cEHND9OABDBBBHKAEDQILKOSQfbPden8c8d8e8fCggFDtD9OD/6FAKAEDQBFGENVcMTtmYi8ZpyHECTD+sFD/6FHID/gFAECTD+rFCTD+sFD/6FHLD/gFD/kFD/lFHE9DB/+g6DYALAEAOD+2FHOALCUUUU94DtHcD9OD9RD/kFHLALD/mFAEAED/mFAIAOAIAcD9OD9RD/kFHEAED/mFD/kFD/kFD/jFD/nFHID/mF9DBBX9LDYHOD/kFCTD+rFALAID/mFAOD/kFCggEDtD9OD9QHLAEAID/mFAOD/kFCaDbCBDnGCBDnECBDnKCBDnOCBDncCBDnMCBDnfCBDnbD9OHEDQNVi8ZcMpySQ8c8dfb8e8fD9QDMBBABAKAND9OALAEDQBFTtGEmYILPdKOenD9QDMBBABCAJRBAGCIJHGAF9JQBMMM/hEIGaF97FaL978jUUUUBCTlREGXAF9FQBCBRIEXAEABDBBBHLABCTJHKDBBBHODQILKOSQfbPden8c8d8e8fHNCTD+sFHVCID+rFDMIBAB9DBBU8/DY9D/zI818/DYAVCEDtD9QD/6FD/nFHVALAODQBFGENVcMTtmYi8ZpyHLCTD+rFCTD+sFD/6FD/mFHOAOD/mFAVALCTD+sFD/6FD/mFHcAcD/mFAVANCTD+rFCTD+sFD/6FD/mFHNAND/mFD/kFD/kFD/lFCBDtD+4FD/jF9DB/+g6DYHVD/mF9DBBX9LDYHLD/kFCggEDtHMD9OAcAVD/mFALD/kFCTD+rFD9QHcANAVD/mFALD/kFCTD+rFAOAVD/mFALD/kFAMD9OD9QHVDQBFTtGEmYILPdKOenHLD8dBAEDBIBDyB+t+J83EBABCNJALD8dFAEDBIBDyF+t+J83EBAKAcAVDQNVi8ZcMpySQ8c8dfb8e8fHVD8dBAEDBIBDyG+t+J83EBABCiJAVD8dFAEDBIBDyE+t+J83EBABCAJRBAICIJHIAF9JQBMMM9jFF97GXAGCGrAF9sHG9FQBCBRFEXABABDBBBHECND+rFCND+sFD/6FAECiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMBBABCTJRBAFCIJHFAG9JQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEMMMFBCUNMIT9tBB",s=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),a=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]);if(typeof WebAssembly!="object")return{supported:!1};let c=o;WebAssembly.validate(s)&&(c=e);let d;const b=WebAssembly.instantiate(_e(c),{}).then(ot=>{d=ot.instance,d.exports.__wasm_call_ctors()});function _e(ot){const at=new Uint8Array(ot.length);for(let ut=0;ut<ot.length;++ut){const ft=ot.charCodeAt(ut);at[ut]=ft>96?ft-71:ft>64?ft-65:ft>47?ft+4:ft>46?63:62}let ct=0;for(let ut=0;ut<ot.length;++ut)at[ct++]=at[ut]<60?a[at[ut]]:(at[ut]-60)*64+at[++ut];return at.buffer.slice(0,ct)}function tt(ot,at,ct,ut,ft,dt){const lt=d.exports.sbrk,ht=ct+3&-4,mt=lt(ht*ut),xt=lt(ft.length),St=new Uint8Array(d.exports.memory.buffer);St.set(ft,xt);const yt=ot(mt,ct,ut,xt,ft.length);if(yt===0&&dt&&dt(mt,ht,ut),at.set(St.subarray(mt,mt+ct*ut)),lt(mt-lt(0)),yt!==0)throw new Error(`Malformed buffer data: ${yt}`)}const nt={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},it={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return generated={ready:b,supported:!0,decodeVertexBuffer(ot,at,ct,ut,ft){tt(d.exports.meshopt_decodeVertexBuffer,ot,at,ct,ut,d.exports[nt[ft]])},decodeIndexBuffer(ot,at,ct,ut){tt(d.exports.meshopt_decodeIndexBuffer,ot,at,ct,ut)},decodeIndexSequence(ot,at,ct,ut){tt(d.exports.meshopt_decodeIndexSequence,ot,at,ct,ut)},decodeGltfBuffer(ot,at,ct,ut,ft,dt){tt(d.exports[it[ft]],ot,at,ct,ut,d.exports[nt[dt]])}},generated};function shaderMaterial(o,e,s,a){const c=class extends ShaderMaterial{constructor(b={}){const _e=Object.entries(o);super({uniforms:_e.reduce((tt,[nt,it])=>{const ot=UniformsUtils.clone({[nt]:{value:it}});return{...tt,...ot}},{}),vertexShader:e,fragmentShader:s}),this.key="",_e.forEach(([tt])=>Object.defineProperty(this,tt,{get:()=>this.uniforms[tt].value,set:nt=>this.uniforms[tt].value=nt})),Object.assign(this,b)}};return c.key=MathUtils.generateUUID(),c}const IsObject=o=>o===Object(o)&&!Array.isArray(o)&&typeof o!="function";function useTexture(o,e){const s=useThree(d=>d.gl),a=useLoader(TextureLoader,IsObject(o)?Object.values(o):o);return reactExports.useLayoutEffect(()=>{e==null||e(a)},[e]),reactExports.useEffect(()=>{if("initTexture"in s){let d=[];Array.isArray(a)?d=a:a instanceof Texture?d=[a]:IsObject(a)&&(d=Object.values(a)),d.forEach(b=>{b instanceof Texture&&s.initTexture(b)})}},[s,a]),reactExports.useMemo(()=>{if(IsObject(o)){const d={};let b=0;for(const _e in o)d[_e]=a[b++];return d}else return a},[o,a])}useTexture.preload=o=>useLoader.preload(TextureLoader,o);useTexture.clear=o=>useLoader.clear(TextureLoader,o);const getVersion=()=>parseInt(REVISION.replace(/\D+/g,"")),version=getVersion();let dracoLoader=null,decoderPath="https://www.gstatic.com/draco/versioned/decoders/1.5.5/";function extensions(o=!0,e=!0,s){return a=>{s&&s(a),o&&(dracoLoader||(dracoLoader=new DRACOLoader),dracoLoader.setDecoderPath(typeof o=="string"?o:decoderPath),a.setDRACOLoader(dracoLoader)),e&&a.setMeshoptDecoder(typeof MeshoptDecoder=="function"?MeshoptDecoder():MeshoptDecoder)}}const useGLTF=(o,e,s,a)=>useLoader(GLTFLoader,o,extensions(e,s,a));useGLTF.preload=(o,e,s,a)=>useLoader.preload(GLTFLoader,o,extensions(e,s,a));useGLTF.clear=o=>useLoader.clear(GLTFLoader,o);useGLTF.setDecoderPath=o=>{decoderPath=o};function useFBO(o,e,s){const a=useThree(at=>at.size),c=useThree(at=>at.viewport),d=typeof o=="number"?o:a.width*c.dpr,b=a.height*c.dpr,_e=(typeof o=="number"?s:o)||{},{samples:tt=0,depth:nt,...it}=_e,ot=reactExports.useMemo(()=>{const at=new WebGLRenderTarget(d,b,{minFilter:LinearFilter,magFilter:LinearFilter,type:HalfFloatType,...it});return nt&&(at.depthTexture=new DepthTexture(d,b,FloatType)),at.samples=tt,at},[]);return reactExports.useLayoutEffect(()=>{ot.setSize(d,b),tt&&(ot.samples=tt)},[tt,ot,d,b]),reactExports.useEffect(()=>()=>ot.dispose(),[]),ot}const isFunction$1=o=>typeof o=="function",OrthographicCamera=reactExports.forwardRef(({envMap:o,resolution:e=256,frames:s=1/0,children:a,makeDefault:c,...d},b)=>{const _e=useThree(({set:dt})=>dt),tt=useThree(({camera:dt})=>dt),nt=useThree(({size:dt})=>dt),it=reactExports.useRef(null);reactExports.useImperativeHandle(b,()=>it.current,[]);const ot=reactExports.useRef(null),at=useFBO(e);reactExports.useLayoutEffect(()=>{d.manual||it.current.updateProjectionMatrix()},[nt,d]),reactExports.useLayoutEffect(()=>{it.current.updateProjectionMatrix()}),reactExports.useLayoutEffect(()=>{if(c){const dt=tt;return _e(()=>({camera:it.current})),()=>_e(()=>({camera:dt}))}},[it,c,_e]);let ct=0,ut=null;const ft=isFunction$1(a);return useFrame(dt=>{ft&&(s===1/0||ct<s)&&(ot.current.visible=!1,dt.gl.setRenderTarget(at),ut=dt.scene.background,o&&(dt.scene.background=o),dt.gl.render(dt.scene,it.current),dt.scene.background=ut,dt.gl.setRenderTarget(null),ot.current.visible=!0,ct++)}),reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("orthographicCamera",_extends({left:nt.width/-2,right:nt.width/2,top:nt.height/2,bottom:nt.height/-2,ref:it},d),!ft&&a),reactExports.createElement("group",{ref:ot},ft&&a(at.texture)))}),OrbitControls=reactExports.forwardRef(({makeDefault:o,camera:e,regress:s,domElement:a,enableDamping:c=!0,keyEvents:d=!1,onChange:b,onStart:_e,onEnd:tt,...nt},it)=>{const ot=useThree(yt=>yt.invalidate),at=useThree(yt=>yt.camera),ct=useThree(yt=>yt.gl),ut=useThree(yt=>yt.events),ft=useThree(yt=>yt.setEvents),dt=useThree(yt=>yt.set),lt=useThree(yt=>yt.get),ht=useThree(yt=>yt.performance),mt=e||at,xt=a||ut.connected||ct.domElement,St=reactExports.useMemo(()=>new OrbitControls$1(mt),[mt]);return useFrame(()=>{St.enabled&&St.update()},-1),reactExports.useEffect(()=>(d&&St.connect(d===!0?xt:d),St.connect(xt),()=>void St.dispose()),[d,xt,s,St,ot]),reactExports.useEffect(()=>{const yt=_t=>{ot(),s&&ht.regress(),b&&b(_t)},wt=_t=>{_e&&_e(_t)},Et=_t=>{tt&&tt(_t)};return St.addEventListener("change",yt),St.addEventListener("start",wt),St.addEventListener("end",Et),()=>{St.removeEventListener("start",wt),St.removeEventListener("end",Et),St.removeEventListener("change",yt)}},[b,_e,tt,St,ot,ft]),reactExports.useEffect(()=>{if(o){const yt=lt().controls;return dt({controls:St}),()=>dt({controls:yt})}},[o,St]),reactExports.createElement("primitive",_extends({ref:it,object:St,enableDamping:c},nt))}),TransformControls=reactExports.forwardRef(({children:o,domElement:e,onChange:s,onMouseDown:a,onMouseUp:c,onObjectChange:d,object:b,makeDefault:_e,camera:tt,enabled:nt,axis:it,mode:ot,translationSnap:at,rotationSnap:ct,scaleSnap:ut,space:ft,size:dt,showX:lt,showY:ht,showZ:mt,...xt},St)=>{const yt=useThree(Pt=>Pt.controls),wt=useThree(Pt=>Pt.gl),Et=useThree(Pt=>Pt.events),_t=useThree(Pt=>Pt.camera),vt=useThree(Pt=>Pt.invalidate),Mt=useThree(Pt=>Pt.get),jt=useThree(Pt=>Pt.set),Lt=tt||_t,Nt=e||Et.connected||wt.domElement,kt=reactExports.useMemo(()=>new TransformControls$1(Lt,Nt),[Lt,Nt]),Ot=reactExports.useRef(null);reactExports.useLayoutEffect(()=>(b?kt.attach(b instanceof Object3D?b:b.current):Ot.current instanceof Object3D&&kt.attach(Ot.current),()=>void kt.detach()),[b,o,kt]),reactExports.useEffect(()=>{if(yt){const Pt=Wt=>yt.enabled=!Wt.value;return kt.addEventListener("dragging-changed",Pt),()=>kt.removeEventListener("dragging-changed",Pt)}},[kt,yt]);const Ht=reactExports.useRef(),Ct=reactExports.useRef(),Ut=reactExports.useRef(),Gt=reactExports.useRef();return reactExports.useLayoutEffect(()=>void(Ht.current=s),[s]),reactExports.useLayoutEffect(()=>void(Ct.current=a),[a]),reactExports.useLayoutEffect(()=>void(Ut.current=c),[c]),reactExports.useLayoutEffect(()=>void(Gt.current=d),[d]),reactExports.useEffect(()=>{const Pt=tn=>{vt(),Ht.current==null||Ht.current(tn)},Wt=tn=>Ct.current==null?void 0:Ct.current(tn),sn=tn=>Ut.current==null?void 0:Ut.current(tn),Bt=tn=>Gt.current==null?void 0:Gt.current(tn);return kt.addEventListener("change",Pt),kt.addEventListener("mouseDown",Wt),kt.addEventListener("mouseUp",sn),kt.addEventListener("objectChange",Bt),()=>{kt.removeEventListener("change",Pt),kt.removeEventListener("mouseDown",Wt),kt.removeEventListener("mouseUp",sn),kt.removeEventListener("objectChange",Bt)}},[vt,kt]),reactExports.useEffect(()=>{if(_e){const Pt=Mt().controls;return jt({controls:kt}),()=>jt({controls:Pt})}},[_e,kt]),reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("primitive",{ref:St,object:kt,enabled:nt,axis:it,mode:ot,translationSnap:at,rotationSnap:ct,scaleSnap:ut,space:ft,size:dt,showX:lt,showY:ht,showZ:mt}),reactExports.createElement("group",_extends({ref:Ot},xt),o))}),PointerLockControls=reactExports.forwardRef(({domElement:o,selector:e,onChange:s,onLock:a,onUnlock:c,enabled:d=!0,makeDefault:b,..._e},tt)=>{const{camera:nt,...it}=_e,ot=useThree(St=>St.setEvents),at=useThree(St=>St.gl),ct=useThree(St=>St.camera),ut=useThree(St=>St.invalidate),ft=useThree(St=>St.events),dt=useThree(St=>St.get),lt=useThree(St=>St.set),ht=nt||ct,mt=o||ft.connected||at.domElement,xt=reactExports.useMemo(()=>new PointerLockControls$1(ht),[ht]);return reactExports.useEffect(()=>{if(d){xt.connect(mt);const St=dt().events.compute;return ot({compute(yt,wt){const Et=wt.size.width/2,_t=wt.size.height/2;wt.pointer.set(Et/wt.size.width*2-1,-(_t/wt.size.height)*2+1),wt.raycaster.setFromCamera(wt.pointer,wt.camera)}}),()=>{xt.disconnect(),ot({compute:St})}}},[d,xt]),reactExports.useEffect(()=>{const St=Et=>{ut(),s&&s(Et)};xt.addEventListener("change",St),a&&xt.addEventListener("lock",a),c&&xt.addEventListener("unlock",c);const yt=()=>xt.lock(),wt=e?Array.from(document.querySelectorAll(e)):[document];return wt.forEach(Et=>Et&&Et.addEventListener("click",yt)),()=>{xt.removeEventListener("change",St),a&&xt.removeEventListener("lock",a),c&&xt.removeEventListener("unlock",c),wt.forEach(Et=>Et?Et.removeEventListener("click",yt):void 0)}},[s,a,c,e,xt,ut]),reactExports.useEffect(()=>{if(b){const St=dt().controls;return lt({controls:xt}),()=>lt({controls:St})}},[b,xt]),reactExports.createElement("primitive",_extends({ref:tt,object:xt},it))});function RenderHud({defaultScene:o,defaultCamera:e,renderPriority:s=1}){const{gl:a,scene:c,camera:d}=useThree();let b;return useFrame(()=>{b=a.autoClear,s===1&&(a.autoClear=!0,a.render(o,e)),a.autoClear=!1,a.clearDepth(),a.render(c,d),a.autoClear=b},s),reactExports.createElement("group",{onPointerOver:()=>null})}function Hud({children:o,renderPriority:e=1}){const{scene:s,camera:a}=useThree(),[c]=reactExports.useState(()=>new Scene);return reactExports.createElement(reactExports.Fragment,null,createPortal(reactExports.createElement(reactExports.Fragment,null,o,reactExports.createElement(RenderHud,{defaultScene:s,defaultCamera:a,renderPriority:e})),c,{events:{priority:e+1}}))}const Context=reactExports.createContext({}),useGizmoContext=()=>reactExports.useContext(Context),turnRate=2*Math.PI,dummy=new Object3D,matrix=new Matrix4,[q1,q2]=[new Quaternion,new Quaternion],target=new Vector3,targetPosition=new Vector3,isOrbitControls=o=>"minPolarAngle"in o,isCameraControls=o=>"getTarget"in o,GizmoHelper=({alignment:o="bottom-right",margin:e=[80,80],renderPriority:s=1,onUpdate:a,onTarget:c,children:d})=>{const b=useThree(yt=>yt.size),_e=useThree(yt=>yt.camera),tt=useThree(yt=>yt.controls),nt=useThree(yt=>yt.invalidate),it=reactExports.useRef(null),ot=reactExports.useRef(null),at=reactExports.useRef(!1),ct=reactExports.useRef(0),ut=reactExports.useRef(new Vector3(0,0,0)),ft=reactExports.useRef(new Vector3(0,0,0));reactExports.useEffect(()=>{ft.current.copy(_e.up),dummy.up.copy(_e.up)},[_e]);const dt=reactExports.useCallback(yt=>{at.current=!0,(tt||c)&&(ut.current=(c==null?void 0:c())||(isCameraControls(tt)?tt.getTarget(ut.current):tt==null?void 0:tt.target)),ct.current=_e.position.distanceTo(target),q1.copy(_e.quaternion),targetPosition.copy(yt).multiplyScalar(ct.current).add(target),dummy.lookAt(targetPosition),q2.copy(dummy.quaternion),nt()},[tt,_e,c,nt]);useFrame((yt,wt)=>{if(ot.current&&it.current){var Et;if(at.current)if(q1.angleTo(q2)<.01)at.current=!1,isOrbitControls(tt)&&_e.up.copy(ft.current);else{const _t=wt*turnRate;q1.rotateTowards(q2,_t),_e.position.set(0,0,1).applyQuaternion(q1).multiplyScalar(ct.current).add(ut.current),_e.up.set(0,1,0).applyQuaternion(q1).normalize(),_e.quaternion.copy(q1),isCameraControls(tt)&&tt.setPosition(_e.position.x,_e.position.y,_e.position.z),a?a():tt&&tt.update(wt),nt()}matrix.copy(_e.matrix).invert(),(Et=it.current)==null||Et.quaternion.setFromRotationMatrix(matrix)}});const lt=reactExports.useMemo(()=>({tweenCamera:dt}),[dt]),[ht,mt]=e,xt=o.endsWith("-center")?0:o.endsWith("-left")?-b.width/2+ht:b.width/2-ht,St=o.startsWith("center-")?0:o.startsWith("top-")?b.height/2-mt:-b.height/2+mt;return reactExports.createElement(Hud,{renderPriority:s},reactExports.createElement(Context.Provider,{value:lt},reactExports.createElement(OrthographicCamera,{makeDefault:!0,ref:ot,position:[0,0,200]}),reactExports.createElement("group",{ref:it,position:[xt,St,0]},d)))};function Axis({scale:o=[.8,.05,.05],color:e,rotation:s}){return reactExports.createElement("group",{rotation:s},reactExports.createElement("mesh",{position:[.4,0,0]},reactExports.createElement("boxGeometry",{args:o}),reactExports.createElement("meshBasicMaterial",{color:e,toneMapped:!1})))}function AxisHead({onClick:o,font:e,disabled:s,arcStyle:a,label:c,labelColor:d,axisHeadScale:b=1,..._e}){const tt=useThree(ft=>ft.gl),nt=reactExports.useMemo(()=>{const ft=document.createElement("canvas");ft.width=64,ft.height=64;const dt=ft.getContext("2d");return dt.beginPath(),dt.arc(32,32,16,0,2*Math.PI),dt.closePath(),dt.fillStyle=a,dt.fill(),c&&(dt.font=e,dt.textAlign="center",dt.fillStyle=d,dt.fillText(c,32,41)),new CanvasTexture(ft)},[a,c,d,e]),[it,ot]=reactExports.useState(!1),at=(c?1:.75)*(it?1.2:1)*b,ct=ft=>{ft.stopPropagation(),ot(!0)},ut=ft=>{ft.stopPropagation(),ot(!1)};return reactExports.createElement("sprite",_extends({scale:at,onPointerOver:s?void 0:ct,onPointerOut:s?void 0:o||ut},_e),reactExports.createElement("spriteMaterial",{map:nt,"map-anisotropy":tt.capabilities.getMaxAnisotropy()||1,alphaTest:.3,opacity:c?1:.75,toneMapped:!1}))}const GizmoViewport=({hideNegativeAxes:o,hideAxisHeads:e,disabled:s,font:a="18px Inter var, Arial, sans-serif",axisColors:c=["#ff2060","#20df80","#2080ff"],axisHeadScale:d=1,axisScale:b,labels:_e=["X","Y","Z"],labelColor:tt="#000",onClick:nt,...it})=>{const[ot,at,ct]=c,{tweenCamera:ut}=useGizmoContext(),ft={font:a,disabled:s,labelColor:tt,onClick:nt,axisHeadScale:d,onPointerDown:s?void 0:dt=>{ut(dt.object.position),dt.stopPropagation()}};return reactExports.createElement("group",_extends({scale:40},it),reactExports.createElement(Axis,{color:ot,rotation:[0,0,0],scale:b}),reactExports.createElement(Axis,{color:at,rotation:[0,0,Math.PI/2],scale:b}),reactExports.createElement(Axis,{color:ct,rotation:[0,-Math.PI/2,0],scale:b}),!e&&reactExports.createElement(reactExports.Fragment,null,reactExports.createElement(AxisHead,_extends({arcStyle:ot,position:[1,0,0],label:_e[0]},ft)),reactExports.createElement(AxisHead,_extends({arcStyle:at,position:[0,1,0],label:_e[1]},ft)),reactExports.createElement(AxisHead,_extends({arcStyle:ct,position:[0,0,1],label:_e[2]},ft)),!o&&reactExports.createElement(reactExports.Fragment,null,reactExports.createElement(AxisHead,_extends({arcStyle:ot,position:[-1,0,0]},ft)),reactExports.createElement(AxisHead,_extends({arcStyle:at,position:[0,-1,0]},ft)),reactExports.createElement(AxisHead,_extends({arcStyle:ct,position:[0,0,-1]},ft)))))},GridMaterial=shaderMaterial({cellSize:.5,sectionSize:1,fadeDistance:100,fadeStrength:1,fadeFrom:1,cellThickness:.5,sectionThickness:1,cellColor:new Color,sectionColor:new Color,infiniteGrid:!1,followCamera:!1,worldCamProjPosition:new Vector3,worldPlanePosition:new Vector3},`
    varying vec3 localPosition;
    varying vec4 worldPosition;

    uniform vec3 worldCamProjPosition;
    uniform vec3 worldPlanePosition;
    uniform float fadeDistance;
    uniform bool infiniteGrid;
    uniform bool followCamera;

    void main() {
      localPosition = position.xzy;
      if (infiniteGrid) localPosition *= 1.0 + fadeDistance;
      
      worldPosition = modelMatrix * vec4(localPosition, 1.0);
      if (followCamera) {
        worldPosition.xyz += (worldCamProjPosition - worldPlanePosition);
        localPosition = (inverse(modelMatrix) * worldPosition).xyz;
      }

      gl_Position = projectionMatrix * viewMatrix * worldPosition;
    }
  `,`
    varying vec3 localPosition;
    varying vec4 worldPosition;

    uniform vec3 worldCamProjPosition;
    uniform float cellSize;
    uniform float sectionSize;
    uniform vec3 cellColor;
    uniform vec3 sectionColor;
    uniform float fadeDistance;
    uniform float fadeStrength;
    uniform float fadeFrom;
    uniform float cellThickness;
    uniform float sectionThickness;

    float getGrid(float size, float thickness) {
      vec2 r = localPosition.xz / size;
      vec2 grid = abs(fract(r - 0.5) - 0.5) / fwidth(r);
      float line = min(grid.x, grid.y) + 1.0 - thickness;
      return 1.0 - min(line, 1.0);
    }

    void main() {
      float g1 = getGrid(cellSize, cellThickness);
      float g2 = getGrid(sectionSize, sectionThickness);

      vec3 from = worldCamProjPosition*vec3(fadeFrom);
      float dist = distance(from, worldPosition.xyz);
      float d = 1.0 - min(dist / fadeDistance, 1.0);
      vec3 color = mix(cellColor, sectionColor, min(1.0, sectionThickness * g2));

      gl_FragColor = vec4(color, (g1 + g2) * pow(d, fadeStrength));
      gl_FragColor.a = mix(0.75 * gl_FragColor.a, gl_FragColor.a, g2);
      if (gl_FragColor.a <= 0.0) discard;

      #include <tonemapping_fragment>
      #include <${version>=154?"colorspace_fragment":"encodings_fragment"}>
    }
  `),Grid=reactExports.forwardRef(({args:o,cellColor:e="#000000",sectionColor:s="#2080ff",cellSize:a=.5,sectionSize:c=1,followCamera:d=!1,infiniteGrid:b=!1,fadeDistance:_e=100,fadeStrength:tt=1,fadeFrom:nt=1,cellThickness:it=.5,sectionThickness:ot=1,side:at=BackSide,...ct},ut)=>{extend({GridMaterial});const ft=reactExports.useRef(null);reactExports.useImperativeHandle(ut,()=>ft.current,[]);const dt=new Plane,lt=new Vector3(0,1,0),ht=new Vector3(0,0,0);useFrame(St=>{dt.setFromNormalAndCoplanarPoint(lt,ht).applyMatrix4(ft.current.matrixWorld);const yt=ft.current.material,wt=yt.uniforms.worldCamProjPosition,Et=yt.uniforms.worldPlanePosition;dt.projectPoint(St.camera.position,wt.value),Et.value.set(0,0,0).applyMatrix4(ft.current.matrixWorld)});const mt={cellSize:a,sectionSize:c,cellColor:e,sectionColor:s,cellThickness:it,sectionThickness:ot},xt={fadeDistance:_e,fadeStrength:tt,fadeFrom:nt,infiniteGrid:b,followCamera:d};return reactExports.createElement("mesh",_extends({ref:ft,frustumCulled:!1},ct),reactExports.createElement("gridMaterial",_extends({transparent:!0,"extensions-derivatives":!0,side:at},mt,xt)),reactExports.createElement("planeGeometry",{args:o}))}),LinearEncoding=3e3,sRGBEncoding=3001,getBufferForType=(o,e,s)=>{let a;switch(o){case UnsignedByteType:a=new Uint8ClampedArray(e*s*4);break;case HalfFloatType:a=new Uint16Array(e*s*4);break;case UnsignedIntType:a=new Uint32Array(e*s*4);break;case ByteType:a=new Int8Array(e*s*4);break;case ShortType:a=new Int16Array(e*s*4);break;case IntType:a=new Int32Array(e*s*4);break;case FloatType:a=new Float32Array(e*s*4);break;default:throw new Error("Unsupported data type")}return a};let _canReadPixelsResult;const canReadPixels=(o,e,s,a)=>{if(_canReadPixelsResult!==void 0)return _canReadPixelsResult;const c=new WebGLRenderTarget(1,1,a);e.setRenderTarget(c);const d=new Mesh(new PlaneGeometry,new MeshBasicMaterial({color:16777215}));e.render(d,s),e.setRenderTarget(null);const b=getBufferForType(o,c.width,c.height);return e.readRenderTargetPixels(c,0,0,c.width,c.height,b),c.dispose(),d.geometry.dispose(),d.material.dispose(),_canReadPixelsResult=b[0]!==0,_canReadPixelsResult};class QuadRenderer{constructor(e){var s,a,c,d,b,_e,tt,nt,it,ot,at,ct,ut,ft,dt,lt;this._rendererIsDisposable=!1,this._supportsReadPixels=!0,this.render=()=>{this._renderer.setRenderTarget(this._renderTarget);try{this._renderer.render(this._scene,this._camera)}catch(mt){throw this._renderer.setRenderTarget(null),mt}this._renderer.setRenderTarget(null)},this._width=e.width,this._height=e.height,this._type=e.type,this._colorSpace=e.colorSpace;const ht={format:RGBAFormat,depthBuffer:!1,stencilBuffer:!1,type:this._type,colorSpace:this._colorSpace,anisotropy:((s=e.renderTargetOptions)===null||s===void 0?void 0:s.anisotropy)!==void 0?(a=e.renderTargetOptions)===null||a===void 0?void 0:a.anisotropy:1,generateMipmaps:((c=e.renderTargetOptions)===null||c===void 0?void 0:c.generateMipmaps)!==void 0?(d=e.renderTargetOptions)===null||d===void 0?void 0:d.generateMipmaps:!1,magFilter:((b=e.renderTargetOptions)===null||b===void 0?void 0:b.magFilter)!==void 0?(_e=e.renderTargetOptions)===null||_e===void 0?void 0:_e.magFilter:LinearFilter,minFilter:((tt=e.renderTargetOptions)===null||tt===void 0?void 0:tt.minFilter)!==void 0?(nt=e.renderTargetOptions)===null||nt===void 0?void 0:nt.minFilter:LinearFilter,samples:((it=e.renderTargetOptions)===null||it===void 0?void 0:it.samples)!==void 0?(ot=e.renderTargetOptions)===null||ot===void 0?void 0:ot.samples:void 0,wrapS:((at=e.renderTargetOptions)===null||at===void 0?void 0:at.wrapS)!==void 0?(ct=e.renderTargetOptions)===null||ct===void 0?void 0:ct.wrapS:ClampToEdgeWrapping,wrapT:((ut=e.renderTargetOptions)===null||ut===void 0?void 0:ut.wrapT)!==void 0?(ft=e.renderTargetOptions)===null||ft===void 0?void 0:ft.wrapT:ClampToEdgeWrapping};if(this._material=e.material,e.renderer?this._renderer=e.renderer:(this._renderer=QuadRenderer.instantiateRenderer(),this._rendererIsDisposable=!0),this._scene=new Scene,this._camera=new OrthographicCamera$1,this._camera.position.set(0,0,10),this._camera.left=-.5,this._camera.right=.5,this._camera.top=.5,this._camera.bottom=-.5,this._camera.updateProjectionMatrix(),!canReadPixels(this._type,this._renderer,this._camera,ht)){let mt;switch(this._type){case HalfFloatType:mt=this._renderer.extensions.has("EXT_color_buffer_float")?FloatType:void 0;break}mt!==void 0?(console.warn(`This browser does not support reading pixels from ${this._type} RenderTargets, switching to ${FloatType}`),this._type=mt):(this._supportsReadPixels=!1,console.warn("This browser dos not support toArray or toDataTexture, calls to those methods will result in an error thrown"))}this._quad=new Mesh(new PlaneGeometry,this._material),this._quad.geometry.computeBoundingBox(),this._scene.add(this._quad),this._renderTarget=new WebGLRenderTarget(this.width,this.height,ht),this._renderTarget.texture.mapping=((dt=e.renderTargetOptions)===null||dt===void 0?void 0:dt.mapping)!==void 0?(lt=e.renderTargetOptions)===null||lt===void 0?void 0:lt.mapping:UVMapping}static instantiateRenderer(){const e=new WebGLRenderer;return e.setSize(128,128),e}toArray(){if(!this._supportsReadPixels)throw new Error("Can't read pixels in this browser");const e=getBufferForType(this._type,this._width,this._height);return this._renderer.readRenderTargetPixels(this._renderTarget,0,0,this._width,this._height,e),e}toDataTexture(e){const s=new DataTexture(this.toArray(),this.width,this.height,RGBAFormat,this._type,(e==null?void 0:e.mapping)||UVMapping,(e==null?void 0:e.wrapS)||ClampToEdgeWrapping,(e==null?void 0:e.wrapT)||ClampToEdgeWrapping,(e==null?void 0:e.magFilter)||LinearFilter,(e==null?void 0:e.minFilter)||LinearFilter,(e==null?void 0:e.anisotropy)||1,LinearSRGBColorSpace$1);return s.generateMipmaps=(e==null?void 0:e.generateMipmaps)!==void 0?e==null?void 0:e.generateMipmaps:!1,s}disposeOnDemandRenderer(){this._renderer.setRenderTarget(null),this._rendererIsDisposable&&(this._renderer.dispose(),this._renderer.forceContextLoss())}dispose(e){this.disposeOnDemandRenderer(),e&&this.renderTarget.dispose(),this.material instanceof ShaderMaterial&&Object.values(this.material.uniforms).forEach(s=>{s.value instanceof Texture&&s.value.dispose()}),Object.values(this.material).forEach(s=>{s instanceof Texture&&s.dispose()}),this.material.dispose(),this._quad.geometry.dispose()}get width(){return this._width}set width(e){this._width=e,this._renderTarget.setSize(this._width,this._height)}get height(){return this._height}set height(e){this._height=e,this._renderTarget.setSize(this._width,this._height)}get renderer(){return this._renderer}get renderTarget(){return this._renderTarget}set renderTarget(e){this._renderTarget=e,this._width=e.width,this._height=e.height}get material(){return this._material}get type(){return this._type}get colorSpace(){return this._colorSpace}}const vertexShader=`
varying vec2 vUv;

void main() {
  vUv = uv;
  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
}
`,fragmentShader=`
// min half float value
#define HALF_FLOAT_MIN vec3( -65504, -65504, -65504 )
// max half float value
#define HALF_FLOAT_MAX vec3( 65504, 65504, 65504 )

uniform sampler2D sdr;
uniform sampler2D gainMap;
uniform vec3 gamma;
uniform vec3 offsetHdr;
uniform vec3 offsetSdr;
uniform vec3 gainMapMin;
uniform vec3 gainMapMax;
uniform float weightFactor;

varying vec2 vUv;

void main() {
  vec3 rgb = texture2D( sdr, vUv ).rgb;
  vec3 recovery = texture2D( gainMap, vUv ).rgb;
  vec3 logRecovery = pow( recovery, gamma );
  vec3 logBoost = gainMapMin * ( 1.0 - logRecovery ) + gainMapMax * logRecovery;
  vec3 hdrColor = (rgb + offsetSdr) * exp2( logBoost * weightFactor ) - offsetHdr;
  vec3 clampedHdrColor = max( HALF_FLOAT_MIN, min( HALF_FLOAT_MAX, hdrColor ));
  gl_FragColor = vec4( clampedHdrColor , 1.0 );
}
`;class GainMapDecoderMaterial extends ShaderMaterial{constructor({gamma:e,offsetHdr:s,offsetSdr:a,gainMapMin:c,gainMapMax:d,maxDisplayBoost:b,hdrCapacityMin:_e,hdrCapacityMax:tt,sdr:nt,gainMap:it}){super({name:"GainMapDecoderMaterial",vertexShader,fragmentShader,uniforms:{sdr:{value:nt},gainMap:{value:it},gamma:{value:new Vector3(1/e[0],1/e[1],1/e[2])},offsetHdr:{value:new Vector3().fromArray(s)},offsetSdr:{value:new Vector3().fromArray(a)},gainMapMin:{value:new Vector3().fromArray(c)},gainMapMax:{value:new Vector3().fromArray(d)},weightFactor:{value:(Math.log2(b)-_e)/(tt-_e)}},blending:NoBlending,depthTest:!1,depthWrite:!1}),this._maxDisplayBoost=b,this._hdrCapacityMin=_e,this._hdrCapacityMax=tt,this.needsUpdate=!0,this.uniformsNeedUpdate=!0}get sdr(){return this.uniforms.sdr.value}set sdr(e){this.uniforms.sdr.value=e}get gainMap(){return this.uniforms.gainMap.value}set gainMap(e){this.uniforms.gainMap.value=e}get offsetHdr(){return this.uniforms.offsetHdr.value.toArray()}set offsetHdr(e){this.uniforms.offsetHdr.value.fromArray(e)}get offsetSdr(){return this.uniforms.offsetSdr.value.toArray()}set offsetSdr(e){this.uniforms.offsetSdr.value.fromArray(e)}get gainMapMin(){return this.uniforms.gainMapMin.value.toArray()}set gainMapMin(e){this.uniforms.gainMapMin.value.fromArray(e)}get gainMapMax(){return this.uniforms.gainMapMax.value.toArray()}set gainMapMax(e){this.uniforms.gainMapMax.value.fromArray(e)}get gamma(){const e=this.uniforms.gamma.value;return[1/e.x,1/e.y,1/e.z]}set gamma(e){const s=this.uniforms.gamma.value;s.x=1/e[0],s.y=1/e[1],s.z=1/e[2]}get hdrCapacityMin(){return this._hdrCapacityMin}set hdrCapacityMin(e){this._hdrCapacityMin=e,this.calculateWeight()}get hdrCapacityMax(){return this._hdrCapacityMax}set hdrCapacityMax(e){this._hdrCapacityMax=e,this.calculateWeight()}get maxDisplayBoost(){return this._maxDisplayBoost}set maxDisplayBoost(e){this._maxDisplayBoost=Math.max(1,Math.min(65504,e)),this.calculateWeight()}calculateWeight(){const e=(Math.log2(this._maxDisplayBoost)-this._hdrCapacityMin)/(this._hdrCapacityMax-this._hdrCapacityMin);this.uniforms.weightFactor.value=Math.max(0,Math.min(1,e))}}class GainMapNotFoundError extends Error{}class XMPMetadataNotFoundError extends Error{}const getXMLValue=(o,e,s)=>{const a=new RegExp(`${e}="([^"]*)"`,"i").exec(o);if(a)return a[1];const c=new RegExp(`<${e}[^>]*>([\\s\\S]*?)</${e}>`,"i").exec(o);if(c){const d=c[1].match(/<rdf:li>([^<]*)<\/rdf:li>/g);return d&&d.length===3?d.map(b=>b.replace(/<\/?rdf:li>/g,"")):c[1].trim()}if(s!==void 0)return s;throw new Error(`Can't find ${e} in gainmap metadata`)},extractXMP=o=>{let e;typeof TextDecoder<"u"?e=new TextDecoder().decode(o):e=o.toString();let s=e.indexOf("<x:xmpmeta");for(;s!==-1;){const a=e.indexOf("x:xmpmeta>",s),c=e.slice(s,a+10);try{const d=getXMLValue(c,"hdrgm:GainMapMin","0"),b=getXMLValue(c,"hdrgm:GainMapMax"),_e=getXMLValue(c,"hdrgm:Gamma","1"),tt=getXMLValue(c,"hdrgm:OffsetSDR","0.015625"),nt=getXMLValue(c,"hdrgm:OffsetHDR","0.015625"),it=/hdrgm:HDRCapacityMin="([^"]*)"/.exec(c),ot=it?it[1]:"0",at=/hdrgm:HDRCapacityMax="([^"]*)"/.exec(c);if(!at)throw new Error("Incomplete gainmap metadata");const ct=at[1];return{gainMapMin:Array.isArray(d)?d.map(ut=>parseFloat(ut)):[parseFloat(d),parseFloat(d),parseFloat(d)],gainMapMax:Array.isArray(b)?b.map(ut=>parseFloat(ut)):[parseFloat(b),parseFloat(b),parseFloat(b)],gamma:Array.isArray(_e)?_e.map(ut=>parseFloat(ut)):[parseFloat(_e),parseFloat(_e),parseFloat(_e)],offsetSdr:Array.isArray(tt)?tt.map(ut=>parseFloat(ut)):[parseFloat(tt),parseFloat(tt),parseFloat(tt)],offsetHdr:Array.isArray(nt)?nt.map(ut=>parseFloat(ut)):[parseFloat(nt),parseFloat(nt),parseFloat(nt)],hdrCapacityMin:parseFloat(ot),hdrCapacityMax:parseFloat(ct)}}catch{}s=e.indexOf("<x:xmpmeta",a)}};class MPFExtractor{constructor(e){this.options={debug:e&&e.debug!==void 0?e.debug:!1,extractFII:e&&e.extractFII!==void 0?e.extractFII:!0,extractNonFII:e&&e.extractNonFII!==void 0?e.extractNonFII:!0}}extract(e){return new Promise((s,a)=>{const c=this.options.debug,d=new DataView(e.buffer);if(d.getUint16(0)!==65496){a(new Error("Not a valid jpeg"));return}const b=d.byteLength;let _e=2,tt=0,nt;for(;_e<b;){if(++tt>250){a(new Error(`Found no marker after ${tt} loops `));return}if(d.getUint8(_e)!==255){a(new Error(`Not a valid marker at offset 0x${_e.toString(16)}, found: 0x${d.getUint8(_e).toString(16)}`));return}if(nt=d.getUint8(_e+1),c&&console.log(`Marker: ${nt.toString(16)}`),nt===226){c&&console.log("Found APP2 marker (0xffe2)");const it=_e+4;if(d.getUint32(it)===1297106432){const ot=it+4;let at;if(d.getUint16(ot)===18761)at=!1;else if(d.getUint16(ot)===19789)at=!0;else{a(new Error("No valid endianness marker found in TIFF header"));return}if(d.getUint16(ot+2,!at)!==42){a(new Error("Not valid TIFF data! (no 0x002A marker)"));return}const ct=d.getUint32(ot+4,!at);if(ct<8){a(new Error("Not valid TIFF data! (First offset less than 8)"));return}const ut=ot+ct,ft=d.getUint16(ut,!at),dt=ut+2;let lt=0;for(let St=dt;St<dt+12*ft;St+=12)d.getUint16(St,!at)===45057&&(lt=d.getUint32(St+8,!at));const mt=ut+2+ft*12+4,xt=[];for(let St=mt;St<mt+lt*16;St+=16){const yt={MPType:d.getUint32(St,!at),size:d.getUint32(St+4,!at),dataOffset:d.getUint32(St+8,!at),dependantImages:d.getUint32(St+12,!at),start:-1,end:-1,isFII:!1};yt.dataOffset?(yt.start=ot+yt.dataOffset,yt.isFII=!1):(yt.start=0,yt.isFII=!0),yt.end=yt.start+yt.size,xt.push(yt)}if(this.options.extractNonFII&&xt.length){const St=new Blob([d]),yt=[];for(const wt of xt){if(wt.isFII&&!this.options.extractFII)continue;const Et=St.slice(wt.start,wt.end+1,"image/jpeg");yt.push(Et)}s(yt)}}}_e+=2+d.getUint16(_e+2)}})}}const extractGainmapFromJPEG=async o=>{const e=extractXMP(o);if(!e)throw new XMPMetadataNotFoundError("Gain map XMP metadata not found");const a=await new MPFExtractor({extractFII:!0,extractNonFII:!0}).extract(o);if(a.length!==2)throw new GainMapNotFoundError("Gain map recovery image not found");return{sdr:new Uint8Array(await a[0].arrayBuffer()),gainMap:new Uint8Array(await a[1].arrayBuffer()),metadata:e}},getHTMLImageFromBlob=o=>new Promise((e,s)=>{const a=document.createElement("img");a.onload=()=>{e(a)},a.onerror=c=>{s(c)},a.src=URL.createObjectURL(o)});class LoaderBase extends Loader{constructor(e,s){super(s),e&&(this._renderer=e),this._internalLoadingManager=new LoadingManager}setRenderer(e){return this._renderer=e,this}setRenderTargetOptions(e){return this._renderTargetOptions=e,this}prepareQuadRenderer(){this._renderer||console.warn("WARNING: An existing WebGL Renderer was not passed to this Loader constructor or in setRenderer, the result of this Loader will need to be converted to a Data Texture with toDataTexture() before you can use it in your renderer.");const e=new GainMapDecoderMaterial({gainMapMax:[1,1,1],gainMapMin:[0,0,0],gamma:[1,1,1],offsetHdr:[1,1,1],offsetSdr:[1,1,1],hdrCapacityMax:1,hdrCapacityMin:0,maxDisplayBoost:1,gainMap:new Texture,sdr:new Texture});return new QuadRenderer({width:16,height:16,type:HalfFloatType,colorSpace:LinearSRGBColorSpace$1,material:e,renderer:this._renderer,renderTargetOptions:this._renderTargetOptions})}async render(e,s,a,c){const d=c?new Blob([c],{type:"image/jpeg"}):void 0,b=new Blob([a],{type:"image/jpeg"});let _e,tt,nt=!1;if(typeof createImageBitmap>"u"){const at=await Promise.all([d?getHTMLImageFromBlob(d):Promise.resolve(void 0),getHTMLImageFromBlob(b)]);tt=at[0],_e=at[1],nt=!0}else{const at=await Promise.all([d?createImageBitmap(d,{imageOrientation:"flipY"}):Promise.resolve(void 0),createImageBitmap(b,{imageOrientation:"flipY"})]);tt=at[0],_e=at[1]}const it=new Texture(tt||new ImageData(2,2),UVMapping,ClampToEdgeWrapping,ClampToEdgeWrapping,LinearFilter,LinearMipMapLinearFilter,RGBAFormat,UnsignedByteType,1,LinearSRGBColorSpace$1);it.flipY=nt,it.needsUpdate=!0;const ot=new Texture(_e,UVMapping,ClampToEdgeWrapping,ClampToEdgeWrapping,LinearFilter,LinearMipMapLinearFilter,RGBAFormat,UnsignedByteType,1,SRGBColorSpace$1);ot.flipY=nt,ot.needsUpdate=!0,e.width=_e.width,e.height=_e.height,e.material.gainMap=it,e.material.sdr=ot,e.material.gainMapMin=s.gainMapMin,e.material.gainMapMax=s.gainMapMax,e.material.offsetHdr=s.offsetHdr,e.material.offsetSdr=s.offsetSdr,e.material.gamma=s.gamma,e.material.hdrCapacityMin=s.hdrCapacityMin,e.material.hdrCapacityMax=s.hdrCapacityMax,e.material.maxDisplayBoost=Math.pow(2,s.hdrCapacityMax),e.material.needsUpdate=!0,e.render()}}class GainMapLoader extends LoaderBase{load([e,s,a],c,d,b){const _e=this.prepareQuadRenderer();let tt,nt,it;const ot=async()=>{if(tt&&nt&&it){try{await this.render(_e,it,tt,nt)}catch(_t){this.manager.itemError(e),this.manager.itemError(s),this.manager.itemError(a),typeof b=="function"&&b(_t),_e.disposeOnDemandRenderer();return}typeof c=="function"&&c(_e),this.manager.itemEnd(e),this.manager.itemEnd(s),this.manager.itemEnd(a),_e.disposeOnDemandRenderer()}};let at=!0,ct=0,ut=0,ft=!0,dt=0,lt=0,ht=!0,mt=0,xt=0;const St=()=>{if(typeof d=="function"){const _t=ct+dt+mt,vt=ut+lt+xt,Mt=at&&ft&&ht;d(new ProgressEvent("progress",{lengthComputable:Mt,loaded:vt,total:_t}))}};this.manager.itemStart(e),this.manager.itemStart(s),this.manager.itemStart(a);const yt=new FileLoader(this._internalLoadingManager);yt.setResponseType("arraybuffer"),yt.setRequestHeader(this.requestHeader),yt.setPath(this.path),yt.setWithCredentials(this.withCredentials),yt.load(e,async _t=>{if(typeof _t=="string")throw new Error("Invalid sdr buffer");tt=_t,await ot()},_t=>{at=_t.lengthComputable,ut=_t.loaded,ct=_t.total,St()},_t=>{this.manager.itemError(e),typeof b=="function"&&b(_t)});const wt=new FileLoader(this._internalLoadingManager);wt.setResponseType("arraybuffer"),wt.setRequestHeader(this.requestHeader),wt.setPath(this.path),wt.setWithCredentials(this.withCredentials),wt.load(s,async _t=>{if(typeof _t=="string")throw new Error("Invalid gainmap buffer");nt=_t,await ot()},_t=>{ft=_t.lengthComputable,lt=_t.loaded,dt=_t.total,St()},_t=>{this.manager.itemError(s),typeof b=="function"&&b(_t)});const Et=new FileLoader(this._internalLoadingManager);return Et.setRequestHeader(this.requestHeader),Et.setPath(this.path),Et.setWithCredentials(this.withCredentials),Et.load(a,async _t=>{if(typeof _t!="string")throw new Error("Invalid metadata string");it=JSON.parse(_t),await ot()},_t=>{ht=_t.lengthComputable,xt=_t.loaded,mt=_t.total,St()},_t=>{this.manager.itemError(a),typeof b=="function"&&b(_t)}),_e}}class HDRJPGLoader extends LoaderBase{load(e,s,a,c){const d=this.prepareQuadRenderer(),b=new FileLoader(this._internalLoadingManager);return b.setResponseType("arraybuffer"),b.setRequestHeader(this.requestHeader),b.setPath(this.path),b.setWithCredentials(this.withCredentials),this.manager.itemStart(e),b.load(e,async _e=>{if(typeof _e=="string")throw new Error("Invalid buffer, received [string], was expecting [ArrayBuffer]");const tt=new Uint8Array(_e);let nt,it,ot;try{const at=await extractGainmapFromJPEG(tt);nt=at.sdr,it=at.gainMap,ot=at.metadata}catch(at){if(at instanceof XMPMetadataNotFoundError||at instanceof GainMapNotFoundError)console.warn(`Failure to reconstruct an HDR image from ${e}: Gain map metadata not found in the file, HDRJPGLoader will render the SDR jpeg`),ot={gainMapMin:[0,0,0],gainMapMax:[1,1,1],gamma:[1,1,1],hdrCapacityMin:0,hdrCapacityMax:1,offsetHdr:[0,0,0],offsetSdr:[0,0,0]},nt=tt;else throw at}try{await this.render(d,ot,nt,it)}catch(at){this.manager.itemError(e),typeof c=="function"&&c(at),d.disposeOnDemandRenderer();return}typeof s=="function"&&s(d),this.manager.itemEnd(e),d.disposeOnDemandRenderer()},a,_e=>{this.manager.itemError(e),typeof c=="function"&&c(_e)}),d}}const presetsObj={apartment:"lebombo_1k.hdr",city:"potsdamer_platz_1k.hdr",dawn:"kiara_1_dawn_1k.hdr",forest:"forest_slope_1k.hdr",lobby:"st_fagans_interior_1k.hdr",night:"dikhololo_night_1k.hdr",park:"rooitou_park_1k.hdr",studio:"studio_small_03_1k.hdr",sunset:"venice_sunset_1k.hdr",warehouse:"empty_warehouse_01_1k.hdr"},CUBEMAP_ROOT="https://raw.githack.com/pmndrs/drei-assets/456060a26bbeb8fdf79326f224b6d99b8bcce736/hdri/",isArray=o=>Array.isArray(o),defaultFiles=["/px.png","/nx.png","/py.png","/ny.png","/pz.png","/nz.png"];function useEnvironment({files:o=defaultFiles,path:e="",preset:s=void 0,encoding:a=void 0,extensions:c}={}){let d=null,b=!1;s&&(validatePreset(s),o=presetsObj[s],e=CUBEMAP_ROOT),b=isArray(o);const{extension:_e,isCubemap:tt}=getExtension(o);if(d=getLoader(_e),!d)throw new Error("useEnvironment: Unrecognized file extension: "+o);const nt=useThree(ct=>ct.gl);reactExports.useLayoutEffect(()=>{if(_e!=="webp"&&_e!=="jpg"&&_e!=="jpeg")return;function ct(){useLoader.clear(d,b?[o]:o)}nt.domElement.addEventListener("webglcontextlost",ct,{once:!0})},[o,nt.domElement]);const it=useLoader(d,b?[o]:o,ct=>{(_e==="webp"||_e==="jpg"||_e==="jpeg")&&ct.setRenderer(nt),ct.setPath==null||ct.setPath(e),c&&c(ct)});let ot=b?it[0]:it;if(_e==="jpg"||_e==="jpeg"||_e==="webp"){var at;ot=(at=ot.renderTarget)==null?void 0:at.texture}return ot.mapping=tt?CubeReflectionMapping:EquirectangularReflectionMapping,"colorSpace"in ot?ot.colorSpace=a??tt?"srgb":"srgb-linear":ot.encoding=a??tt?sRGBEncoding:LinearEncoding,ot}const preloadDefaultOptions={files:defaultFiles,path:"",preset:void 0,extensions:void 0};useEnvironment.preload=o=>{const e={...preloadDefaultOptions,...o};let{files:s,path:a=""}=e;const{preset:c,extensions:d}=e;c&&(validatePreset(c),s=presetsObj[c],a=CUBEMAP_ROOT);const{extension:b}=getExtension(s);if(b==="webp"||b==="jpg"||b==="jpeg")throw new Error("useEnvironment: Preloading gainmaps is not supported");const _e=getLoader(b);if(!_e)throw new Error("useEnvironment: Unrecognized file extension: "+s);useLoader.preload(_e,isArray(s)?[s]:s,tt=>{tt.setPath==null||tt.setPath(a),d&&d(tt)})};const clearDefaultOptins={files:defaultFiles,preset:void 0};useEnvironment.clear=o=>{const e={...clearDefaultOptins,...o};let{files:s}=e;const{preset:a}=e;a&&(validatePreset(a),s=presetsObj[a]);const{extension:c}=getExtension(s),d=getLoader(c);if(!d)throw new Error("useEnvironment: Unrecognized file extension: "+s);useLoader.clear(d,isArray(s)?[s]:s)};function validatePreset(o){if(!(o in presetsObj))throw new Error("Preset must be one of: "+Object.keys(presetsObj).join(", "))}function getExtension(o){var e;const s=isArray(o)&&o.length===6,a=isArray(o)&&o.length===3&&o.some(b=>b.endsWith("json")),c=isArray(o)?o[0]:o;return{extension:s?"cube":a?"webp":c.startsWith("data:application/exr")?"exr":c.startsWith("data:application/hdr")?"hdr":c.startsWith("data:image/jpeg")?"jpg":(e=c.split(".").pop())==null||(e=e.split("?"))==null||(e=e.shift())==null?void 0:e.toLowerCase(),isCubemap:s,isGainmap:a}}function getLoader(o){return o==="cube"?CubeTextureLoader:o==="hdr"?RGBELoader:o==="exr"?EXRLoader:o==="jpg"||o==="jpeg"?HDRJPGLoader:o==="webp"?GainMapLoader:null}const isRef=o=>o.current&&o.current.isScene,resolveScene=o=>isRef(o)?o.current:o;function setEnvProps(o,e,s,a,c={}){var d,b,_e,tt;c={backgroundBlurriness:0,backgroundIntensity:1,backgroundRotation:[0,0,0],environmentIntensity:1,environmentRotation:[0,0,0],...c};const nt=resolveScene(e||s),it=nt.background,ot=nt.environment,at={backgroundBlurriness:nt.backgroundBlurriness,backgroundIntensity:nt.backgroundIntensity,backgroundRotation:(d=(b=nt.backgroundRotation)==null||b.clone==null?void 0:b.clone())!==null&&d!==void 0?d:[0,0,0],environmentIntensity:nt.environmentIntensity,environmentRotation:(_e=(tt=nt.environmentRotation)==null||tt.clone==null?void 0:tt.clone())!==null&&_e!==void 0?_e:[0,0,0]};return o!=="only"&&(nt.environment=a),o&&(nt.background=a),applyProps(nt,c),()=>{o!=="only"&&(nt.environment=ot),o&&(nt.background=it),applyProps(nt,at)}}function EnvironmentMap({scene:o,background:e=!1,map:s,...a}){const c=useThree(d=>d.scene);return reactExports.useLayoutEffect(()=>{if(s)return setEnvProps(e,o,c,s,a)}),null}function EnvironmentCube({background:o=!1,scene:e,blur:s,backgroundBlurriness:a,backgroundIntensity:c,backgroundRotation:d,environmentIntensity:b,environmentRotation:_e,...tt}){const nt=useEnvironment(tt),it=useThree(ot=>ot.scene);return reactExports.useLayoutEffect(()=>setEnvProps(o,e,it,nt,{backgroundBlurriness:s??a,backgroundIntensity:c,backgroundRotation:d,environmentIntensity:b,environmentRotation:_e})),reactExports.useEffect(()=>()=>{nt.dispose()},[nt]),null}function EnvironmentPortal({children:o,near:e=.1,far:s=1e3,resolution:a=256,frames:c=1,map:d,background:b=!1,blur:_e,backgroundBlurriness:tt,backgroundIntensity:nt,backgroundRotation:it,environmentIntensity:ot,environmentRotation:at,scene:ct,files:ut,path:ft,preset:dt=void 0,extensions:lt}){const ht=useThree(Et=>Et.gl),mt=useThree(Et=>Et.scene),xt=reactExports.useRef(null),[St]=reactExports.useState(()=>new Scene),yt=reactExports.useMemo(()=>{const Et=new WebGLCubeRenderTarget(a);return Et.texture.type=HalfFloatType,Et},[a]);reactExports.useEffect(()=>()=>{yt.dispose()},[yt]),reactExports.useLayoutEffect(()=>{if(c===1){const Et=ht.autoClear;ht.autoClear=!0,xt.current.update(ht,St),ht.autoClear=Et}return setEnvProps(b,ct,mt,yt.texture,{backgroundBlurriness:_e??tt,backgroundIntensity:nt,backgroundRotation:it,environmentIntensity:ot,environmentRotation:at})},[o,St,yt.texture,ct,mt,b,c,ht]);let wt=1;return useFrame(()=>{if(c===1/0||wt<c){const Et=ht.autoClear;ht.autoClear=!0,xt.current.update(ht,St),ht.autoClear=Et,wt++}}),reactExports.createElement(reactExports.Fragment,null,createPortal(reactExports.createElement(reactExports.Fragment,null,o,reactExports.createElement("cubeCamera",{ref:xt,args:[e,s,yt]}),ut||dt?reactExports.createElement(EnvironmentCube,{background:!0,files:ut,preset:dt,path:ft,extensions:lt}):d?reactExports.createElement(EnvironmentMap,{background:!0,map:d,extensions:lt}):null),St))}function EnvironmentGround(o){var e,s,a,c;const d=useEnvironment(o),b=o.map||d;reactExports.useMemo(()=>extend({GroundProjectedEnvImpl:GroundProjectedEnv}),[]),reactExports.useEffect(()=>()=>{d.dispose()},[d]);const _e=reactExports.useMemo(()=>[b],[b]),tt=(e=o.ground)==null?void 0:e.height,nt=(s=o.ground)==null?void 0:s.radius,it=(a=(c=o.ground)==null?void 0:c.scale)!==null&&a!==void 0?a:1e3;return reactExports.createElement(reactExports.Fragment,null,reactExports.createElement(EnvironmentMap,_extends({},o,{map:b})),reactExports.createElement("groundProjectedEnvImpl",{args:_e,scale:it,height:tt,radius:nt}))}function Environment(o){return o.ground?reactExports.createElement(EnvironmentGround,o):o.map?reactExports.createElement(EnvironmentMap,o):o.children?reactExports.createElement(EnvironmentPortal,o):reactExports.createElement(EnvironmentCube,o)}function calcPosFromAngles(o,e,s=new Vector3){const a=Math.PI*(o-.5),c=2*Math.PI*(e-.5);return s.x=Math.cos(c),s.y=Math.sin(a),s.z=Math.sin(c),s}const Sky=reactExports.forwardRef(({inclination:o=.6,azimuth:e=.1,distance:s=1e3,mieCoefficient:a=.005,mieDirectionalG:c=.8,rayleigh:d=.5,turbidity:b=10,sunPosition:_e=calcPosFromAngles(o,e),...tt},nt)=>{const it=reactExports.useMemo(()=>new Vector3().setScalar(s),[s]),[ot]=reactExports.useState(()=>new Sky$1);return reactExports.createElement("primitive",_extends({object:ot,ref:nt,"material-uniforms-mieCoefficient-value":a,"material-uniforms-mieDirectionalG-value":c,"material-uniforms-rayleigh-value":d,"material-uniforms-sunPosition-value":_e,"material-uniforms-turbidity-value":b,scale:it},tt))}),BLOCK_COLORS={grass:"#4a7c23",dirt:"#8b6914",stone:"#888888",wood:"#8b5a2b",leaves:"#228b22",sand:"#f4d03f",water:"#1e90ff",brick:"#b22222",glass:"#add8e6",coal:"#2f2f2f",iron:"#c0c0c0",gold:"#ffd700",diamond:"#00ffff",bedrock:"#1a1a1a"},CHUNK_SIZE=16,RENDER_DISTANCE=3,PLAYER_SPEED$3=6,SPRINT_MULTIPLIER$1=1.5,JUMP_FORCE$1=8,GRAVITY$2=20;function generateChunk(o,e){const s=[],a=o*CHUNK_SIZE,c=e*CHUNK_SIZE;for(let d=0;d<CHUNK_SIZE;d++)for(let b=0;b<CHUNK_SIZE;b++){const _e=a+d,tt=c+b,nt=Math.floor(20+Math.sin(_e*.05)*5+Math.cos(tt*.05)*5+Math.sin((_e+tt)*.02)*8+Math.sin(_e*.15)*Math.cos(tt*.15)*3);s.push({position:[_e,0,tt],type:"bedrock"});for(let it=1;it<nt-4;it++){let ot="stone";it<10&&Math.random()<.05&&(ot="coal"),it<15&&it>5&&Math.random()<.02&&(ot="iron"),it<10&&Math.random()<.005&&(ot="gold"),it<8&&Math.random()<.002&&(ot="diamond"),s.push({position:[_e,it,tt],type:ot})}for(let it=Math.max(1,nt-4);it<nt;it++)s.push({position:[_e,it,tt],type:"dirt"});nt>15?s.push({position:[_e,nt,tt],type:"grass"}):s.push({position:[_e,nt,tt],type:"sand"});for(let it=nt+1;it<=12;it++)s.push({position:[_e,it,tt],type:"water"});if(nt>18&&Math.random()<.02){const it=4+Math.floor(Math.random()*3);for(let ot=1;ot<=it;ot++)s.push({position:[_e,nt+ot,tt],type:"wood"});for(let ot=-2;ot<=2;ot++)for(let at=-2;at<=2;at++)for(let ct=it-1;ct<=it+2;ct++)Math.abs(ot)+Math.abs(at)+Math.abs(ct-it)<4&&(ot===0&&at===0&&ct<=it||s.push({position:[_e+ot,nt+ct,tt+at],type:"leaves"}))}}return{x:o,z:e,blocks:s}}function BlockMesh({block:o,onBreak:e,onPlace:s}){const a=reactExports.useRef(null),[c,d]=reactExports.useState(!1),b=_e=>{var tt;if(_e.stopPropagation(),_e.button===0)e(o.position);else if(_e.button===2){const nt=(tt=_e.face)==null?void 0:tt.normal;nt&&s(o.position,nt)}};return o.type==="water"?jsxRuntimeExports.jsxs("mesh",{position:o.position,ref:a,children:[jsxRuntimeExports.jsx("boxGeometry",{args:[1,.9,1]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:BLOCK_COLORS[o.type],transparent:!0,opacity:.6})]}):jsxRuntimeExports.jsxs("mesh",{position:o.position,ref:a,onPointerDown:b,onPointerOver:()=>d(!0),onPointerOut:()=>d(!1),children:[jsxRuntimeExports.jsx("boxGeometry",{args:[1,1,1]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:c?"#ffffff":BLOCK_COLORS[o.type],emissive:c?BLOCK_COLORS[o.type]:"#000000",emissiveIntensity:c?.3:0})]})}function ChunkMesh({chunk:o,onBreak:e,onPlace:s}){const a=reactExports.useMemo(()=>{const c=new Map;return o.blocks.forEach(d=>{c.set(`${d.position[0]},${d.position[1]},${d.position[2]}`,d)}),o.blocks.filter(d=>{const[b,_e,tt]=d.position;return[`${b+1},${_e},${tt}`,`${b-1},${_e},${tt}`,`${b},${_e+1},${tt}`,`${b},${_e-1},${tt}`,`${b},${_e},${tt+1}`,`${b},${_e},${tt-1}`].some(it=>!c.has(it))})},[o.blocks]);return jsxRuntimeExports.jsx("group",{children:a.map((c,d)=>jsxRuntimeExports.jsx(BlockMesh,{block:c,onBreak:e,onPlace:s},`${c.position[0]},${c.position[1]},${c.position[2]}`))})}function Player$3({position:o,onPositionChange:e,chunks:s,selectedBlock:a,onBreakBlock:c,onPlaceBlock:d}){const{camera:b,raycaster:_e}=useThree(),[,tt]=useKeyboardControls(),nt=reactExports.useRef(new Vector3),it=reactExports.useRef(o.clone()),ot=reactExports.useRef(!1),at=reactExports.useRef(!0),ct=reactExports.useCallback((ft,dt,lt)=>{const ht=Math.floor(ft/CHUNK_SIZE),mt=Math.floor(lt/CHUNK_SIZE),xt=s.get(`${ht},${mt}`);if(!xt)return null;const St=Math.floor(ft),yt=Math.floor(dt),wt=Math.floor(lt);return xt.blocks.find(Et=>Et.position[0]===St&&Et.position[1]===yt&&Et.position[2]===wt)||null},[s]),ut=reactExports.useCallback(ft=>{const dt=[[ft.x-.3,ft.y,ft.z-.3],[ft.x+.3,ft.y,ft.z-.3],[ft.x-.3,ft.y,ft.z+.3],[ft.x+.3,ft.y,ft.z+.3],[ft.x-.3,ft.y+1,ft.z-.3],[ft.x+.3,ft.y+1,ft.z-.3],[ft.x-.3,ft.y+1,ft.z+.3],[ft.x+.3,ft.y+1,ft.z+.3]];for(const lt of dt){const ht=ct(lt[0],lt[1],lt[2]);if(ht&&ht.type!=="water")return!0}return!1},[ct]);return useFrame((ft,dt)=>{const lt=tt(),ht=lt.sprint?PLAYER_SPEED$3*SPRINT_MULTIPLIER$1:PLAYER_SPEED$3,mt=new Vector3,xt=new Vector3;b.getWorldDirection(mt),mt.y=0,mt.normalize(),xt.crossVectors(mt,new Vector3(0,1,0));const St=new Vector3;if(lt.forward&&St.add(mt),lt.back&&St.sub(mt),lt.left&&St.sub(xt),lt.right&&St.add(xt),St.length()>0){St.normalize();const Et=it.current.clone();Et.x+=St.x*ht*dt,Et.z+=St.z*ht*dt,ut(Et)||(it.current.x=Et.x,it.current.z=Et.z)}lt.jump&&ot.current&&(nt.current.y=JUMP_FORCE$1,ot.current=!1),nt.current.y-=GRAVITY$2*dt;const yt=it.current.y+nt.current.y*dt,wt=ct(it.current.x,yt-.1,it.current.z);wt&&wt.type!=="water"&&nt.current.y<0?(it.current.y=Math.floor(yt)+1.6,nt.current.y=0,ot.current=!0):(it.current.y=yt,nt.current.y<0&&(ot.current=!1)),it.current.y<-10&&(it.current.set(0,30,0),nt.current.set(0,0,0)),b.position.copy(it.current),e(it.current.clone())}),reactExports.useEffect(()=>{const ft=dt=>{if(!at.current)return;const lt=new Vector3;b.getWorldDirection(lt),_e.set(b.position,lt);const ht=[],mt=b.parent;mt&&mt.traverse(St=>{St instanceof Mesh&&St.geometry instanceof BoxGeometry&&ht.push(St)});const xt=_e.intersectObjects(ht,!1);if(xt.length>0&&xt[0].distance<5){const St=xt[0],yt=[Math.round(St.object.position.x),Math.round(St.object.position.y),Math.round(St.object.position.z)];if(dt.button===0)c(yt),at.current=!1,setTimeout(()=>{at.current=!0},250);else if(dt.button===2&&St.face){const wt=[yt[0]+Math.round(St.face.normal.x),yt[1]+Math.round(St.face.normal.y),yt[2]+Math.round(St.face.normal.z)];d(wt,a),at.current=!1,setTimeout(()=>{at.current=!0},250)}}};return window.addEventListener("mousedown",ft),()=>window.removeEventListener("mousedown",ft)},[b,_e,c,d,a]),null}function GameWorld$4({chunks:o,onBreakBlock:e,onPlaceBlock:s,playerPosition:a,onPlayerPositionChange:c,selectedBlock:d}){const b=reactExports.useCallback(tt=>{e(tt)},[e]),_e=reactExports.useCallback((tt,nt)=>{const it=[tt[0]+Math.round(nt.x),tt[1]+Math.round(nt.y),tt[2]+Math.round(nt.z)];s(it,d)},[s,d]);return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("ambientLight",{intensity:.4}),jsxRuntimeExports.jsx("directionalLight",{position:[100,100,50],intensity:1,castShadow:!0,"shadow-mapSize":[2048,2048]}),jsxRuntimeExports.jsx("hemisphereLight",{intensity:.3,color:"#87ceeb",groundColor:"#8b4513"}),jsxRuntimeExports.jsx(Sky,{sunPosition:[100,50,100],turbidity:10,rayleigh:.5,mieCoefficient:.005,mieDirectionalG:.8}),jsxRuntimeExports.jsx("fog",{attach:"fog",args:["#87ceeb",50,200]}),Array.from(o.values()).map(tt=>jsxRuntimeExports.jsx(ChunkMesh,{chunk:tt,onBreak:b,onPlace:_e},`${tt.x},${tt.z}`)),jsxRuntimeExports.jsx(Player$3,{position:a,onPositionChange:c,chunks:o,selectedBlock:d,onBreakBlock:e,onPlaceBlock:s}),jsxRuntimeExports.jsx(PointerLockControls,{})]})}function GameUI$6({inventory:o,selectedSlot:e,onSelectSlot:s,playerPosition:a,health:c,hunger:d}){return jsxRuntimeExports.jsxs("div",{className:"absolute inset-0 pointer-events-none select-none",children:[jsxRuntimeExports.jsxs("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2",children:[jsxRuntimeExports.jsx("div",{className:"w-6 h-0.5 bg-white/80 absolute -left-3"}),jsxRuntimeExports.jsx("div",{className:"h-6 w-0.5 bg-white/80 absolute -top-3"})]}),jsxRuntimeExports.jsx("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 flex gap-1 pointer-events-auto",children:o.slice(0,9).map((b,_e)=>jsxRuntimeExports.jsx("div",{onClick:()=>s(_e),className:`w-12 h-12 border-2 flex items-center justify-center cursor-pointer transition-all ${_e===e?"border-white bg-white/20":"border-gray-600 bg-black/60 hover:border-gray-400"}`,children:b.type&&jsxRuntimeExports.jsxs("div",{className:"relative w-full h-full flex items-center justify-center",children:[jsxRuntimeExports.jsx("div",{className:"w-8 h-8 rounded",style:{backgroundColor:BLOCK_COLORS[b.type]}}),b.count>1&&jsxRuntimeExports.jsx("span",{className:"absolute bottom-0 right-1 text-white text-xs font-bold",children:b.count})]})},_e))}),jsxRuntimeExports.jsxs("div",{className:"absolute bottom-20 left-1/2 transform -translate-x-1/2",children:[jsxRuntimeExports.jsx("div",{className:"flex gap-1 mb-1",children:Array.from({length:10}).map((b,_e)=>jsxRuntimeExports.jsx("div",{className:`w-5 h-5 ${_e<Math.ceil(c/10)?"text-red-500":"text-gray-600"}`,children:""},_e))}),jsxRuntimeExports.jsx("div",{className:"flex gap-1",children:Array.from({length:10}).map((b,_e)=>jsxRuntimeExports.jsx("div",{className:`w-5 h-5 ${_e<Math.ceil(d/10)?"text-yellow-600":"text-gray-600"}`,children:""},_e))})]}),jsxRuntimeExports.jsxs("div",{className:"absolute top-4 left-4 bg-black/70 text-white p-3 rounded font-mono text-sm",children:[jsxRuntimeExports.jsxs("div",{children:["X: ",Math.floor(a.x)]}),jsxRuntimeExports.jsxs("div",{children:["Y: ",Math.floor(a.y)]}),jsxRuntimeExports.jsxs("div",{children:["Z: ",Math.floor(a.z)]})]}),jsxRuntimeExports.jsxs("div",{className:"absolute top-4 right-4 bg-black/70 text-white p-3 rounded text-sm",children:[jsxRuntimeExports.jsx("div",{className:"text-[#c9a227] font-bold mb-2",children:"Controls"}),jsxRuntimeExports.jsx("div",{children:"WASD - Move"}),jsxRuntimeExports.jsx("div",{children:"SPACE - Jump"}),jsxRuntimeExports.jsx("div",{children:"SHIFT - Sprint"}),jsxRuntimeExports.jsx("div",{children:"1-9 - Select Block"}),jsxRuntimeExports.jsx("div",{children:"Left Click - Break"}),jsxRuntimeExports.jsx("div",{children:"Right Click - Place"})]})]})}const keyMap$6=[{name:"forward",keys:["ArrowUp","KeyW"]},{name:"back",keys:["ArrowDown","KeyS"]},{name:"left",keys:["ArrowLeft","KeyA"]},{name:"right",keys:["ArrowRight","KeyD"]},{name:"jump",keys:["Space"]},{name:"sprint",keys:["ShiftLeft","ShiftRight"]},{name:"slot1",keys:["Digit1"]},{name:"slot2",keys:["Digit2"]},{name:"slot3",keys:["Digit3"]},{name:"slot4",keys:["Digit4"]},{name:"slot5",keys:["Digit5"]},{name:"slot6",keys:["Digit6"]},{name:"slot7",keys:["Digit7"]},{name:"slot8",keys:["Digit8"]},{name:"slot9",keys:["Digit9"]},{name:"inventory",keys:["KeyE"]}],GrudaChainBox=()=>{var mt;const[o,e]=reactExports.useState("menu"),[s,a]=reactExports.useState(new Map),[c,d]=reactExports.useState(new Vector3(0,30,0)),[b,_e]=reactExports.useState([{type:"grass",count:64},{type:"dirt",count:64},{type:"stone",count:64},{type:"wood",count:64},{type:"brick",count:64},{type:"glass",count:64},{type:"sand",count:64},{type:"leaves",count:64},{type:null,count:0},...Array(27).fill({type:null,count:0})]),[tt,nt]=reactExports.useState(0),[it,ot]=reactExports.useState(100),[at,ct]=reactExports.useState(100),ut=reactExports.useCallback(()=>{const xt=new Map;for(let St=-RENDER_DISTANCE;St<=RENDER_DISTANCE;St++)for(let yt=-RENDER_DISTANCE;yt<=RENDER_DISTANCE;yt++){const wt=generateChunk(St,yt);xt.set(`${St},${yt}`,wt)}a(xt)},[]),ft=reactExports.useCallback(xt=>{const St=Math.floor(xt[0]/CHUNK_SIZE),yt=Math.floor(xt[2]/CHUNK_SIZE),wt=`${St},${yt}`;a(Et=>{const _t=new Map(Et),vt=_t.get(wt);if(vt){const Mt=vt.blocks.findIndex(jt=>jt.position[0]===xt[0]&&jt.position[1]===xt[1]&&jt.position[2]===xt[2]);if(Mt!==-1){const jt=vt.blocks[Mt];if(jt.type!=="bedrock"){const Lt=[...vt.blocks];Lt.splice(Mt,1),_t.set(wt,{...vt,blocks:Lt}),_e(Nt=>{const kt=[...Nt],Ot=kt.findIndex(Ht=>Ht.type===jt.type&&Ht.count<64);if(Ot!==-1)kt[Ot]={...kt[Ot],count:kt[Ot].count+1};else{const Ht=kt.findIndex(Ct=>Ct.type===null);Ht!==-1&&(kt[Ht]={type:jt.type,count:1})}return kt})}}}return _t})},[]),dt=reactExports.useCallback((xt,St)=>{const yt=b[tt];if(!yt.type||yt.count<=0)return;const wt=Math.floor(xt[0]/CHUNK_SIZE),Et=Math.floor(xt[2]/CHUNK_SIZE),_t=`${wt},${Et}`;a(vt=>{const Mt=new Map(vt),jt=Mt.get(_t);if(jt&&!jt.blocks.some(Nt=>Nt.position[0]===xt[0]&&Nt.position[1]===xt[1]&&Nt.position[2]===xt[2])){const Nt=[...jt.blocks,{position:xt,type:yt.type}];Mt.set(_t,{...jt,blocks:Nt}),_e(kt=>{const Ot=[...kt];return Ot[tt]={...Ot[tt],count:Ot[tt].count-1,type:Ot[tt].count-1<=0?null:Ot[tt].type},Ot})}return Mt})},[b,tt]);reactExports.useEffect(()=>{const xt=St=>{if(St.code.startsWith("Digit")){const yt=parseInt(St.code.replace("Digit",""));yt>=1&&yt<=9&&nt(yt-1)}St.code==="Escape"&&o==="playing"&&e("paused")};return window.addEventListener("keydown",xt),()=>window.removeEventListener("keydown",xt)},[o]);const lt=reactExports.useCallback(()=>{ut(),d(new Vector3(0,30,0)),ot(100),ct(100),e("playing")},[ut]);if(o==="menu")return jsxRuntimeExports.jsxs("div",{className:"w-full h-full bg-gradient-to-b from-[#1a5a5a] via-[#0a0a0a] to-[#0a0a0a] flex flex-col items-center justify-center",children:[jsxRuntimeExports.jsx("h1",{className:"text-6xl font-black text-white mb-2",style:{textShadow:"0 0 30px #c9a227"},children:"GRUDA CHAIN BOX"}),jsxRuntimeExports.jsx("p",{className:"text-xl text-[#c9a227] mb-8",children:"Build  Mine  Survive"}),jsxRuntimeExports.jsx("button",{onClick:lt,className:"px-10 py-4 bg-gradient-to-r from-[#c9a227] to-[#a88b1f] hover:from-[#d4b02f] hover:to-[#b8991f] text-black text-xl font-bold rounded-lg transition-all transform hover:scale-105",children:"NEW WORLD"}),jsxRuntimeExports.jsxs("div",{className:"mt-8 text-white/70 text-sm text-center max-w-md",children:[jsxRuntimeExports.jsx("p",{className:"mb-2",children:"A voxel building game"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-2 text-left bg-black/30 p-4 rounded-lg mt-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"text-[#c9a227]",children:"WASD"})," - Move"]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"text-[#c9a227]",children:"SPACE"})," - Jump"]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"text-[#c9a227]",children:"SHIFT"})," - Sprint"]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"text-[#c9a227]",children:"1-9"})," - Select Block"]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"text-[#c9a227]",children:"Left Click"})," - Break"]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"text-[#c9a227]",children:"Right Click"})," - Place"]})]})]})]});if(o==="paused")return jsxRuntimeExports.jsxs("div",{className:"w-full h-full bg-black/80 flex flex-col items-center justify-center",children:[jsxRuntimeExports.jsx("h2",{className:"text-4xl font-bold text-white mb-8",children:"PAUSED"}),jsxRuntimeExports.jsx("button",{onClick:()=>e("playing"),className:"px-8 py-3 bg-[#1a5a5a] hover:bg-[#2a7a7a] text-white text-lg font-bold rounded-lg mb-4",children:"Resume"}),jsxRuntimeExports.jsx("button",{onClick:()=>e("menu"),className:"px-8 py-3 bg-gray-700 hover:bg-gray-600 text-white text-lg font-bold rounded-lg",children:"Main Menu"})]});const ht=((mt=b[tt])==null?void 0:mt.type)||"dirt";return jsxRuntimeExports.jsxs("div",{className:"w-full h-full relative bg-black",children:[jsxRuntimeExports.jsx(KeyboardControls,{map:keyMap$6,children:jsxRuntimeExports.jsx(Canvas,{shadows:!0,camera:{fov:70,near:.1,far:500},gl:{antialias:!0},onContextMenu:xt=>xt.preventDefault(),children:jsxRuntimeExports.jsx(GameWorld$4,{chunks:s,onBreakBlock:ft,onPlaceBlock:dt,playerPosition:c,onPlayerPositionChange:d,selectedBlock:ht})})}),jsxRuntimeExports.jsx(GameUI$6,{inventory:b,selectedSlot:tt,onSelectSlot:nt,playerPosition:c,health:it,hunger:at})]})},generateId=()=>`obj_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,useGameForge=create$1((o,e)=>({project:null,sceneObjects:{},selectedObjectIds:[],visualScripts:[],currentScript:null,assets:[],activeTool:"select",activeView:"scene",isPlaying:!1,isPaused:!1,gridVisible:!0,gridSize:1,snapToGrid:!0,undoStack:[],redoStack:[],setProject:s=>o({project:s}),addSceneObject:s=>o(a=>({sceneObjects:{...a.sceneObjects,[s.id]:s}})),updateSceneObject:(s,a)=>o(c=>({sceneObjects:{...c.sceneObjects,[s]:{...c.sceneObjects[s],...a}}})),removeSceneObject:s=>o(a=>{const{[s]:c,...d}=a.sceneObjects;return{sceneObjects:d,selectedObjectIds:a.selectedObjectIds.filter(b=>b!==s)}}),duplicateSceneObject:s=>{const c=e().sceneObjects[s];if(!c)return"";const d=generateId(),b={...c,id:d,name:`${c.name} (Copy)`,position:[c.position[0]+1,c.position[1],c.position[2]]};return o(_e=>({sceneObjects:{..._e.sceneObjects,[d]:b}})),d},selectObject:(s,a=!1)=>o(c=>({selectedObjectIds:a?c.selectedObjectIds.includes(s)?c.selectedObjectIds.filter(d=>d!==s):[...c.selectedObjectIds,s]:[s]})),deselectAll:()=>o({selectedObjectIds:[]}),setActiveTool:s=>o({activeTool:s}),setActiveView:s=>o({activeView:s}),play:()=>o({isPlaying:!0,isPaused:!1}),pause:()=>o({isPaused:!0}),stop:()=>o({isPlaying:!1,isPaused:!1}),addVisualScript:s=>o(a=>({visualScripts:[...a.visualScripts,s]})),updateVisualScript:(s,a)=>o(c=>({visualScripts:c.visualScripts.map(d=>d.id===s?{...d,...a}:d)})),setCurrentScript:s=>o({currentScript:s}),addNode:(s,a)=>o(c=>({visualScripts:c.visualScripts.map(d=>d.id===s?{...d,nodes:[...d.nodes,a]}:d)})),updateNode:(s,a,c)=>o(d=>({visualScripts:d.visualScripts.map(b=>b.id===s?{...b,nodes:b.nodes.map(_e=>_e.id===a?{..._e,...c}:_e)}:b)})),removeNode:(s,a)=>o(c=>({visualScripts:c.visualScripts.map(d=>d.id===s?{...d,nodes:d.nodes.filter(b=>b.id!==a),connections:d.connections.filter(b=>b.fromNode!==a&&b.toNode!==a)}:d)})),addConnection:(s,a)=>o(c=>({visualScripts:c.visualScripts.map(d=>d.id===s?{...d,connections:[...d.connections,a]}:d)})),removeConnection:(s,a)=>o(c=>({visualScripts:c.visualScripts.map(d=>d.id===s?{...d,connections:d.connections.filter(b=>b.id!==a)}:d)})),addAsset:s=>o(a=>({assets:[...a.assets,s]})),removeAsset:s=>o(a=>({assets:a.assets.filter(c=>c.id!==s)})),toggleGrid:()=>o(s=>({gridVisible:!s.gridVisible})),setGridSize:s=>o({gridSize:s}),toggleSnap:()=>o(s=>({snapToGrid:!s.snapToGrid})),undo:()=>{const{undoStack:s}=e();s.length},redo:()=>{const{redoStack:s}=e();s.length}})),NODE_LIBRARY={onStart:{type:"onStart",category:"event",inputs:[],outputs:[{id:"flow",name:"Start",type:"flow"}],properties:{}},onUpdate:{type:"onUpdate",category:"event",inputs:[],outputs:[{id:"flow",name:"Update",type:"flow"},{id:"deltaTime",name:"Delta Time",type:"number"}],properties:{}},onKeyPress:{type:"onKeyPress",category:"event",inputs:[],outputs:[{id:"flow",name:"Pressed",type:"flow"}],properties:{key:"Space"}},onCollision:{type:"onCollision",category:"event",inputs:[],outputs:[{id:"flow",name:"Collision",type:"flow"},{id:"other",name:"Other Object",type:"object"}],properties:{}},move:{type:"move",category:"action",inputs:[{id:"flow",name:"Execute",type:"flow"},{id:"direction",name:"Direction",type:"vector3"},{id:"speed",name:"Speed",type:"number"}],outputs:[{id:"flow",name:"Done",type:"flow"}],properties:{speed:5}},rotate:{type:"rotate",category:"action",inputs:[{id:"flow",name:"Execute",type:"flow"},{id:"rotation",name:"Rotation",type:"vector3"}],outputs:[{id:"flow",name:"Done",type:"flow"}],properties:{}},playSound:{type:"playSound",category:"action",inputs:[{id:"flow",name:"Execute",type:"flow"},{id:"sound",name:"Sound",type:"string"}],outputs:[{id:"flow",name:"Done",type:"flow"}],properties:{volume:1}},spawnObject:{type:"spawnObject",category:"action",inputs:[{id:"flow",name:"Execute",type:"flow"},{id:"prefab",name:"Prefab",type:"object"},{id:"position",name:"Position",type:"vector3"}],outputs:[{id:"flow",name:"Done",type:"flow"},{id:"spawned",name:"Spawned Object",type:"object"}],properties:{}},destroyObject:{type:"destroyObject",category:"action",inputs:[{id:"flow",name:"Execute",type:"flow"},{id:"target",name:"Target",type:"object"}],outputs:[{id:"flow",name:"Done",type:"flow"}],properties:{}},branch:{type:"branch",category:"logic",inputs:[{id:"flow",name:"Execute",type:"flow"},{id:"condition",name:"Condition",type:"boolean"}],outputs:[{id:"true",name:"True",type:"flow"},{id:"false",name:"False",type:"flow"}],properties:{}},loop:{type:"loop",category:"logic",inputs:[{id:"flow",name:"Execute",type:"flow"},{id:"count",name:"Count",type:"number"}],outputs:[{id:"loop",name:"Loop Body",type:"flow"},{id:"index",name:"Index",type:"number"},{id:"completed",name:"Completed",type:"flow"}],properties:{count:10}},delay:{type:"delay",category:"logic",inputs:[{id:"flow",name:"Execute",type:"flow"},{id:"seconds",name:"Seconds",type:"number"}],outputs:[{id:"flow",name:"After Delay",type:"flow"}],properties:{seconds:1}},add:{type:"add",category:"math",inputs:[{id:"a",name:"A",type:"number"},{id:"b",name:"B",type:"number"}],outputs:[{id:"result",name:"Result",type:"number"}],properties:{}},multiply:{type:"multiply",category:"math",inputs:[{id:"a",name:"A",type:"number"},{id:"b",name:"B",type:"number"}],outputs:[{id:"result",name:"Result",type:"number"}],properties:{}},random:{type:"random",category:"math",inputs:[{id:"min",name:"Min",type:"number"},{id:"max",name:"Max",type:"number"}],outputs:[{id:"result",name:"Result",type:"number"}],properties:{min:0,max:1}},getVariable:{type:"getVariable",category:"variable",inputs:[],outputs:[{id:"value",name:"Value",type:"number"}],properties:{name:"myVariable",type:"number"}},setVariable:{type:"setVariable",category:"variable",inputs:[{id:"flow",name:"Execute",type:"flow"},{id:"value",name:"Value",type:"number"}],outputs:[{id:"flow",name:"Done",type:"flow"}],properties:{name:"myVariable"}}};function SceneObjectMesh({object:o,isSelected:e,onSelect:s}){const a=reactExports.useRef(null);reactExports.useEffect(()=>{a.current&&(a.current.position.set(...o.position),a.current.rotation.set(o.rotation[0]*Math.PI/180,o.rotation[1]*Math.PI/180,o.rotation[2]*Math.PI/180),a.current.scale.set(...o.scale))},[o.position,o.rotation,o.scale]);const c=reactExports.useMemo(()=>{switch(o.geometry){case"sphere":return new SphereGeometry(.5,32,32);case"cylinder":return new CylinderGeometry(.5,.5,1,32);case"cone":return new ConeGeometry(.5,1,32);case"torus":return new TorusGeometry(.5,.2,16,32);case"plane":return new PlaneGeometry(1,1);default:return new BoxGeometry(1,1,1)}},[o.geometry]),d=reactExports.useMemo(()=>{const b=o.material||{type:"standard",color:"#4a90d9"},_e={color:b.color||"#4a90d9"};return(b.type==="standard"||b.type==="physical")&&(_e.metalness=b.metalness??.3,_e.roughness=b.roughness??.7),b.emissive&&(_e.emissive=b.emissive,_e.emissiveIntensity=b.emissiveIntensity??1),new MeshStandardMaterial(_e)},[o.material]);return jsxRuntimeExports.jsx("mesh",{ref:a,position:o.position,rotation:o.rotation.map(b=>b*Math.PI/180),scale:o.scale,geometry:c,material:d,visible:o.visible,onClick:b=>{b.stopPropagation(),s(o.id)},castShadow:!0,receiveShadow:!0,children:e&&jsxRuntimeExports.jsx(Html,{position:[0,1.5,0],center:!0,children:jsxRuntimeExports.jsx("div",{className:"bg-blue-600 text-white text-xs px-2 py-1 rounded shadow-lg whitespace-nowrap",children:o.name})})})}function TransformGizmo({selectedObjects:o,tool:e,onTransformChange:s}){const a=reactExports.useRef(null),c=reactExports.useRef(null);if(o.length===0||e==="select")return null;const d=o[0],b=e==="move"?"translate":e==="rotate"?"rotate":"scale";return jsxRuntimeExports.jsx("group",{ref:a,position:d.position,children:jsxRuntimeExports.jsx(TransformControls,{ref:c,mode:b,onObjectChange:()=>{if(c.current&&a.current){const _e=a.current.position,tt=a.current.rotation,nt=a.current.scale;s(d.id,[_e.x,_e.y,_e.z],[tt.x*180/Math.PI,tt.y*180/Math.PI,tt.z*180/Math.PI],[nt.x,nt.y,nt.z])}}})})}function SceneContent(){const{sceneObjects:o,selectedObjectIds:e,activeTool:s,selectObject:a,updateSceneObject:c,gridVisible:d,gridSize:b}=useGameForge(),_e=reactExports.useMemo(()=>e.map(nt=>o[nt]).filter(Boolean),[e,o]),tt=reactExports.useCallback((nt,it,ot,at)=>{c(nt,{position:it,rotation:ot,scale:at})},[c]);return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("ambientLight",{intensity:.4}),jsxRuntimeExports.jsx("directionalLight",{position:[10,20,10],intensity:1,castShadow:!0,"shadow-mapSize":[2048,2048]}),jsxRuntimeExports.jsx("directionalLight",{position:[-10,10,-10],intensity:.3}),d&&jsxRuntimeExports.jsx(Grid,{args:[100,100],cellSize:b,cellThickness:.5,cellColor:"#666666",sectionSize:b*10,sectionThickness:1,sectionColor:"#888888",fadeDistance:100,fadeStrength:1,followCamera:!1,infiniteGrid:!0}),Object.values(o).map(nt=>jsxRuntimeExports.jsx(SceneObjectMesh,{object:nt,isSelected:e.includes(nt.id),onSelect:a},nt.id)),jsxRuntimeExports.jsx(TransformGizmo,{selectedObjects:_e,tool:s,onTransformChange:tt}),jsxRuntimeExports.jsx(OrbitControls,{makeDefault:!0,enableDamping:!0,dampingFactor:.1,minDistance:1,maxDistance:500}),jsxRuntimeExports.jsx(GizmoHelper,{alignment:"bottom-right",margin:[80,80],children:jsxRuntimeExports.jsx(GizmoViewport,{axisColors:["#ff4444","#44ff44","#4444ff"],labelColor:"white"})})]})}const SceneViewport=({className:o})=>{const{deselectAll:e,isPlaying:s}=useGameForge();return jsxRuntimeExports.jsxs("div",{className:`relative ${o}`,children:[jsxRuntimeExports.jsxs(Canvas,{shadows:!0,camera:{position:[10,10,10],fov:60},onPointerMissed:e,gl:{antialias:!0,alpha:!1},style:{background:s?"#1a1a2e":"#2d2d3a"},children:[jsxRuntimeExports.jsx("color",{attach:"background",args:[s?"#1a1a2e":"#2d2d3a"]}),jsxRuntimeExports.jsx("fog",{attach:"fog",args:[s?"#1a1a2e":"#2d2d3a",50,200]}),jsxRuntimeExports.jsx(SceneContent,{})]}),s&&jsxRuntimeExports.jsx("div",{className:"absolute top-2 left-2 bg-green-600 text-white px-3 py-1 rounded text-sm font-bold",children:" PLAYING"})]})},NODE_COLORS={event:"bg-red-700 border-red-500",action:"bg-blue-700 border-blue-500",logic:"bg-yellow-700 border-yellow-500",variable:"bg-green-700 border-green-500",math:"bg-purple-700 border-purple-500"},PORT_COLORS={flow:"bg-[#c9a227]",boolean:"bg-red-400",number:"bg-green-400",string:"bg-yellow-400",vector3:"bg-blue-400",object:"bg-purple-400"},NodeComponent=({node:o,isSelected:e,onSelect:s,onDragStart:a,onPortClick:c,scale:d})=>{const b=NODE_COLORS[o.category]||"bg-gray-700 border-gray-500";return jsxRuntimeExports.jsxs("div",{className:`absolute rounded-lg border-2 shadow-xl cursor-move select-none ${b} ${e?"ring-2 ring-white":""}`,style:{left:o.position.x*d,top:o.position.y*d,minWidth:180,transform:`scale(${d})`},onMouseDown:_e=>{_e.stopPropagation(),s(o.id),a(o.id,_e)},children:[jsxRuntimeExports.jsx("div",{className:"px-3 py-2 border-b border-white/20 font-bold text-white text-sm uppercase tracking-wide",children:o.type.replace(/([A-Z])/g," $1").trim()}),jsxRuntimeExports.jsx("div",{className:"p-2 space-y-1",children:o.inputs.map(_e=>jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("div",{className:`w-3 h-3 rounded-full cursor-pointer hover:scale-125 transition-transform ${PORT_COLORS[_e.type]}`,onClick:tt=>{tt.stopPropagation(),c(o.id,_e.id,!1)}}),jsxRuntimeExports.jsx("span",{className:"text-white/80 text-xs",children:_e.name})]},_e.id))}),jsxRuntimeExports.jsx("div",{className:"p-2 space-y-1",children:o.outputs.map(_e=>jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-end gap-2",children:[jsxRuntimeExports.jsx("span",{className:"text-white/80 text-xs",children:_e.name}),jsxRuntimeExports.jsx("div",{className:`w-3 h-3 rounded-full cursor-pointer hover:scale-125 transition-transform ${PORT_COLORS[_e.type]}`,onClick:tt=>{tt.stopPropagation(),c(o.id,_e.id,!0)}})]},_e.id))})]})},ConnectionLine=({connection:o,nodes:e,scale:s})=>{const a=e.find(it=>it.id===o.fromNode),c=e.find(it=>it.id===o.toNode);if(!a||!c)return null;const d=(a.position.x+180)*s,b=(a.position.y+50)*s,_e=c.position.x*s,tt=(c.position.y+50)*s,nt=(d+_e)/2;return jsxRuntimeExports.jsx("svg",{className:"absolute inset-0 pointer-events-none",style:{overflow:"visible"},children:jsxRuntimeExports.jsx("path",{d:`M ${d} ${b} C ${nt} ${b}, ${nt} ${tt}, ${_e} ${tt}`,stroke:"white",strokeWidth:2,fill:"none",opacity:.6})})},VisualScriptEditor=({scriptId:o,className:e})=>{const{visualScripts:s,addNode:a,updateNode:c,removeNode:d,addConnection:b,removeConnection:_e}=useGameForge(),[tt,nt]=reactExports.useState(null),[it,ot]=reactExports.useState(null),[at,ct]=reactExports.useState({x:0,y:0}),[ut,ft]=reactExports.useState(null),[dt,lt]=reactExports.useState(1);reactExports.useState({x:0,y:0});const[ht,mt]=reactExports.useState(!1),[xt,St]=reactExports.useState({x:0,y:0}),yt=reactExports.useRef(null),wt=reactExports.useMemo(()=>s.find(Ot=>Ot.id===o),[s,o]),Et=reactExports.useCallback((Ot,Ht)=>{const Ct=wt==null?void 0:wt.nodes.find(Ut=>Ut.id===Ot);Ct&&(ot(Ot),ct({x:Ht.clientX-Ct.position.x*dt,y:Ht.clientY-Ct.position.y*dt}))},[wt,dt]),_t=reactExports.useCallback(Ot=>{if(it){const Ht=(Ot.clientX-at.x)/dt,Ct=(Ot.clientY-at.y)/dt;c(o,it,{position:{x:Ht,y:Ct}})}},[it,at,dt,o,c]),vt=reactExports.useCallback(()=>{ot(null)},[]),Mt=reactExports.useCallback((Ot,Ht,Ct)=>{if(!ut)ft({nodeId:Ot,portId:Ht,isOutput:Ct});else{if(ut.isOutput!==Ct){const Ut=Ct?Ot:ut.nodeId,Gt=Ct?Ht:ut.portId,Pt=Ct?ut.nodeId:Ot,Wt=Ct?ut.portId:Ht;b(o,{id:`conn_${Date.now()}`,fromNode:Ut,fromPort:Gt,toNode:Pt,toPort:Wt})}ft(null)}},[ut,o,b]),jt=reactExports.useCallback(Ot=>{var Ct;Ot.preventDefault();const Ht=(Ct=yt.current)==null?void 0:Ct.getBoundingClientRect();Ht&&(St({x:Ot.clientX-Ht.left,y:Ot.clientY-Ht.top}),mt(!0))},[]),Lt=reactExports.useCallback(Ot=>{const Ht=NODE_LIBRARY[Ot];if(!Ht)return;const Ct={id:`node_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,type:Ot,category:Ht.category,position:{x:xt.x/dt,y:xt.y/dt},inputs:Ht.inputs.map(Ut=>({...Ut})),outputs:Ht.outputs.map(Ut=>({...Ut})),properties:{...Ht.properties}};a(o,Ct),mt(!1)},[o,xt,dt,a]),Nt=reactExports.useCallback(()=>{tt&&(d(o,tt),nt(null))},[tt,o,d]);if(reactExports.useEffect(()=>{const Ot=Ht=>{(Ht.key==="Delete"||Ht.key==="Backspace")&&Nt(),Ht.key==="Escape"&&(ft(null),mt(!1))};return window.addEventListener("keydown",Ot),()=>window.removeEventListener("keydown",Ot)},[Nt]),!wt)return jsxRuntimeExports.jsx("div",{className:`flex items-center justify-center bg-gray-900 text-gray-400 ${e}`,children:"No script selected"});const kt=Object.entries(NODE_LIBRARY).reduce((Ot,[Ht,Ct])=>(Ot[Ct.category]||(Ot[Ct.category]=[]),Ot[Ct.category].push({key:Ht,...Ct}),Ot),{});return jsxRuntimeExports.jsxs("div",{ref:yt,className:`relative overflow-hidden bg-gray-900 ${e}`,style:{backgroundImage:"radial-gradient(circle, #444 1px, transparent 1px)",backgroundSize:`${20*dt}px ${20*dt}px`},onMouseMove:_t,onMouseUp:vt,onMouseLeave:vt,onContextMenu:jt,onClick:()=>mt(!1),children:[wt.connections.map(Ot=>jsxRuntimeExports.jsx(ConnectionLine,{connection:Ot,nodes:wt.nodes,scale:dt},Ot.id)),wt.nodes.map(Ot=>jsxRuntimeExports.jsx(NodeComponent,{node:Ot,isSelected:tt===Ot.id,onSelect:nt,onDragStart:Et,onPortClick:Mt,scale:dt},Ot.id)),ht&&jsxRuntimeExports.jsxs("div",{className:"absolute bg-gray-800 border border-gray-600 rounded-lg shadow-2xl z-50 max-h-80 overflow-y-auto",style:{left:xt.x,top:xt.y},onClick:Ot=>Ot.stopPropagation(),children:[jsxRuntimeExports.jsx("div",{className:"p-2 border-b border-gray-600 text-white font-bold text-sm",children:"Add Node"}),Object.entries(kt).map(([Ot,Ht])=>jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("div",{className:"px-3 py-1 text-gray-400 text-xs uppercase tracking-wide bg-gray-700/50",children:Ot}),Ht.map(Ct=>jsxRuntimeExports.jsx("button",{className:"w-full px-3 py-2 text-left text-white text-sm hover:bg-gray-700 transition-colors",onClick:()=>Lt(Ct.key),children:Ct.key.replace(/([A-Z])/g," $1").trim()},Ct.key))]},Ot))]}),jsxRuntimeExports.jsxs("div",{className:"absolute bottom-2 left-2 flex gap-2",children:[jsxRuntimeExports.jsx("button",{className:"px-3 py-1 bg-gray-700 text-white rounded text-sm hover:bg-gray-600",onClick:()=>lt(Ot=>Math.min(2,Ot+.1)),children:"+"}),jsxRuntimeExports.jsxs("span",{className:"px-3 py-1 bg-gray-800 text-white rounded text-sm",children:[Math.round(dt*100),"%"]}),jsxRuntimeExports.jsx("button",{className:"px-3 py-1 bg-gray-700 text-white rounded text-sm hover:bg-gray-600",onClick:()=>lt(Ot=>Math.max(.25,Ot-.1)),children:"-"})]}),jsxRuntimeExports.jsx("div",{className:"absolute bottom-2 right-2 text-gray-500 text-xs",children:"Right-click to add nodes  Delete to remove"})]})},ASSET_ICONS={model:"",texture:"",audio:"",script:"",prefab:"",world:"",other:""},AssetManager=({className:o,onAssetSelect:e})=>{var Mt,jt,Lt;const{assets:s,addAsset:a,removeAsset:c}=useGameForge(),[d,b]=reactExports.useState([]),[_e,tt]=reactExports.useState(null),[nt,it]=reactExports.useState("all"),[ot,at]=reactExports.useState(""),[ct,ut]=reactExports.useState("grid"),[ft,dt]=reactExports.useState(!1),[lt,ht]=reactExports.useState("cloud"),mt=reactExports.useCallback(async()=>{dt(!0);try{const Nt=nt!=="all"?`?filter=${nt}`:"",kt=await fetch(`/api/assets${Nt}`);if(kt.ok){const Ot=await kt.json();b(Ot)}}catch(Nt){console.error("Failed to load cloud assets:",Nt)}finally{dt(!1)}},[nt]);reactExports.useEffect(()=>{mt()},[mt]);const xt=d.filter(Nt=>!(ot&&!Nt.name.toLowerCase().includes(ot.toLowerCase()))),St=s.filter(Nt=>!(nt!=="all"&&Nt.type!==nt||ot&&!Nt.name.toLowerCase().includes(ot.toLowerCase()))),yt=reactExports.useCallback(async()=>{const Nt=document.createElement("input");Nt.type="file",Nt.multiple=!0,Nt.accept=".glb,.gltf,.fbx,.obj,.png,.jpg,.jpeg,.mp3,.wav,.ogg,.mca,.dat",Nt.onchange=async kt=>{var Ht;const Ot=kt.target.files;if(Ot)for(const Ct of Array.from(Ot)){const Ut=new FormData;Ut.append("file",Ct);try{if((await fetch("/api/assets/upload",{method:"POST",body:Ut})).ok)await mt();else{const Pt=((Ht=Ct.name.split(".").pop())==null?void 0:Ht.toLowerCase())||"";let Wt="model";["png","jpg","jpeg","webp"].includes(Pt)?Wt="texture":["mp3","wav","ogg"].includes(Pt)?Wt="audio":["js","ts","json"].includes(Pt)&&(Wt="script");const sn={id:`asset_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,name:Ct.name,type:Wt,path:URL.createObjectURL(Ct),size:Ct.size,dateAdded:new Date};a(sn)}}catch(Gt){console.error("Upload failed:",Gt)}}},Nt.click()},[a,mt]),wt=reactExports.useCallback(Nt=>{const kt={id:Nt.id,name:Nt.name,type:Nt.type==="world"||Nt.type==="other"?"model":Nt.type,path:Nt.path,size:Nt.size,dateAdded:new Date(Nt.dateAdded)};a(kt),e==null||e(kt)},[a,e]),Et=reactExports.useCallback(async()=>{if(_e)if(lt==="cloud")try{(await fetch(`/api/assets/${_e}`,{method:"DELETE"})).ok&&(await mt(),tt(null))}catch(Nt){console.error("Delete failed:",Nt)}else c(_e),tt(null)},[_e,lt,mt,c]),_t=Nt=>Nt===0?"-":Nt<1024?`${Nt} B`:Nt<1024*1024?`${(Nt/1024).toFixed(1)} KB`:`${(Nt/(1024*1024)).toFixed(1)} MB`,vt=lt==="cloud"?xt:St;return jsxRuntimeExports.jsxs("div",{className:`flex flex-col bg-gray-900 ${o}`,children:[jsxRuntimeExports.jsxs("div",{className:"p-3 border-b border-gray-700 space-y-2",children:[jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[jsxRuntimeExports.jsx("button",{onClick:()=>ht("cloud"),className:`flex-1 px-3 py-2 text-sm rounded font-medium transition-colors ${lt==="cloud"?"bg-blue-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,children:" Cloud Storage"}),jsxRuntimeExports.jsx("button",{onClick:()=>ht("local"),className:`flex-1 px-3 py-2 text-sm rounded font-medium transition-colors ${lt==="local"?"bg-blue-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,children:" Project Assets"})]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[jsxRuntimeExports.jsx("input",{type:"text",placeholder:"Search assets...",value:ot,onChange:Nt=>at(Nt.target.value),className:"flex-1 px-3 py-1 bg-gray-800 border border-gray-600 rounded text-white text-sm focus:outline-none focus:border-blue-500"}),jsxRuntimeExports.jsx("button",{onClick:yt,className:"px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-500 transition-colors",children:"+ Import"}),jsxRuntimeExports.jsx("button",{onClick:mt,className:"px-3 py-1 bg-gray-700 text-white rounded text-sm hover:bg-gray-600 transition-colors",title:"Refresh",children:""})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center",children:[jsxRuntimeExports.jsx("div",{className:"flex gap-1 flex-wrap",children:["all","model","texture","audio","script","world"].map(Nt=>jsxRuntimeExports.jsx("button",{onClick:()=>it(Nt),className:`px-2 py-1 text-xs rounded transition-colors ${nt===Nt?"bg-blue-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,children:Nt==="all"?"All":ASSET_ICONS[Nt]||Nt},Nt))}),jsxRuntimeExports.jsxs("div",{className:"flex gap-1",children:[jsxRuntimeExports.jsx("button",{onClick:()=>ut("grid"),className:`p-1 rounded ${ct==="grid"?"bg-blue-600":"bg-gray-700"}`,children:jsxRuntimeExports.jsx("span",{className:"text-white text-xs",children:""})}),jsxRuntimeExports.jsx("button",{onClick:()=>ut("list"),className:`p-1 rounded ${ct==="list"?"bg-blue-600":"bg-gray-700"}`,children:jsxRuntimeExports.jsx("span",{className:"text-white text-xs",children:""})})]})]})]}),jsxRuntimeExports.jsx("div",{className:"flex-1 overflow-y-auto p-2",children:ft?jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-500",children:[jsxRuntimeExports.jsx("div",{className:"text-4xl mb-2 animate-spin",children:""}),jsxRuntimeExports.jsx("div",{className:"text-sm",children:"Loading assets..."})]}):vt.length===0?jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-500",children:[jsxRuntimeExports.jsx("div",{className:"text-4xl mb-2",children:""}),jsxRuntimeExports.jsx("div",{className:"text-sm",children:"No assets found"}),jsxRuntimeExports.jsx("div",{className:"text-xs mt-1",children:lt==="cloud"?"Import assets or they will appear from cloud storage":"Add assets from cloud storage to use in your project"})]}):ct==="grid"?jsxRuntimeExports.jsx("div",{className:"grid grid-cols-4 gap-2",children:vt.map(Nt=>jsxRuntimeExports.jsxs("div",{onClick:()=>tt(Nt.id),onDoubleClick:()=>wt(Nt),className:`flex flex-col items-center p-2 rounded cursor-pointer transition-colors ${_e===Nt.id?"bg-blue-600/30 ring-2 ring-blue-500":"hover:bg-gray-800"}`,children:[jsxRuntimeExports.jsxs("div",{className:"w-12 h-12 flex items-center justify-center bg-gray-800 rounded mb-1 relative",children:[jsxRuntimeExports.jsx("span",{className:"text-2xl",children:ASSET_ICONS[Nt.type]||""}),"source"in Nt&&Nt.source==="bundled"&&jsxRuntimeExports.jsx("span",{className:"absolute -top-1 -right-1 text-xs",children:""})]}),jsxRuntimeExports.jsx("div",{className:"text-white text-xs text-center truncate w-full",title:Nt.name,children:Nt.name}),jsxRuntimeExports.jsx("div",{className:"text-gray-500 text-[10px]",children:_t(Nt.size)})]},Nt.id))}):jsxRuntimeExports.jsx("div",{className:"space-y-1",children:vt.map(Nt=>jsxRuntimeExports.jsxs("div",{onClick:()=>tt(Nt.id),onDoubleClick:()=>wt(Nt),className:`flex items-center gap-3 p-2 rounded cursor-pointer transition-colors ${_e===Nt.id?"bg-blue-600/30 ring-1 ring-blue-500":"hover:bg-gray-800"}`,children:[jsxRuntimeExports.jsx("span",{className:"text-xl",children:ASSET_ICONS[Nt.type]||""}),jsxRuntimeExports.jsxs("div",{className:"flex-1 min-w-0",children:[jsxRuntimeExports.jsx("div",{className:"text-white text-sm truncate",children:Nt.name}),jsxRuntimeExports.jsxs("div",{className:"text-gray-500 text-xs flex items-center gap-2",children:[jsxRuntimeExports.jsx("span",{children:Nt.type}),"source"in Nt&&jsxRuntimeExports.jsx("span",{className:`px-1 rounded text-[10px] ${Nt.source==="bundled"?"bg-green-600/30":"bg-blue-600/30"}`,children:Nt.source})]})]}),jsxRuntimeExports.jsx("div",{className:"text-gray-500 text-xs",children:_t(Nt.size)})]},Nt.id))})}),_e&&jsxRuntimeExports.jsxs("div",{className:"p-2 border-t border-gray-700 flex justify-between items-center gap-2",children:[jsxRuntimeExports.jsx("div",{className:"text-gray-400 text-xs truncate flex-1",children:(Mt=vt.find(Nt=>Nt.id===_e))==null?void 0:Mt.name}),jsxRuntimeExports.jsx("button",{onClick:()=>{const Nt=vt.find(kt=>kt.id===_e);Nt&&wt(Nt)},className:"px-2 py-1 bg-green-600 text-white rounded text-xs hover:bg-green-500",children:"Use"}),lt==="cloud"&&!((Lt=(jt=vt.find(Nt=>Nt.id===_e))==null?void 0:jt.source)!=null&&Lt.includes("bundled"))&&jsxRuntimeExports.jsx("button",{onClick:Et,className:"px-2 py-1 bg-red-600 text-white rounded text-xs hover:bg-red-500",children:"Delete"}),lt==="local"&&jsxRuntimeExports.jsx("button",{onClick:Et,className:"px-2 py-1 bg-red-600 text-white rounded text-xs hover:bg-red-500",children:"Remove"})]})]})},TreeNode=({object:o,level:e,isSelected:s,onSelect:a,onToggleVisibility:c,onDelete:d,onDuplicate:b})=>{const[_e,tt]=reactExports.useState(!1),nt=ot=>{ot.preventDefault(),tt(!0)},it=()=>{switch(o.type){case"mesh":return"";case"light":return"";case"camera":return"";case"group":return"";case"prefab":return"";default:return""}};return jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsxs("div",{className:`flex items-center gap-1 px-2 py-1 cursor-pointer transition-colors ${s?"bg-blue-600 text-white":"text-gray-300 hover:bg-gray-700"}`,style:{paddingLeft:`${e*16+8}px`},onClick:()=>a(o.id),onContextMenu:nt,children:[jsxRuntimeExports.jsx("span",{className:"text-sm",children:it()}),jsxRuntimeExports.jsx("span",{className:`flex-1 text-sm truncate ${o.locked?"italic opacity-50":""}`,children:o.name}),jsxRuntimeExports.jsx("button",{onClick:ot=>{ot.stopPropagation(),c(o.id)},className:"p-1 hover:bg-gray-600 rounded opacity-50 hover:opacity-100",children:o.visible?"":""})]}),_e&&jsxRuntimeExports.jsxs("div",{className:"absolute left-full top-0 ml-1 bg-gray-800 border border-gray-600 rounded shadow-xl z-50",onMouseLeave:()=>tt(!1),children:[jsxRuntimeExports.jsx("button",{className:"w-full px-4 py-2 text-left text-white text-sm hover:bg-gray-700",onClick:()=>{b(o.id),tt(!1)},children:"Duplicate"}),jsxRuntimeExports.jsx("button",{className:"w-full px-4 py-2 text-left text-red-400 text-sm hover:bg-gray-700",onClick:()=>{d(o.id),tt(!1)},children:"Delete"})]})]})},HierarchyPanel=({className:o})=>{const{sceneObjects:e,selectedObjectIds:s,selectObject:a,updateSceneObject:c,removeSceneObject:d,duplicateSceneObject:b,addSceneObject:_e}=useGameForge(),[tt,nt]=reactExports.useState(""),[it,ot]=reactExports.useState(!1),at=Object.values(e).filter(ut=>!tt||ut.name.toLowerCase().includes(tt.toLowerCase())),ct=reactExports.useCallback((ut,ft)=>{const dt=`obj_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,lt={id:dt,name:`New ${ut}`,type:ut,position:[0,0,0],rotation:[0,0,0],scale:[1,1,1],geometry:ft||"box",material:{type:"standard",color:"#4a90d9",metalness:.3,roughness:.7},visible:!0,locked:!1,components:[]};_e(lt),a(dt),ot(!1)},[_e,a]);return jsxRuntimeExports.jsxs("div",{className:`flex flex-col bg-gray-900 ${o}`,children:[jsxRuntimeExports.jsxs("div",{className:"p-2 border-b border-gray-700 flex gap-2",children:[jsxRuntimeExports.jsx("input",{type:"text",placeholder:"Search...",value:tt,onChange:ut=>nt(ut.target.value),className:"flex-1 px-2 py-1 bg-gray-800 border border-gray-600 rounded text-white text-sm focus:outline-none focus:border-blue-500"}),jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx("button",{onClick:()=>ot(!it),className:"px-3 py-1 bg-green-600 text-white rounded text-sm hover:bg-green-500",children:"+"}),it&&jsxRuntimeExports.jsxs("div",{className:"absolute right-0 top-full mt-1 bg-gray-800 border border-gray-600 rounded shadow-xl z-50 min-w-[160px]",children:[jsxRuntimeExports.jsx("div",{className:"px-3 py-1 text-gray-400 text-xs uppercase border-b border-gray-700",children:"3D Objects"}),["box","sphere","cylinder","cone","torus","plane"].map(ut=>jsxRuntimeExports.jsxs("button",{className:"w-full px-3 py-2 text-left text-white text-sm hover:bg-gray-700 capitalize",onClick:()=>ct("mesh",ut),children:[" ",ut]},ut)),jsxRuntimeExports.jsx("div",{className:"px-3 py-1 text-gray-400 text-xs uppercase border-b border-t border-gray-700",children:"Lights"}),jsxRuntimeExports.jsx("button",{className:"w-full px-3 py-2 text-left text-white text-sm hover:bg-gray-700",onClick:()=>ct("light"),children:" Point Light"}),jsxRuntimeExports.jsx("div",{className:"px-3 py-1 text-gray-400 text-xs uppercase border-b border-t border-gray-700",children:"Other"}),jsxRuntimeExports.jsx("button",{className:"w-full px-3 py-2 text-left text-white text-sm hover:bg-gray-700",onClick:()=>ct("camera"),children:" Camera"}),jsxRuntimeExports.jsx("button",{className:"w-full px-3 py-2 text-left text-white text-sm hover:bg-gray-700",onClick:()=>ct("group"),children:" Empty Group"})]})]})]}),jsxRuntimeExports.jsx("div",{className:"flex-1 overflow-y-auto",children:at.length===0?jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-500 p-4",children:[jsxRuntimeExports.jsx("div",{className:"text-3xl mb-2",children:""}),jsxRuntimeExports.jsx("div",{className:"text-sm",children:"Scene is empty"}),jsxRuntimeExports.jsx("div",{className:"text-xs mt-1",children:"Click + to add objects"})]}):at.map(ut=>jsxRuntimeExports.jsx(TreeNode,{object:ut,level:0,isSelected:s.includes(ut.id),onSelect:a,onToggleVisibility:ft=>c(ft,{visible:!e[ft].visible}),onDelete:d,onDuplicate:b},ut.id))}),jsxRuntimeExports.jsxs("div",{className:"p-2 border-t border-gray-700 text-gray-500 text-xs",children:[at.length," objects"]})]})},BUILTIN_COMPONENTS={transform:{id:"transform",name:"Transform",category:"Core",description:"Position, rotation, and scale of the object",icon:"",properties:[{name:"position",type:"vector3",default:[0,0,0]},{name:"rotation",type:"vector3",default:[0,0,0]},{name:"scale",type:"vector3",default:[1,1,1]}]},rigidbody:{id:"rigidbody",name:"Rigidbody",category:"Physics",description:"Enables physics simulation for the object",icon:"",properties:[{name:"mass",type:"number",default:1,min:0,step:.1},{name:"useGravity",type:"boolean",default:!0},{name:"isKinematic",type:"boolean",default:!1},{name:"drag",type:"number",default:0,min:0,max:10,step:.1},{name:"angularDrag",type:"number",default:.05,min:0,max:10,step:.01}],onUpdate:(o,e,s)=>{if(e.useGravity&&!e.isKinematic){const a=o.userData.velocity||new Vector3;a.y-=9.81*s,a.multiplyScalar(1-e.drag*s),o.position.add(a.clone().multiplyScalar(s)),o.userData.velocity=a}}},boxCollider:{id:"boxCollider",name:"Box Collider",category:"Physics",description:"Axis-aligned bounding box for collision detection",icon:"",properties:[{name:"size",type:"vector3",default:[1,1,1]},{name:"center",type:"vector3",default:[0,0,0]},{name:"isTrigger",type:"boolean",default:!1}]},sphereCollider:{id:"sphereCollider",name:"Sphere Collider",category:"Physics",description:"Spherical collision boundary",icon:"",properties:[{name:"radius",type:"number",default:.5,min:.01,step:.1},{name:"center",type:"vector3",default:[0,0,0]},{name:"isTrigger",type:"boolean",default:!1}]},meshRenderer:{id:"meshRenderer",name:"Mesh Renderer",category:"Rendering",description:"Renders the mesh with materials",icon:"",properties:[{name:"castShadows",type:"boolean",default:!0},{name:"receiveShadows",type:"boolean",default:!0},{name:"visible",type:"boolean",default:!0}],onUpdate:(o,e)=>{o instanceof Mesh&&(o.castShadow=e.castShadows,o.receiveShadow=e.receiveShadows,o.visible=e.visible)}},light:{id:"light",name:"Light",category:"Rendering",description:"Light source component",icon:"",properties:[{name:"type",type:"enum",default:"point",options:["point","spot","directional"]},{name:"color",type:"color",default:"#ffffff"},{name:"intensity",type:"number",default:1,min:0,max:10,step:.1},{name:"range",type:"number",default:10,min:0,step:1},{name:"castShadow",type:"boolean",default:!0}]},camera:{id:"camera",name:"Camera",category:"Rendering",description:"Camera component for viewing the scene",icon:"",properties:[{name:"fov",type:"number",default:75,min:10,max:120,step:1},{name:"near",type:"number",default:.1,min:.01,step:.1},{name:"far",type:"number",default:1e3,min:10,step:10},{name:"isMain",type:"boolean",default:!1}]},audioSource:{id:"audioSource",name:"Audio Source",category:"Audio",description:"Plays audio clips",icon:"",properties:[{name:"clip",type:"asset",default:""},{name:"volume",type:"number",default:1,min:0,max:1,step:.01},{name:"pitch",type:"number",default:1,min:.1,max:3,step:.1},{name:"loop",type:"boolean",default:!1},{name:"playOnAwake",type:"boolean",default:!1},{name:"spatial",type:"boolean",default:!0}]},characterController:{id:"characterController",name:"Character Controller",category:"Gameplay",description:"Character movement and controls",icon:"",properties:[{name:"moveSpeed",type:"number",default:5,min:0,step:.5},{name:"jumpForce",type:"number",default:8,min:0,step:.5},{name:"gravity",type:"number",default:20,min:0,step:1},{name:"groundCheck",type:"number",default:.1,min:0,step:.05}],onUpdate:(o,e,s)=>{const a=o.userData.charVelocity||new Vector3;a.y-=e.gravity*s,o.position.y<=0&&(o.position.y=0,a.y=0,o.userData.isGrounded=!0),o.position.add(a.clone().multiplyScalar(s)),o.userData.charVelocity=a}},health:{id:"health",name:"Health",category:"Gameplay",description:"Health and damage system",icon:"",properties:[{name:"maxHealth",type:"number",default:100,min:1,step:10},{name:"currentHealth",type:"number",default:100,min:0,step:1},{name:"invincible",type:"boolean",default:!1},{name:"destroyOnDeath",type:"boolean",default:!0}]},spawner:{id:"spawner",name:"Spawner",category:"Gameplay",description:"Spawns objects over time",icon:"",properties:[{name:"prefab",type:"asset",default:""},{name:"spawnRate",type:"number",default:1,min:.1,step:.1},{name:"maxSpawned",type:"number",default:10,min:1,step:1},{name:"spawnOnStart",type:"boolean",default:!0}]},waypoint:{id:"waypoint",name:"Waypoint",category:"AI",description:"Navigation waypoint for AI movement",icon:"",properties:[{name:"radius",type:"number",default:1,min:.1,step:.1},{name:"waitTime",type:"number",default:0,min:0,step:.5},{name:"nextWaypoint",type:"string",default:""}]},aiFollow:{id:"aiFollow",name:"AI Follow",category:"AI",description:"AI that follows a target",icon:"",properties:[{name:"target",type:"string",default:""},{name:"followSpeed",type:"number",default:3,min:0,step:.5},{name:"stoppingDistance",type:"number",default:2,min:0,step:.5},{name:"lookAtTarget",type:"boolean",default:!0}],onUpdate:(o,e,s)=>{if(!e.target)return;const a=o.parent;if(!a)return;const c=a.getObjectByName(e.target);if(!c)return;const d=new Vector3().subVectors(c.position,o.position);d.length()>e.stoppingDistance&&(d.normalize(),o.position.add(d.multiplyScalar(e.followSpeed*s))),e.lookAtTarget&&o.lookAt(c.position)}},trigger:{id:"trigger",name:"Trigger Zone",category:"Events",description:"Detects when objects enter/exit",icon:"",properties:[{name:"size",type:"vector3",default:[2,2,2]},{name:"tags",type:"string",default:"Player"},{name:"oneShot",type:"boolean",default:!1}]},timer:{id:"timer",name:"Timer",category:"Events",description:"Triggers events based on time",icon:"",properties:[{name:"duration",type:"number",default:5,min:.1,step:.5},{name:"autoStart",type:"boolean",default:!1},{name:"loop",type:"boolean",default:!1}]},particleEmitter:{id:"particleEmitter",name:"Particle Emitter",category:"Effects",description:"Emits particle effects",icon:"",properties:[{name:"particleCount",type:"number",default:100,min:1,step:10},{name:"lifetime",type:"number",default:2,min:.1,step:.1},{name:"startColor",type:"color",default:"#ffffff"},{name:"endColor",type:"color",default:"#000000"},{name:"startSize",type:"number",default:.5,min:.01,step:.1},{name:"endSize",type:"number",default:0,min:0,step:.1},{name:"emitRate",type:"number",default:10,min:0,step:1}]}};class ComponentManager{constructor(){this.components=new Map,this.objectComponents=new Map,Object.values(BUILTIN_COMPONENTS).forEach(e=>{this.components.set(e.id,e)})}registerComponent(e){this.components.set(e.id,e)}getComponent(e){return this.components.get(e)}getAllComponents(){return Array.from(this.components.values())}getComponentsByCategory(){const e={};return this.components.forEach(s=>{e[s.category]||(e[s.category]=[]),e[s.category].push(s)}),e}addComponentToObject(e,s,a){const c=this.components.get(s);if(!c)return;this.objectComponents.has(e)||this.objectComponents.set(e,new Map);const d={};c.properties.forEach(b=>{d[b.name]=(a==null?void 0:a[b.name])??b.default}),this.objectComponents.get(e).set(s,d)}removeComponentFromObject(e,s){var a;(a=this.objectComponents.get(e))==null||a.delete(s)}getObjectComponents(e){return this.objectComponents.get(e)}updateComponent(e,s,a,c){const d=this.objectComponents.get(e);d!=null&&d.has(s)&&(d.get(s)[a]=c)}updateAllComponents(e,s){e.forEach((a,c)=>{const d=this.objectComponents.get(a);d&&d.forEach((b,_e)=>{const tt=this.components.get(_e);tt!=null&&tt.onUpdate&&tt.onUpdate(c,b,s)})})}}new ComponentManager;const PropertyInput=({definition:o,value:e,onChange:s})=>{var a;switch(o.type){case"number":return jsxRuntimeExports.jsx("input",{type:"number",value:e??o.default,min:o.min,max:o.max,step:o.step,onChange:d=>s(parseFloat(d.target.value)),className:"w-full px-2 py-1 bg-gray-700 border border-gray-600 rounded text-white text-sm"});case"string":return jsxRuntimeExports.jsx("input",{type:"text",value:e??o.default,onChange:d=>s(d.target.value),className:"w-full px-2 py-1 bg-gray-700 border border-gray-600 rounded text-white text-sm"});case"boolean":return jsxRuntimeExports.jsx("input",{type:"checkbox",checked:e??o.default,onChange:d=>s(d.target.checked),className:"w-4 h-4"});case"color":return jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[jsxRuntimeExports.jsx("input",{type:"color",value:e??o.default,onChange:d=>s(d.target.value),className:"w-8 h-8 bg-transparent border-0 cursor-pointer"}),jsxRuntimeExports.jsx("input",{type:"text",value:e??o.default,onChange:d=>s(d.target.value),className:"flex-1 px-2 py-1 bg-gray-700 border border-gray-600 rounded text-white text-sm"})]});case"vector3":const c=e??o.default??[0,0,0];return jsxRuntimeExports.jsx("div",{className:"flex gap-1",children:["X","Y","Z"].map((d,b)=>jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsx("label",{className:"text-xs text-gray-500",children:d}),jsxRuntimeExports.jsx("input",{type:"number",value:c[b],step:.1,onChange:_e=>{const tt=[...c];tt[b]=parseFloat(_e.target.value),s(tt)},className:"w-full px-1 py-1 bg-gray-700 border border-gray-600 rounded text-white text-xs"})]},d))});case"enum":return jsxRuntimeExports.jsx("select",{value:e??o.default,onChange:d=>s(d.target.value),className:"w-full px-2 py-1 bg-gray-700 border border-gray-600 rounded text-white text-sm",children:(a=o.options)==null?void 0:a.map(d=>jsxRuntimeExports.jsx("option",{value:d,children:d},d))});case"asset":return jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[jsxRuntimeExports.jsx("input",{type:"text",value:e??"",readOnly:!0,placeholder:"No asset",className:"flex-1 px-2 py-1 bg-gray-700 border border-gray-600 rounded text-white text-sm"}),jsxRuntimeExports.jsx("button",{className:"px-2 py-1 bg-blue-600 text-white rounded text-sm",children:"..."})]});default:return jsxRuntimeExports.jsx("span",{className:"text-gray-500 text-sm",children:"Unknown type"})}},ComponentEditor=({component:o,definition:e,onPropertyChange:s,onRemove:a})=>{const[c,d]=reactExports.useState(!0);return jsxRuntimeExports.jsxs("div",{className:"border border-gray-700 rounded overflow-hidden mb-2",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-gray-800 cursor-pointer",onClick:()=>d(!c),children:[jsxRuntimeExports.jsx("span",{className:"text-white",children:c?"":""}),jsxRuntimeExports.jsx("span",{className:"text-lg",children:e.icon}),jsxRuntimeExports.jsx("span",{className:"flex-1 text-white font-medium",children:e.name}),jsxRuntimeExports.jsx("input",{type:"checkbox",checked:o.enabled,onChange:b=>s("enabled",b.target.checked),onClick:b=>b.stopPropagation(),className:"w-4 h-4"}),jsxRuntimeExports.jsx("button",{onClick:b=>{b.stopPropagation(),a()},className:"text-red-400 hover:text-red-300 text-sm",children:""})]}),c&&jsxRuntimeExports.jsx("div",{className:"p-3 space-y-3",children:e.properties.map(b=>jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-gray-400 text-xs mb-1 capitalize",children:b.name.replace(/([A-Z])/g," $1").trim()}),jsxRuntimeExports.jsx(PropertyInput,{definition:b,value:o.properties[b.name],onChange:_e=>s(b.name,_e)})]},b.name))})]})},InspectorPanel=({className:o})=>{var at,ct,ut,ft;const{sceneObjects:e,selectedObjectIds:s,updateSceneObject:a}=useGameForge(),[c,d]=reactExports.useState(!1),b=s.length===1?e[s[0]]:null,_e=reactExports.useCallback((dt,lt)=>{b&&a(b.id,{[dt]:lt})},[b,a]),tt=reactExports.useCallback(dt=>{if(!b)return;const lt=BUILTIN_COMPONENTS[dt];if(!lt)return;const ht={};lt.properties.forEach(xt=>{ht[xt.name]=xt.default});const mt={id:`comp_${Date.now()}`,type:dt,properties:ht,enabled:!0};a(b.id,{components:[...b.components,mt]}),d(!1)},[b,a]),nt=reactExports.useCallback(dt=>{b&&a(b.id,{components:b.components.filter(lt=>lt.id!==dt)})},[b,a]),it=reactExports.useCallback((dt,lt,ht)=>{b&&a(b.id,{components:b.components.map(mt=>mt.id===dt?{...mt,properties:{...mt.properties,[lt]:ht}}:mt)})},[b,a]);if(!b)return jsxRuntimeExports.jsxs("div",{className:`flex flex-col items-center justify-center bg-gray-900 text-gray-500 ${o}`,children:[jsxRuntimeExports.jsx("div",{className:"text-3xl mb-2",children:""}),jsxRuntimeExports.jsx("div",{className:"text-sm",children:"Select an object"}),jsxRuntimeExports.jsx("div",{className:"text-xs",children:"to edit its properties"})]});if(s.length>1)return jsxRuntimeExports.jsxs("div",{className:`flex flex-col items-center justify-center bg-gray-900 text-gray-500 ${o}`,children:[jsxRuntimeExports.jsx("div",{className:"text-3xl mb-2",children:""}),jsxRuntimeExports.jsxs("div",{className:"text-sm",children:[s.length," objects selected"]}),jsxRuntimeExports.jsx("div",{className:"text-xs",children:"Multi-selection editing"})]});const ot=Object.entries(BUILTIN_COMPONENTS).reduce((dt,[lt,ht])=>(dt[ht.category]||(dt[ht.category]=[]),dt[ht.category].push({componentKey:lt,...ht}),dt),{});return jsxRuntimeExports.jsxs("div",{className:`flex flex-col bg-gray-900 overflow-y-auto ${o}`,children:[jsxRuntimeExports.jsxs("div",{className:"p-3 border-b border-gray-700",children:[jsxRuntimeExports.jsx("input",{type:"text",value:b.name,onChange:dt=>_e("name",dt.target.value),className:"w-full px-3 py-2 bg-gray-800 border border-gray-600 rounded text-white font-bold"}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3 mt-2 text-sm",children:[jsxRuntimeExports.jsxs("label",{className:"flex items-center gap-2 text-gray-400",children:[jsxRuntimeExports.jsx("input",{type:"checkbox",checked:b.visible,onChange:dt=>_e("visible",dt.target.checked)}),"Visible"]}),jsxRuntimeExports.jsxs("label",{className:"flex items-center gap-2 text-gray-400",children:[jsxRuntimeExports.jsx("input",{type:"checkbox",checked:b.locked,onChange:dt=>_e("locked",dt.target.checked)}),"Locked"]})]})]}),jsxRuntimeExports.jsxs("div",{className:"p-3 border-b border-gray-700",children:[jsxRuntimeExports.jsx("div",{className:"text-gray-400 text-xs uppercase mb-2",children:"Transform"}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"text-xs text-gray-500",children:"Position"}),jsxRuntimeExports.jsx("div",{className:"flex gap-1",children:["X","Y","Z"].map((dt,lt)=>jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsx("div",{className:"text-xs text-gray-600",children:dt}),jsxRuntimeExports.jsx("input",{type:"number",value:b.position[lt],step:.1,onChange:ht=>{const mt=[...b.position];mt[lt]=parseFloat(ht.target.value),_e("position",mt)},className:"w-full px-1 py-1 bg-gray-700 border border-gray-600 rounded text-white text-xs"})]},dt))})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"text-xs text-gray-500",children:"Rotation"}),jsxRuntimeExports.jsx("div",{className:"flex gap-1",children:["X","Y","Z"].map((dt,lt)=>jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsx("div",{className:"text-xs text-gray-600",children:dt}),jsxRuntimeExports.jsx("input",{type:"number",value:b.rotation[lt],step:1,onChange:ht=>{const mt=[...b.rotation];mt[lt]=parseFloat(ht.target.value),_e("rotation",mt)},className:"w-full px-1 py-1 bg-gray-700 border border-gray-600 rounded text-white text-xs"})]},dt))})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"text-xs text-gray-500",children:"Scale"}),jsxRuntimeExports.jsx("div",{className:"flex gap-1",children:["X","Y","Z"].map((dt,lt)=>jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsx("div",{className:"text-xs text-gray-600",children:dt}),jsxRuntimeExports.jsx("input",{type:"number",value:b.scale[lt],step:.1,min:.01,onChange:ht=>{const mt=[...b.scale];mt[lt]=parseFloat(ht.target.value),_e("scale",mt)},className:"w-full px-1 py-1 bg-gray-700 border border-gray-600 rounded text-white text-xs"})]},dt))})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"p-3 border-b border-gray-700",children:[jsxRuntimeExports.jsx("div",{className:"text-gray-400 text-xs uppercase mb-2",children:"Material"}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"text-xs text-gray-500",children:"Color"}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[jsxRuntimeExports.jsx("input",{type:"color",value:((at=b.material)==null?void 0:at.color)||"#4a90d9",onChange:dt=>_e("material",{...b.material,color:dt.target.value}),className:"w-8 h-8 bg-transparent border-0 cursor-pointer"}),jsxRuntimeExports.jsx("input",{type:"text",value:((ct=b.material)==null?void 0:ct.color)||"#4a90d9",onChange:dt=>_e("material",{...b.material,color:dt.target.value}),className:"flex-1 px-2 py-1 bg-gray-700 border border-gray-600 rounded text-white text-sm"})]})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"text-xs text-gray-500",children:"Metalness"}),jsxRuntimeExports.jsx("input",{type:"range",min:0,max:1,step:.01,value:((ut=b.material)==null?void 0:ut.metalness)??.3,onChange:dt=>_e("material",{...b.material,metalness:parseFloat(dt.target.value)}),className:"w-full"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"text-xs text-gray-500",children:"Roughness"}),jsxRuntimeExports.jsx("input",{type:"range",min:0,max:1,step:.01,value:((ft=b.material)==null?void 0:ft.roughness)??.7,onChange:dt=>_e("material",{...b.material,roughness:parseFloat(dt.target.value)}),className:"w-full"})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"p-3 flex-1",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-2",children:[jsxRuntimeExports.jsx("div",{className:"text-gray-400 text-xs uppercase",children:"Components"}),jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx("button",{onClick:()=>d(!c),className:"px-2 py-1 bg-blue-600 text-white rounded text-xs hover:bg-blue-500",children:"+ Add"}),c&&jsxRuntimeExports.jsx("div",{className:"absolute right-0 top-full mt-1 bg-gray-800 border border-gray-600 rounded shadow-xl z-50 min-w-[180px] max-h-60 overflow-y-auto",children:Object.entries(ot).map(([dt,lt])=>jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("div",{className:"px-3 py-1 text-gray-400 text-xs uppercase bg-gray-700/50",children:dt}),lt.map(ht=>jsxRuntimeExports.jsxs("button",{className:"w-full px-3 py-2 text-left text-white text-sm hover:bg-gray-700 flex items-center gap-2",onClick:()=>tt(ht.componentKey),children:[jsxRuntimeExports.jsx("span",{children:ht.icon}),jsxRuntimeExports.jsx("span",{children:ht.name})]},ht.componentKey))]},dt))})]})]}),b.components.length===0?jsxRuntimeExports.jsx("div",{className:"text-gray-500 text-sm text-center py-4",children:"No components added"}):b.components.map(dt=>{const lt=BUILTIN_COMPONENTS[dt.type];return lt?jsxRuntimeExports.jsx(ComponentEditor,{component:dt,definition:lt,onPropertyChange:(ht,mt)=>it(dt.id,ht,mt),onRemove:()=>nt(dt.id)},dt.id):null})]})]})},GameForge=()=>{const{project:o,setProject:e,activeTool:s,setActiveTool:a,activeView:c,setActiveView:d,isPlaying:b,play:_e,pause:tt,stop:nt,gridVisible:it,toggleGrid:ot,snapToGrid:at,toggleSnap:ct,addVisualScript:ut,visualScripts:ft,currentScript:dt,setCurrentScript:lt,addSceneObject:ht}=useGameForge(),[mt,xt]=reactExports.useState("scene"),[St,yt]=reactExports.useState("standard"),[wt,Et]=reactExports.useState(!1);reactExports.useEffect(()=>{if(!o){const Mt={id:`proj_${Date.now()}`,name:"New GameForge Project",description:"Created with GameForge Editor",scenes:["main"],currentScene:"main",settings:{renderer:{antialias:!0,shadows:!0,shadowMapSize:2048,toneMapping:"ACESFilmic",exposure:1},physics:{gravity:[0,-9.81,0],enabled:!0},audio:{masterVolume:1,enabled:!0}},createdAt:new Date,updatedAt:new Date};e(Mt);const jt={id:"script_main",name:"Main Script",nodes:[],connections:[]};ut(jt),lt(jt.id),ht({id:"ground",name:"Ground",type:"mesh",position:[0,0,0],rotation:[-90,0,0],scale:[50,50,1],geometry:"plane",material:{type:"standard",color:"#3d5c3d",metalness:.1,roughness:.9},visible:!0,locked:!1,components:[]})}},[o,e,ut,lt,ht]);const _t=reactExports.useCallback(Mt=>{if(!(Mt.target instanceof HTMLInputElement||Mt.target instanceof HTMLTextAreaElement)){switch(Mt.key.toLowerCase()){case"q":a("select");break;case"w":a("move");break;case"e":a("rotate");break;case"r":a("scale");break;case"g":ot();break;case"f":yt(jt=>jt==="focus"?"standard":"focus");break}Mt.key==="F5"&&(Mt.preventDefault(),b?nt():_e()),Mt.key==="F6"&&b&&(Mt.preventDefault(),tt())}},[a,ot,b,_e,tt,nt]);reactExports.useEffect(()=>(window.addEventListener("keydown",_t),()=>window.removeEventListener("keydown",_t)),[_t]);const vt=[{id:"select",icon:"",name:"Select (Q)",key:"Q"},{id:"move",icon:"",name:"Move (W)",key:"W"},{id:"rotate",icon:"",name:"Rotate (E)",key:"E"},{id:"scale",icon:"",name:"Scale (R)",key:"R"}];return jsxRuntimeExports.jsxs("div",{className:"flex flex-col w-full h-full bg-gray-900 text-white overflow-hidden",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between px-4 py-2 bg-gray-800 border-b border-gray-700",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("span",{className:"text-2xl",children:""}),jsxRuntimeExports.jsx("span",{className:"font-bold text-lg",children:"GameForge"})]}),jsxRuntimeExports.jsx("div",{className:"flex items-center gap-1 ml-4",children:["scene","scripts","assets"].map(Mt=>jsxRuntimeExports.jsx("button",{onClick:()=>xt(Mt),className:`px-4 py-1 rounded-t text-sm font-medium transition-colors ${mt===Mt?"bg-gray-900 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,children:Mt==="scene"?" Scene":Mt==="scripts"?" Scripts":" Assets"},Mt))})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("button",{onClick:()=>Et(!wt),className:"px-3 py-1 bg-gray-700 text-white rounded text-sm hover:bg-gray-600",children:" Settings"}),jsxRuntimeExports.jsx("button",{onClick:()=>{const Mt=JSON.stringify({project:o,visualScripts:ft},null,2),jt=new Blob([Mt],{type:"application/json"}),Lt=URL.createObjectURL(jt),Nt=document.createElement("a");Nt.href=Lt,Nt.download=`${(o==null?void 0:o.name)||"project"}.gameforge`,Nt.click()},className:"px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-500",children:" Save"})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-gray-850 border-b border-gray-700",style:{backgroundColor:"#1f2937"},children:[jsxRuntimeExports.jsx("div",{className:"flex items-center gap-1 mr-4",children:vt.map(Mt=>jsxRuntimeExports.jsx("button",{onClick:()=>a(Mt.id),title:Mt.name,className:`w-8 h-8 rounded flex items-center justify-center transition-colors ${s===Mt.id?"bg-blue-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,children:Mt.icon},Mt.id))}),jsxRuntimeExports.jsx("div",{className:"h-6 w-px bg-gray-600 mx-2"}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("button",{onClick:b?nt:_e,className:`px-4 py-1 rounded text-sm font-medium ${b?"bg-red-600 hover:bg-red-500":"bg-green-600 hover:bg-green-500"}`,children:b?" Stop":" Play"}),b&&jsxRuntimeExports.jsx("button",{onClick:tt,className:"px-3 py-1 bg-yellow-600 hover:bg-yellow-500 rounded text-sm font-medium",children:" Pause"})]}),jsxRuntimeExports.jsx("div",{className:"h-6 w-px bg-gray-600 mx-2"}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("button",{onClick:ot,title:"Toggle Grid (G)",className:`px-3 py-1 rounded text-sm ${it?"bg-blue-600":"bg-gray-700"}`,children:"Grid"}),jsxRuntimeExports.jsx("button",{onClick:ct,title:"Toggle Snap",className:`px-3 py-1 rounded text-sm ${at?"bg-blue-600":"bg-gray-700"}`,children:"Snap"})]}),jsxRuntimeExports.jsx("div",{className:"flex-1"}),jsxRuntimeExports.jsx("div",{className:"flex items-center gap-1",children:["standard","focus","split"].map(Mt=>jsxRuntimeExports.jsx("button",{onClick:()=>yt(Mt),className:`px-2 py-1 rounded text-xs ${St===Mt?"bg-blue-600":"bg-gray-700"}`,children:Mt==="standard"?"":Mt==="focus"?"":""},Mt))})]}),jsxRuntimeExports.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[St!=="focus"&&jsxRuntimeExports.jsx("div",{className:"w-64 flex flex-col border-r border-gray-700",children:jsxRuntimeExports.jsx(HierarchyPanel,{className:"flex-1"})}),jsxRuntimeExports.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[mt==="scene"&&jsxRuntimeExports.jsx(SceneViewport,{className:"flex-1"}),mt==="scripts"&&jsxRuntimeExports.jsxs("div",{className:"flex-1 flex flex-col",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-gray-800 border-b border-gray-700",children:[jsxRuntimeExports.jsx("span",{className:"text-gray-400 text-sm",children:"Scripts:"}),ft.map(Mt=>jsxRuntimeExports.jsxs("button",{onClick:()=>lt(Mt.id),className:`px-3 py-1 rounded text-sm ${dt===Mt.id?"bg-blue-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,children:[" ",Mt.name]},Mt.id)),jsxRuntimeExports.jsx("button",{onClick:()=>{const Mt={id:`script_${Date.now()}`,name:`Script ${ft.length+1}`,nodes:[],connections:[]};ut(Mt),lt(Mt.id)},className:"px-2 py-1 bg-green-600 text-white rounded text-sm hover:bg-green-500",children:"+"})]}),dt&&jsxRuntimeExports.jsx(VisualScriptEditor,{scriptId:dt,className:"flex-1"})]}),mt==="assets"&&jsxRuntimeExports.jsx(AssetManager,{className:"flex-1"})]}),St!=="focus"&&jsxRuntimeExports.jsx("div",{className:"w-72 border-l border-gray-700",children:jsxRuntimeExports.jsx(InspectorPanel,{className:"h-full"})})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between px-4 py-1 bg-gray-800 border-t border-gray-700 text-xs text-gray-400",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4",children:[jsxRuntimeExports.jsx("span",{children:"GameForge Editor v1.0"}),jsxRuntimeExports.jsx("span",{children:"|"}),jsxRuntimeExports.jsxs("span",{children:["Project: ",(o==null?void 0:o.name)||"Untitled"]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4",children:[jsxRuntimeExports.jsxs("span",{children:["Tool: ",s]}),jsxRuntimeExports.jsx("span",{children:"|"}),jsxRuntimeExports.jsxs("span",{children:["Grid: ",it?"On":"Off"]}),jsxRuntimeExports.jsx("span",{children:"|"}),jsxRuntimeExports.jsx("span",{className:b?"text-green-400":"",children:b?" Playing":" Stopped"})]})]}),wt&&jsxRuntimeExports.jsx("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center z-50",children:jsxRuntimeExports.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-2xl w-[500px] max-h-[80%] overflow-y-auto",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-gray-700",children:[jsxRuntimeExports.jsx("h2",{className:"font-bold",children:"Project Settings"}),jsxRuntimeExports.jsx("button",{onClick:()=>Et(!1),className:"text-gray-400 hover:text-white",children:""})]}),jsxRuntimeExports.jsxs("div",{className:"p-4 space-y-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-gray-400 text-sm mb-1",children:"Project Name"}),jsxRuntimeExports.jsx("input",{type:"text",value:(o==null?void 0:o.name)||"",onChange:Mt=>o&&e({...o,name:Mt.target.value}),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-gray-400 text-sm mb-1",children:"Description"}),jsxRuntimeExports.jsx("textarea",{value:(o==null?void 0:o.description)||"",onChange:Mt=>o&&e({...o,description:Mt.target.value}),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white h-20"})]}),jsxRuntimeExports.jsxs("div",{className:"border-t border-gray-700 pt-4",children:[jsxRuntimeExports.jsx("h3",{className:"text-sm font-bold text-gray-300 mb-3",children:"Renderer"}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsxs("label",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("input",{type:"checkbox",checked:o==null?void 0:o.settings.renderer.antialias,onChange:Mt=>o&&e({...o,settings:{...o.settings,renderer:{...o.settings.renderer,antialias:Mt.target.checked}}})}),jsxRuntimeExports.jsx("span",{className:"text-gray-300 text-sm",children:"Antialiasing"})]}),jsxRuntimeExports.jsxs("label",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("input",{type:"checkbox",checked:o==null?void 0:o.settings.renderer.shadows,onChange:Mt=>o&&e({...o,settings:{...o.settings,renderer:{...o.settings.renderer,shadows:Mt.target.checked}}})}),jsxRuntimeExports.jsx("span",{className:"text-gray-300 text-sm",children:"Shadows"})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"border-t border-gray-700 pt-4",children:[jsxRuntimeExports.jsx("h3",{className:"text-sm font-bold text-gray-300 mb-3",children:"Physics"}),jsxRuntimeExports.jsxs("label",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("input",{type:"checkbox",checked:o==null?void 0:o.settings.physics.enabled,onChange:Mt=>o&&e({...o,settings:{...o.settings,physics:{...o.settings.physics,enabled:Mt.target.checked}}})}),jsxRuntimeExports.jsx("span",{className:"text-gray-300 text-sm",children:"Enable Physics"})]})]})]}),jsxRuntimeExports.jsx("div",{className:"flex justify-end gap-2 px-4 py-3 border-t border-gray-700",children:jsxRuntimeExports.jsx("button",{onClick:()=>Et(!1),className:"px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-500",children:"Close"})})]})})]})},MediaFireWorldLoader=({onWorldLoaded:o,apiKey:e=""})=>{const[s,a]=reactExports.useState("Ready to load world"),[c,d]=reactExports.useState(!1),[b,_e]=reactExports.useState(0),[tt,nt]=reactExports.useState(!1),it=reactExports.useRef(null),ot="https://www.mediafire.com/file/t9wqm1bwcd6ng81/I_Love_Minecraft_3_V34_Final_1.12.2.rar/file",at=async()=>{d(!0),_e(0),nt(!0);try{a("Initializing rendering engine..."),_e(10),await new Promise(ft=>setTimeout(ft,500)),a("Checking WebAssembly support..."),_e(20),await new Promise(ft=>setTimeout(ft,500)),a(typeof WebAssembly<"u"?"WebAssembly ready!":"Using JavaScript fallback..."),_e(30),await new Promise(ft=>setTimeout(ft,500)),a("Generating world from MediaFire reference..."),_e(50),await new Promise(ft=>setTimeout(ft,1e3)),a("Creating optimized chunk data..."),_e(70),await new Promise(ft=>setTimeout(ft,1e3)),a("Optimizing for FPS performance..."),_e(90),await new Promise(ft=>setTimeout(ft,500)),a("World loaded successfully!"),_e(100),o&&o({status:"loaded"})}catch(ut){console.error("Error loading MediaFire world:",ut),a("Error loading world - please try again")}finally{d(!1)}},ct=async()=>{d(!0),nt(!0),a("Creating sample world...");try{_e(25),await new Promise(ut=>setTimeout(ut,500)),a("Generating terrain blocks..."),_e(50),await new Promise(ut=>setTimeout(ut,500)),a("Adding structures..."),_e(75),await new Promise(ut=>setTimeout(ut,500)),a("Sample world ready!"),_e(100),o&&o({status:"sample_loaded"})}catch(ut){console.error("Error creating sample world:",ut),a("Error creating sample world")}finally{d(!1)}};return jsxRuntimeExports.jsx("div",{className:"w-full h-full flex flex-col",style:{background:"#0a0a0a"},children:jsxRuntimeExports.jsxs("div",{className:"p-4 flex-1 overflow-auto",children:[jsxRuntimeExports.jsx("h2",{className:"text-xl font-bold mb-4",style:{color:"#c9a227"},children:"Minecraft World Loader"}),jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"rounded-lg p-4",style:{border:"1px solid #1a5a5a",background:"#111"},children:[jsxRuntimeExports.jsx("h3",{className:"font-semibold mb-2",style:{color:"#1a5a5a"},children:"I Love Minecraft 3 (MediaFire)"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-300 mb-3",children:"Load the specific world file from MediaFire"}),jsxRuntimeExports.jsxs("a",{href:ot,target:"_blank",rel:"noopener noreferrer",className:"text-xs hover:underline block mb-3",style:{color:"#c9a227"},children:["Source: ",ot.substring(0,40),"..."]}),jsxRuntimeExports.jsx("button",{onClick:at,disabled:c,className:"w-full py-2 px-4 rounded-lg font-medium transition-colors disabled:opacity-50",style:{background:"#1a5a5a",color:"white"},children:c?"Loading...":"Load MediaFire World"})]}),jsxRuntimeExports.jsxs("div",{className:"rounded-lg p-4",style:{border:"1px solid #c9a227",background:"#111"},children:[jsxRuntimeExports.jsx("h3",{className:"font-semibold mb-2",style:{color:"#c9a227"},children:"Generate Sample World"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-300 mb-3",children:"Create a demonstration world with WebAssembly acceleration"}),jsxRuntimeExports.jsx("button",{onClick:ct,disabled:c,className:"w-full py-2 px-4 rounded-lg font-medium transition-colors disabled:opacity-50",style:{background:"#c9a227",color:"#0a0a0a"},children:c?"Generating...":"Generate Sample World"})]}),s&&jsxRuntimeExports.jsxs("div",{className:"p-3 rounded-lg",style:{background:"#1a1a1a"},children:[jsxRuntimeExports.jsx("div",{className:"text-sm mb-1",style:{color:"#c9a227"},children:"Status:"}),jsxRuntimeExports.jsx("div",{className:"text-sm text-white",children:s}),c&&jsxRuntimeExports.jsxs("div",{className:"mt-2",children:[jsxRuntimeExports.jsx("div",{className:"w-full rounded-full h-2",style:{background:"#333"},children:jsxRuntimeExports.jsx("div",{className:"h-2 rounded-full transition-all duration-300",style:{width:`${b}%`,background:"#1a5a5a"}})}),jsxRuntimeExports.jsxs("div",{className:"text-xs text-gray-400 mt-1",children:[b,"%"]})]})]}),tt&&jsxRuntimeExports.jsx("div",{className:"rounded-lg overflow-hidden",style:{border:"1px solid #333"},children:jsxRuntimeExports.jsx("canvas",{ref:it,id:"minecraft-world-canvas",className:"w-full h-48",style:{background:"#1a1a1a"}})}),jsxRuntimeExports.jsxs("div",{className:"text-xs text-gray-400",children:[jsxRuntimeExports.jsx("div",{className:"font-medium mb-1",style:{color:"#1a5a5a"},children:"System Status:"}),jsxRuntimeExports.jsxs("div",{children:["WebAssembly: ",typeof WebAssembly<"u"?"Available":"Not supported"]}),jsxRuntimeExports.jsxs("div",{children:["Canvas: ",tt?"Active":"Ready"]}),jsxRuntimeExports.jsx("div",{children:"Controls: FPS camera with mouse lock"})]})]})]})})},DB_NAME="GrudaOS",DB_VERSION=1,STORES={files:"files",cache:"cache",config:"config",processes:"processes",apps:"apps"};class GrudaFileSystem{constructor(){this.memoryCache=new Map,this.db=null,this.initialized=!1}async init(){if(!this.initialized)return new Promise((e,s)=>{const a=indexedDB.open(DB_NAME,DB_VERSION);a.onerror=()=>s(a.error),a.onsuccess=()=>{this.db=a.result,this.initialized=!0,console.log("[GrudaOS] File system initialized"),e()},a.onupgradeneeded=c=>{const d=c.target.result;d.objectStoreNames.contains(STORES.files)||d.createObjectStore(STORES.files,{keyPath:"path"}),d.objectStoreNames.contains(STORES.cache)||d.createObjectStore(STORES.cache,{keyPath:"key"}),d.objectStoreNames.contains(STORES.config)||d.createObjectStore(STORES.config,{keyPath:"key"}),d.objectStoreNames.contains(STORES.processes)||d.createObjectStore(STORES.processes,{keyPath:"pid"}),d.objectStoreNames.contains(STORES.apps)||d.createObjectStore(STORES.apps,{keyPath:"id"})}})}async transaction(e,s,a){if(await this.init(),!this.db)throw new Error("Database not initialized");return new Promise((c,d)=>{const _e=this.db.transaction(e,s).objectStore(e),tt=a(_e);tt.onsuccess=()=>c(tt.result),tt.onerror=()=>d(tt.error)})}async writeFile(e,s){const a={name:e.split("/").pop()||e,path:e,type:"file",size:typeof s=="string"?s.length:s.byteLength,modified:new Date,content:s};if(this.memoryCache.set(e,a),await this.transaction(STORES.files,"readwrite",c=>c.put(a)),this.isCloudEnabled())try{await puter.fs.write(e,s)}catch(c){console.warn("[GrudaOS] Cloud sync failed:",c)}}async readFile(e){if(this.memoryCache.has(e))return this.memoryCache.get(e).content;const s=await this.transaction(STORES.files,"readonly",a=>a.get(e));if(s)return this.memoryCache.set(e,s),s.content||null;if(this.isCloudEnabled())try{const a=await puter.fs.read(e);if(a)return await this.writeFile(e,a),a}catch(a){console.warn("[GrudaOS] Cloud read failed:",a)}return null}async deleteFile(e){if(this.memoryCache.delete(e),await this.transaction(STORES.files,"readwrite",s=>s.delete(e)),this.isCloudEnabled())try{await puter.fs.delete(e)}catch(s){console.warn("[GrudaOS] Cloud delete failed:",s)}}async listDirectory(e){return await this.init(),this.db?new Promise((s,a)=>{const b=this.db.transaction(STORES.files,"readonly").objectStore(STORES.files).getAll();b.onsuccess=()=>{const _e=b.result,tt=e.endsWith("/")?e:e+"/",nt=_e.filter(it=>it.path===e?!1:it.path.startsWith(tt)&&it.path.slice(tt.length).indexOf("/")===-1);s(nt)},b.onerror=()=>a(b.error)}):[]}async mkdir(e){const s={name:e.split("/").filter(Boolean).pop()||"root",path:e,type:"directory",size:0,modified:new Date};await this.transaction(STORES.files,"readwrite",a=>a.put(s))}async exists(e){return!!await this.transaction(STORES.files,"readonly",a=>a.get(e))}isCloudEnabled(){return typeof puter<"u"&&(puter==null?void 0:puter.fs)}clearMemoryCache(){this.memoryCache.clear(),console.log("[GrudaOS] Memory cache cleared")}getMemoryCacheSize(){return this.memoryCache.size}}class GrudaCache{constructor(e){this.memoryCache=new Map,this.fs=e}async set(e,s,a=36e5,c="medium"){const d={key:e,value:s,expires:Date.now()+a,priority:c};if(this.memoryCache.set(e,d),c!=="low")try{localStorage.setItem(`gruda_cache_${e}`,JSON.stringify(d))}catch(b){console.warn("[GrudaOS] LocalStorage cache failed:",b)}}async get(e){if(this.memoryCache.has(e)){const s=this.memoryCache.get(e);if(s.expires>Date.now())return s.value;this.memoryCache.delete(e)}try{const s=localStorage.getItem(`gruda_cache_${e}`);if(s){const a=JSON.parse(s);if(a.expires>Date.now())return this.memoryCache.set(e,a),a.value;localStorage.removeItem(`gruda_cache_${e}`)}}catch(s){console.warn("[GrudaOS] Cache read failed:",s)}return null}async invalidate(e){this.memoryCache.delete(e);try{localStorage.removeItem(`gruda_cache_${e}`)}catch{}}async clear(){this.memoryCache.clear(),Object.keys(localStorage).filter(s=>s.startsWith("gruda_cache_")).forEach(s=>localStorage.removeItem(s)),console.log("[GrudaOS] Cache cleared")}getStats(){return{memoryEntries:this.memoryCache.size,totalSize:Array.from(this.memoryCache.values()).reduce((e,s)=>e+JSON.stringify(s.value).length,0)}}}class GrudaProcessManager{constructor(){this.processes=new Map,this.nextPid=1}spawn(e,s){const a=this.nextPid++,c={pid:a,name:e,component:s,started:new Date,memory:0,state:"running"};return this.processes.set(a,c),console.log(`[GrudaOS] Process spawned: ${e} (PID: ${a})`),a}terminate(e){const s=this.processes.get(e);return s?(s.state="terminated",this.processes.delete(e),console.log(`[GrudaOS] Process terminated: ${s.name} (PID: ${e})`),!0):!1}suspend(e){const s=this.processes.get(e);return s&&s.state==="running"?(s.state="suspended",!0):!1}resume(e){const s=this.processes.get(e);return s&&s.state==="suspended"?(s.state="running",!0):!1}list(){return Array.from(this.processes.values())}getProcess(e){return this.processes.get(e)}getByComponent(e){return Array.from(this.processes.values()).find(s=>s.component===e)}}class GrudaConfig{constructor(){this.config={theme:"dark",accentColor:"#1a5a5a",fontSize:14,animations:!0,soundEnabled:!0,autoSave:!0,cloudSync:!0}}async load(){try{const e=localStorage.getItem("gruda_system_config");if(e&&(this.config={...this.config,...JSON.parse(e)}),typeof puter<"u"&&(puter!=null&&puter.kv)){const s=await puter.kv.get("system_config");s&&(this.config={...this.config,...JSON.parse(s)})}}catch(e){console.warn("[GrudaOS] Config load failed:",e)}return this.config}async save(){try{localStorage.setItem("gruda_system_config",JSON.stringify(this.config)),typeof puter<"u"&&(puter!=null&&puter.kv)&&this.config.cloudSync&&await puter.kv.set("system_config",JSON.stringify(this.config))}catch(e){console.warn("[GrudaOS] Config save failed:",e)}}get(e){return this.config[e]}async set(e,s){this.config[e]=s,await this.save()}getAll(){return{...this.config}}}class GrudaOS{constructor(){this.initialized=!1,this.fs=new GrudaFileSystem,this.cache=new GrudaCache(this.fs),this.processes=new GrudaProcessManager,this.config=new GrudaConfig,this.bootTime=new Date}async boot(){if(this.initialized)return;console.log("[GrudaOS] Booting...");const e=Date.now();await this.fs.init(),await this.config.load(),await this.fs.mkdir("/home"),await this.fs.mkdir("/home/user"),await this.fs.mkdir("/home/user/documents"),await this.fs.mkdir("/home/user/downloads"),await this.fs.mkdir("/home/user/pictures"),await this.fs.mkdir("/home/user/music"),await this.fs.mkdir("/home/user/videos"),await this.fs.mkdir("/tmp"),await this.fs.mkdir("/var"),await this.fs.mkdir("/var/cache"),await this.fs.mkdir("/etc"),this.initialized=!0;const s=Date.now()-e;console.log(`[GrudaOS] Boot complete in ${s}ms`)}getUptime(){return Date.now()-this.bootTime.getTime()}getSystemInfo(){return{uptime:this.getUptime(),bootTime:this.bootTime,processes:this.processes.list().length,cacheStats:this.cache.getStats(),memoryCache:this.fs.getMemoryCacheSize()}}async shutdown(){console.log("[GrudaOS] Shutting down...");const e=this.processes.list();for(const s of e)this.processes.terminate(s.pid);await this.config.save(),this.fs.clearMemoryCache(),console.log("[GrudaOS] Shutdown complete")}}const grudaOS=new GrudaOS;function useGrudaOS(){const[o,e]=reactExports.useState(!1),[s,a]=reactExports.useState(!1);return reactExports.useEffect(()=>{(async()=>{if(!(o||s)){a(!0);try{await grudaOS.boot(),e(!0)}catch(d){console.error("[useGrudaOS] Boot failed:",d)}finally{a(!1)}}})()},[]),{os:grudaOS,isBooted:o,isBooting:s}}function useFileSystem(){const{os:o,isBooted:e}=useGrudaOS(),s=reactExports.useCallback(async(tt,nt)=>{if(!e)throw new Error("OS not booted");return o.fs.writeFile(tt,nt)},[o,e]),a=reactExports.useCallback(async tt=>{if(!e)throw new Error("OS not booted");return o.fs.readFile(tt)},[o,e]),c=reactExports.useCallback(async tt=>{if(!e)throw new Error("OS not booted");return o.fs.deleteFile(tt)},[o,e]),d=reactExports.useCallback(async tt=>e?o.fs.listDirectory(tt):[],[o,e]),b=reactExports.useCallback(async tt=>{if(!e)throw new Error("OS not booted");return o.fs.mkdir(tt)},[o,e]),_e=reactExports.useCallback(async tt=>e?o.fs.exists(tt):!1,[o,e]);return{writeFile:s,readFile:a,deleteFile:c,listDir:d,mkdir:b,exists:_e,isReady:e}}function useCache(){const{os:o,isBooted:e}=useGrudaOS(),s=reactExports.useCallback(async(_e,tt,nt)=>{if(e)return o.cache.set(_e,tt,nt)},[o,e]),a=reactExports.useCallback(async _e=>e?o.cache.get(_e):null,[o,e]),c=reactExports.useCallback(async _e=>{if(e)return o.cache.invalidate(_e)},[o,e]),d=reactExports.useCallback(async()=>{if(e)return o.cache.clear()},[o,e]),b=reactExports.useCallback(()=>e?o.cache.getStats():{memoryEntries:0,totalSize:0},[o,e]);return{set:s,get:a,invalidate:c,clear:d,getStats:b,isReady:e}}function useProcessManager(){const{os:o,isBooted:e}=useGrudaOS(),[s,a]=reactExports.useState([]),c=reactExports.useCallback(()=>{e&&a(o.processes.list())},[o,e]);reactExports.useEffect(()=>{if(e){c();const nt=setInterval(c,1e3);return()=>clearInterval(nt)}},[e,c]);const d=reactExports.useCallback((nt,it)=>{if(!e)return-1;const ot=o.processes.spawn(nt,it);return c(),ot},[o,e,c]),b=reactExports.useCallback(nt=>{if(!e)return!1;const it=o.processes.terminate(nt);return c(),it},[o,e,c]),_e=reactExports.useCallback(nt=>{if(!e)return!1;const it=o.processes.suspend(nt);return c(),it},[o,e,c]),tt=reactExports.useCallback(nt=>{if(!e)return!1;const it=o.processes.resume(nt);return c(),it},[o,e,c]);return{processes:s,spawn:d,terminate:b,suspend:_e,resume:tt,refresh:c,isReady:e}}function useSystemInfo(){const{os:o,isBooted:e}=useGrudaOS(),[s,a]=reactExports.useState(null);return reactExports.useEffect(()=>{if(e){const c=()=>a(o.getSystemInfo());c();const d=setInterval(c,1e3);return()=>clearInterval(d)}},[o,e]),{info:s,isReady:e}}const FileManager=()=>{const{openWindow:o}=useDesktop(),{listDir:e,writeFile:s,deleteFile:a,mkdir:c,readFile:d,isReady:b}=useFileSystem(),[_e,tt]=reactExports.useState("/"),[nt,it]=reactExports.useState([]),[ot,at]=reactExports.useState([]),[ct,ut]=reactExports.useState(!1),[ft,dt]=reactExports.useState("list"),[lt,ht]=reactExports.useState("name"),[mt,xt]=reactExports.useState(!1),[St,yt]=reactExports.useState(""),wt=reactExports.useRef(null),Et=reactExports.useCallback(async()=>{if(b){ut(!0);try{const Ct=(await e(_e)).map(Ut=>({name:Ut.name,path:Ut.path,type:Ut.type==="directory"?"folder":"file",size:Ut.size||0,modifiedAt:Ut.modified||new Date}));Ct.sort((Ut,Gt)=>Ut.type!==Gt.type?Ut.type==="folder"?-1:1:lt==="name"?Ut.name.localeCompare(Gt.name):lt==="size"?Gt.size-Ut.size:Gt.modifiedAt.getTime()-Ut.modifiedAt.getTime()),it(Ct)}catch(Ht){console.error("Failed to load directory:",Ht),it([])}finally{ut(!1)}}},[_e,e,b,lt]);reactExports.useEffect(()=>{Et()},[Et]);const _t=()=>{if(_e==="/")return;const Ht=_e.split("/").filter(Boolean);Ht.pop(),tt("/"+Ht.join("/")||"/")},vt=Ht=>{Ht.type==="folder"?(tt(Ht.path),at([])):Mt(Ht)},Mt=Ht=>{o({id:`file-${Date.now()}`,title:Ht.name,component:"TextEditor",props:{filePath:Ht.path,fileName:Ht.name},position:{x:100,y:100},size:{width:700,height:500}})},jt=async Ht=>{const Ct=Ht.target.files;if(Ct){for(const Ut of Array.from(Ct)){const Gt=await Ut.arrayBuffer(),Pt=_e==="/"?`/${Ut.name}`:`${_e}/${Ut.name}`;await s(Pt,Gt)}Et()}},Lt=async()=>{if(!St.trim())return;const Ht=_e==="/"?`/${St}`:`${_e}/${St}`;await c(Ht),xt(!1),yt(""),Et()},Nt=async()=>{for(const Ht of ot){const Ct=nt.find(Ut=>Ut.name===Ht);Ct&&await a(Ct.path)}at([]),Et()},kt=Ht=>{if(Ht===0)return"-";const Ct=1024,Ut=["B","KB","MB","GB"],Gt=Math.floor(Math.log(Ht)/Math.log(Ct));return parseFloat((Ht/Math.pow(Ct,Gt)).toFixed(1))+" "+Ut[Gt]},Ot=Ht=>{var Gt;if(Ht.type==="folder")return"";const Ct=(Gt=Ht.name.split(".").pop())==null?void 0:Gt.toLowerCase();return{txt:"",md:"",json:"",js:"",ts:"",tsx:"",css:"",html:"",png:"",jpg:"",gif:"",mp3:"",mp4:"",zip:"","7z":"",rar:""}[Ct||""]||""};return jsxRuntimeExports.jsxs("div",{className:"h-full flex flex-col bg-gradient-to-br from-[#0a0a0a] to-[#0d0d0d]",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gradient-to-r from-[#0a0a0a] to-[#1a1a1a] border-b border-[#1a5a5a]/50",children:[jsxRuntimeExports.jsx("button",{onClick:_t,disabled:_e==="/",className:"p-2 rounded-lg bg-[#1a1a1a] hover:bg-[#1a5a5a]/50 disabled:opacity-30 disabled:cursor-not-allowed transition-colors",title:"Go up",children:""}),jsxRuntimeExports.jsx("button",{onClick:Et,className:"p-2 rounded-lg bg-[#1a1a1a] hover:bg-[#1a5a5a]/50 transition-colors",title:"Refresh",children:""}),jsxRuntimeExports.jsx("div",{className:"flex-1 px-3 py-2 bg-[#0a0a0a] border border-[#1a5a5a]/50 rounded-lg text-sm text-white font-mono",children:_e}),jsxRuntimeExports.jsx("button",{onClick:()=>dt(ft==="list"?"grid":"list"),className:"p-2 rounded-lg bg-[#1a1a1a] hover:bg-[#1a5a5a]/50 transition-colors",title:ft==="list"?"Grid view":"List view",children:ft==="list"?"":""})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 p-2 bg-[#0a0a0a] border-b border-[#1a5a5a]/30",children:[jsxRuntimeExports.jsx("button",{onClick:()=>{var Ht;return(Ht=wt.current)==null?void 0:Ht.click()},className:"px-3 py-1.5 bg-gradient-to-r from-[#1a5a5a] to-[#2a7a7a] hover:from-[#2a7a7a] hover:to-[#3a9a9a] rounded-lg text-xs text-white font-medium transition-colors",children:" Upload"}),jsxRuntimeExports.jsx("button",{onClick:()=>xt(!0),className:"px-3 py-1.5 bg-gradient-to-r from-[#c9a227] to-[#d4b02f] hover:from-[#d4b02f] hover:to-[#e5c03f] rounded-lg text-xs text-black font-medium transition-colors",children:" New Folder"}),ot.length>0&&jsxRuntimeExports.jsxs("button",{onClick:Nt,className:"px-3 py-1.5 bg-gradient-to-r from-red-600 to-red-500 hover:from-red-500 hover:to-red-400 rounded-lg text-xs text-white font-medium transition-colors",children:[" Delete (",ot.length,")"]}),jsxRuntimeExports.jsx("div",{className:"flex-1"}),jsxRuntimeExports.jsxs("select",{value:lt,onChange:Ht=>ht(Ht.target.value),className:"px-2 py-1 bg-[#1a1a1a] border border-[#1a5a5a]/50 rounded text-xs text-white",children:[jsxRuntimeExports.jsx("option",{value:"name",children:"Sort: Name"}),jsxRuntimeExports.jsx("option",{value:"size",children:"Sort: Size"}),jsxRuntimeExports.jsx("option",{value:"date",children:"Sort: Date"})]})]}),jsxRuntimeExports.jsx("div",{className:"flex-1 overflow-auto p-2",children:ct?jsxRuntimeExports.jsx("div",{className:"flex items-center justify-center h-full",children:jsxRuntimeExports.jsx("div",{className:"text-[#c9a227] animate-pulse",children:"Loading..."})}):nt.length===0?jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-500",children:[jsxRuntimeExports.jsx("span",{className:"text-4xl mb-2",children:""}),jsxRuntimeExports.jsx("span",{children:"This folder is empty"})]}):ft==="grid"?jsxRuntimeExports.jsx("div",{className:"grid grid-cols-4 gap-3",children:nt.map(Ht=>jsxRuntimeExports.jsxs("div",{className:`flex flex-col items-center p-4 rounded-xl cursor-pointer transition-all ${ot.includes(Ht.name)?"bg-[#1a5a5a]/50 ring-2 ring-[#c9a227]":"bg-[#1a1a1a]/50 hover:bg-[#1a5a5a]/30"}`,onClick:()=>{ot.includes(Ht.name)?at(Ct=>Ct.filter(Ut=>Ut!==Ht.name)):at(Ct=>[...Ct,Ht.name])},onDoubleClick:()=>vt(Ht),children:[jsxRuntimeExports.jsx("span",{className:"text-4xl mb-2",children:Ot(Ht)}),jsxRuntimeExports.jsx("span",{className:"text-xs text-white text-center truncate w-full",children:Ht.name}),jsxRuntimeExports.jsx("span",{className:"text-xs text-gray-500",children:kt(Ht.size)})]},Ht.path))}):jsxRuntimeExports.jsxs("table",{className:"w-full text-sm",children:[jsxRuntimeExports.jsx("thead",{className:"sticky top-0 bg-[#0a0a0a]",children:jsxRuntimeExports.jsxs("tr",{className:"border-b border-[#1a5a5a]/50",children:[jsxRuntimeExports.jsx("th",{className:"text-left p-2 text-[#c9a227] font-medium",children:"Name"}),jsxRuntimeExports.jsx("th",{className:"text-left p-2 text-[#c9a227] font-medium w-24",children:"Size"}),jsxRuntimeExports.jsx("th",{className:"text-left p-2 text-[#c9a227] font-medium w-32",children:"Modified"})]})}),jsxRuntimeExports.jsx("tbody",{children:nt.map(Ht=>jsxRuntimeExports.jsxs("tr",{className:`border-b border-[#1a5a5a]/20 cursor-pointer transition-colors ${ot.includes(Ht.name)?"bg-[#1a5a5a]/40":"hover:bg-[#1a5a5a]/20"}`,onClick:()=>{ot.includes(Ht.name)?at(Ct=>Ct.filter(Ut=>Ut!==Ht.name)):at(Ct=>[...Ct,Ht.name])},onDoubleClick:()=>vt(Ht),children:[jsxRuntimeExports.jsxs("td",{className:"p-2 flex items-center gap-2",children:[jsxRuntimeExports.jsx("span",{children:Ot(Ht)}),jsxRuntimeExports.jsx("span",{className:"text-white",children:Ht.name})]}),jsxRuntimeExports.jsx("td",{className:"p-2 text-gray-400",children:kt(Ht.size)}),jsxRuntimeExports.jsx("td",{className:"p-2 text-gray-400",children:Ht.modifiedAt.toLocaleDateString()})]},Ht.path))})]})}),jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between p-2 bg-[#0a0a0a] border-t border-[#1a5a5a]/30 text-xs",children:[jsxRuntimeExports.jsxs("span",{className:"text-gray-400",children:[nt.length," items"]}),ot.length>0&&jsxRuntimeExports.jsxs("span",{className:"text-[#c9a227]",children:[ot.length," selected"]})]}),mt&&jsxRuntimeExports.jsx("div",{className:"absolute inset-0 bg-black/60 flex items-center justify-center backdrop-blur-sm",children:jsxRuntimeExports.jsxs("div",{className:"bg-gradient-to-br from-[#1a1a1a] to-[#0a0a0a] p-6 rounded-xl border border-[#1a5a5a]/50 w-80",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-bold text-[#c9a227] mb-4",children:"New Folder"}),jsxRuntimeExports.jsx("input",{type:"text",value:St,onChange:Ht=>yt(Ht.target.value),placeholder:"Folder name",className:"w-full px-3 py-2 bg-[#0a0a0a] border border-[#1a5a5a]/50 rounded-lg text-white text-sm mb-4 outline-none focus:border-[#c9a227]",autoFocus:!0,onKeyDown:Ht=>Ht.key==="Enter"&&Lt()}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2 justify-end",children:[jsxRuntimeExports.jsx("button",{onClick:()=>xt(!1),className:"px-4 py-2 bg-[#1a1a1a] hover:bg-[#2a2a2a] rounded-lg text-sm text-gray-400",children:"Cancel"}),jsxRuntimeExports.jsx("button",{onClick:Lt,className:"px-4 py-2 bg-gradient-to-r from-[#c9a227] to-[#d4b02f] rounded-lg text-sm text-black font-medium",children:"Create"})]})]})}),jsxRuntimeExports.jsx("input",{ref:wt,type:"file",multiple:!0,onChange:jt,className:"hidden"})]})},TextEditor=({fileName:o="untitled.txt"})=>{const[e,s]=reactExports.useState(""),[a,c]=reactExports.useState(o),[d,b]=reactExports.useState(!1),[_e,tt]=reactExports.useState(!1),nt=reactExports.useRef(null),it=ht=>{s(ht.target.value),b(!0)},ot=()=>{d&&!confirm("You have unsaved changes. Create new file?")||(s(""),c("untitled.txt"),b(!1))},at=()=>{var ht;(ht=nt.current)==null||ht.click()},ct=ht=>{var St;const mt=(St=ht.target.files)==null?void 0:St[0];if(!mt)return;const xt=new FileReader;xt.onload=yt=>{var wt;s(((wt=yt.target)==null?void 0:wt.result)||""),c(mt.name),b(!1)},xt.readAsText(mt)},ut=async()=>{tt(!0);try{if(typeof puter<"u"&&puter.fs)await puter.fs.write(`/documents/${a}`,e);else{const ht=new Blob([e],{type:"text/plain"}),mt=URL.createObjectURL(ht),xt=document.createElement("a");xt.href=mt,xt.download=a,xt.click(),URL.revokeObjectURL(mt)}b(!1)}catch(ht){console.error("Save failed:",ht)}tt(!1)},ft=()=>{navigator.clipboard.writeText(e)},dt=async()=>{try{const ht=await navigator.clipboard.readText();s(mt=>mt+ht),b(!0)}catch{console.log("Paste not available")}},lt=e.trim()?e.trim().split(/\s+/).length:0;return jsxRuntimeExports.jsxs("div",{className:"h-full flex flex-col bg-[#0a0a0a] text-white",children:[jsxRuntimeExports.jsx("div",{className:"bg-[#1a1a1a] border-b border-[#1a5a5a] p-1",children:jsxRuntimeExports.jsxs("div",{className:"flex gap-1 text-xs",children:[jsxRuntimeExports.jsx("button",{onClick:ot,className:"px-3 py-1 hover:bg-[#1a5a5a] rounded transition-colors",children:"New"}),jsxRuntimeExports.jsx("button",{onClick:at,className:"px-3 py-1 hover:bg-[#1a5a5a] rounded transition-colors",children:"Open"}),jsxRuntimeExports.jsx("button",{onClick:ut,className:"px-3 py-1 hover:bg-[#1a5a5a] rounded transition-colors",children:"Save"})]})}),jsxRuntimeExports.jsxs("div",{className:"bg-[#151515] border-b border-[#1a5a5a] p-2 flex gap-2",children:[jsxRuntimeExports.jsx("button",{onClick:ut,disabled:!d||_e,className:"px-3 py-1.5 bg-[#1a5a5a] hover:bg-[#1a6a6a] disabled:opacity-50 rounded text-xs transition-colors",children:_e?" Saving...":" Save"}),jsxRuntimeExports.jsx("button",{onClick:ft,className:"px-3 py-1.5 bg-[#252525] hover:bg-[#353535] rounded text-xs transition-colors",children:" Copy All"}),jsxRuntimeExports.jsx("button",{onClick:dt,className:"px-3 py-1.5 bg-[#252525] hover:bg-[#353535] rounded text-xs transition-colors",children:" Paste"}),jsxRuntimeExports.jsx("div",{className:"flex-1"}),d&&jsxRuntimeExports.jsx("span",{className:"text-[#c9a227] text-xs self-center",children:" Unsaved"})]}),jsxRuntimeExports.jsx("div",{className:"flex-1 p-2",children:jsxRuntimeExports.jsx("textarea",{value:e,onChange:it,className:"w-full h-full resize-none bg-[#0d0d0d] border border-[#1a5a5a] rounded p-3 font-mono text-sm text-white focus:outline-none focus:ring-1 focus:ring-[#1a5a5a]",placeholder:"Start typing...",spellCheck:!1})}),jsxRuntimeExports.jsxs("div",{className:"bg-[#1a5a5a] border-t border-[#1a5a5a] px-3 py-1.5 text-xs flex justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsxs("span",{children:[" ",a]}),d&&jsxRuntimeExports.jsx("span",{className:"text-[#c9a227]",children:"(modified)"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4 text-gray-200",children:[jsxRuntimeExports.jsxs("span",{children:["Lines: ",e.split(`
`).length]}),jsxRuntimeExports.jsxs("span",{children:["Words: ",lt]}),jsxRuntimeExports.jsxs("span",{children:["Chars: ",e.length]})]})]}),jsxRuntimeExports.jsx("input",{ref:nt,type:"file",accept:".txt,.md,.json,.js,.ts,.html,.css",className:"hidden",onChange:ct})]})},ExtractionResults=({archiveInfo:o})=>{const e=c=>{if(c===0)return"0 B";const d=1024,b=["B","KB","MB","GB"],_e=Math.floor(Math.log(c)/Math.log(d));return parseFloat((c/Math.pow(d,_e)).toFixed(2))+" "+b[_e]},s=((1-o.compressionRatio)*100).toFixed(1),a=o.totalSize-o.compressedSize;return jsxRuntimeExports.jsxs("div",{className:"h-full flex flex-col bg-[#0a0a0a] text-white",children:[jsxRuntimeExports.jsxs("div",{className:"bg-[#1a1a1a] border-b border-[#1a5a5a] p-3",children:[jsxRuntimeExports.jsx("h3",{className:"font-bold text-sm text-[#c9a227]",children:" Archive Extraction Complete"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-gray-400 mt-1",children:o.name})]}),jsxRuntimeExports.jsxs("div",{className:"bg-[#151515] border-b border-[#1a5a5a] p-3",children:[jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-4 text-xs",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"font-semibold text-gray-400",children:"Archive Type:"}),jsxRuntimeExports.jsx("div",{className:"text-[#1a5a5a] uppercase",children:o.type})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"font-semibold text-gray-400",children:"Files Extracted:"}),jsxRuntimeExports.jsx("div",{children:o.entries.filter(c=>!c.isDirectory).length})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"font-semibold text-gray-400",children:"Folders:"}),jsxRuntimeExports.jsx("div",{children:o.entries.filter(c=>c.isDirectory).length})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"font-semibold text-gray-400",children:"Total Size:"}),jsxRuntimeExports.jsx("div",{children:e(o.totalSize)})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"font-semibold text-gray-400",children:"Compressed Size:"}),jsxRuntimeExports.jsx("div",{children:e(o.compressedSize)})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"font-semibold text-gray-400",children:"Compression:"}),jsxRuntimeExports.jsxs("div",{className:"text-[#c9a227]",children:[s,"% saved"]})]})]}),jsxRuntimeExports.jsx("div",{className:"mt-3 p-2 bg-[#1a5a5a]/20 border border-[#1a5a5a] rounded",children:jsxRuntimeExports.jsxs("div",{className:"text-xs text-[#c9a227]",children:[" Space saved: ",e(a)," (",s,"% compression)"]})})]}),jsxRuntimeExports.jsx("div",{className:"flex-1 overflow-auto",children:jsxRuntimeExports.jsxs("div",{className:"p-2",children:[jsxRuntimeExports.jsx("h4",{className:"text-xs font-semibold mb-2 text-[#c9a227]",children:"Extracted Files:"}),jsxRuntimeExports.jsx("div",{className:"space-y-1",children:o.entries.map((c,d)=>jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 text-xs py-1 px-2 hover:bg-[#1a5a5a]/20 rounded transition-colors",children:[jsxRuntimeExports.jsx("span",{children:c.isDirectory?"":""}),jsxRuntimeExports.jsx("span",{className:"flex-1 font-mono",children:c.name}),jsxRuntimeExports.jsx("span",{className:"text-gray-500",children:!c.isDirectory&&e(c.size)}),jsxRuntimeExports.jsx("span",{className:"text-gray-600 text-xs",children:c.date.toLocaleTimeString()})]},d))})]})}),jsxRuntimeExports.jsx("div",{className:"bg-[#1a5a5a] border-t border-[#1a5a5a] p-2 text-xs",children:"Extraction completed successfully. Files are now available in the file system."})]})},PlayerModel=({appearance:o})=>{const e=reactExports.useRef(null),a=(c=>{switch(c){case"slim":return[.8,.9,.8];case"muscular":return[1.2,1.1,1.2];default:return[1,1,1]}})(o.build);return jsxRuntimeExports.jsxs("group",{ref:e,scale:[a[0],a[1]*o.height,a[2]],children:[jsxRuntimeExports.jsxs("mesh",{position:[0,1.5,0],children:[jsxRuntimeExports.jsx("boxGeometry",{args:[.5,.5,.5]}),jsxRuntimeExports.jsx("meshLambertMaterial",{color:o.skinColor})]}),jsxRuntimeExports.jsxs("mesh",{position:[0,1.7,0],children:[jsxRuntimeExports.jsx("boxGeometry",{args:[.6,.3,.6]}),jsxRuntimeExports.jsx("meshLambertMaterial",{color:o.hairColor})]}),jsxRuntimeExports.jsxs("mesh",{position:[-.1,1.55,.26],children:[jsxRuntimeExports.jsx("sphereGeometry",{args:[.05]}),jsxRuntimeExports.jsx("meshLambertMaterial",{color:o.eyeColor})]}),jsxRuntimeExports.jsxs("mesh",{position:[.1,1.55,.26],children:[jsxRuntimeExports.jsx("sphereGeometry",{args:[.05]}),jsxRuntimeExports.jsx("meshLambertMaterial",{color:o.eyeColor})]}),jsxRuntimeExports.jsxs("mesh",{position:[0,.8,0],children:[jsxRuntimeExports.jsx("boxGeometry",{args:[.8,1.2,.4]}),jsxRuntimeExports.jsx("meshLambertMaterial",{color:o.clothing.shirt})]}),jsxRuntimeExports.jsxs("mesh",{position:[-.6,.8,0],children:[jsxRuntimeExports.jsx("boxGeometry",{args:[.3,1,.3]}),jsxRuntimeExports.jsx("meshLambertMaterial",{color:o.skinColor})]}),jsxRuntimeExports.jsxs("mesh",{position:[.6,.8,0],children:[jsxRuntimeExports.jsx("boxGeometry",{args:[.3,1,.3]}),jsxRuntimeExports.jsx("meshLambertMaterial",{color:o.skinColor})]}),jsxRuntimeExports.jsxs("mesh",{position:[-.2,-.5,0],children:[jsxRuntimeExports.jsx("boxGeometry",{args:[.3,1.2,.3]}),jsxRuntimeExports.jsx("meshLambertMaterial",{color:o.clothing.pants})]}),jsxRuntimeExports.jsxs("mesh",{position:[.2,-.5,0],children:[jsxRuntimeExports.jsx("boxGeometry",{args:[.3,1.2,.3]}),jsxRuntimeExports.jsx("meshLambertMaterial",{color:o.clothing.pants})]}),jsxRuntimeExports.jsxs("mesh",{position:[-.2,-1.2,.1],children:[jsxRuntimeExports.jsx("boxGeometry",{args:[.4,.2,.5]}),jsxRuntimeExports.jsx("meshLambertMaterial",{color:o.clothing.shoes})]}),jsxRuntimeExports.jsxs("mesh",{position:[.2,-1.2,.1],children:[jsxRuntimeExports.jsx("boxGeometry",{args:[.4,.2,.5]}),jsxRuntimeExports.jsx("meshLambertMaterial",{color:o.clothing.shoes})]})]})},PlayerCreation=()=>{const{openWindow:o,closeWindow:e}=useDesktop(),[s,a]=reactExports.useState("name"),[c,d]=reactExports.useState({name:"",stats:{health:10,stamina:10,strength:10,intelligence:10,agility:10,luck:10},appearance:{skinColor:"#FDBCB4",hairColor:"#8B4513",hairStyle:"short",eyeColor:"#4169E1",height:1,build:"normal",clothing:{shirt:"#FF6347",pants:"#4169E1",shoes:"#8B4513"}},startingLocation:"spawn",difficulty:"normal"}),[b,_e]=reactExports.useState(20),tt=(dt,lt)=>{const ht=c.stats[dt],mt=lt-ht;b>=mt&&lt>=1&&lt<=20&&(d(xt=>({...xt,stats:{...xt.stats,[dt]:lt}})),_e(xt=>xt-mt))},nt=(dt,lt)=>{d(ht=>({...ht,appearance:{...ht.appearance,[dt]:lt}}))},it=(dt,lt)=>{d(ht=>({...ht,appearance:{...ht.appearance,clothing:{...ht.appearance.clothing,[dt]:lt}}}))},ot=()=>{if(!c.name.trim()){alert("Please enter a player name");return}localStorage.setItem("playerData",JSON.stringify(c)),e("player-creation"),o({id:"gruda-chain-box-game",title:`GRUDA CHAIN BOX - ${c.name}`,component:"GrudaChainBox",position:{x:50,y:50},size:{width:1200,height:800},props:{playerData:c}})},at=()=>jsxRuntimeExports.jsxs("div",{className:"p-6",children:[jsxRuntimeExports.jsx("h2",{className:"text-xl font-bold mb-4",children:"Create Your Character"}),jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Player Name:"}),jsxRuntimeExports.jsx("input",{type:"text",value:c.name,onChange:dt=>d(lt=>({...lt,name:dt.target.value})),className:"w-full px-3 py-2 border border-[#1a5a5a] bg-[#111] text-white text-sm rounded",placeholder:"Enter your name...",maxLength:16})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Difficulty:"}),jsxRuntimeExports.jsxs("select",{value:c.difficulty,onChange:dt=>d(lt=>({...lt,difficulty:dt.target.value})),className:"w-full px-3 py-2 border border-[#1a5a5a] bg-[#111] text-white text-sm rounded",children:[jsxRuntimeExports.jsx("option",{value:"easy",children:"Easy - More resources, regenerative health"}),jsxRuntimeExports.jsx("option",{value:"normal",children:"Normal - Balanced gameplay"}),jsxRuntimeExports.jsx("option",{value:"hard",children:"Hard - Limited resources, stronger enemies"}),jsxRuntimeExports.jsx("option",{value:"hardcore",children:"Hardcore - Permanent death"})]})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Starting Location:"}),jsxRuntimeExports.jsxs("select",{value:c.startingLocation,onChange:dt=>d(lt=>({...lt,startingLocation:dt.target.value})),className:"w-full px-3 py-2 border border-[#1a5a5a] bg-[#111] text-white text-sm rounded",children:[jsxRuntimeExports.jsx("option",{value:"spawn",children:"Spawn Village - Safe starting area"}),jsxRuntimeExports.jsx("option",{value:"forest",children:"Dense Forest - Rich in resources"}),jsxRuntimeExports.jsx("option",{value:"desert",children:"Desert Oasis - Harsh but rewarding"}),jsxRuntimeExports.jsx("option",{value:"mountain",children:"Mountain Peak - High altitude challenges"})]})]})]})]}),ct=()=>jsxRuntimeExports.jsxs("div",{className:"p-6",children:[jsxRuntimeExports.jsx("h2",{className:"text-xl font-bold mb-4",children:"Character Stats"}),jsxRuntimeExports.jsxs("p",{className:"text-sm text-[#c9a227] mb-4",children:["Available Points: ",b]}),jsxRuntimeExports.jsx("div",{className:"space-y-4",children:Object.entries(c.stats).map(([dt,lt])=>jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("label",{className:"text-sm font-semibold capitalize w-24",children:[dt,":"]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("button",{onClick:()=>tt(dt,lt-1),className:"w-6 h-6 bg-[#222] border border-[#1a5a5a] hover:bg-[#1a5a5a] text-white text-xs rounded",disabled:lt<=1,children:"-"}),jsxRuntimeExports.jsx("span",{className:"w-8 text-center text-sm",children:lt}),jsxRuntimeExports.jsx("button",{onClick:()=>tt(dt,lt+1),className:"w-6 h-6 bg-[#222] border border-[#1a5a5a] hover:bg-[#1a5a5a] text-white text-xs rounded",disabled:lt>=20||b<=0,children:"+"}),jsxRuntimeExports.jsx("div",{className:"w-20 bg-[#222] h-2 ml-2 rounded",children:jsxRuntimeExports.jsx("div",{className:"bg-blue-500 h-2",style:{width:`${lt/20*100}%`}})})]})]},dt))}),jsxRuntimeExports.jsxs("div",{className:"mt-4 text-xs text-gray-400",children:[jsxRuntimeExports.jsx("p",{children:"Health: Determines hit points and survival"}),jsxRuntimeExports.jsx("p",{children:"Stamina: Affects running and building speed"}),jsxRuntimeExports.jsx("p",{children:"Strength: Increases damage and carrying capacity"}),jsxRuntimeExports.jsx("p",{children:"Intelligence: Improves crafting and XP gain"}),jsxRuntimeExports.jsx("p",{children:"Agility: Affects movement speed and dodge chance"}),jsxRuntimeExports.jsx("p",{children:"Luck: Influences rare item drops and critical hits"})]})]}),ut=()=>jsxRuntimeExports.jsxs("div",{className:"p-6 flex gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsx("h2",{className:"text-xl font-bold mb-4",children:"Character Appearance"}),jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Build:"}),jsxRuntimeExports.jsxs("select",{value:c.appearance.build,onChange:dt=>nt("build",dt.target.value),className:"w-full px-3 py-2 border border-[#1a5a5a] bg-[#111] text-white text-sm rounded",children:[jsxRuntimeExports.jsx("option",{value:"slim",children:"Slim"}),jsxRuntimeExports.jsx("option",{value:"normal",children:"Normal"}),jsxRuntimeExports.jsx("option",{value:"muscular",children:"Muscular"})]})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Height:"}),jsxRuntimeExports.jsx("input",{type:"range",min:"0.8",max:"1.2",step:"0.1",value:c.appearance.height,onChange:dt=>nt("height",parseFloat(dt.target.value)),className:"w-full"}),jsxRuntimeExports.jsxs("span",{className:"text-xs text-[#c9a227]",children:[c.appearance.height,"x"]})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Skin Color:"}),jsxRuntimeExports.jsx("input",{type:"color",value:c.appearance.skinColor,onChange:dt=>nt("skinColor",dt.target.value),className:"w-full h-8 border border-[#1a5a5a] rounded"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Hair Color:"}),jsxRuntimeExports.jsx("input",{type:"color",value:c.appearance.hairColor,onChange:dt=>nt("hairColor",dt.target.value),className:"w-full h-8 border border-[#1a5a5a] rounded"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Eye Color:"}),jsxRuntimeExports.jsx("input",{type:"color",value:c.appearance.eyeColor,onChange:dt=>nt("eyeColor",dt.target.value),className:"w-full h-8 border border-[#1a5a5a] rounded"})]})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsx("h3",{className:"text-sm font-semibold",children:"Clothing:"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-xs mb-1",children:"Shirt:"}),jsxRuntimeExports.jsx("input",{type:"color",value:c.appearance.clothing.shirt,onChange:dt=>it("shirt",dt.target.value),className:"w-full h-6 border border-[#1a5a5a] rounded"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-xs mb-1",children:"Pants:"}),jsxRuntimeExports.jsx("input",{type:"color",value:c.appearance.clothing.pants,onChange:dt=>it("pants",dt.target.value),className:"w-full h-6 border border-[#1a5a5a] rounded"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-xs mb-1",children:"Shoes:"}),jsxRuntimeExports.jsx("input",{type:"color",value:c.appearance.clothing.shoes,onChange:dt=>it("shoes",dt.target.value),className:"w-full h-6 border border-[#1a5a5a] rounded"})]})]})]})]})]}),jsxRuntimeExports.jsx("div",{className:"w-64 h-64 border border-[#1a5a5a] rounded bg-[#111]",children:jsxRuntimeExports.jsxs(Canvas,{camera:{position:[0,0,3],fov:50},children:[jsxRuntimeExports.jsx("ambientLight",{intensity:.4}),jsxRuntimeExports.jsx("directionalLight",{position:[10,10,5],intensity:1}),jsxRuntimeExports.jsx(PlayerModel,{appearance:c.appearance}),jsxRuntimeExports.jsx(OrbitControls,{enableZoom:!1}),jsxRuntimeExports.jsx(Environment,{preset:"studio"})]})})]}),ft=()=>{switch(s){case"name":return at();case"stats":return ct();case"appearance":return ut();default:return at()}};return jsxRuntimeExports.jsxs("div",{className:"h-full flex flex-col bg-[#0a0a0a] text-white",children:[jsxRuntimeExports.jsx("div",{className:"bg-[#111] border-b border-[#1a5a5a] p-2",children:jsxRuntimeExports.jsxs("div",{className:"flex justify-between text-xs gap-2",children:[jsxRuntimeExports.jsx("button",{onClick:()=>a("name"),className:`px-3 py-1 rounded transition-colors ${s==="name"?"bg-[#1a5a5a] text-white":"bg-[#222] text-gray-400 hover:bg-[#333]"}`,children:"1. Basic Info"}),jsxRuntimeExports.jsx("button",{onClick:()=>a("stats"),className:`px-3 py-1 rounded transition-colors ${s==="stats"?"bg-[#1a5a5a] text-white":"bg-[#222] text-gray-400 hover:bg-[#333]"}`,children:"2. Stats"}),jsxRuntimeExports.jsx("button",{onClick:()=>a("appearance"),className:`px-3 py-1 rounded transition-colors ${s==="appearance"?"bg-[#1a5a5a] text-white":"bg-[#222] text-gray-400 hover:bg-[#333]"}`,children:"3. Appearance"})]})}),jsxRuntimeExports.jsx("div",{className:"flex-1 overflow-auto",children:ft()}),jsxRuntimeExports.jsxs("div",{className:"bg-[#111] border-t border-[#1a5a5a] p-3 flex justify-between",children:[jsxRuntimeExports.jsx("button",{onClick:()=>{const dt=["name","stats","appearance"],lt=dt.indexOf(s);lt>0&&a(dt[lt-1])},disabled:s==="name",className:"px-4 py-2 bg-[#222] border border-[#333] hover:bg-[#333] text-sm disabled:opacity-50 rounded text-gray-300",children:" Previous"}),jsxRuntimeExports.jsx("button",{onClick:()=>{if(s==="appearance")ot();else{const dt=["name","stats","appearance"],lt=dt.indexOf(s);lt<dt.length-1&&a(dt[lt+1])}},className:"px-4 py-2 bg-[#c9a227] text-[#0a0a0a] font-medium border border-[#d9b237] hover:bg-[#d9b237] text-sm rounded",children:s==="appearance"?"Create Character":"Next "})]})]})},WEAPONS=[{id:"pistol",name:"Pistol",damage:20,fireRate:300,ammo:12,maxAmmo:12,reloadTime:1500,spread:.02,range:50,color:"#888888"},{id:"rifle",name:"Assault Rifle",damage:25,fireRate:100,ammo:30,maxAmmo:30,reloadTime:2e3,spread:.05,range:80,color:"#4a4a4a"},{id:"shotgun",name:"Shotgun",damage:80,fireRate:800,ammo:6,maxAmmo:6,reloadTime:2500,spread:.15,range:20,color:"#8B4513"},{id:"sniper",name:"Sniper",damage:100,fireRate:1500,ammo:5,maxAmmo:5,reloadTime:3e3,spread:.005,range:200,color:"#2F4F4F"},{id:"smg",name:"SMG",damage:15,fireRate:60,ammo:35,maxAmmo:35,reloadTime:1800,spread:.08,range:40,color:"#696969"}],PLAYER_SPEED$2=10,SPRINT_MULTIPLIER=1.6,CROUCH_MULTIPLIER=.5,JUMP_FORCE=12,GRAVITY$1=30,BULLET_SPEED=120,MAP_SIZE=200,INITIAL_PLAYERS=20;function LAGangMap(){const o=useGLTF("/models/la_gang/scene.gltf");return jsxRuntimeExports.jsx("primitive",{object:o.scene,scale:[.5,.5,.5],position:[0,-2,0],receiveShadow:!0,castShadow:!0})}function FallbackMap(){const o=reactExports.useMemo(()=>{const s=document.createElement("canvas");s.width=512,s.height=512;const a=s.getContext("2d");a.fillStyle="#3a5a3a",a.fillRect(0,0,512,512);for(let d=0;d<1e3;d++)a.fillStyle=`rgba(${30+Math.random()*40}, ${60+Math.random()*40}, ${30+Math.random()*40}, 0.5)`,a.fillRect(Math.random()*512,Math.random()*512,2,2);const c=new CanvasTexture(s);return c.wrapS=c.wrapT=RepeatWrapping,c.repeat.set(20,20),c},[]),e=reactExports.useMemo(()=>{const s=[];for(let a=0;a<40;a++){const c=(Math.random()-.5)*MAP_SIZE*.8,d=(Math.random()-.5)*MAP_SIZE*.8,b=8+Math.random()*15,_e=8+Math.random()*15,tt=10+Math.random()*30;s.push({x:c,z:d,width:b,depth:_e,height:tt,color:`hsl(${20+Math.random()*20}, 30%, ${30+Math.random()*20}%)`})}return s},[]);return jsxRuntimeExports.jsxs("group",{children:[jsxRuntimeExports.jsxs("mesh",{rotation:[-Math.PI/2,0,0],receiveShadow:!0,position:[0,0,0],children:[jsxRuntimeExports.jsx("planeGeometry",{args:[MAP_SIZE,MAP_SIZE]}),jsxRuntimeExports.jsx("meshStandardMaterial",{map:o})]}),e.map((s,a)=>jsxRuntimeExports.jsxs("mesh",{position:[s.x,s.height/2,s.z],castShadow:!0,receiveShadow:!0,children:[jsxRuntimeExports.jsx("boxGeometry",{args:[s.width,s.height,s.depth]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:s.color})]},a)),jsxRuntimeExports.jsxs("mesh",{position:[0,.1,0],rotation:[-Math.PI/2,0,0],children:[jsxRuntimeExports.jsx("ringGeometry",{args:[MAP_SIZE*.3,MAP_SIZE*.32,64]}),jsxRuntimeExports.jsx("meshBasicMaterial",{color:"#444"})]})]})}function StormCircle({zone:o}){const e=reactExports.useRef(null);return useFrame(()=>{e.current&&e.current.position.set(o.center.x,50,o.center.y)}),jsxRuntimeExports.jsxs("group",{children:[jsxRuntimeExports.jsxs("mesh",{ref:e,rotation:[-Math.PI/2,0,0],children:[jsxRuntimeExports.jsx("ringGeometry",{args:[o.currentRadius,o.currentRadius+500,128]}),jsxRuntimeExports.jsx("meshBasicMaterial",{color:"#6a1b9a",transparent:!0,opacity:.4,side:DoubleSide})]}),jsxRuntimeExports.jsxs("mesh",{position:[o.center.x,.2,o.center.y],rotation:[-Math.PI/2,0,0],children:[jsxRuntimeExports.jsx("ringGeometry",{args:[o.targetRadius-1,o.targetRadius+1,64]}),jsxRuntimeExports.jsx("meshBasicMaterial",{color:"#ffffff",transparent:!0,opacity:.6})]})]})}function PlayerController$1({playerData:o,onShoot:e,bots:s,onPlayerUpdate:a,zone:c,loot:d,onPickupLoot:b}){const{camera:_e}=useThree(),[,tt]=useKeyboardControls(),nt=reactExports.useRef(new Vector3),it=reactExports.useRef(new Vector3(o.position.x,o.position.y,o.position.z)),ot=reactExports.useRef(!0),at=reactExports.useRef(!0),ct=reactExports.useRef(!1),ut=reactExports.useRef(!1),ft=reactExports.useRef(0);return useFrame((dt,lt)=>{if(!o.isAlive)return;const ht=tt();ut.current=ht.crouch;let mt=PLAYER_SPEED$2;ht.sprint&&!ut.current&&(mt*=SPRINT_MULTIPLIER),ut.current&&(mt*=CROUCH_MULTIPLIER);const xt=new Vector3,St=new Vector3;_e.getWorldDirection(xt),xt.y=0,xt.normalize(),St.crossVectors(xt,new Vector3(0,1,0));const yt=new Vector3;ht.forward&&yt.add(xt),ht.back&&yt.sub(xt),ht.left&&yt.sub(St),ht.right&&yt.add(St),yt.length()>0&&(yt.normalize(),it.current.x+=yt.x*mt*lt,it.current.z+=yt.z*mt*lt),ht.jump&&ot.current&&(nt.current.y=JUMP_FORCE,ot.current=!1),nt.current.y-=GRAVITY$1*lt,it.current.y+=nt.current.y*lt;const wt=ut.current?1.2:2;it.current.y<=wt&&(it.current.y=wt,nt.current.y=0,ot.current=!0);const Et=MAP_SIZE/2-5;if(it.current.x=Math.max(-Et,Math.min(Et,it.current.x)),it.current.z=Math.max(-Et,Math.min(Et,it.current.z)),_e.position.copy(it.current),Math.sqrt(Math.pow(it.current.x-c.center.x,2)+Math.pow(it.current.z-c.center.y,2))>c.currentRadius){const vt=Date.now();vt-ft.current>1e3&&(ft.current=vt,a({health:Math.max(0,o.health-c.damage),position:it.current.clone()}))}else a({position:it.current.clone()});for(const vt of d)it.current.distanceTo(vt.position)<3&&ht.interact&&b(vt.id);ht.reload&&o.weapon&&!ct.current&&(ct.current=!0,setTimeout(()=>{o.weapon&&a({weapon:{...o.weapon,ammo:o.weapon.maxAmmo}}),ct.current=!1},o.weapon.reloadTime))}),reactExports.useEffect(()=>{const dt=lt=>{if(lt.button===0&&at.current&&o.weapon&&o.weapon.ammo>0&&o.isAlive&&!ct.current){at.current=!1;const ht=new Vector3;_e.getWorldDirection(ht),ht.x+=(Math.random()-.5)*o.weapon.spread,ht.y+=(Math.random()-.5)*o.weapon.spread,ht.z+=(Math.random()-.5)*o.weapon.spread,ht.normalize();const mt={id:`bullet_${Date.now()}_${Math.random()}`,position:it.current.clone().add(ht.clone().multiplyScalar(1)),direction:ht.clone(),speed:BULLET_SPEED,damage:o.weapon.damage,ownerId:o.id,createdAt:Date.now()};e(mt),a({weapon:{...o.weapon,ammo:o.weapon.ammo-1}}),setTimeout(()=>{at.current=!0},o.weapon.fireRate)}};return window.addEventListener("mousedown",dt),()=>window.removeEventListener("mousedown",dt)},[_e,e,o,a]),null}function BotMesh({bot:o}){const e=reactExports.useRef(null);return useFrame(()=>{e.current&&o.isAlive&&(e.current.position.copy(o.position),e.current.rotation.y=o.rotation)}),o.isAlive?jsxRuntimeExports.jsxs("group",{ref:e,children:[jsxRuntimeExports.jsxs("mesh",{position:[0,.9,0],castShadow:!0,children:[jsxRuntimeExports.jsx("boxGeometry",{args:[.8,1.8,.5]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#4a5568"})]}),jsxRuntimeExports.jsxs("mesh",{position:[0,2,0],castShadow:!0,children:[jsxRuntimeExports.jsx("sphereGeometry",{args:[.35,16,16]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#e2a87f"})]}),o.weapon&&jsxRuntimeExports.jsxs("mesh",{position:[.5,.8,-.3],rotation:[0,0,-.3],children:[jsxRuntimeExports.jsx("boxGeometry",{args:[.1,.1,.6]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:o.weapon.color})]}),jsxRuntimeExports.jsxs("mesh",{position:[0,2.8,0],children:[jsxRuntimeExports.jsx("planeGeometry",{args:[1.2,.15]}),jsxRuntimeExports.jsx("meshBasicMaterial",{color:"#1a1a1a",transparent:!0,opacity:.8})]}),jsxRuntimeExports.jsxs("mesh",{position:[-(1.2-o.health/100*1.2)/2,2.8,.01],children:[jsxRuntimeExports.jsx("planeGeometry",{args:[o.health/100*1.2,.1]}),jsxRuntimeExports.jsx("meshBasicMaterial",{color:o.health>50?"#22c55e":o.health>25?"#eab308":"#ef4444"})]})]}):null}function LootMesh({item:o}){const e=reactExports.useRef(null);useFrame(a=>{e.current&&(e.current.rotation.y=a.clock.elapsedTime*2,e.current.position.y=o.position.y+Math.sin(a.clock.elapsedTime*3)*.2)});const s=()=>{switch(o.type){case"weapon":return"#c9a227";case"ammo":return"#f59e0b";case"health":return"#ef4444";case"shield":return"#3b82f6"}};return jsxRuntimeExports.jsxs("mesh",{ref:e,position:[o.position.x,o.position.y,o.position.z],children:[jsxRuntimeExports.jsx("boxGeometry",{args:[.6,.6,.6]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:s(),emissive:s(),emissiveIntensity:.5})]})}function BulletMesh({bullet:o}){const e=reactExports.useRef(null);return useFrame(()=>{e.current&&e.current.position.copy(o.position)}),jsxRuntimeExports.jsxs("mesh",{ref:e,children:[jsxRuntimeExports.jsx("sphereGeometry",{args:[.08,6,6]}),jsxRuntimeExports.jsx("meshBasicMaterial",{color:"#ffff00"})]})}function GameScene$2({player:o,bots:e,bullets:s,loot:a,zone:c,onShoot:d,onPlayerUpdate:b,onPickupLoot:_e}){return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("ambientLight",{intensity:.3}),jsxRuntimeExports.jsx("directionalLight",{position:[100,100,50],intensity:1.2,castShadow:!0,"shadow-mapSize":[4096,4096],"shadow-camera-far":500,"shadow-camera-left":-100,"shadow-camera-right":100,"shadow-camera-top":100,"shadow-camera-bottom":-100}),jsxRuntimeExports.jsx("hemisphereLight",{intensity:.4,color:"#87ceeb",groundColor:"#3a5a3a"}),jsxRuntimeExports.jsx(Sky,{sunPosition:[100,50,100],turbidity:8,rayleigh:.5,mieCoefficient:.005,mieDirectionalG:.8}),jsxRuntimeExports.jsx("fog",{attach:"fog",args:["#87ceeb",100,400]}),jsxRuntimeExports.jsx(reactExports.Suspense,{fallback:jsxRuntimeExports.jsx(FallbackMap,{}),children:jsxRuntimeExports.jsx(LAGangMap,{})}),jsxRuntimeExports.jsx(FallbackMap,{}),jsxRuntimeExports.jsx(StormCircle,{zone:c}),o.isAlive&&jsxRuntimeExports.jsx(PlayerController$1,{playerData:o,onShoot:d,bots:e,onPlayerUpdate:b,zone:c,loot:a,onPickupLoot:_e}),jsxRuntimeExports.jsx(PointerLockControls,{}),e.map(tt=>jsxRuntimeExports.jsx(BotMesh,{bot:tt},tt.id)),a.map(tt=>jsxRuntimeExports.jsx(LootMesh,{item:tt},tt.id)),s.map(tt=>jsxRuntimeExports.jsx(BulletMesh,{bullet:tt},tt.id))]})}function GameUI$5({player:o,playersAlive:e,zone:s,kills:a,gameTime:c}){const d=_e=>{const tt=Math.floor(_e/1e3),nt=Math.floor(tt/60),it=tt%60;return`${nt}:${it.toString().padStart(2,"0")}`},b=Math.max(0,s.nextShrinkTime-Date.now());return jsxRuntimeExports.jsxs("div",{className:"absolute inset-0 pointer-events-none select-none",children:[jsxRuntimeExports.jsxs("div",{className:"absolute top-4 left-1/2 transform -translate-x-1/2 flex gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"bg-[#0a0a0a]/90 border border-[#c9a227] px-6 py-2 rounded text-white text-center",children:[jsxRuntimeExports.jsx("div",{className:"text-2xl font-bold text-[#c9a227]",children:e}),jsxRuntimeExports.jsx("div",{className:"text-xs text-gray-400",children:"ALIVE"})]}),jsxRuntimeExports.jsxs("div",{className:"bg-[#0a0a0a]/90 border border-[#1a5a5a] px-6 py-2 rounded text-white text-center",children:[jsxRuntimeExports.jsx("div",{className:"text-2xl font-bold",children:a}),jsxRuntimeExports.jsx("div",{className:"text-xs text-gray-400",children:"KILLS"})]}),jsxRuntimeExports.jsxs("div",{className:"bg-[#0a0a0a]/90 border border-gray-600 px-6 py-2 rounded text-white text-center",children:[jsxRuntimeExports.jsx("div",{className:"text-2xl font-bold",children:d(c)}),jsxRuntimeExports.jsx("div",{className:"text-xs text-gray-400",children:"TIME"})]})]}),jsxRuntimeExports.jsxs("div",{className:"absolute top-4 right-4 bg-[#0a0a0a]/90 border border-purple-600 p-3 rounded text-white",children:[jsxRuntimeExports.jsxs("div",{className:"text-purple-400 text-sm font-bold",children:["STORM PHASE ",s.phase]}),jsxRuntimeExports.jsxs("div",{className:"text-xs text-gray-400",children:["Next circle: ",d(b)]}),jsxRuntimeExports.jsxs("div",{className:"text-xs text-red-400",children:["Damage: ",s.damage,"/sec"]})]}),jsxRuntimeExports.jsxs("div",{className:"absolute bottom-4 left-4 bg-[#0a0a0a]/90 border border-gray-700 p-4 rounded",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[jsxRuntimeExports.jsx("span",{className:"text-red-500 text-lg",children:""}),jsxRuntimeExports.jsx("div",{className:"w-40 h-5 bg-gray-800 rounded overflow-hidden border border-gray-700",children:jsxRuntimeExports.jsx("div",{className:"h-full bg-gradient-to-r from-red-600 to-red-500 transition-all duration-300",style:{width:`${o.health}%`}})}),jsxRuntimeExports.jsx("span",{className:"text-white font-mono w-12",children:o.health})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("span",{className:"text-blue-400 text-lg",children:""}),jsxRuntimeExports.jsx("div",{className:"w-40 h-5 bg-gray-800 rounded overflow-hidden border border-gray-700",children:jsxRuntimeExports.jsx("div",{className:"h-full bg-gradient-to-r from-blue-600 to-blue-400 transition-all duration-300",style:{width:`${o.shield}%`}})}),jsxRuntimeExports.jsx("span",{className:"text-white font-mono w-12",children:o.shield})]})]}),o.weapon&&jsxRuntimeExports.jsxs("div",{className:"absolute bottom-4 right-4 bg-[#0a0a0a]/90 border border-[#c9a227] p-4 rounded",children:[jsxRuntimeExports.jsx("div",{className:"text-[#c9a227] font-bold text-lg",children:o.weapon.name}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[jsxRuntimeExports.jsx("div",{className:"text-white text-2xl font-mono",children:o.weapon.ammo}),jsxRuntimeExports.jsx("div",{className:"text-gray-500 text-xl",children:"/"}),jsxRuntimeExports.jsx("div",{className:"text-gray-400 text-lg",children:o.weapon.maxAmmo})]}),jsxRuntimeExports.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"[R] Reload"})]}),jsxRuntimeExports.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2",children:jsxRuntimeExports.jsxs("div",{className:"relative w-8 h-8",children:[jsxRuntimeExports.jsx("div",{className:"absolute top-1/2 left-0 w-3 h-0.5 bg-white/80 -translate-y-1/2"}),jsxRuntimeExports.jsx("div",{className:"absolute top-1/2 right-0 w-3 h-0.5 bg-white/80 -translate-y-1/2"}),jsxRuntimeExports.jsx("div",{className:"absolute left-1/2 top-0 w-0.5 h-3 bg-white/80 -translate-x-1/2"}),jsxRuntimeExports.jsx("div",{className:"absolute left-1/2 bottom-0 w-0.5 h-3 bg-white/80 -translate-x-1/2"}),jsxRuntimeExports.jsx("div",{className:"absolute top-1/2 left-1/2 w-1 h-1 bg-red-500 rounded-full -translate-x-1/2 -translate-y-1/2"})]})}),jsxRuntimeExports.jsxs("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 bg-[#0a0a0a]/80 px-4 py-2 rounded text-white text-sm",children:[jsxRuntimeExports.jsx("span",{className:"text-gray-400",children:"WASD"})," Move ",jsxRuntimeExports.jsx("span",{className:"text-gray-400",children:" SHIFT"})," Sprint ",jsxRuntimeExports.jsx("span",{className:"text-gray-400",children:" CTRL"})," Crouch ",jsxRuntimeExports.jsx("span",{className:"text-gray-400",children:" SPACE"})," Jump ",jsxRuntimeExports.jsx("span",{className:"text-gray-400",children:" E"})," Pick Up ",jsxRuntimeExports.jsx("span",{className:"text-gray-400",children:" CLICK"})," Shoot"]}),jsxRuntimeExports.jsx("div",{className:"absolute top-20 right-4 w-32 h-32 bg-[#0a0a0a]/80 border border-gray-700 rounded overflow-hidden",children:jsxRuntimeExports.jsxs("div",{className:"w-full h-full relative",children:[jsxRuntimeExports.jsx("div",{className:"absolute w-2 h-2 bg-white rounded-full",style:{left:`${50+o.position.x/MAP_SIZE*100}%`,top:`${50+o.position.z/MAP_SIZE*100}%`,transform:"translate(-50%, -50%)"}}),jsxRuntimeExports.jsx("div",{className:"absolute border-2 border-purple-500 rounded-full",style:{width:`${s.currentRadius/MAP_SIZE*200}%`,height:`${s.currentRadius/MAP_SIZE*200}%`,left:`${50+s.center.x/MAP_SIZE*100}%`,top:`${50+s.center.y/MAP_SIZE*100}%`,transform:"translate(-50%, -50%)"}}),jsxRuntimeExports.jsx("div",{className:"absolute border border-white/50 rounded-full",style:{width:`${s.targetRadius/MAP_SIZE*200}%`,height:`${s.targetRadius/MAP_SIZE*200}%`,left:`${50+s.center.x/MAP_SIZE*100}%`,top:`${50+s.center.y/MAP_SIZE*100}%`,transform:"translate(-50%, -50%)"}})]})})]})}const keyMap$5=[{name:"forward",keys:["ArrowUp","KeyW"]},{name:"back",keys:["ArrowDown","KeyS"]},{name:"left",keys:["ArrowLeft","KeyA"]},{name:"right",keys:["ArrowRight","KeyD"]},{name:"jump",keys:["Space"]},{name:"sprint",keys:["ShiftLeft","ShiftRight"]},{name:"reload",keys:["KeyR"]},{name:"crouch",keys:["ControlLeft","ControlRight","KeyC"]},{name:"interact",keys:["KeyE"]},{name:"weapon1",keys:["Digit1"]},{name:"weapon2",keys:["Digit2"]},{name:"weapon3",keys:["Digit3"]}];function FPSArena(){const[o,e]=reactExports.useState("menu"),[s,a]=reactExports.useState(null),[c,d]=reactExports.useState([]),[b,_e]=reactExports.useState([]),[tt,nt]=reactExports.useState([]),[it,ot]=reactExports.useState({center:new Vector2(0,0),currentRadius:MAP_SIZE,targetRadius:MAP_SIZE*.7,damage:1,phase:1,shrinkSpeed:.5,nextShrinkTime:Date.now()+6e4}),[at,ct]=reactExports.useState(0),[ut,ft]=reactExports.useState(0),dt=reactExports.useRef(0),lt=reactExports.useCallback(()=>{const yt=Math.random()*Math.PI*2,wt=MAP_SIZE*.3,Et={id:"player",position:new Vector3(Math.cos(yt)*wt,2,Math.sin(yt)*wt),rotation:0,health:100,shield:0,isAlive:!0,kills:0,weapon:{...WEAPONS[0]},isBot:!1,name:"You",lastShot:0},_t=[];for(let Mt=0;Mt<INITIAL_PLAYERS-1;Mt++){const jt=Math.random()*Math.PI*2,Lt=20+Math.random()*(MAP_SIZE*.4);_t.push({id:`bot_${Mt}`,position:new Vector3(Math.cos(jt)*Lt,2,Math.sin(jt)*Lt),rotation:Math.random()*Math.PI*2,health:100,shield:Math.random()>.7?50:0,isAlive:!0,kills:0,weapon:{...WEAPONS[Math.floor(Math.random()*WEAPONS.length)]},isBot:!0,name:`Bot ${Mt+1}`,targetPosition:void 0,lastShot:0})}const vt=[];for(let Mt=0;Mt<50;Mt++){const jt=Math.random()*Math.PI*2,Lt=Math.random()*MAP_SIZE*.4,Nt=["weapon","ammo","health","shield"][Math.floor(Math.random()*4)];vt.push({id:`loot_${Mt}`,position:new Vector3(Math.cos(jt)*Lt,1,Math.sin(jt)*Lt),type:Nt,weapon:Nt==="weapon"?{...WEAPONS[Math.floor(Math.random()*WEAPONS.length)]}:void 0,amount:Nt==="ammo"?30:Nt==="health"||Nt==="shield"?25:void 0})}a(Et),d(_t),nt(vt),_e([]),ft(0),ot({center:new Vector2(0,0),currentRadius:MAP_SIZE,targetRadius:MAP_SIZE*.7,damage:1,phase:1,shrinkSpeed:.5,nextShrinkTime:Date.now()+6e4}),dt.current=Date.now(),e("playing")},[]);reactExports.useEffect(()=>{if(o!=="playing")return;const yt=setInterval(()=>{ct(Date.now()-dt.current),ot(Et=>{const _t=Date.now();let vt={...Et};if(Et.currentRadius>Et.targetRadius&&(vt.currentRadius=Math.max(Et.targetRadius,Et.currentRadius-Et.shrinkSpeed)),_t>Et.nextShrinkTime&&Et.currentRadius<=Et.targetRadius){const Mt=Et.phase+1,jt=Math.max(10,Et.targetRadius*.6),Lt=(Math.random()-.5)*(Et.targetRadius*.3),Nt=(Math.random()-.5)*(Et.targetRadius*.3);vt={...vt,phase:Mt,targetRadius:jt,center:new Vector2(Math.max(-MAP_SIZE/2+jt,Math.min(MAP_SIZE/2-jt,Et.center.x+Lt)),Math.max(-MAP_SIZE/2+jt,Math.min(MAP_SIZE/2-jt,Et.center.y+Nt))),damage:Math.min(10,Et.damage+1),shrinkSpeed:Et.shrinkSpeed+.2,nextShrinkTime:_t+45e3}}return vt}),d(Et=>Et.map(_t=>{if(!_t.isAlive)return _t;const vt=Math.sqrt(Math.pow(_t.position.x-it.center.x,2)+Math.pow(_t.position.z-it.center.y,2));let Mt=_t.health;if(vt>it.currentRadius&&(Mt=Math.max(0,_t.health-it.damage*.05)),Mt<=0)return{..._t,health:0,isAlive:!1};const jt=new Vector3;if(vt>it.currentRadius*.8?(jt.x=it.center.x-_t.position.x,jt.z=it.center.y-_t.position.z):Math.random()<.02&&(jt.x=(Math.random()-.5)*2,jt.z=(Math.random()-.5)*2),jt.length()>0){jt.normalize();const Lt=_t.position.clone();Lt.x+=jt.x*.1,Lt.z+=jt.z*.1;const Nt=MAP_SIZE/2-5;return Lt.x=Math.max(-Nt,Math.min(Nt,Lt.x)),Lt.z=Math.max(-Nt,Math.min(Nt,Lt.z)),{..._t,position:Lt,rotation:Math.atan2(jt.x,jt.z),health:Mt}}return{..._t,health:Mt}})),_e(Et=>Et.filter(_t=>{if(Date.now()-_t.createdAt>3e3||(_t.position.add(_t.direction.clone().multiplyScalar(_t.speed*.016)),Math.abs(_t.position.x)>MAP_SIZE/2||Math.abs(_t.position.z)>MAP_SIZE/2))return!1;if(_t.ownerId==="player"){for(const vt of c)if(vt.isAlive&&_t.position.distanceTo(vt.position)<1.5)return d(Mt=>Mt.map(jt=>{if(jt.id===vt.id){const Lt=Math.max(0,jt.health-_t.damage);return Lt<=0?(ft(Nt=>Nt+1),{...jt,health:0,isAlive:!1}):{...jt,health:Lt}}return jt})),!1}else if(s&&s.isAlive&&_t.position.distanceTo(s.position)<1.2)return a(vt=>{if(!vt)return vt;let Mt=_t.damage,jt=vt.shield,Lt=vt.health;if(jt>0){const Nt=Math.min(jt,Mt);jt-=Nt,Mt-=Nt}return Lt=Math.max(0,Lt-Mt),Lt<=0&&setTimeout(()=>e("defeat"),500),{...vt,health:Lt,shield:jt,isAlive:Lt>0}}),!1;return!0}));const wt=c.filter(Et=>Et.isAlive);s&&s.isAlive&&wt.length===0&&e("victory")},16);return()=>clearInterval(yt)},[o,c,s,it]);const ht=reactExports.useCallback(yt=>{_e(wt=>[...wt,yt])},[]),mt=reactExports.useCallback(yt=>{a(wt=>{if(!wt)return wt;const Et={...wt,...yt};return Et.health<=0&&(Et.isAlive=!1,setTimeout(()=>e("defeat"),500)),Et})},[]),xt=reactExports.useCallback(yt=>{const wt=tt.find(Et=>Et.id===yt);if(!(!wt||!s))switch(nt(Et=>Et.filter(_t=>_t.id!==yt)),wt.type){case"weapon":wt.weapon&&a(Et=>Et&&{...Et,weapon:wt.weapon});break;case"ammo":s.weapon&&a(Et=>Et&&{...Et,weapon:{...Et.weapon,ammo:Math.min(Et.weapon.maxAmmo,Et.weapon.ammo+(wt.amount||0))}});break;case"health":a(Et=>Et&&{...Et,health:Math.min(100,Et.health+(wt.amount||0))});break;case"shield":a(Et=>Et&&{...Et,shield:Math.min(100,Et.shield+(wt.amount||0))});break}},[tt,s]);if(o==="menu")return jsxRuntimeExports.jsx("div",{className:"w-full h-full bg-gradient-to-b from-[#1a5a5a] via-[#0a0a0a] to-[#0a0a0a] flex flex-col items-center justify-center",children:jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("h1",{className:"text-7xl font-black mb-2 text-white",style:{textShadow:"0 0 30px #c9a227, 0 0 60px #c9a227"},children:"BATTLE ROYALE"}),jsxRuntimeExports.jsx("p",{className:"text-2xl text-[#c9a227] mb-8",children:"LA GANG WARS"}),jsxRuntimeExports.jsx("button",{onClick:lt,className:"px-12 py-5 bg-gradient-to-r from-[#c9a227] to-[#a88b1f] hover:from-[#d4b02f] hover:to-[#b8991f] text-black text-2xl font-bold rounded-lg transition-all transform hover:scale-105 shadow-lg",children:"DROP IN"}),jsxRuntimeExports.jsxs("div",{className:"mt-12 text-white/70 text-sm max-w-md mx-auto",children:[jsxRuntimeExports.jsxs("p",{className:"mb-4",children:[INITIAL_PLAYERS," players  Last one standing wins"]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-4 text-left bg-black/30 p-4 rounded-lg",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"text-[#c9a227]",children:"WASD"})," - Move"]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"text-[#c9a227]",children:"SHIFT"})," - Sprint"]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"text-[#c9a227]",children:"CTRL/C"})," - Crouch"]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"text-[#c9a227]",children:"SPACE"})," - Jump"]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"text-[#c9a227]",children:"E"})," - Pick Up"]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"text-[#c9a227]",children:"R"})," - Reload"]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"text-[#c9a227]",children:"CLICK"})," - Shoot"]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"text-[#c9a227]",children:"MOUSE"})," - Aim"]})]})]})]})});const St=(s!=null&&s.isAlive?1:0)+c.filter(yt=>yt.isAlive).length;if(o==="victory")return jsxRuntimeExports.jsxs("div",{className:"w-full h-full bg-gradient-to-b from-[#c9a227] via-[#1a5a5a] to-[#0a0a0a] flex flex-col items-center justify-center",children:[jsxRuntimeExports.jsx("h1",{className:"text-8xl font-black text-white mb-4",style:{textShadow:"0 0 40px #c9a227"},children:"VICTORY ROYALE"}),jsxRuntimeExports.jsxs("p",{className:"text-3xl text-[#c9a227] mb-2",children:["#1 / ",INITIAL_PLAYERS]}),jsxRuntimeExports.jsxs("p",{className:"text-2xl text-white mb-8",children:["Kills: ",ut]}),jsxRuntimeExports.jsx("button",{onClick:lt,className:"px-10 py-4 bg-[#c9a227] hover:bg-[#d4b02f] text-black text-xl font-bold rounded-lg transition-colors",children:"PLAY AGAIN"})]});if(o==="defeat"){const yt=c.filter(wt=>wt.isAlive).length+1;return jsxRuntimeExports.jsxs("div",{className:"w-full h-full bg-gradient-to-b from-[#8b0000] via-[#1a1a1a] to-[#0a0a0a] flex flex-col items-center justify-center",children:[jsxRuntimeExports.jsx("h1",{className:"text-7xl font-black text-white mb-4",style:{textShadow:"0 0 30px #ff0000"},children:"ELIMINATED"}),jsxRuntimeExports.jsxs("p",{className:"text-3xl text-red-400 mb-2",children:["#",yt," / ",INITIAL_PLAYERS]}),jsxRuntimeExports.jsxs("p",{className:"text-2xl text-white mb-8",children:["Kills: ",ut]}),jsxRuntimeExports.jsx("button",{onClick:lt,className:"px-10 py-4 bg-red-600 hover:bg-red-500 text-white text-xl font-bold rounded-lg transition-colors",children:"TRY AGAIN"})]})}return jsxRuntimeExports.jsxs("div",{className:"w-full h-full relative bg-black",children:[jsxRuntimeExports.jsx(KeyboardControls,{map:keyMap$5,children:jsxRuntimeExports.jsx(Canvas,{shadows:!0,camera:{fov:75,near:.1,far:1e3},gl:{antialias:!0},children:s&&jsxRuntimeExports.jsx(GameScene$2,{player:s,bots:c,bullets:b,loot:tt,zone:it,onShoot:ht,onPlayerUpdate:mt,onPickupLoot:xt})})}),s&&jsxRuntimeExports.jsx(GameUI$5,{player:s,playersAlive:St,zone:it,kills:ut,gameTime:at})]})}const TILE_SIZE=24,VIEW_RADIUS=6,MAP_WIDTH=50,MAP_HEIGHT=40;function generateDungeon(o){const e=Array(MAP_HEIGHT).fill(null).map(()=>Array(MAP_WIDTH).fill(null).map(()=>({type:"wall",visible:!1,explored:!1}))),s=[],a=8+Math.floor(Math.random()*5);for(let ot=0;ot<a*3;ot++){const at=4+Math.floor(Math.random()*6),ct=4+Math.floor(Math.random()*6),ut=1+Math.floor(Math.random()*(MAP_WIDTH-at-2)),ft=1+Math.floor(Math.random()*(MAP_HEIGHT-ct-2));if(!s.some(lt=>ut<lt.x+lt.w+1&&ut+at+1>lt.x&&ft<lt.y+lt.h+1&&ft+ct+1>lt.y)){s.push({x:ut,y:ft,w:at,h:ct});for(let lt=ft;lt<ft+ct;lt++)for(let ht=ut;ht<ut+at;ht++)e[lt][ht]={type:"floor",visible:!1,explored:!1}}if(s.length>=a)break}for(let ot=1;ot<s.length;ot++){const at=s[ot-1],ct=s[ot],ut={x:Math.floor(at.x+at.w/2),y:Math.floor(at.y+at.h/2)},ft={x:Math.floor(ct.x+ct.w/2),y:Math.floor(ct.y+ct.h/2)};if(Math.random()>.5){for(let dt=Math.min(ut.x,ft.x);dt<=Math.max(ut.x,ft.x);dt++)e[ut.y][dt]={type:"corridor",visible:!1,explored:!1};for(let dt=Math.min(ut.y,ft.y);dt<=Math.max(ut.y,ft.y);dt++)e[dt][ft.x]={type:"corridor",visible:!1,explored:!1}}else{for(let dt=Math.min(ut.y,ft.y);dt<=Math.max(ut.y,ft.y);dt++)e[dt][ut.x]={type:"corridor",visible:!1,explored:!1};for(let dt=Math.min(ut.x,ft.x);dt<=Math.max(ut.x,ft.x);dt++)e[ft.y][dt]={type:"corridor",visible:!1,explored:!1}}}const c=[],d={x:Math.floor(s[0].x+s[0].w/2),y:Math.floor(s[0].y+s[0].h/2)},b=s[s.length-1];c.push({id:"stairs",type:"stairs",position:{x:Math.floor(b.x+b.w/2),y:Math.floor(b.y+b.h/2)}});const _e=["Goblin","Skeleton","Orc","Troll","Dark Knight"],tt=5+o*2;for(let ot=0;ot<tt;ot++){const at=s[1+Math.floor(Math.random()*(s.length-1))];c.push({id:`enemy_${ot}`,type:"enemy",position:{x:at.x+1+Math.floor(Math.random()*(at.w-2)),y:at.y+1+Math.floor(Math.random()*(at.h-2))},health:20+o*10,maxHealth:20+o*10,attack:5+o*2,defense:2+o,name:_e[Math.floor(Math.random()*_e.length)]})}const nt=["health","weapon","armor"],it=3+Math.floor(Math.random()*3);for(let ot=0;ot<it;ot++){const at=s[Math.floor(Math.random()*s.length)];c.push({id:`item_${ot}`,type:"item",position:{x:at.x+1+Math.floor(Math.random()*(at.w-2)),y:at.y+1+Math.floor(Math.random()*(at.h-2))},itemType:nt[Math.floor(Math.random()*nt.length)]})}return{map:e,entities:c,playerStart:d}}function updateVisibility(o,e){var a,c;const s=o.map(d=>d.map(b=>({...b,visible:!1})));for(let d=-VIEW_RADIUS;d<=VIEW_RADIUS;d++)for(let b=-VIEW_RADIUS;b<=VIEW_RADIUS;b++){const _e=e.x+b,tt=e.y+d;if(_e<0||_e>=MAP_WIDTH||tt<0||tt>=MAP_HEIGHT||Math.sqrt(b*b+d*d)>VIEW_RADIUS)continue;let nt=!1;const it=Math.max(Math.abs(b),Math.abs(d));for(let ot=0;ot<=it&&!nt;ot++){const at=e.x+Math.round(b*ot/it),ct=e.y+Math.round(d*ot/it);((c=(a=s[ct])==null?void 0:a[at])==null?void 0:c.type)==="wall"&&ot<it&&(nt=!0)}nt||(s[tt][_e].visible=!0,s[tt][_e].explored=!0)}return s}function DungeonCrawler(){const[o,e]=reactExports.useState("menu"),[s,a]=reactExports.useState(1),[c,d]=reactExports.useState([]),[b,_e]=reactExports.useState([]),[tt,nt]=reactExports.useState({x:0,y:0}),[it,ot]=reactExports.useState({health:100,maxHealth:100,attack:10,defense:5,xp:0,level:1}),[at,ct]=reactExports.useState([]),[ut,ft]=reactExports.useState(0),dt=reactExports.useCallback(St=>{ct(yt=>[...yt.slice(-4),St])},[]),lt=reactExports.useCallback(()=>{const{map:St,entities:yt,playerStart:wt}=generateDungeon(1);d(updateVisibility(St,wt)),_e(yt),nt(wt),ot({health:100,maxHealth:100,attack:10,defense:5,xp:0,level:1}),a(1),ft(0),ct(["Welcome to the dungeon! Find the stairs to descend."]),e("playing")},[]),ht=reactExports.useCallback(()=>{const St=s+1;if(St>10){e("victory");return}const{map:yt,entities:wt,playerStart:Et}=generateDungeon(St);d(updateVisibility(yt,Et)),_e(wt),nt(Et),a(St),ft(_t=>_t+500),dt(`You descend to level ${St}...`)},[s,dt]),mt=reactExports.useCallback((St,yt)=>{if(o!=="playing")return;const wt=tt.x+St,Et=tt.y+yt;if(wt<0||wt>=MAP_WIDTH||Et<0||Et>=MAP_HEIGHT||c[Et][wt].type==="wall")return;const _t=b.find(jt=>jt.type==="enemy"&&jt.position.x===wt&&jt.position.y===Et);if(_t&&_t.health){const jt=Math.max(1,it.attack-(_t.defense||0));if(_t.health-=jt,dt(`You hit ${_t.name} for ${jt} damage!`),_t.health<=0){_e(Nt=>Nt.filter(kt=>kt.id!==_t.id));const Lt=20+s*5;ft(Nt=>Nt+100),ot(Nt=>{const kt=Nt.xp+Lt,Ot=Nt.level*100;return kt>=Ot?(dt(`Level up! You are now level ${Nt.level+1}`),{...Nt,xp:kt-Ot,level:Nt.level+1,maxHealth:Nt.maxHealth+20,health:Math.min(Nt.health+20,Nt.maxHealth+20),attack:Nt.attack+3,defense:Nt.defense+1}):{...Nt,xp:kt}}),dt(`${_t.name} defeated! +${Lt} XP`)}else{const Lt=Math.max(1,(_t.attack||5)-it.defense);ot(Nt=>{const kt=Nt.health-Lt;return kt<=0&&e("gameover"),{...Nt,health:Math.max(0,kt)}}),dt(`${_t.name} hits you for ${Lt} damage!`)}return}nt({x:wt,y:Et}),d(jt=>updateVisibility(jt,{x:wt,y:Et}));const vt=b.find(jt=>jt.type==="item"&&jt.position.x===wt&&jt.position.y===Et);vt&&(_e(jt=>jt.filter(Lt=>Lt.id!==vt.id)),vt.itemType==="health"?(ot(jt=>({...jt,health:Math.min(jt.health+30,jt.maxHealth)})),dt("Found a health potion! +30 HP")):vt.itemType==="weapon"?(ot(jt=>({...jt,attack:jt.attack+5})),dt("Found a better weapon! +5 Attack")):vt.itemType==="armor"&&(ot(jt=>({...jt,defense:jt.defense+3})),dt("Found armor! +3 Defense")),ft(jt=>jt+50)),b.find(jt=>jt.type==="stairs"&&jt.position.x===wt&&jt.position.y===Et)&&(dt("You found the stairs!"),ht())},[o,tt,c,b,it,s,dt,ht]);reactExports.useEffect(()=>{const St=yt=>{if(o==="playing")switch(yt.key){case"ArrowUp":case"w":case"W":mt(0,-1);break;case"ArrowDown":case"s":case"S":mt(0,1);break;case"ArrowLeft":case"a":case"A":mt(-1,0);break;case"ArrowRight":case"d":case"D":mt(1,0);break}};return window.addEventListener("keydown",St),()=>window.removeEventListener("keydown",St)},[o,mt]);const xt=reactExports.useMemo(()=>({x:Math.max(0,Math.min(tt.x-12,MAP_WIDTH-25)),y:Math.max(0,Math.min(tt.y-10,MAP_HEIGHT-20))}),[tt]);return o==="menu"?jsxRuntimeExports.jsxs("div",{className:"w-full h-full bg-gradient-to-b from-orange-900 to-black flex flex-col items-center justify-center text-white",children:[jsxRuntimeExports.jsx("h1",{className:"text-5xl font-bold mb-4 text-orange-400",style:{textShadow:"0 0 20px #ff6600"},children:"DUNGEON CRAWLER"}),jsxRuntimeExports.jsx("p",{className:"text-xl mb-8 text-yellow-200",children:"Descend 10 levels to claim victory"}),jsxRuntimeExports.jsx("button",{onClick:lt,className:"px-8 py-4 bg-orange-600 hover:bg-orange-500 text-white text-2xl font-bold rounded-lg transition-colors",children:"ENTER DUNGEON"}),jsxRuntimeExports.jsxs("div",{className:"mt-8 text-yellow-100 text-center",children:[jsxRuntimeExports.jsx("p",{children:"WASD or Arrow Keys to move"}),jsxRuntimeExports.jsx("p",{children:"Walk into enemies to attack"})]})]}):o==="gameover"?jsxRuntimeExports.jsxs("div",{className:"w-full h-full bg-gradient-to-b from-orange-900 to-black flex flex-col items-center justify-center text-white",children:[jsxRuntimeExports.jsx("h1",{className:"text-5xl font-bold mb-4 text-orange-400",children:"YOU DIED"}),jsxRuntimeExports.jsxs("p",{className:"text-2xl mb-2 text-white",children:["Final Score: ",ut]}),jsxRuntimeExports.jsxs("p",{className:"text-xl mb-8 text-yellow-200",children:["Reached Level ",s]}),jsxRuntimeExports.jsx("button",{onClick:lt,className:"px-8 py-4 bg-orange-600 hover:bg-orange-500 text-white text-2xl font-bold rounded-lg transition-colors",children:"TRY AGAIN"})]}):o==="victory"?jsxRuntimeExports.jsxs("div",{className:"w-full h-full bg-gradient-to-b from-yellow-600 to-orange-900 flex flex-col items-center justify-center text-white",children:[jsxRuntimeExports.jsx("h1",{className:"text-5xl font-bold mb-4 text-yellow-300",children:"VICTORY!"}),jsxRuntimeExports.jsxs("p",{className:"text-2xl mb-2 text-white",children:["Final Score: ",ut]}),jsxRuntimeExports.jsx("p",{className:"text-xl mb-8 text-yellow-100",children:"You conquered all 10 levels!"}),jsxRuntimeExports.jsx("button",{onClick:lt,className:"px-8 py-4 bg-orange-600 hover:bg-orange-500 text-white text-2xl font-bold rounded-lg transition-colors",children:"PLAY AGAIN"})]}):jsxRuntimeExports.jsxs("div",{className:"w-full h-full bg-gray-900 flex",children:[jsxRuntimeExports.jsx("div",{className:"flex-1 flex items-center justify-center overflow-hidden",children:jsxRuntimeExports.jsx("div",{className:"relative bg-black",style:{width:25*TILE_SIZE,height:20*TILE_SIZE,imageRendering:"pixelated"},children:c.slice(xt.y,xt.y+20).map((St,yt)=>St.slice(xt.x,xt.x+25).map((wt,Et)=>{const _t=Et+xt.x,vt=yt+xt.y;let Mt="#000";wt.explored&&(wt.type==="wall"?Mt=wt.visible?"#4a4a4a":"#2a2a2a":Mt=wt.visible?"#3a3a3a":"#1a1a1a");const jt=b.find(Nt=>Nt.position.x===_t&&Nt.position.y===vt),Lt=tt.x===_t&&tt.y===vt;return jsxRuntimeExports.jsx("div",{className:"absolute flex items-center justify-center text-lg font-bold",style:{left:Et*TILE_SIZE,top:yt*TILE_SIZE,width:TILE_SIZE,height:TILE_SIZE,backgroundColor:Mt},children:wt.visible&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[Lt&&jsxRuntimeExports.jsx("span",{className:"text-yellow-400",children:"@"}),!Lt&&(jt==null?void 0:jt.type)==="enemy"&&jsxRuntimeExports.jsx("span",{className:"text-red-500",children:"E"}),!Lt&&(jt==null?void 0:jt.type)==="item"&&jsxRuntimeExports.jsx("span",{className:jt.itemType==="health"?"text-green-400":jt.itemType==="weapon"?"text-orange-400":"text-blue-400",children:jt.itemType==="health"?"+":jt.itemType==="weapon"?"/":"O"}),!Lt&&(jt==null?void 0:jt.type)==="stairs"&&jsxRuntimeExports.jsx("span",{className:"text-purple-400",children:">"})]})},`${Et}-${yt}`)}))})}),jsxRuntimeExports.jsxs("div",{className:"w-64 bg-gray-800 p-4 flex flex-col text-white font-mono text-sm",children:[jsxRuntimeExports.jsxs("div",{className:"mb-4",children:[jsxRuntimeExports.jsxs("h2",{className:"text-xl font-bold text-yellow-400 mb-2",children:["Level ",s]}),jsxRuntimeExports.jsxs("div",{className:"text-gray-400",children:["Score: ",ut]})]}),jsxRuntimeExports.jsxs("div",{className:"mb-4 p-3 bg-gray-900 rounded",children:[jsxRuntimeExports.jsxs("div",{className:"text-yellow-400 font-bold mb-2",children:["Player Lv.",it.level]}),jsxRuntimeExports.jsxs("div",{className:"mb-2",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between text-red-400",children:[jsxRuntimeExports.jsx("span",{children:"HP"}),jsxRuntimeExports.jsxs("span",{children:[it.health,"/",it.maxHealth]})]}),jsxRuntimeExports.jsx("div",{className:"w-full h-2 bg-gray-700 rounded overflow-hidden",children:jsxRuntimeExports.jsx("div",{className:"h-full bg-red-500",style:{width:`${it.health/it.maxHealth*100}%`}})})]}),jsxRuntimeExports.jsxs("div",{className:"mb-2",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between text-blue-400",children:[jsxRuntimeExports.jsx("span",{children:"XP"}),jsxRuntimeExports.jsxs("span",{children:[it.xp,"/",it.level*100]})]}),jsxRuntimeExports.jsx("div",{className:"w-full h-2 bg-gray-700 rounded overflow-hidden",children:jsxRuntimeExports.jsx("div",{className:"h-full bg-blue-500",style:{width:`${it.xp/(it.level*100)*100}%`}})})]}),jsxRuntimeExports.jsxs("div",{className:"text-orange-400",children:["ATK: ",it.attack]}),jsxRuntimeExports.jsxs("div",{className:"text-cyan-400",children:["DEF: ",it.defense]})]}),jsxRuntimeExports.jsx("div",{className:"flex-1 bg-gray-900 rounded p-2 overflow-y-auto",children:jsxRuntimeExports.jsx("div",{className:"text-gray-400 text-xs",children:at.map((St,yt)=>jsxRuntimeExports.jsx("div",{className:"mb-1",children:St},yt))})}),jsxRuntimeExports.jsxs("div",{className:"mt-4 text-gray-500 text-xs",children:[jsxRuntimeExports.jsx("div",{children:"WASD/Arrows - Move"}),jsxRuntimeExports.jsx("div",{children:"@ = You | E = Enemy"}),jsxRuntimeExports.jsxs("div",{children:[">"," = Stairs | + = Health"]})]})]})]})}const MAX_SPEED$1=50,ACCELERATION$1=25,BRAKE_POWER=40,FRICTION$1=8,TURN_SPEED$1=2.5,BOOST_MULTIPLIER=1.5,CHECKPOINTS=[{x:0,z:-80,radius:15},{x:60,z:-40,radius:15},{x:80,z:40,radius:15},{x:20,z:80,radius:15},{x:-60,z:60,radius:15},{x:-80,z:-20,radius:15},{x:-40,z:-60,radius:15},{x:0,z:0,radius:20}];function Car({isPlayer:o,carState:e,color:s}){const a=reactExports.useRef(null),c=reactExports.useRef(null),d=reactExports.useRef(null),b=reactExports.useRef(null),_e=reactExports.useRef(null);return useFrame(()=>{if(a.current){a.current.position.copy(e.position),a.current.rotation.y=e.rotation;const tt=e.speed*.1;[c,d,b,_e].forEach(nt=>{nt.current&&(nt.current.rotation.x+=tt)})}}),jsxRuntimeExports.jsxs("group",{ref:a,children:[jsxRuntimeExports.jsxs("mesh",{position:[0,.4,0],castShadow:!0,children:[jsxRuntimeExports.jsx("boxGeometry",{args:[2,.6,4]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:s,metalness:.6,roughness:.3})]}),jsxRuntimeExports.jsxs("mesh",{position:[0,.9,-.5],castShadow:!0,children:[jsxRuntimeExports.jsx("boxGeometry",{args:[1.8,.5,2]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:s,metalness:.6,roughness:.3})]}),jsxRuntimeExports.jsxs("mesh",{position:[0,.85,0],castShadow:!0,children:[jsxRuntimeExports.jsx("boxGeometry",{args:[1.6,.4,1.5]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#88ccff",transparent:!0,opacity:.6})]}),jsxRuntimeExports.jsxs("mesh",{ref:c,position:[-.9,.25,1.2],rotation:[0,0,Math.PI/2],children:[jsxRuntimeExports.jsx("cylinderGeometry",{args:[.25,.25,.3,16]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#222"})]}),jsxRuntimeExports.jsxs("mesh",{ref:d,position:[.9,.25,1.2],rotation:[0,0,Math.PI/2],children:[jsxRuntimeExports.jsx("cylinderGeometry",{args:[.25,.25,.3,16]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#222"})]}),jsxRuntimeExports.jsxs("mesh",{ref:b,position:[-.9,.25,-1.2],rotation:[0,0,Math.PI/2],children:[jsxRuntimeExports.jsx("cylinderGeometry",{args:[.25,.25,.3,16]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#222"})]}),jsxRuntimeExports.jsxs("mesh",{ref:_e,position:[.9,.25,-1.2],rotation:[0,0,Math.PI/2],children:[jsxRuntimeExports.jsx("cylinderGeometry",{args:[.25,.25,.3,16]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#222"})]}),o&&jsxRuntimeExports.jsx("pointLight",{position:[0,.5,2.5],intensity:30,distance:20,color:"#ffff88"})]})}function Track(){const o=useTexture("/textures/asphalt.png");o.wrapS=o.wrapT=RepeatWrapping,o.repeat.set(40,40);const e=useTexture("/textures/grass.png");e.wrapS=e.wrapT=RepeatWrapping,e.repeat.set(20,20);const s=reactExports.useMemo(()=>{const a=[];for(let d=0;d<=100;d++){const b=d/100*Math.PI*2,_e=60+Math.sin(b*3)*20;a.push(new Vector3(Math.cos(b)*_e,0,Math.sin(b)*_e))}return a},[]);return jsxRuntimeExports.jsxs("group",{children:[jsxRuntimeExports.jsxs("mesh",{rotation:[-Math.PI/2,0,0],position:[0,-.01,0],receiveShadow:!0,children:[jsxRuntimeExports.jsx("planeGeometry",{args:[300,300]}),jsxRuntimeExports.jsx("meshStandardMaterial",{map:e})]}),s.slice(0,-1).map((a,c)=>{const d=s[(c+1)%s.length],b=new Vector3().subVectors(d,a).normalize(),_e=Math.atan2(b.x,b.z),tt=a.distanceTo(d),nt=new Vector3().addVectors(a,d).multiplyScalar(.5);return jsxRuntimeExports.jsxs("mesh",{position:[nt.x,0,nt.z],rotation:[-Math.PI/2,0,-_e],receiveShadow:!0,children:[jsxRuntimeExports.jsx("planeGeometry",{args:[15,tt+1]}),jsxRuntimeExports.jsx("meshStandardMaterial",{map:o})]},c)}),CHECKPOINTS.map((a,c)=>jsxRuntimeExports.jsxs("group",{position:[a.x,0,a.z],children:[jsxRuntimeExports.jsxs("mesh",{position:[-a.radius/2,2,0],children:[jsxRuntimeExports.jsx("boxGeometry",{args:[.5,4,.5]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:c===CHECKPOINTS.length-1?"#ffff00":"#ff4444"})]}),jsxRuntimeExports.jsxs("mesh",{position:[a.radius/2,2,0],children:[jsxRuntimeExports.jsx("boxGeometry",{args:[.5,4,.5]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:c===CHECKPOINTS.length-1?"#ffff00":"#ff4444"})]}),jsxRuntimeExports.jsxs("mesh",{position:[0,4,0],children:[jsxRuntimeExports.jsx("boxGeometry",{args:[a.radius,.5,.5]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:c===CHECKPOINTS.length-1?"#ffff00":"#ff4444"})]})]},c))]})}function PlayerController({carState:o,setCarState:e,onLapComplete:s}){const{camera:a}=useThree(),[,c]=useKeyboardControls();return useFrame((d,b)=>{if(o.finished)return;const _e=c();let tt=o.speed,nt=o.rotation;const it=o.position.clone();if(_e.forward){const mt=_e.boost?MAX_SPEED$1*BOOST_MULTIPLIER:MAX_SPEED$1;tt=Math.min(tt+ACCELERATION$1*b,mt)}else _e.back?tt=Math.max(tt-BRAKE_POWER*b,-MAX_SPEED$1*.3):tt=tt>0?Math.max(0,tt-FRICTION$1*b):Math.min(0,tt+FRICTION$1*b);if(Math.abs(tt)>.5){const mt=Math.min(1,Math.abs(tt)/20);_e.left&&(nt+=TURN_SPEED$1*b*mt*Math.sign(tt)),_e.right&&(nt-=TURN_SPEED$1*b*mt*Math.sign(tt))}const ot=new Vector3(Math.sin(nt),0,Math.cos(nt));it.addScaledVector(ot,tt*b);const at=Math.sqrt(it.x*it.x+it.z*it.z);if((at>110||at<30)&&(tt*=.95,at>115)){const mt=it.clone().normalize();it.x=mt.x*110,it.z=mt.z*110}let ct=o.checkpoint,ut=o.lap;const ft=CHECKPOINTS[ct];Math.sqrt(Math.pow(it.x-ft.x,2)+Math.pow(it.z-ft.z,2))<ft.radius&&(ct=(ct+1)%CHECKPOINTS.length,ct===0&&(ut++,s())),e({...o,position:it,rotation:nt,speed:tt,checkpoint:ct,lap:ut});const lt=new Vector3(-Math.sin(nt)*12,6,-Math.cos(nt)*12),ht=it.clone().add(lt);a.position.lerp(ht,5*b),a.lookAt(it.x,it.y+1,it.z)}),null}function GameScene$1({playerCar:o,setPlayerCar:e,aiCars:s,onLapComplete:a}){return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("ambientLight",{intensity:.5}),jsxRuntimeExports.jsx("directionalLight",{position:[50,100,50],intensity:1.2,castShadow:!0}),jsxRuntimeExports.jsx(Sky,{sunPosition:[100,50,100]}),jsxRuntimeExports.jsx(Track,{}),jsxRuntimeExports.jsx(PlayerController,{carState:o,setCarState:e,onLapComplete:a}),jsxRuntimeExports.jsx(Car,{isPlayer:!0,carState:o,color:"#ff3333"}),s.map((c,d)=>jsxRuntimeExports.jsx(Car,{isPlayer:!1,carState:c,color:["#3333ff","#33ff33","#ffff33"][d%3]},d))]})}function GameUI$4({speed:o,lap:e,position:s,time:a,checkpoint:c}){const d=b=>{const _e=Math.floor(b/6e4),tt=Math.floor(b%6e4/1e3),nt=Math.floor(b%1e3/10);return`${_e}:${tt.toString().padStart(2,"0")}.${nt.toString().padStart(2,"0")}`};return jsxRuntimeExports.jsxs("div",{className:"absolute inset-0 pointer-events-none",children:[jsxRuntimeExports.jsxs("div",{className:"absolute top-4 left-4 bg-black/70 text-white p-4 rounded font-mono",children:[jsxRuntimeExports.jsxs("div",{className:"text-3xl font-bold",children:["LAP ",e,"/3"]}),jsxRuntimeExports.jsx("div",{className:"text-xl text-yellow-400",children:d(a)}),jsxRuntimeExports.jsxs("div",{className:"text-lg",children:["Position: ",s,"/4"]})]}),jsxRuntimeExports.jsxs("div",{className:"absolute bottom-4 left-4 bg-black/70 text-white p-4 rounded font-mono",children:[jsxRuntimeExports.jsxs("div",{className:"text-2xl",children:[Math.abs(Math.round(o*3.6))," km/h"]}),jsxRuntimeExports.jsx("div",{className:"w-40 h-3 bg-gray-700 rounded overflow-hidden mt-2",children:jsxRuntimeExports.jsx("div",{className:"h-full bg-gradient-to-r from-green-500 via-yellow-500 to-red-500 transition-all",style:{width:`${Math.abs(o)/(MAX_SPEED$1*BOOST_MULTIPLIER)*100}%`}})})]}),jsxRuntimeExports.jsxs("div",{className:"absolute bottom-4 right-4 bg-black/70 text-white p-3 rounded text-sm",children:[jsxRuntimeExports.jsx("div",{children:"W/ - Accelerate"}),jsxRuntimeExports.jsx("div",{children:"S/ - Brake/Reverse"}),jsxRuntimeExports.jsx("div",{children:"A/D or / - Steer"}),jsxRuntimeExports.jsx("div",{children:"SHIFT - Boost"})]}),jsxRuntimeExports.jsxs("div",{className:"absolute top-4 right-4 bg-black/70 text-white p-3 rounded",children:[jsxRuntimeExports.jsx("div",{className:"text-sm text-gray-400",children:"Checkpoint"}),jsxRuntimeExports.jsxs("div",{className:"text-xl",children:[c+1,"/",CHECKPOINTS.length]})]})]})}const keyMap$4=[{name:"forward",keys:["ArrowUp","KeyW"]},{name:"back",keys:["ArrowDown","KeyS"]},{name:"left",keys:["ArrowLeft","KeyA"]},{name:"right",keys:["ArrowRight","KeyD"]},{name:"brake",keys:["Space"]},{name:"boost",keys:["ShiftLeft","ShiftRight"]}];function RacingGame(){const[o,e]=reactExports.useState("menu"),[s,a]=reactExports.useState(3),[c,d]=reactExports.useState(0),[b,_e]=reactExports.useState([]),[tt,nt]=reactExports.useState({position:new Vector3(0,0,0),rotation:0,speed:0,lap:1,checkpoint:0,finished:!1}),[it,ot]=reactExports.useState([]),at=reactExports.useCallback(()=>{nt({position:new Vector3(0,0,0),rotation:Math.PI,speed:0,lap:1,checkpoint:0,finished:!1}),ot([{position:new Vector3(4,0,5),rotation:Math.PI,speed:0,lap:1,checkpoint:0,finished:!1},{position:new Vector3(-4,0,5),rotation:Math.PI,speed:0,lap:1,checkpoint:0,finished:!1},{position:new Vector3(0,0,10),rotation:Math.PI,speed:0,lap:1,checkpoint:0,finished:!1}]),d(0),_e([]),a(3),e("countdown")},[]),ct=reactExports.useCallback(()=>{_e(ft=>[...ft,c]),tt.lap>=3&&(nt(ft=>({...ft,finished:!0})),e("finished"))},[c,tt.lap]);reactExports.useEffect(()=>{if(o==="countdown"&&s>0){const ft=setTimeout(()=>a(dt=>dt-1),1e3);return()=>clearTimeout(ft)}else o==="countdown"&&s===0&&e("racing")},[o,s]),reactExports.useEffect(()=>{if(o==="racing"){const ft=setInterval(()=>{d(dt=>dt+16),ot(dt=>dt.map(lt=>{if(lt.finished)return lt;const ht=CHECKPOINTS[lt.checkpoint];let xt=Math.atan2(ht.x-lt.position.x,ht.z-lt.position.z)-lt.rotation;for(;xt>Math.PI;)xt-=Math.PI*2;for(;xt<-Math.PI;)xt+=Math.PI*2;const St=lt.rotation+Math.sign(xt)*Math.min(Math.abs(xt),.03),yt=Math.min(lt.speed+.3,MAX_SPEED$1*.85),wt=new Vector3(Math.sin(St),0,Math.cos(St)),Et=lt.position.clone().addScaledVector(wt,yt*.016);let _t=lt.checkpoint,vt=lt.lap;return Math.sqrt(Math.pow(Et.x-ht.x,2)+Math.pow(Et.z-ht.z,2))<ht.radius&&(_t=(_t+1)%CHECKPOINTS.length,_t===0&&vt++),{...lt,position:Et,rotation:St,speed:yt,checkpoint:_t,lap:vt,finished:vt>3}}))},16);return()=>clearInterval(ft)}},[o]);const ut=()=>[tt,...it].sort((lt,ht)=>lt.lap!==ht.lap?ht.lap-lt.lap:ht.checkpoint-lt.checkpoint).findIndex(lt=>lt===tt)+1;return o==="menu"?jsxRuntimeExports.jsxs("div",{className:"w-full h-full bg-gradient-to-b from-orange-900 to-black flex flex-col items-center justify-center text-white",children:[jsxRuntimeExports.jsx("h1",{className:"text-6xl font-bold mb-4 text-orange-400",style:{textShadow:"0 0 20px #ff6600"},children:"TURBO RACER"}),jsxRuntimeExports.jsx("p",{className:"text-xl mb-8 text-yellow-200",children:"Complete 3 laps to win"}),jsxRuntimeExports.jsx("button",{onClick:at,className:"px-8 py-4 bg-orange-600 hover:bg-orange-500 text-white text-2xl font-bold rounded-lg transition-colors",children:"START RACE"}),jsxRuntimeExports.jsxs("div",{className:"mt-8 text-yellow-100 text-center",children:[jsxRuntimeExports.jsx("p",{children:"W/ to accelerate  A/D or / to steer"}),jsxRuntimeExports.jsx("p",{children:"S/ to brake  SHIFT for boost"})]})]}):o==="finished"?jsxRuntimeExports.jsxs("div",{className:"w-full h-full bg-gradient-to-b from-yellow-600 to-orange-900 flex flex-col items-center justify-center text-white",children:[jsxRuntimeExports.jsx("h1",{className:"text-5xl font-bold mb-4 text-yellow-300",children:"RACE COMPLETE!"}),jsxRuntimeExports.jsxs("p",{className:"text-3xl mb-2 text-white",children:["Position: ",ut(),"/4"]}),jsxRuntimeExports.jsxs("p",{className:"text-2xl mb-4 text-orange-300",children:["Total Time: ",Math.floor(c/6e4),":",(c%6e4/1e3).toFixed(2).padStart(5,"0")]}),jsxRuntimeExports.jsx("div",{className:"mb-8 text-yellow-100",children:b.map((ft,dt)=>jsxRuntimeExports.jsxs("div",{children:["Lap ",dt+1,": ",Math.floor(ft/6e4),":",(ft%6e4/1e3).toFixed(2).padStart(5,"0")]},dt))}),jsxRuntimeExports.jsx("button",{onClick:at,className:"px-8 py-4 bg-orange-600 hover:bg-orange-500 text-white text-2xl font-bold rounded-lg transition-colors",children:"RACE AGAIN"})]}):jsxRuntimeExports.jsxs("div",{className:"w-full h-full relative",children:[jsxRuntimeExports.jsx(KeyboardControls,{map:keyMap$4,children:jsxRuntimeExports.jsx(Canvas,{shadows:!0,camera:{fov:60,near:.1,far:500},children:jsxRuntimeExports.jsx(GameScene$1,{playerCar:tt,setPlayerCar:nt,aiCars:it,onLapComplete:ct})})}),o==="countdown"&&jsxRuntimeExports.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:jsxRuntimeExports.jsx("div",{className:"text-9xl font-bold text-white",style:{textShadow:"0 0 30px #fff"},children:s>0?s:"GO!"})}),o==="racing"&&jsxRuntimeExports.jsx(GameUI$4,{speed:tt.speed,lap:tt.lap,position:ut(),time:c,checkpoint:tt.checkpoint})]})}const GRAVITY=-20,HOOP_HEIGHT=3.05,HOOP_RADIUS=.23,BALL_RADIUS=.12,COURT_LENGTH=15;function Basketball({ball:o,onReset:e}){const s=reactExports.useRef(null),a=reactExports.useRef(null),c=reactExports.useRef(new Float32Array(300)),d=reactExports.useRef(0);return useFrame((b,_e)=>{if(s.current){if(o.isShot){if(o.velocity.y+=GRAVITY*_e,o.position.add(o.velocity.clone().multiplyScalar(_e)),d.current<100){const tt=d.current*3;c.current[tt]=o.position.x,c.current[tt+1]=o.position.y,c.current[tt+2]=o.position.z,d.current++,a.current&&(a.current.geometry.attributes.position.needsUpdate=!0)}o.position.y<.12&&(o.position.y=.12,o.velocity.y=Math.abs(o.velocity.y)*.6,o.velocity.x*=.8,o.velocity.z*=.8,Math.abs(o.velocity.y)<.5&&setTimeout(e,500))}s.current.position.copy(o.position),s.current.rotation.x+=o.velocity.z*_e*2,s.current.rotation.z-=o.velocity.x*_e*2}}),jsxRuntimeExports.jsxs("group",{children:[jsxRuntimeExports.jsxs("mesh",{ref:s,castShadow:!0,children:[jsxRuntimeExports.jsx("sphereGeometry",{args:[BALL_RADIUS,32,32]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#ff6600",roughness:.7})]}),o.isShot&&jsxRuntimeExports.jsxs("points",{ref:a,children:[jsxRuntimeExports.jsx("bufferGeometry",{children:jsxRuntimeExports.jsx("bufferAttribute",{attach:"attributes-position",count:100,array:c.current,itemSize:3})}),jsxRuntimeExports.jsx("pointsMaterial",{size:.05,color:"#ffaa00",transparent:!0,opacity:.5})]})]})}function Hoop(){return jsxRuntimeExports.jsxs("group",{position:[0,0,-COURT_LENGTH/2+1.2],children:[jsxRuntimeExports.jsxs("mesh",{position:[0,HOOP_HEIGHT+.45,-.6],castShadow:!0,children:[jsxRuntimeExports.jsx("boxGeometry",{args:[1.8,1.05,.05]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#ffffff"})]}),jsxRuntimeExports.jsxs("mesh",{position:[0,HOOP_HEIGHT+.45,-.6],children:[jsxRuntimeExports.jsx("boxGeometry",{args:[.45,.45,.06]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#ff0000"})]}),jsxRuntimeExports.jsxs("mesh",{position:[0,HOOP_HEIGHT,0],rotation:[Math.PI/2,0,0],children:[jsxRuntimeExports.jsx("torusGeometry",{args:[HOOP_RADIUS,.02,16,32]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#ff4400",metalness:.8})]}),jsxRuntimeExports.jsxs("mesh",{position:[0,HOOP_HEIGHT-.15,0],children:[jsxRuntimeExports.jsx("cylinderGeometry",{args:[HOOP_RADIUS,HOOP_RADIUS*.9,.4,32,1,!0]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#ffffff",transparent:!0,opacity:.3,side:DoubleSide})]}),jsxRuntimeExports.jsxs("mesh",{position:[0,HOOP_HEIGHT/2,-.65],castShadow:!0,children:[jsxRuntimeExports.jsx("boxGeometry",{args:[.15,HOOP_HEIGHT,.15]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#888888"})]})]})}function Court(){return jsxRuntimeExports.jsxs("group",{children:[jsxRuntimeExports.jsxs("mesh",{rotation:[-Math.PI/2,0,0],receiveShadow:!0,children:[jsxRuntimeExports.jsx("planeGeometry",{args:[12,COURT_LENGTH]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#cd853f"})]}),jsxRuntimeExports.jsxs("mesh",{rotation:[-Math.PI/2,0,0],position:[0,.01,0],children:[jsxRuntimeExports.jsx("ringGeometry",{args:[1.8,1.85,32]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#ffffff"})]}),jsxRuntimeExports.jsxs("mesh",{rotation:[-Math.PI/2,0,0],position:[0,.01,-COURT_LENGTH/2+5.8],children:[jsxRuntimeExports.jsx("ringGeometry",{args:[.9,.95,32,1,0,Math.PI]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#ffffff"})]}),[-5.9,5.9].map(o=>jsxRuntimeExports.jsxs("mesh",{rotation:[-Math.PI/2,0,0],position:[o,.01,0],children:[jsxRuntimeExports.jsx("planeGeometry",{args:[.05,COURT_LENGTH]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#ffffff"})]},o))]})}function PowerMeter({power:o,isAiming:e}){return e?jsxRuntimeExports.jsxs("group",{position:[0,.5,3],children:[jsxRuntimeExports.jsxs("mesh",{children:[jsxRuntimeExports.jsx("boxGeometry",{args:[.3,2,.1]}),jsxRuntimeExports.jsx("meshBasicMaterial",{color:"#333"})]}),jsxRuntimeExports.jsxs("mesh",{position:[0,-1+o,0],children:[jsxRuntimeExports.jsx("boxGeometry",{args:[.25,o*2,.11]}),jsxRuntimeExports.jsx("meshBasicMaterial",{color:o<.3?"#00ff00":o<.7?"#ffff00":"#ff0000"})]})]}):null}function AimLine({startPos:o,angle:e,power:s}){const a=reactExports.useMemo(()=>{const d=[],b=new Vector3(Math.sin(e)*s*12,s*8+5,-Math.cos(e)*s*12-3),_e=o.clone();for(let tt=0;tt<30&&(d.push(_e.clone()),b.y+=GRAVITY*.05,_e.add(b.clone().multiplyScalar(.05)),!(_e.y<0));tt++);return d},[o,e,s]),c=reactExports.useMemo(()=>new BufferGeometry().setFromPoints(a),[a]);return jsxRuntimeExports.jsx("primitive",{object:new Line(c,new LineBasicMaterial({color:"#ffffff",transparent:!0,opacity:.5}))})}function GameScene({ball:o,onShoot:e,onReset:s,isAiming:a,power:c,angle:d,setIsAiming:b,setPower:_e,setAngle:tt}){const{camera:nt}=useThree(),it=reactExports.useRef(1);return reactExports.useEffect(()=>{nt.position.set(0,3,8),nt.lookAt(0,HOOP_HEIGHT,-COURT_LENGTH/2)},[nt]),useFrame((ot,at)=>{if(a){let ct=c+it.current*at*.8;ct>=1?(ct=1,it.current=-1):ct<=0&&(ct=0,it.current=1),_e(ct)}}),reactExports.useEffect(()=>{const ot=at=>{o.isShot||(at.code==="Space"&&(a?(e(c,d),b(!1)):(b(!0),_e(0),it.current=1)),a&&(at.code==="ArrowLeft"||at.code==="KeyA"?tt(Math.min(d+.1,.5)):(at.code==="ArrowRight"||at.code==="KeyD")&&tt(Math.max(d-.1,-.5))))};return window.addEventListener("keydown",ot),()=>window.removeEventListener("keydown",ot)},[o.isShot,a,c,d,e,b,_e,tt]),jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("ambientLight",{intensity:.6}),jsxRuntimeExports.jsx("directionalLight",{position:[10,20,10],intensity:1,castShadow:!0}),jsxRuntimeExports.jsx("pointLight",{position:[0,10,0],intensity:.5}),jsxRuntimeExports.jsx(Court,{}),jsxRuntimeExports.jsx(Hoop,{}),jsxRuntimeExports.jsx(Basketball,{ball:o,onReset:s}),jsxRuntimeExports.jsx(PowerMeter,{power:c,isAiming:a}),a&&!o.isShot&&jsxRuntimeExports.jsx(AimLine,{startPos:o.position,angle:d,power:c})]})}function GameUI$3({stats:o,isAiming:e}){const s=a=>{const c=Math.floor(a/60),d=a%60;return`${c}:${d.toString().padStart(2,"0")}`};return jsxRuntimeExports.jsxs("div",{className:"absolute inset-0 pointer-events-none",children:[jsxRuntimeExports.jsxs("div",{className:"absolute top-4 left-4 bg-black/70 text-white p-4 rounded font-mono",children:[jsxRuntimeExports.jsx("div",{className:"text-4xl font-bold text-orange-400",children:o.score}),jsxRuntimeExports.jsxs("div",{className:"text-lg",children:["Shots: ",o.shots]}),jsxRuntimeExports.jsxs("div",{className:"text-lg",children:["Accuracy: ",o.shots>0?Math.round(o.score/2/o.shots*100):0,"%"]})]}),jsxRuntimeExports.jsxs("div",{className:"absolute top-4 right-4 bg-black/70 text-white p-4 rounded font-mono",children:[jsxRuntimeExports.jsx("div",{className:"text-3xl font-bold text-red-400",children:s(o.timeLeft)}),jsxRuntimeExports.jsx("div",{className:"text-sm text-gray-400",children:"Time Left"})]}),jsxRuntimeExports.jsxs("div",{className:"absolute top-4 left-1/2 -translate-x-1/2 bg-black/70 text-white px-6 py-2 rounded font-mono",children:[jsxRuntimeExports.jsxs("span",{className:"text-yellow-400",children:["Streak: ",o.streak]}),jsxRuntimeExports.jsxs("span",{className:"text-gray-400 ml-4",children:["Best: ",o.bestStreak]})]}),jsxRuntimeExports.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 bg-black/70 text-white px-6 py-3 rounded text-center",children:e?jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("div",{className:"text-yellow-400 text-xl",children:"AIMING..."}),jsxRuntimeExports.jsx("div",{className:"text-sm text-gray-400",children:"A/D to aim left/right  SPACE to shoot"})]}):jsxRuntimeExports.jsx("div",{className:"text-sm text-gray-400",children:"Press SPACE to start aiming"})}),jsxRuntimeExports.jsxs("div",{className:"absolute bottom-4 right-4 bg-black/70 text-white p-3 rounded text-sm",children:[jsxRuntimeExports.jsx("div",{children:"SPACE - Aim/Shoot"}),jsxRuntimeExports.jsx("div",{children:"A/D or / - Aim"})]})]})}function BasketballGame(){const[o,e]=reactExports.useState("menu"),[s,a]=reactExports.useState({score:0,shots:0,streak:0,bestStreak:0,timeLeft:60}),[c,d]=reactExports.useState({position:new Vector3(0,1,4),velocity:new Vector3(0,0,0),isShot:!1}),[b,_e]=reactExports.useState(!1),[tt,nt]=reactExports.useState(0),[it,ot]=reactExports.useState(0),at=reactExports.useCallback(dt=>{const lt=new Vector3(0,HOOP_HEIGHT,-COURT_LENGTH/2+1.2);return Math.sqrt(Math.pow(dt.x-lt.x,2)+Math.pow(dt.z-lt.z,2))<HOOP_RADIUS&&Math.abs(dt.y-lt.y)<.3},[]),ct=reactExports.useCallback((dt,lt)=>{const ht=new Vector3(Math.sin(lt)*dt*12,dt*8+5,-Math.cos(lt)*dt*12-3);d(mt=>({...mt,velocity:ht,isShot:!0})),a(mt=>({...mt,shots:mt.shots+1})),setTimeout(()=>{const mt=c.position.clone();let xt=ht.clone(),St=!1;for(let yt=0;yt<100;yt++){if(xt.y+=GRAVITY*.02,mt.add(xt.clone().multiplyScalar(.02)),at(mt)){St=!0;break}if(mt.y<0)break}a(St?yt=>({...yt,score:yt.score+2,streak:yt.streak+1,bestStreak:Math.max(yt.bestStreak,yt.streak+1)}):yt=>({...yt,streak:0}))},100)},[c.position,at]),ut=reactExports.useCallback(()=>{d({position:new Vector3(0,1,4),velocity:new Vector3(0,0,0),isShot:!1}),ot(0),nt(0)},[]),ft=reactExports.useCallback(()=>{a({score:0,shots:0,streak:0,bestStreak:0,timeLeft:60}),ut(),e("playing")},[ut]);return reactExports.useEffect(()=>{if(o==="playing"&&s.timeLeft>0){const dt=setInterval(()=>{a(lt=>lt.timeLeft<=1?(e("gameover"),lt):{...lt,timeLeft:lt.timeLeft-1})},1e3);return()=>clearInterval(dt)}},[o,s.timeLeft]),o==="menu"?jsxRuntimeExports.jsxs("div",{className:"w-full h-full bg-gradient-to-b from-orange-900 to-black flex flex-col items-center justify-center text-white",children:[jsxRuntimeExports.jsx("h1",{className:"text-6xl font-bold mb-4 text-orange-400",style:{textShadow:"0 0 20px #ff6600"},children:"HOOPS MASTER"}),jsxRuntimeExports.jsx("p",{className:"text-xl mb-8 text-yellow-200",children:"Score as many points as you can in 60 seconds!"}),jsxRuntimeExports.jsx("button",{onClick:ft,className:"px-8 py-4 bg-orange-600 hover:bg-orange-500 text-white text-2xl font-bold rounded-lg transition-colors",children:"PLAY BALL"}),jsxRuntimeExports.jsxs("div",{className:"mt-8 text-yellow-100 text-center",children:[jsxRuntimeExports.jsx("p",{children:"SPACE to aim and shoot"}),jsxRuntimeExports.jsx("p",{children:"A/D or / to adjust aim"})]})]}):o==="gameover"?jsxRuntimeExports.jsxs("div",{className:"w-full h-full bg-gradient-to-b from-orange-900 to-black flex flex-col items-center justify-center text-white",children:[jsxRuntimeExports.jsx("h1",{className:"text-5xl font-bold mb-4 text-orange-400",children:"TIME'S UP!"}),jsxRuntimeExports.jsxs("p",{className:"text-4xl mb-2 text-white",children:["Final Score: ",s.score]}),jsxRuntimeExports.jsxs("p",{className:"text-xl mb-2 text-yellow-200",children:[s.shots," shots  ",s.shots>0?Math.round(s.score/2/s.shots*100):0,"% accuracy"]}),jsxRuntimeExports.jsxs("p",{className:"text-xl mb-8 text-yellow-300",children:["Best Streak: ",s.bestStreak]}),jsxRuntimeExports.jsx("button",{onClick:ft,className:"px-8 py-4 bg-orange-600 hover:bg-orange-500 text-white text-2xl font-bold rounded-lg transition-colors",children:"PLAY AGAIN"})]}):jsxRuntimeExports.jsxs("div",{className:"w-full h-full relative",children:[jsxRuntimeExports.jsx(Canvas,{shadows:!0,camera:{fov:50},children:jsxRuntimeExports.jsx(GameScene,{ball:c,onShoot:ct,onReset:ut,isAiming:b,power:tt,angle:it,setIsAiming:_e,setPower:nt,setAngle:ot})}),jsxRuntimeExports.jsx(GameUI$3,{stats:s,isAiming:b})]})}const MAX_SPEED=200,ACCELERATION=60,BRAKE_FORCE=80,FRICTION=20,TURN_SPEED=2.5,NITRO_MULTIPLIER=1.5,NITRO_CONSUMPTION=25,NITRO_REGEN=8,ROAD_WIDTH=16,LANES=[-6,-2,2,6];function HighwayMap(){const{scene:o}=useGLTF("/maps/highway/scene.gltf");return reactExports.useEffect(()=>{o.traverse(e=>{e instanceof Mesh&&(e.castShadow=!0,e.receiveShadow=!0)})},[o]),jsxRuntimeExports.jsx("primitive",{object:o,scale:1,position:[0,0,0]})}function Road({playerZ:o}){const e=reactExports.useMemo(()=>{const s=[];for(let a=-5;a<20;a++)s.push(a*100);return s},[]);return jsxRuntimeExports.jsx("group",{children:e.map((s,a)=>jsxRuntimeExports.jsxs("group",{position:[0,0,s+Math.floor(o/100)*100],children:[jsxRuntimeExports.jsxs("mesh",{rotation:[-Math.PI/2,0,0],receiveShadow:!0,children:[jsxRuntimeExports.jsx("planeGeometry",{args:[ROAD_WIDTH,100]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#333333"})]}),[-4,0,4].map((c,d)=>jsxRuntimeExports.jsxs("mesh",{position:[c,.01,0],rotation:[-Math.PI/2,0,0],children:[jsxRuntimeExports.jsx("planeGeometry",{args:[.15,100]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#ffffff"})]},d)),jsxRuntimeExports.jsxs("mesh",{position:[-8,.02,0],rotation:[-Math.PI/2,0,0],children:[jsxRuntimeExports.jsx("planeGeometry",{args:[.3,100]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#ffcc00"})]}),jsxRuntimeExports.jsxs("mesh",{position:[8,.02,0],rotation:[-Math.PI/2,0,0],children:[jsxRuntimeExports.jsx("planeGeometry",{args:[.3,100]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#ffcc00"})]}),jsxRuntimeExports.jsxs("mesh",{position:[-12,0,0],rotation:[-Math.PI/2,0,0],children:[jsxRuntimeExports.jsx("planeGeometry",{args:[8,100]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#2d5a27"})]}),jsxRuntimeExports.jsxs("mesh",{position:[12,0,0],rotation:[-Math.PI/2,0,0],children:[jsxRuntimeExports.jsx("planeGeometry",{args:[8,100]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#2d5a27"})]})]},a))})}function DetailedCar({color:o,isPlayer:e=!1,nitroActive:s=!1}){return jsxRuntimeExports.jsxs("group",{children:[jsxRuntimeExports.jsxs("mesh",{castShadow:!0,position:[0,.35,0],children:[jsxRuntimeExports.jsx("boxGeometry",{args:[1.8,.5,4.2]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:o,metalness:.8,roughness:.2})]}),jsxRuntimeExports.jsxs("mesh",{castShadow:!0,position:[0,.75,-.3],children:[jsxRuntimeExports.jsx("boxGeometry",{args:[1.6,.5,2]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#1a1a1a",metalness:.5,roughness:.3})]}),jsxRuntimeExports.jsxs("mesh",{position:[.7,.75,-.3],children:[jsxRuntimeExports.jsx("boxGeometry",{args:[.05,.4,1.8]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#87ceeb",transparent:!0,opacity:.6})]}),jsxRuntimeExports.jsxs("mesh",{position:[-.7,.75,-.3],children:[jsxRuntimeExports.jsx("boxGeometry",{args:[.05,.4,1.8]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#87ceeb",transparent:!0,opacity:.6})]}),jsxRuntimeExports.jsxs("mesh",{position:[0,.75,.6],children:[jsxRuntimeExports.jsx("boxGeometry",{args:[1.5,.4,.05]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#87ceeb",transparent:!0,opacity:.6})]}),jsxRuntimeExports.jsxs("mesh",{position:[0,.75,-1.2],children:[jsxRuntimeExports.jsx("boxGeometry",{args:[1.5,.4,.05]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#87ceeb",transparent:!0,opacity:.6})]}),[[-.75,.25,1.5],[.75,.25,1.5],[-.75,.25,-1.5],[.75,.25,-1.5]].map((a,c)=>jsxRuntimeExports.jsxs("group",{position:a,children:[jsxRuntimeExports.jsxs("mesh",{rotation:[0,0,Math.PI/2],children:[jsxRuntimeExports.jsx("cylinderGeometry",{args:[.3,.3,.25,16]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#1a1a1a"})]}),jsxRuntimeExports.jsxs("mesh",{rotation:[0,0,Math.PI/2],children:[jsxRuntimeExports.jsx("cylinderGeometry",{args:[.2,.2,.26,16]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#666666",metalness:.9})]})]},c)),jsxRuntimeExports.jsxs("mesh",{position:[.6,.35,2],children:[jsxRuntimeExports.jsx("boxGeometry",{args:[.3,.1,.05]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#ffff88",emissive:"#ffff00",emissiveIntensity:.5})]}),jsxRuntimeExports.jsxs("mesh",{position:[-.6,.35,2],children:[jsxRuntimeExports.jsx("boxGeometry",{args:[.3,.1,.05]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#ffff88",emissive:"#ffff00",emissiveIntensity:.5})]}),jsxRuntimeExports.jsxs("mesh",{position:[.6,.35,-2.1],children:[jsxRuntimeExports.jsx("boxGeometry",{args:[.4,.15,.05]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#ff3333",emissive:"#ff0000",emissiveIntensity:.3})]}),jsxRuntimeExports.jsxs("mesh",{position:[-.6,.35,-2.1],children:[jsxRuntimeExports.jsx("boxGeometry",{args:[.4,.15,.05]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#ff3333",emissive:"#ff0000",emissiveIntensity:.3})]}),e&&jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsxs("mesh",{position:[.5,.5,-.3],children:[jsxRuntimeExports.jsx("sphereGeometry",{args:[.15,8,8]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#c9a227"})]})}),s&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("pointLight",{position:[.4,.3,-2.2],color:"#ff4400",intensity:10,distance:5}),jsxRuntimeExports.jsx("pointLight",{position:[-.4,.3,-2.2],color:"#ff4400",intensity:10,distance:5}),jsxRuntimeExports.jsxs("mesh",{position:[.4,.35,-2.3],children:[jsxRuntimeExports.jsx("coneGeometry",{args:[.15,.8,8]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#ff6600",emissive:"#ff4400",emissiveIntensity:2,transparent:!0,opacity:.8})]}),jsxRuntimeExports.jsxs("mesh",{position:[-.4,.35,-2.3],children:[jsxRuntimeExports.jsx("coneGeometry",{args:[.15,.8,8]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#ff6600",emissive:"#ff4400",emissiveIntensity:2,transparent:!0,opacity:.8})]})]})]})}function TrafficCarEntity({car:o}){return jsxRuntimeExports.jsx("group",{position:[o.position.x,0,o.position.z],children:jsxRuntimeExports.jsx(DetailedCar,{color:o.color})})}function PlayerCar({carState:o,onStateChange:e}){const s=reactExports.useRef(null),[,a]=useKeyboardControls();useFrame((d,b)=>{const _e=a();let{position:tt,rotation:nt,speed:it,nitroActive:ot,nitroFuel:at}=o;if(_e.forward){const ct=ot&&at>0?ACCELERATION*NITRO_MULTIPLIER:ACCELERATION,ut=ot&&at>0?MAX_SPEED*NITRO_MULTIPLIER:MAX_SPEED;it=Math.min(it+ct*b,ut)}else _e.back?it=Math.max(it-BRAKE_FORCE*b,-MAX_SPEED*.2):it>0?it=Math.max(0,it-FRICTION*b):it<0&&(it=Math.min(0,it+FRICTION*b));if(_e.brake&&(it*=.92,Math.abs(it)<1&&(it=0)),ot=_e.nitro&&at>5&&it>10,ot?at=Math.max(0,at-NITRO_CONSUMPTION*b):at<100&&(at=Math.min(100,at+NITRO_REGEN*b)),Math.abs(it)>5){const ct=Math.min(1,Math.abs(it)/50)*Math.sign(it);_e.left&&(tt=new Vector3(Math.max(-7,tt.x-TURN_SPEED*2*b*ct),tt.y,tt.z)),_e.right&&(tt=new Vector3(Math.min(7,tt.x+TURN_SPEED*2*b*ct),tt.y,tt.z))}tt=new Vector3(tt.x,tt.y,tt.z+it*b*.1),e({position:tt,rotation:nt,speed:it,nitroActive:ot,nitroFuel:at})});const c=reactExports.useMemo(()=>0,[]);return jsxRuntimeExports.jsx("group",{ref:s,position:o.position,rotation:[0,Math.PI,c],children:jsxRuntimeExports.jsx(DetailedCar,{color:"#c9a227",isPlayer:!0,nitroActive:o.nitroActive})})}function FollowCamera$3({target:o,speed:e}){const{camera:s}=useThree();return reactExports.useRef(new Vector3(0,4,-10)),useFrame(()=>{const a=4+e/MAX_SPEED*2,c=10+e/MAX_SPEED*5,d=new Vector3(o.position.x*.3,o.position.y+a,o.position.z-c);s.position.lerp(d,.08),s.lookAt(o.position.x*.5,o.position.y+1,o.position.z+20)}),null}function GameWorld$3({carState:o,onCarStateChange:e,traffic:s,onCollision:a}){return useFrame(()=>{for(const c of s){const d=Math.abs(c.position.x-o.position.x),b=Math.abs(c.position.z-o.position.z);d<2&&b<4&&a()}}),jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("ambientLight",{intensity:.6}),jsxRuntimeExports.jsx("directionalLight",{position:[50,100,30],intensity:1.5,castShadow:!0,"shadow-mapSize":[2048,2048],"shadow-camera-far":300,"shadow-camera-left":-50,"shadow-camera-right":50,"shadow-camera-top":50,"shadow-camera-bottom":-50}),jsxRuntimeExports.jsx("hemisphereLight",{intensity:.4,color:"#87ceeb",groundColor:"#333333"}),jsxRuntimeExports.jsx(Sky,{sunPosition:[100,50,100]}),jsxRuntimeExports.jsx("fog",{attach:"fog",args:["#87ceeb",100,500]}),jsxRuntimeExports.jsx(Road,{playerZ:o.position.z}),jsxRuntimeExports.jsxs(reactExports.Suspense,{fallback:null,children:[jsxRuntimeExports.jsx("group",{position:[-30,0,0],children:jsxRuntimeExports.jsx(HighwayMap,{})}),jsxRuntimeExports.jsx("group",{position:[30,0,0],rotation:[0,Math.PI,0],children:jsxRuntimeExports.jsx(HighwayMap,{})})]}),s.map(c=>jsxRuntimeExports.jsx(TrafficCarEntity,{car:c},c.id)),jsxRuntimeExports.jsx(PlayerCar,{carState:o,onStateChange:e}),jsxRuntimeExports.jsx(FollowCamera$3,{target:o,speed:o.speed})]})}function GameUI$2({carState:o,stats:e,gameOver:s,onRestart:a}){const c=Math.abs(Math.round(o.speed*1.8));return s?jsxRuntimeExports.jsxs("div",{className:"absolute inset-0 bg-black/80 flex flex-col items-center justify-center",children:[jsxRuntimeExports.jsx("h1",{className:"text-6xl font-black text-red-500 mb-4",children:"CRASHED!"}),jsxRuntimeExports.jsx("div",{className:"bg-black/60 p-6 rounded-lg border border-[#c9a227] mb-6",children:jsxRuntimeExports.jsxs("div",{className:"text-white text-xl space-y-2",children:[jsxRuntimeExports.jsxs("div",{children:["Distance: ",jsxRuntimeExports.jsxs("span",{className:"text-[#c9a227]",children:[Math.round(e.distance),"m"]})]}),jsxRuntimeExports.jsxs("div",{children:["Score: ",jsxRuntimeExports.jsx("span",{className:"text-[#c9a227]",children:e.score.toLocaleString()})]}),jsxRuntimeExports.jsxs("div",{children:["Top Speed: ",jsxRuntimeExports.jsxs("span",{className:"text-[#c9a227]",children:[Math.round(e.topSpeed*1.8)," KM/H"]})]}),jsxRuntimeExports.jsxs("div",{children:["Near Misses: ",jsxRuntimeExports.jsx("span",{className:"text-[#c9a227]",children:e.nearMisses})]})]})}),jsxRuntimeExports.jsx("button",{onClick:a,className:"px-8 py-3 bg-[#c9a227] hover:bg-[#d4b02f] text-black font-bold text-xl rounded-lg",children:"TRY AGAIN"})]}):jsxRuntimeExports.jsxs("div",{className:"absolute inset-0 pointer-events-none select-none",children:[jsxRuntimeExports.jsxs("div",{className:"absolute top-4 left-4 bg-black/70 p-3 rounded-lg border border-[#1a5a5a]",children:[jsxRuntimeExports.jsx("div",{className:"text-[#c9a227] text-2xl font-bold",children:e.score.toLocaleString()}),jsxRuntimeExports.jsx("div",{className:"text-white text-sm",children:"SCORE"})]}),jsxRuntimeExports.jsx("div",{className:"absolute top-4 right-4 bg-black/70 p-3 rounded-lg border border-[#1a5a5a]",children:jsxRuntimeExports.jsxs("div",{className:"text-white text-sm",children:["Distance: ",Math.round(e.distance),"m"]})}),jsxRuntimeExports.jsxs("div",{className:"absolute bottom-8 right-8 bg-black/80 p-4 rounded-xl border-2 border-[#c9a227]",children:[jsxRuntimeExports.jsx("div",{className:"text-7xl font-black text-white text-right tabular-nums",style:{fontFamily:"monospace"},children:c}),jsxRuntimeExports.jsx("div",{className:"text-lg text-[#c9a227] text-right font-bold",children:"KM/H"})]}),jsxRuntimeExports.jsxs("div",{className:"absolute bottom-8 left-8 bg-black/80 p-4 rounded-lg border border-[#1a5a5a] w-56",children:[jsxRuntimeExports.jsx("div",{className:"text-xs text-gray-400 mb-2",children:"NITRO"}),jsxRuntimeExports.jsx("div",{className:"w-full h-5 bg-gray-800 rounded-full overflow-hidden",children:jsxRuntimeExports.jsx("div",{className:`h-full transition-all duration-100 ${o.nitroActive?"bg-gradient-to-r from-orange-500 to-red-500":"bg-gradient-to-r from-[#c9a227] to-[#f0d050]"}`,style:{width:`${o.nitroFuel}%`}})}),jsxRuntimeExports.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Hold SHIFT for boost"})]}),jsxRuntimeExports.jsx("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 bg-black/60 px-4 py-2 rounded-lg",children:jsxRuntimeExports.jsxs("div",{className:"text-white text-sm",children:[jsxRuntimeExports.jsx("span",{className:"text-[#c9a227]",children:"W/S"})," Speed ",jsxRuntimeExports.jsx("span",{className:"text-[#c9a227] ml-2",children:"A/D"})," Steer ",jsxRuntimeExports.jsx("span",{className:"text-[#c9a227] ml-2",children:"SPACE"})," Brake ",jsxRuntimeExports.jsx("span",{className:"text-[#c9a227] ml-2",children:"SHIFT"})," Nitro"]})})]})}const keyMap$3=[{name:"forward",keys:["ArrowUp","KeyW"]},{name:"back",keys:["ArrowDown","KeyS"]},{name:"left",keys:["ArrowLeft","KeyA"]},{name:"right",keys:["ArrowRight","KeyD"]},{name:"brake",keys:["Space"]},{name:"nitro",keys:["ShiftLeft","ShiftRight"]}],TRAFFIC_COLORS=["#ff4444","#4444ff","#44ff44","#ffff44","#ff44ff","#44ffff","#ffffff","#888888"],HighwayDriving=()=>{const[o,e]=reactExports.useState("menu"),[s,a]=reactExports.useState({position:new Vector3(0,.5,0),rotation:0,speed:0,nitroActive:!1,nitroFuel:100}),[c,d]=reactExports.useState([]),[b,_e]=reactExports.useState({score:0,distance:0,topSpeed:0,nearMisses:0}),tt=reactExports.useRef(0);reactExports.useEffect(()=>{if(o==="playing"){const ot=setInterval(()=>{_e(at=>({...at,distance:s.position.z,score:at.score+Math.round(s.speed*.1),topSpeed:Math.max(at.topSpeed,s.speed)})),d(at=>{let ct=at.map(ut=>({...ut,position:new Vector3(ut.position.x,ut.position.y,ut.position.z+ut.speed*.016)})).filter(ut=>ut.position.z>s.position.z-50&&ut.position.z<s.position.z+300);if(Math.random()<.05&&ct.length<15){const ut=LANES[Math.floor(Math.random()*LANES.length)];ct.push({id:`traffic-${Date.now()}-${Math.random()}`,position:new Vector3(ut,.5,s.position.z+150+Math.random()*100),lane:LANES.indexOf(ut),speed:20+Math.random()*30,color:TRAFFIC_COLORS[Math.floor(Math.random()*TRAFFIC_COLORS.length)]})}return ct})},16);return()=>clearInterval(ot)}},[o,s.position.z,s.speed]);const nt=reactExports.useCallback(()=>{e("gameover")},[]),it=reactExports.useCallback(()=>{a({position:new Vector3(0,.5,0),rotation:0,speed:0,nitroActive:!1,nitroFuel:100}),d([]),_e({score:0,distance:0,topSpeed:0,nearMisses:0}),tt.current=0,e("playing")},[]);return o==="menu"?jsxRuntimeExports.jsxs("div",{className:"w-full h-full bg-gradient-to-b from-[#1a5a5a] via-[#0a0a0a] to-[#0a0a0a] flex flex-col items-center justify-center",children:[jsxRuntimeExports.jsx("h1",{className:"text-7xl font-black text-white mb-2",style:{textShadow:"0 0 40px #c9a227, 0 0 80px #c9a227"},children:"HIGHWAY RACER"}),jsxRuntimeExports.jsx("p",{className:"text-2xl text-[#c9a227] mb-8",children:"Endless Speed Challenge"}),jsxRuntimeExports.jsx("button",{onClick:it,className:"px-12 py-5 bg-gradient-to-r from-[#c9a227] to-[#f0d050] hover:from-[#d4b02f] hover:to-[#ffdd66] text-black text-2xl font-black rounded-xl transition-all transform hover:scale-105 shadow-lg",children:"START RACE"}),jsxRuntimeExports.jsx("div",{className:"mt-10 bg-black/40 p-6 rounded-xl border border-[#1a5a5a]",children:jsxRuntimeExports.jsxs("div",{className:"text-white text-lg grid grid-cols-2 gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("span",{className:"bg-[#c9a227] text-black px-2 py-1 rounded font-bold",children:"W/S"}),jsxRuntimeExports.jsx("span",{children:"Accelerate/Brake"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("span",{className:"bg-[#c9a227] text-black px-2 py-1 rounded font-bold",children:"A/D"}),jsxRuntimeExports.jsx("span",{children:"Steer Left/Right"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("span",{className:"bg-[#c9a227] text-black px-2 py-1 rounded font-bold",children:"SPACE"}),jsxRuntimeExports.jsx("span",{children:"Emergency Brake"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("span",{className:"bg-[#c9a227] text-black px-2 py-1 rounded font-bold",children:"SHIFT"}),jsxRuntimeExports.jsx("span",{children:"Nitro Boost"})]})]})})]}):jsxRuntimeExports.jsxs("div",{className:"w-full h-full relative bg-black",children:[jsxRuntimeExports.jsx(KeyboardControls,{map:keyMap$3,children:jsxRuntimeExports.jsx(Canvas,{shadows:!0,camera:{fov:75,near:.1,far:1e3},children:jsxRuntimeExports.jsx(GameWorld$3,{carState:s,onCarStateChange:a,traffic:c,onCollision:nt})})}),jsxRuntimeExports.jsx(GameUI$2,{carState:s,stats:b,gameOver:o==="gameover",onRestart:it})]})},CAR_MAX_SPEED=100,WALK_SPEED=6,SPRINT_SPEED$1=12,CAR_ACCELERATION=50,CAR_FRICTION=15,CAR_TURN_SPEED=2;function CityMap(){const{scene:o}=useGLTF("/maps/crime_city/scene.gltf");return reactExports.useEffect(()=>{o.traverse(e=>{e instanceof Mesh&&(e.castShadow=!0,e.receiveShadow=!0)})},[o]),jsxRuntimeExports.jsx("primitive",{object:o,scale:1,position:[0,0,0]})}function CityGround(){return jsxRuntimeExports.jsxs("group",{children:[jsxRuntimeExports.jsxs("mesh",{rotation:[-Math.PI/2,0,0],position:[0,-.1,0],receiveShadow:!0,children:[jsxRuntimeExports.jsx("planeGeometry",{args:[500,500]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#1a1a1a"})]}),Array.from({length:10}).map((o,e)=>jsxRuntimeExports.jsxs("mesh",{rotation:[-Math.PI/2,0,0],position:[0,.01,(e-5)*50],children:[jsxRuntimeExports.jsx("planeGeometry",{args:[500,12]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#333333"})]},`road-h-${e}`)),Array.from({length:10}).map((o,e)=>jsxRuntimeExports.jsxs("mesh",{rotation:[-Math.PI/2,0,0],position:[(e-5)*50,.01,0],children:[jsxRuntimeExports.jsx("planeGeometry",{args:[12,500]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#333333"})]},`road-v-${e}`))]})}function Buildings(){const o=reactExports.useMemo(()=>{const e=[];for(let s=-4;s<=4;s++)for(let a=-4;a<=4;a++){if(Math.abs(s)<=1&&Math.abs(a)<=1)continue;const c=10+Math.random()*40,d=15+Math.random()*15;e.push({pos:[s*50+(Math.random()-.5)*20,c/2,a*50+(Math.random()-.5)*20],size:[d,c,d],color:["#2a2a2a","#3a3a3a","#1a3a3a","#3a1a1a"][Math.floor(Math.random()*4)]})}return e},[]);return jsxRuntimeExports.jsx("group",{children:o.map((e,s)=>jsxRuntimeExports.jsxs("mesh",{position:e.pos,castShadow:!0,receiveShadow:!0,children:[jsxRuntimeExports.jsx("boxGeometry",{args:e.size}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:e.color})]},s))})}function VehicleModel({color:o="#2a2a2a"}){return jsxRuntimeExports.jsxs("group",{children:[jsxRuntimeExports.jsxs("mesh",{castShadow:!0,position:[0,.5,0],children:[jsxRuntimeExports.jsx("boxGeometry",{args:[2.2,.8,4.5]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:o,metalness:.7,roughness:.3})]}),jsxRuntimeExports.jsxs("mesh",{castShadow:!0,position:[0,1.1,-.3],children:[jsxRuntimeExports.jsx("boxGeometry",{args:[2,.6,2.2]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#1a1a1a"})]}),jsxRuntimeExports.jsxs("mesh",{position:[.9,1.1,-.3],children:[jsxRuntimeExports.jsx("boxGeometry",{args:[.05,.5,2]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#4488aa",transparent:!0,opacity:.5})]}),jsxRuntimeExports.jsxs("mesh",{position:[-.9,1.1,-.3],children:[jsxRuntimeExports.jsx("boxGeometry",{args:[.05,.5,2]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#4488aa",transparent:!0,opacity:.5})]}),[[-.9,.3,1.8],[.9,.3,1.8],[-.9,.3,-1.8],[.9,.3,-1.8]].map((e,s)=>jsxRuntimeExports.jsxs("mesh",{position:e,rotation:[0,0,Math.PI/2],children:[jsxRuntimeExports.jsx("cylinderGeometry",{args:[.35,.35,.3,16]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#111111"})]},s)),jsxRuntimeExports.jsxs("mesh",{position:[0,.5,2.2],children:[jsxRuntimeExports.jsx("boxGeometry",{args:[1.8,.2,.1]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#ffff88",emissive:"#ffff00",emissiveIntensity:.5})]}),jsxRuntimeExports.jsxs("mesh",{position:[.7,.5,-2.3],children:[jsxRuntimeExports.jsx("boxGeometry",{args:[.5,.2,.1]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#ff4444",emissive:"#ff0000",emissiveIntensity:.3})]}),jsxRuntimeExports.jsxs("mesh",{position:[-.7,.5,-2.3],children:[jsxRuntimeExports.jsx("boxGeometry",{args:[.5,.2,.1]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#ff4444",emissive:"#ff0000",emissiveIntensity:.3})]})]})}function PlayerCharacter({color:o="#c9a227"}){return jsxRuntimeExports.jsxs("group",{children:[jsxRuntimeExports.jsxs("mesh",{castShadow:!0,position:[0,.5,0],children:[jsxRuntimeExports.jsx("cylinderGeometry",{args:[.3,.35,1,16]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#1a5a5a"})]}),jsxRuntimeExports.jsxs("mesh",{castShadow:!0,position:[0,1.2,0],children:[jsxRuntimeExports.jsx("cylinderGeometry",{args:[.25,.3,.5,16]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:o})]}),jsxRuntimeExports.jsxs("mesh",{castShadow:!0,position:[0,1.65,0],children:[jsxRuntimeExports.jsx("sphereGeometry",{args:[.25,16,16]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#e8c99b"})]})]})}function NPCEntity({npc:o}){return o.type==="pedestrian"?jsxRuntimeExports.jsx("group",{position:o.position,rotation:[0,o.direction,0],children:jsxRuntimeExports.jsx(PlayerCharacter,{color:"#666666"})}):jsxRuntimeExports.jsx("group",{position:o.position,rotation:[0,o.direction,0],children:jsxRuntimeExports.jsx(VehicleModel,{color:"#444444"})})}function MissionMarker({mission:o,playerPos:e}){return o.target.distanceTo(e),o.completed?null:jsxRuntimeExports.jsxs("group",{position:o.target,children:[jsxRuntimeExports.jsxs("mesh",{position:[0,3,0],children:[jsxRuntimeExports.jsx("cylinderGeometry",{args:[.5,0,2,4]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#c9a227",emissive:"#c9a227",emissiveIntensity:.5})]}),jsxRuntimeExports.jsx("pointLight",{position:[0,3,0],color:"#c9a227",intensity:2,distance:10})]})}function Player$2({state:o,onStateChange:e}){const s=reactExports.useRef(null),[,a]=useKeyboardControls(),c=reactExports.useRef(!1);return useFrame((d,b)=>{const _e=a();let{position:tt,rotation:nt,speed:it,inVehicle:ot,health:at,money:ct,wantedLevel:ut}=o;if(_e.exitCar&&!c.current&&(c.current=!0,ot=!ot,it=0,setTimeout(()=>{c.current=!1},500)),ot){if(_e.forward?it=Math.min(it+CAR_ACCELERATION*b,CAR_MAX_SPEED):_e.back?it=Math.max(it-CAR_ACCELERATION*b,-CAR_MAX_SPEED*.3):it>0?it=Math.max(0,it-CAR_FRICTION*b):it<0&&(it=Math.min(0,it+CAR_FRICTION*b)),_e.brake&&(it*=.9),Math.abs(it)>3){const ft=Math.min(1,Math.abs(it)/30)*Math.sign(it);_e.left&&(nt+=CAR_TURN_SPEED*b*ft),_e.right&&(nt-=CAR_TURN_SPEED*b*ft)}tt=new Vector3(tt.x+Math.sin(nt)*it*b,tt.y,tt.z+Math.cos(nt)*it*b)}else{const ft=_e.sprint?SPRINT_SPEED$1:WALK_SPEED,dt=new Vector3;_e.forward&&(dt.z=1),_e.back&&(dt.z=-1),_e.left&&(dt.x=1),_e.right&&(dt.x=-1),dt.length()>0&&(dt.normalize(),nt=Math.atan2(dt.x,dt.z),tt=new Vector3(tt.x+dt.x*ft*b,tt.y,tt.z+dt.z*ft*b))}e({position:tt,rotation:nt,speed:it,inVehicle:ot,health:at,money:ct,wantedLevel:ut}),s.current&&(s.current.position.copy(tt),s.current.rotation.y=nt)}),jsxRuntimeExports.jsx("group",{ref:s,children:o.inVehicle?jsxRuntimeExports.jsx(VehicleModel,{color:"#c9a227"}):jsxRuntimeExports.jsx(PlayerCharacter,{})})}function FollowCamera$2({target:o}){const{camera:e}=useThree();return useFrame(()=>{const s=o.inVehicle?15:10,a=o.inVehicle?8:5,c=new Vector3(0,a,-s);c.applyAxisAngle(new Vector3(0,1,0),o.rotation);const d=o.position.clone().add(c);e.position.lerp(d,.1),e.lookAt(o.position.x,o.position.y+2,o.position.z)}),null}function GameWorld$2({playerState:o,onPlayerStateChange:e,npcs:s,missions:a}){return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("ambientLight",{intensity:.4}),jsxRuntimeExports.jsx("directionalLight",{position:[50,100,30],intensity:1.2,castShadow:!0,"shadow-mapSize":[2048,2048]}),jsxRuntimeExports.jsx("hemisphereLight",{intensity:.3,color:"#1a1a2e",groundColor:"#333"}),jsxRuntimeExports.jsx(Sky,{sunPosition:[100,30,100]}),jsxRuntimeExports.jsx("fog",{attach:"fog",args:["#1a1a2e",50,300]}),jsxRuntimeExports.jsx(CityGround,{}),jsxRuntimeExports.jsx(Buildings,{}),jsxRuntimeExports.jsx(reactExports.Suspense,{fallback:null,children:jsxRuntimeExports.jsx(CityMap,{})}),s.map(c=>jsxRuntimeExports.jsx(NPCEntity,{npc:c},c.id)),a.map(c=>jsxRuntimeExports.jsx(MissionMarker,{mission:c,playerPos:o.position},c.id)),jsxRuntimeExports.jsx(Player$2,{state:o,onStateChange:e}),jsxRuntimeExports.jsx(FollowCamera$2,{target:o})]})}function GameUI$1({state:o,missions:e,onMissionComplete:s}){const a=e.find(c=>!c.completed);return jsxRuntimeExports.jsxs("div",{className:"absolute inset-0 pointer-events-none select-none",children:[jsxRuntimeExports.jsx("div",{className:"absolute top-4 right-4 bg-gradient-to-br from-[#0a0a0a]/90 to-[#1a1a1a]/90 p-4 rounded-xl border border-[#c9a227]/50 backdrop-blur-sm",children:jsxRuntimeExports.jsxs("div",{className:"text-[#c9a227] text-3xl font-black",children:["$",o.money.toLocaleString()]})}),jsxRuntimeExports.jsxs("div",{className:"absolute top-4 left-4 space-y-3",children:[jsxRuntimeExports.jsxs("div",{className:"bg-gradient-to-br from-[#0a0a0a]/90 to-[#1a1a1a]/90 p-3 rounded-xl border border-[#1a5a5a]/50 backdrop-blur-sm",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[jsxRuntimeExports.jsx("span",{className:"text-red-500 text-lg",children:""}),jsxRuntimeExports.jsxs("span",{className:"text-white font-bold",children:[o.health,"%"]})]}),jsxRuntimeExports.jsx("div",{className:"w-32 h-2 bg-gray-800 rounded-full overflow-hidden",children:jsxRuntimeExports.jsx("div",{className:"h-full bg-gradient-to-r from-red-600 to-red-400",style:{width:`${o.health}%`}})})]}),o.wantedLevel>0&&jsxRuntimeExports.jsx("div",{className:"bg-gradient-to-br from-[#0a0a0a]/90 to-[#1a1a1a]/90 p-3 rounded-xl border border-red-500/50 backdrop-blur-sm",children:jsxRuntimeExports.jsx("div",{className:"flex gap-1",children:Array.from({length:5}).map((c,d)=>jsxRuntimeExports.jsx("span",{className:`text-2xl ${d<o.wantedLevel?"text-red-500":"text-gray-700"}`,children:""},d))})})]}),a&&jsxRuntimeExports.jsxs("div",{className:"absolute top-4 left-1/2 transform -translate-x-1/2 bg-gradient-to-br from-[#0a0a0a]/90 to-[#1a1a1a]/90 px-6 py-3 rounded-xl border border-[#c9a227]/50 backdrop-blur-sm",children:[jsxRuntimeExports.jsx("div",{className:"text-[#c9a227] font-bold text-lg",children:a.title}),jsxRuntimeExports.jsx("div",{className:"text-white/70 text-sm",children:a.description}),jsxRuntimeExports.jsxs("div",{className:"text-green-400 text-sm mt-1",children:["Reward: $",a.reward]})]}),o.inVehicle&&jsxRuntimeExports.jsxs("div",{className:"absolute bottom-8 right-8 bg-gradient-to-br from-[#0a0a0a]/90 to-[#1a1a1a]/90 p-5 rounded-xl border border-[#1a5a5a]/50 backdrop-blur-sm",children:[jsxRuntimeExports.jsx("div",{className:"text-6xl font-black text-white tabular-nums",style:{fontFamily:"monospace"},children:Math.abs(Math.round(o.speed*1.8))}),jsxRuntimeExports.jsx("div",{className:"text-[#c9a227] text-right font-bold",children:"KM/H"})]}),jsxRuntimeExports.jsx("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 bg-gradient-to-br from-[#0a0a0a]/80 to-[#1a1a1a]/80 px-6 py-3 rounded-xl border border-[#1a5a5a]/30 backdrop-blur-sm",children:jsxRuntimeExports.jsxs("div",{className:"text-white text-sm flex gap-4",children:[jsxRuntimeExports.jsxs("span",{children:[jsxRuntimeExports.jsx("span",{className:"text-[#c9a227] font-bold",children:"WASD"})," Move"]}),jsxRuntimeExports.jsxs("span",{children:[jsxRuntimeExports.jsx("span",{className:"text-[#c9a227] font-bold",children:"SPACE"})," Brake"]}),jsxRuntimeExports.jsxs("span",{children:[jsxRuntimeExports.jsx("span",{className:"text-[#c9a227] font-bold",children:"F"})," ",o.inVehicle?"Exit":"Enter"," Vehicle"]}),!o.inVehicle&&jsxRuntimeExports.jsxs("span",{children:[jsxRuntimeExports.jsx("span",{className:"text-[#c9a227] font-bold",children:"SHIFT"})," Sprint"]})]})})]})}const keyMap$2=[{name:"forward",keys:["ArrowUp","KeyW"]},{name:"back",keys:["ArrowDown","KeyS"]},{name:"left",keys:["ArrowLeft","KeyA"]},{name:"right",keys:["ArrowRight","KeyD"]},{name:"brake",keys:["Space"]},{name:"horn",keys:["KeyH"]},{name:"exitCar",keys:["KeyF"]},{name:"sprint",keys:["ShiftLeft","ShiftRight"]}],CrimeCityDriving=()=>{const[o,e]=reactExports.useState("menu"),[s,a]=reactExports.useState({position:new Vector3(0,1,0),rotation:0,speed:0,inVehicle:!0,health:100,money:5e3,wantedLevel:0}),[c,d]=reactExports.useState([]),[b,_e]=reactExports.useState([]),tt=reactExports.useCallback(()=>{const ot=[];for(let at=0;at<20;at++)ot.push({id:`ped-${at}`,position:new Vector3((Math.random()-.5)*200,0,(Math.random()-.5)*200),type:"pedestrian",direction:Math.random()*Math.PI*2,speed:2});for(let at=0;at<10;at++)ot.push({id:`car-${at}`,position:new Vector3((Math.random()-.5)*200,0,(Math.random()-.5)*200),type:"car",direction:Math.random()*Math.PI*2,speed:20+Math.random()*20});d(ot),_e([{id:"m1",title:"First Job",description:"Go to the marker",target:new Vector3(50,0,50),reward:1e3,completed:!1},{id:"m2",title:"Downtown Run",description:"Reach the downtown area",target:new Vector3(-100,0,100),reward:2500,completed:!1}])},[]);reactExports.useEffect(()=>{if(o==="playing"){const ot=setInterval(()=>{d(at=>at.map(ct=>{const ut=ct.position.clone();return ut.x+=Math.sin(ct.direction)*ct.speed*.016,ut.z+=Math.cos(ct.direction)*ct.speed*.016,Math.abs(ut.x)>200||Math.abs(ut.z)>200?{...ct,direction:ct.direction+Math.PI}:{...ct,position:ut}})),_e(at=>at.map(ct=>!ct.completed&&ct.target.distanceTo(s.position)<5?(a(ut=>({...ut,money:ut.money+ct.reward})),{...ct,completed:!0}):ct))},16);return()=>clearInterval(ot)}},[o,s.position]);const nt=reactExports.useCallback(()=>{a({position:new Vector3(0,1,0),rotation:0,speed:0,inVehicle:!0,health:100,money:5e3,wantedLevel:0}),tt(),e("playing")},[tt]),it=reactExports.useCallback(ot=>{_e(at=>at.map(ct=>ct.id===ot?{...ct,completed:!0}:ct))},[]);return o==="menu"?jsxRuntimeExports.jsxs("div",{className:"w-full h-full bg-gradient-to-br from-[#0a0a0a] via-[#1a1a2e] to-[#0a0a0a] flex flex-col items-center justify-center",children:[jsxRuntimeExports.jsxs("div",{className:"text-center mb-8",children:[jsxRuntimeExports.jsx("h1",{className:"text-7xl font-black text-white mb-2",style:{textShadow:"0 0 40px #c9a227, 0 0 80px #1a5a5a"},children:"CRIME CITY"}),jsxRuntimeExports.jsx("p",{className:"text-2xl text-[#c9a227]",children:"Streets of Chaos"})]}),jsxRuntimeExports.jsx("button",{onClick:nt,className:"px-12 py-5 bg-gradient-to-r from-[#c9a227] to-[#f0d050] hover:from-[#d4b02f] hover:to-[#ffdd66] text-black text-2xl font-black rounded-xl transition-all transform hover:scale-105 shadow-xl",children:"ENTER CITY"}),jsxRuntimeExports.jsx("div",{className:"mt-10 bg-[#0a0a0a]/60 p-6 rounded-xl border border-[#1a5a5a]/50 backdrop-blur-sm",children:jsxRuntimeExports.jsxs("div",{className:"text-white text-lg grid grid-cols-2 gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("span",{className:"bg-[#1a5a5a] text-white px-3 py-1 rounded font-bold",children:"WASD"}),jsxRuntimeExports.jsx("span",{children:"Move / Drive"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("span",{className:"bg-[#1a5a5a] text-white px-3 py-1 rounded font-bold",children:"F"}),jsxRuntimeExports.jsx("span",{children:"Enter / Exit Vehicle"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("span",{className:"bg-[#1a5a5a] text-white px-3 py-1 rounded font-bold",children:"SPACE"}),jsxRuntimeExports.jsx("span",{children:"Brake"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("span",{className:"bg-[#1a5a5a] text-white px-3 py-1 rounded font-bold",children:"SHIFT"}),jsxRuntimeExports.jsx("span",{children:"Sprint"})]})]})})]}):jsxRuntimeExports.jsxs("div",{className:"w-full h-full relative bg-black",children:[jsxRuntimeExports.jsx(KeyboardControls,{map:keyMap$2,children:jsxRuntimeExports.jsx(Canvas,{shadows:!0,camera:{fov:75,near:.1,far:1e3},children:jsxRuntimeExports.jsx(GameWorld$2,{playerState:s,onPlayerStateChange:a,npcs:c,missions:b})})}),jsxRuntimeExports.jsx(GameUI$1,{state:s,missions:b,onMissionComplete:it})]})},PLAYER_SPEED$1=7,ATTACK_RANGE=3.5,ATTACK_DAMAGE=30,DODGE_DISTANCE=5,STAMINA_REGEN$1=25,MANA_REGEN=8,ENEMY_ATTACK_RANGE=2.5,ENEMY_DAMAGE=10,AGGRO_RANGE=15;function RPGModel({path:o,scale:e=1,position:s=[0,0,0]}){const{scene:a}=useGLTF(o),c=reactExports.useMemo(()=>a.clone(),[a]);return jsxRuntimeExports.jsx("primitive",{object:c,scale:e,position:s})}function Terrain$1(){const o=reactExports.useMemo(()=>{const e=[];for(let s=0;s<40;s++){const a=(Math.random()-.5)*150,c=(Math.random()-.5)*150;Math.abs(a)<20&&Math.abs(c)<20||e.push({pos:[a,0,c],scale:1+Math.random()*1.5,rot:Math.random()*Math.PI*2})}return e},[]);return jsxRuntimeExports.jsxs("group",{children:[jsxRuntimeExports.jsxs("mesh",{rotation:[-Math.PI/2,0,0],position:[0,0,0],receiveShadow:!0,children:[jsxRuntimeExports.jsx("planeGeometry",{args:[300,300]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#3d6b35"})]}),jsxRuntimeExports.jsxs("mesh",{rotation:[-Math.PI/2,0,0],position:[0,.01,0],receiveShadow:!0,children:[jsxRuntimeExports.jsx("circleGeometry",{args:[25,32]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#4a7a42"})]}),o.map((e,s)=>jsxRuntimeExports.jsx(reactExports.Suspense,{fallback:null,children:jsxRuntimeExports.jsx("group",{position:e.pos,rotation:[0,e.rot,0],children:jsxRuntimeExports.jsx(RPGModel,{path:"/models/rpg/Tree.glb",scale:e.scale})})},s)),jsxRuntimeExports.jsx(reactExports.Suspense,{fallback:null,children:jsxRuntimeExports.jsx(RPGModel,{path:"/models/rpg/Castle.glb",scale:3,position:[0,0,-60]})}),jsxRuntimeExports.jsx(reactExports.Suspense,{fallback:null,children:jsxRuntimeExports.jsx(RPGModel,{path:"/models/rpg/Campfire.glb",scale:2,position:[8,0,8]})}),jsxRuntimeExports.jsx(reactExports.Suspense,{fallback:null,children:jsxRuntimeExports.jsx(RPGModel,{path:"/models/rpg/Well.glb",scale:1.5,position:[-10,0,5]})}),jsxRuntimeExports.jsx(reactExports.Suspense,{fallback:null,children:jsxRuntimeExports.jsx(RPGModel,{path:"/models/rpg/Market Stand.glb",scale:1.5,position:[15,0,-5]})})]})}function EnemyEntity({enemy:o,playerPos:e,onDamagePlayer:s}){const a=reactExports.useRef(null),[c,d]=reactExports.useState(!1);if(useFrame((tt,nt)=>{if(!o.isAlive||!a.current)return;const it=o.position.distanceTo(e);if(it<AGGRO_RANGE&&it>ENEMY_ATTACK_RANGE){const ot=e.clone().sub(o.position).normalize();o.position.add(ot.multiplyScalar(2*nt)),a.current.position.copy(o.position),a.current.lookAt(e)}it<ENEMY_ATTACK_RANGE&&Date.now()-o.lastAttack>1500&&(o.lastAttack=Date.now(),d(!0),setTimeout(()=>{d(!1),o.position.distanceTo(e)<ENEMY_ATTACK_RANGE&&s()},300))}),!o.isAlive)return null;const b=()=>{switch(o.type){case"slime":return"#44ff44";case"skeleton":return"#dddddd";case"dragon":return"#ff4444"}},_e=()=>{switch(o.type){case"slime":return .8;case"skeleton":return 1.2;case"dragon":return 2}};return jsxRuntimeExports.jsxs("group",{ref:a,position:o.position,children:[o.type==="slime"&&jsxRuntimeExports.jsxs("mesh",{castShadow:!0,position:[0,.5,0],scale:c?1.3:1,children:[jsxRuntimeExports.jsx("sphereGeometry",{args:[_e(),16,16]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:b(),transparent:!0,opacity:.8})]}),o.type==="skeleton"&&jsxRuntimeExports.jsxs("group",{scale:c?1.1:1,children:[jsxRuntimeExports.jsxs("mesh",{castShadow:!0,position:[0,1,0],children:[jsxRuntimeExports.jsx("capsuleGeometry",{args:[.3,1,8,16]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#dddddd"})]}),jsxRuntimeExports.jsxs("mesh",{castShadow:!0,position:[0,1.8,0],children:[jsxRuntimeExports.jsx("sphereGeometry",{args:[.3,16,16]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#dddddd"})]})]}),o.type==="dragon"&&jsxRuntimeExports.jsx(reactExports.Suspense,{fallback:jsxRuntimeExports.jsxs("mesh",{castShadow:!0,position:[0,1.5,0],scale:c?1.2:1,children:[jsxRuntimeExports.jsx("boxGeometry",{args:[2,2,4]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#ff4444"})]}),children:jsxRuntimeExports.jsx("group",{scale:c?1.1:1,children:jsxRuntimeExports.jsx(RPGModel,{path:"/models/rpg/Dragon.glb",scale:1})})}),jsxRuntimeExports.jsx(Html,{position:[0,_e()+1.5,0],center:!0,children:jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("div",{className:"text-white text-xs font-bold mb-1 capitalize",children:o.type}),jsxRuntimeExports.jsx("div",{className:"w-20 h-2 bg-gray-900 rounded-full overflow-hidden border border-gray-700",children:jsxRuntimeExports.jsx("div",{className:"h-full bg-gradient-to-r from-red-700 to-red-500",style:{width:`${o.health/o.maxHealth*100}%`}})})]})})]})}function LootDropEntity({loot:o,onCollect:e}){const s=reactExports.useRef(null);useFrame(c=>{s.current&&(s.current.position.y=.5+Math.sin(c.clock.elapsedTime*3)*.2,s.current.rotation.y+=.02)});const a=()=>{switch(o.type){case"gold":return"#c9a227";case"potion":return"#ff44ff";case"weapon":return"#4444ff"}};return jsxRuntimeExports.jsxs("group",{position:o.position,children:[jsxRuntimeExports.jsxs("mesh",{ref:s,castShadow:!0,children:[jsxRuntimeExports.jsx("octahedronGeometry",{args:[.3]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:a(),emissive:a(),emissiveIntensity:.5})]}),jsxRuntimeExports.jsx("pointLight",{color:a(),intensity:1,distance:3})]})}function Player$1({position:o,onPositionChange:e,onAttack:s,stats:a,onStaminaUse:c,isAttacking:d}){const b=reactExports.useRef(null),[,_e]=useKeyboardControls(),tt=reactExports.useRef(0),nt=reactExports.useRef(!1);return useFrame((it,ot)=>{const at=_e(),ct=o.clone(),ut=new Vector3;if(at.forward&&(ut.z=-1),at.back&&(ut.z=1),at.left&&(ut.x=-1),at.right&&(ut.x=1),ut.length()>0&&(ut.normalize(),tt.current=Math.atan2(ut.x,ut.z),ct.add(ut.multiplyScalar(PLAYER_SPEED$1*ot)),e(ct)),at.attack&&!nt.current&&a.stamina>=15&&(nt.current=!0,s(),setTimeout(()=>{nt.current=!1},400)),at.dodge&&c(25)){const ft=ut.length()>0?ut.clone():new Vector3(0,0,-1);ct.add(ft.multiplyScalar(DODGE_DISTANCE)),e(ct)}b.current&&(b.current.rotation.y=tt.current)}),jsxRuntimeExports.jsxs("group",{ref:b,position:o,children:[jsxRuntimeExports.jsxs("mesh",{castShadow:!0,position:[0,1,0],scale:d?[1.1,1.1,1.1]:[1,1,1],children:[jsxRuntimeExports.jsx("capsuleGeometry",{args:[.4,1.2,8,16]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#c9a227"})]}),jsxRuntimeExports.jsxs("mesh",{castShadow:!0,position:[0,1.9,0],children:[jsxRuntimeExports.jsx("sphereGeometry",{args:[.32,16,16]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#e8c99b"})]}),jsxRuntimeExports.jsx(reactExports.Suspense,{fallback:null,children:jsxRuntimeExports.jsx("group",{position:[.6,1.2,0],rotation:[d?-Math.PI/2:-Math.PI/4,0,-Math.PI/4],children:jsxRuntimeExports.jsx(RPGModel,{path:"/models/rpg/Sword.glb",scale:.4})})}),d&&jsxRuntimeExports.jsxs("mesh",{position:[0,1,1.5],rotation:[0,0,Math.PI/4],children:[jsxRuntimeExports.jsx("planeGeometry",{args:[2,.5]}),jsxRuntimeExports.jsx("meshBasicMaterial",{color:"#ffffff",transparent:!0,opacity:.5})]})]})}function FollowCamera$1({target:o}){const{camera:e}=useThree();return useFrame(()=>{const s=new Vector3(0,10,15);e.position.lerp(o.clone().add(s),.1),e.lookAt(o)}),null}function GameWorld$1({playerPosition:o,onPlayerPositionChange:e,enemies:s,onEnemyDamage:a,onPlayerDamage:c,stats:d,onStaminaUse:b,loot:_e,onCollectLoot:tt,isAttacking:nt}){const it=reactExports.useCallback(()=>{s.forEach(ot=>{ot.isAlive&&ot.position.distanceTo(o)<ATTACK_RANGE&&a(ot.id,ATTACK_DAMAGE+d.attack)})},[s,o,a,d.attack]);return useFrame(()=>{_e.forEach(ot=>{ot.position.distanceTo(o)<2&&tt(ot.id)})}),jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("ambientLight",{intensity:.5}),jsxRuntimeExports.jsx("directionalLight",{position:[50,80,30],intensity:1.2,castShadow:!0,"shadow-mapSize":[2048,2048]}),jsxRuntimeExports.jsx("hemisphereLight",{intensity:.4,color:"#87ceeb",groundColor:"#3d6b35"}),jsxRuntimeExports.jsx(Sky,{sunPosition:[100,50,100]}),jsxRuntimeExports.jsx("fog",{attach:"fog",args:["#87ceeb",60,200]}),jsxRuntimeExports.jsx(Terrain$1,{}),jsxRuntimeExports.jsx(Player$1,{position:o,onPositionChange:e,onAttack:it,stats:d,onStaminaUse:b,isAttacking:nt}),s.map(ot=>jsxRuntimeExports.jsx(EnemyEntity,{enemy:ot,playerPos:o,onDamagePlayer:c},ot.id)),_e.map(ot=>jsxRuntimeExports.jsx(LootDropEntity,{loot:ot,onCollect:tt},ot.id)),jsxRuntimeExports.jsx(FollowCamera$1,{target:o})]})}function GameUI({stats:o,inventory:e,showInventory:s,onToggleInventory:a}){return jsxRuntimeExports.jsxs("div",{className:"absolute inset-0 pointer-events-none select-none",children:[jsxRuntimeExports.jsxs("div",{className:"absolute top-4 left-4 bg-gradient-to-br from-[#0a0a0a]/90 to-[#1a1a1a]/90 p-4 rounded-xl border border-[#1a5a5a]/50 backdrop-blur-sm",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[jsxRuntimeExports.jsx("div",{className:"w-12 h-12 bg-[#1a5a5a] rounded-lg flex items-center justify-center",children:jsxRuntimeExports.jsx("span",{className:"text-2xl",children:""})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("div",{className:"text-[#c9a227] font-bold text-lg",children:["Level ",o.level]}),jsxRuntimeExports.jsxs("div",{className:"text-white/70 text-sm",children:[o.exp,"/",o.expToNext," XP"]})]})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-2 w-48",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[jsxRuntimeExports.jsx("span",{className:"text-red-400",children:"HP"}),jsxRuntimeExports.jsxs("span",{className:"text-white",children:[o.health,"/",o.maxHealth]})]}),jsxRuntimeExports.jsx("div",{className:"h-3 bg-gray-800 rounded-full overflow-hidden",children:jsxRuntimeExports.jsx("div",{className:"h-full bg-gradient-to-r from-red-700 to-red-500",style:{width:`${o.health/o.maxHealth*100}%`}})})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[jsxRuntimeExports.jsx("span",{className:"text-blue-400",children:"MP"}),jsxRuntimeExports.jsxs("span",{className:"text-white",children:[Math.round(o.mana),"/",o.maxMana]})]}),jsxRuntimeExports.jsx("div",{className:"h-3 bg-gray-800 rounded-full overflow-hidden",children:jsxRuntimeExports.jsx("div",{className:"h-full bg-gradient-to-r from-blue-700 to-blue-500",style:{width:`${o.mana/o.maxMana*100}%`}})})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[jsxRuntimeExports.jsx("span",{className:"text-green-400",children:"ST"}),jsxRuntimeExports.jsxs("span",{className:"text-white",children:[Math.round(o.stamina),"/",o.maxStamina]})]}),jsxRuntimeExports.jsx("div",{className:"h-3 bg-gray-800 rounded-full overflow-hidden",children:jsxRuntimeExports.jsx("div",{className:"h-full bg-gradient-to-r from-green-700 to-green-500",style:{width:`${o.stamina/o.maxStamina*100}%`}})})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"absolute top-4 right-4 bg-gradient-to-br from-[#0a0a0a]/90 to-[#1a1a1a]/90 p-4 rounded-xl border border-[#c9a227]/50 backdrop-blur-sm",children:[jsxRuntimeExports.jsxs("div",{className:"text-[#c9a227] text-3xl font-black",children:[o.gold," G"]}),jsxRuntimeExports.jsxs("div",{className:"text-white/50 text-xs mt-1",children:["ATK: ",o.attack," | DEF: ",o.defense]})]}),jsxRuntimeExports.jsx("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 bg-gradient-to-br from-[#0a0a0a]/80 to-[#1a1a1a]/80 px-6 py-3 rounded-xl border border-[#1a5a5a]/30 backdrop-blur-sm",children:jsxRuntimeExports.jsxs("div",{className:"text-white text-sm flex gap-4",children:[jsxRuntimeExports.jsxs("span",{children:[jsxRuntimeExports.jsx("span",{className:"text-[#c9a227] font-bold",children:"WASD"})," Move"]}),jsxRuntimeExports.jsxs("span",{children:[jsxRuntimeExports.jsx("span",{className:"text-[#c9a227] font-bold",children:"SPACE"})," Attack"]}),jsxRuntimeExports.jsxs("span",{children:[jsxRuntimeExports.jsx("span",{className:"text-[#c9a227] font-bold",children:"SHIFT"})," Dodge"]}),jsxRuntimeExports.jsxs("span",{children:[jsxRuntimeExports.jsx("span",{className:"text-[#c9a227] font-bold",children:"E"})," Interact"]})]})}),s&&jsxRuntimeExports.jsxs("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-gradient-to-br from-[#0a0a0a] to-[#1a1a1a] p-6 rounded-xl border border-[#c9a227]/50 pointer-events-auto",children:[jsxRuntimeExports.jsx("div",{className:"text-[#c9a227] font-bold text-xl mb-4",children:"Inventory"}),jsxRuntimeExports.jsx("div",{className:"grid grid-cols-5 gap-2",children:e.map(c=>jsxRuntimeExports.jsxs("div",{className:"w-14 h-14 bg-gray-800 rounded-lg flex flex-col items-center justify-center border border-[#1a5a5a]/50 hover:border-[#c9a227] cursor-pointer",children:[jsxRuntimeExports.jsx("span",{className:"text-2xl",children:c.icon}),c.amount>1&&jsxRuntimeExports.jsx("span",{className:"text-xs text-white",children:c.amount})]},c.id))})]})]})}const keyMap$1=[{name:"forward",keys:["ArrowUp","KeyW"]},{name:"back",keys:["ArrowDown","KeyS"]},{name:"left",keys:["ArrowLeft","KeyA"]},{name:"right",keys:["ArrowRight","KeyD"]},{name:"attack",keys:["Space"]},{name:"dodge",keys:["ShiftLeft"]},{name:"interact",keys:["KeyE"]},{name:"inventory",keys:["KeyI"]}],RPGFantasy=()=>{const[o,e]=reactExports.useState("menu"),[s,a]=reactExports.useState(new Vector3(0,0,0)),[c,d]=reactExports.useState({health:100,maxHealth:100,mana:50,maxMana:50,stamina:100,maxStamina:100,level:1,exp:0,expToNext:100,gold:50,attack:10,defense:5}),[b,_e]=reactExports.useState([]),[tt,nt]=reactExports.useState([]),[it,ot]=reactExports.useState([{id:"1",name:"Iron Sword",type:"weapon",icon:"",amount:1,stats:{attack:10}},{id:"2",name:"Health Potion",type:"potion",icon:"",amount:3,stats:{heal:50}}]),[at,ct]=reactExports.useState(!1),[ut,ft]=reactExports.useState(!1);reactExports.useEffect(()=>{if(o==="playing"){const yt=setInterval(()=>{d(wt=>({...wt,stamina:Math.min(wt.maxStamina,wt.stamina+STAMINA_REGEN$1*.05),mana:Math.min(wt.maxMana,wt.mana+MANA_REGEN*.05)}))},50);return()=>clearInterval(yt)}},[o]),reactExports.useEffect(()=>{const yt=wt=>{wt.code==="KeyI"&&ct(Et=>!Et)};return window.addEventListener("keydown",yt),()=>window.removeEventListener("keydown",yt)},[]);const dt=reactExports.useCallback(()=>{const yt=[];for(let wt=0;wt<8;wt++)yt.push({id:`slime-${wt}`,position:new Vector3((Math.random()-.5)*80,0,(Math.random()-.5)*80),health:60,maxHealth:60,type:"slime",isAlive:!0,lastAttack:0,aggro:!1});for(let wt=0;wt<4;wt++)yt.push({id:`skeleton-${wt}`,position:new Vector3((Math.random()-.5)*100,0,(Math.random()-.5)*100),health:100,maxHealth:100,type:"skeleton",isAlive:!0,lastAttack:0,aggro:!1});yt.push({id:"dragon-boss",position:new Vector3(0,0,-40),health:500,maxHealth:500,type:"dragon",isAlive:!0,lastAttack:0,aggro:!1}),_e(yt)},[]),lt=reactExports.useCallback((yt,wt)=>{ft(!0),setTimeout(()=>ft(!1),200),_e(Et=>Et.map(_t=>{if(_t.id===yt&&_t.isAlive){const vt=_t.health-wt;if(vt<=0){const Mt=_t.type==="dragon"?200:_t.type==="skeleton"?30:15,jt=_t.type==="dragon"?100:_t.type==="skeleton"?20:10;return d(Lt=>{let Nt=Lt.exp+Mt,kt=Lt.level,Ot=Lt.expToNext;return Nt>=Lt.expToNext&&(kt++,Nt=Nt-Lt.expToNext,Ot=Math.floor(Lt.expToNext*1.5)),{...Lt,exp:Nt,level:kt,expToNext:Ot,gold:Lt.gold+jt,attack:Lt.attack+(kt>Lt.level?2:0),defense:Lt.defense+(kt>Lt.level?1:0),maxHealth:Lt.maxHealth+(kt>Lt.level?10:0)}}),nt(Lt=>[...Lt,{id:`loot-${Date.now()}`,position:_t.position.clone(),type:Math.random()<.3?"potion":"gold",value:jt}]),{..._t,health:0,isAlive:!1}}return{..._t,health:vt}}return _t}))},[]),ht=reactExports.useCallback(()=>{d(yt=>{const wt=Math.max(1,ENEMY_DAMAGE-yt.defense/2),Et=yt.health-wt;return Et<=0?(e("dead"),{...yt,health:0}):{...yt,health:Et}})},[]),mt=reactExports.useCallback(yt=>c.stamina>=yt?(d(wt=>({...wt,stamina:wt.stamina-yt})),!0):!1,[c.stamina]),xt=reactExports.useCallback(yt=>{nt(wt=>{const Et=wt.find(_t=>_t.id===yt);return Et&&(Et.type==="gold"?d(_t=>({..._t,gold:_t.gold+Et.value})):Et.type==="potion"&&ot(_t=>_t.find(Mt=>Mt.name==="Health Potion")?_t.map(Mt=>Mt.name==="Health Potion"?{...Mt,amount:Mt.amount+1}:Mt):[..._t,{id:`potion-${Date.now()}`,name:"Health Potion",type:"potion",icon:"",amount:1,stats:{heal:50}}])),wt.filter(_t=>_t.id!==yt)})},[]),St=reactExports.useCallback(()=>{a(new Vector3(0,0,0)),d({health:100,maxHealth:100,mana:50,maxMana:50,stamina:100,maxStamina:100,level:1,exp:0,expToNext:100,gold:50,attack:10,defense:5}),nt([]),dt(),e("playing")},[dt]);return o==="menu"||o==="dead"?jsxRuntimeExports.jsxs("div",{className:"w-full h-full bg-gradient-to-br from-[#1a1a2e] via-[#0a0a0a] to-[#2d1f3d] flex flex-col items-center justify-center",children:[jsxRuntimeExports.jsx("h1",{className:"text-7xl font-black text-white mb-2",style:{textShadow:"0 0 40px #c9a227, 0 0 80px #1a5a5a"},children:"REALM QUEST"}),jsxRuntimeExports.jsx("p",{className:"text-2xl text-[#c9a227] mb-2",children:"A Fantasy RPG Adventure"}),o==="dead"&&jsxRuntimeExports.jsx("p",{className:"text-xl text-red-500 mb-4",children:"You have fallen in battle..."}),jsxRuntimeExports.jsx("button",{onClick:St,className:"mt-6 px-12 py-5 bg-gradient-to-r from-[#c9a227] to-[#f0d050] hover:from-[#d4b02f] hover:to-[#ffdd66] text-black text-2xl font-black rounded-xl transition-all transform hover:scale-105 shadow-xl",children:o==="dead"?"TRY AGAIN":"BEGIN QUEST"}),jsxRuntimeExports.jsx("div",{className:"mt-10 bg-[#0a0a0a]/60 p-6 rounded-xl border border-[#1a5a5a]/50 backdrop-blur-sm",children:jsxRuntimeExports.jsxs("div",{className:"text-white text-lg grid grid-cols-2 gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("span",{className:"bg-[#1a5a5a] text-white px-3 py-1 rounded font-bold",children:"WASD"}),jsxRuntimeExports.jsx("span",{children:"Move"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("span",{className:"bg-[#1a5a5a] text-white px-3 py-1 rounded font-bold",children:"SPACE"}),jsxRuntimeExports.jsx("span",{children:"Attack"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("span",{className:"bg-[#1a5a5a] text-white px-3 py-1 rounded font-bold",children:"SHIFT"}),jsxRuntimeExports.jsx("span",{children:"Dodge"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("span",{className:"bg-[#1a5a5a] text-white px-3 py-1 rounded font-bold",children:"I"}),jsxRuntimeExports.jsx("span",{children:"Inventory"})]})]})})]}):jsxRuntimeExports.jsxs("div",{className:"w-full h-full relative bg-black",children:[jsxRuntimeExports.jsx(KeyboardControls,{map:keyMap$1,children:jsxRuntimeExports.jsx(Canvas,{shadows:!0,camera:{fov:60,near:.1,far:500},children:jsxRuntimeExports.jsx(GameWorld$1,{playerPosition:s,onPlayerPositionChange:a,enemies:b,onEnemyDamage:lt,onPlayerDamage:ht,stats:c,onStaminaUse:mt,loot:tt,onCollectLoot:xt,isAttacking:ut})})}),jsxRuntimeExports.jsx(GameUI,{stats:c,inventory:it,showInventory:at,onToggleInventory:()=>ct(!at)})]})},PLAYER_SPEED=6,SPRINT_SPEED=10,HUNGER_DECAY=.3,THIRST_DECAY=.5,STAMINA_REGEN=20,STAMINA_DRAIN=25,GATHER_RANGE=4,GATHER_DAMAGE=20;function SurvivalModel({path:o,scale:e=1,position:s=[0,0,0]}){const{scene:a}=useGLTF(o),c=reactExports.useMemo(()=>a.clone(),[a]);return jsxRuntimeExports.jsx("primitive",{object:c,scale:e,position:s})}function Terrain(){return jsxRuntimeExports.jsxs("group",{children:[jsxRuntimeExports.jsxs("mesh",{rotation:[-Math.PI/2,0,0],receiveShadow:!0,children:[jsxRuntimeExports.jsx("planeGeometry",{args:[400,400]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#3d6b35"})]}),jsxRuntimeExports.jsxs("mesh",{rotation:[-Math.PI/2,0,0],position:[80,.02,0],children:[jsxRuntimeExports.jsx("planeGeometry",{args:[60,60]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#c9a227"})]}),jsxRuntimeExports.jsxs("mesh",{rotation:[-Math.PI/2,0,0],position:[-80,.01,60],children:[jsxRuntimeExports.jsx("circleGeometry",{args:[30,32]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#4a8fc9"})]})]})}function ResourceNodeEntity({node:o,playerPos:e,onGather:s}){const c=o.position.distanceTo(e)<GATHER_RANGE;return o.health<=0?null:jsxRuntimeExports.jsxs("group",{position:o.position,children:[o.type==="tree"&&jsxRuntimeExports.jsx(reactExports.Suspense,{fallback:jsxRuntimeExports.jsxs("group",{children:[jsxRuntimeExports.jsxs("mesh",{position:[0,2,0],castShadow:!0,children:[jsxRuntimeExports.jsx("cylinderGeometry",{args:[.3,.5,4]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#8b4513"})]}),jsxRuntimeExports.jsxs("mesh",{position:[0,4.5,0],castShadow:!0,children:[jsxRuntimeExports.jsx("coneGeometry",{args:[2,3,8]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#228b22"})]})]}),children:jsxRuntimeExports.jsx(SurvivalModel,{path:"/models/rpg/Tree.glb",scale:2})}),o.type==="rock"&&jsxRuntimeExports.jsx(reactExports.Suspense,{fallback:jsxRuntimeExports.jsxs("mesh",{position:[0,.8,0],castShadow:!0,children:[jsxRuntimeExports.jsx("dodecahedronGeometry",{args:[1.2]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#666666"})]}),children:jsxRuntimeExports.jsx(SurvivalModel,{path:"/models/rpg/Rock.glb",scale:2.5})}),o.type==="bush"&&jsxRuntimeExports.jsxs("mesh",{position:[0,.6,0],castShadow:!0,children:[jsxRuntimeExports.jsx("sphereGeometry",{args:[1,12,12]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#228b22"})]}),o.type==="ore"&&jsxRuntimeExports.jsxs("mesh",{position:[0,.5,0],castShadow:!0,children:[jsxRuntimeExports.jsx("octahedronGeometry",{args:[.8]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#c9a227",metalness:.8,roughness:.2})]}),c&&jsxRuntimeExports.jsx(Html,{position:[0,4,0],center:!0,children:jsxRuntimeExports.jsxs("div",{className:"bg-gradient-to-br from-[#0a0a0a]/95 to-[#1a1a1a]/95 px-3 py-2 rounded-lg border border-[#1a5a5a]/50 text-center backdrop-blur-sm",children:[jsxRuntimeExports.jsx("div",{className:"text-white font-bold text-sm capitalize",children:o.type}),jsxRuntimeExports.jsx("div",{className:"w-24 h-2 bg-gray-800 rounded-full overflow-hidden mt-1",children:jsxRuntimeExports.jsx("div",{className:"h-full bg-gradient-to-r from-[#1a5a5a] to-[#2a8a8a]",style:{width:`${o.health/o.maxHealth*100}%`}})}),jsxRuntimeExports.jsx("div",{className:"text-[#c9a227] text-xs mt-1",children:"Press E to gather"})]})})]})}function PlacedBuildingEntity({building:o}){return jsxRuntimeExports.jsxs("group",{position:o.position,children:[o.type==="campfire"&&jsxRuntimeExports.jsxs(reactExports.Suspense,{fallback:jsxRuntimeExports.jsxs("group",{children:[jsxRuntimeExports.jsxs("mesh",{position:[0,.3,0],children:[jsxRuntimeExports.jsx("cylinderGeometry",{args:[.5,.6,.3,8]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#4a3a2a"})]}),jsxRuntimeExports.jsx("pointLight",{position:[0,1,0],color:"#ff6600",intensity:3,distance:10})]}),children:[jsxRuntimeExports.jsx(SurvivalModel,{path:"/models/rpg/Campfire.glb",scale:2}),jsxRuntimeExports.jsx("pointLight",{position:[0,1.5,0],color:"#ff6600",intensity:5,distance:15})]}),o.type==="shelter"&&jsxRuntimeExports.jsx(reactExports.Suspense,{fallback:jsxRuntimeExports.jsxs("mesh",{position:[0,2,0],castShadow:!0,children:[jsxRuntimeExports.jsx("coneGeometry",{args:[3,4,6]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#8b6914"})]}),children:jsxRuntimeExports.jsx(SurvivalModel,{path:"/models/rpg/Tent.glb",scale:2})}),o.type==="storage"&&jsxRuntimeExports.jsx(reactExports.Suspense,{fallback:jsxRuntimeExports.jsxs("mesh",{position:[0,.5,0],castShadow:!0,children:[jsxRuntimeExports.jsx("boxGeometry",{args:[1.5,1,1]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#8b4513"})]}),children:jsxRuntimeExports.jsx(SurvivalModel,{path:"/models/rpg/Chest.glb",scale:1.5})}),o.type==="workbench"&&jsxRuntimeExports.jsx(reactExports.Suspense,{fallback:jsxRuntimeExports.jsxs("mesh",{position:[0,.5,0],castShadow:!0,children:[jsxRuntimeExports.jsx("boxGeometry",{args:[2,1,1]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#5a4a3a"})]}),children:jsxRuntimeExports.jsx(SurvivalModel,{path:"/models/rpg/Anvil.glb",scale:1.5})})]})}function Player({position:o,onPositionChange:e,stats:s,onStatsChange:a,isGathering:c}){const d=reactExports.useRef(null),[,b]=useKeyboardControls(),_e=reactExports.useRef(0);return useFrame((tt,nt)=>{const it=b(),ot=o.clone(),at=it.sprint&&s.stamina>15,ct=at?SPRINT_SPEED:PLAYER_SPEED,ut=new Vector3;it.forward&&(ut.z=-1),it.back&&(ut.z=1),it.left&&(ut.x=-1),it.right&&(ut.x=1),ut.length()>0&&(ut.normalize(),_e.current=Math.atan2(ut.x,ut.z),ot.add(ut.multiplyScalar(ct*nt)),e(ot),at&&a({stamina:Math.max(0,s.stamina-STAMINA_DRAIN*nt)})),d.current&&(d.current.rotation.y=_e.current)}),jsxRuntimeExports.jsxs("group",{ref:d,position:o,children:[jsxRuntimeExports.jsxs("mesh",{castShadow:!0,position:[0,.6,0],children:[jsxRuntimeExports.jsx("cylinderGeometry",{args:[.35,.4,1.2,16]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#6b5a4a"})]}),jsxRuntimeExports.jsxs("mesh",{castShadow:!0,position:[0,1.4,0],children:[jsxRuntimeExports.jsx("cylinderGeometry",{args:[.3,.35,.6,16]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#c9a227"})]}),jsxRuntimeExports.jsxs("mesh",{castShadow:!0,position:[0,1.9,0],children:[jsxRuntimeExports.jsx("sphereGeometry",{args:[.28,16,16]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#e8c99b"})]}),c&&jsxRuntimeExports.jsx("group",{position:[.5,1,.5],rotation:[0,0,-Math.PI/3],children:jsxRuntimeExports.jsx(reactExports.Suspense,{fallback:null,children:jsxRuntimeExports.jsx(SurvivalModel,{path:"/models/rpg/Axe.glb",scale:.5})})})]})}function FollowCamera({target:o}){const{camera:e}=useThree();return useFrame(()=>{const s=new Vector3(0,12,18);e.position.lerp(o.clone().add(s),.1),e.lookAt(o)}),null}function GameWorld({playerPosition:o,onPlayerPositionChange:e,resources:s,onGatherResource:a,buildings:c,stats:d,onStatsChange:b,isGathering:_e}){return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("ambientLight",{intensity:.5}),jsxRuntimeExports.jsx("directionalLight",{position:[50,100,30],intensity:1.3,castShadow:!0,"shadow-mapSize":[2048,2048]}),jsxRuntimeExports.jsx("hemisphereLight",{intensity:.4,color:"#87ceeb",groundColor:"#3d6b35"}),jsxRuntimeExports.jsx(Sky,{sunPosition:[100,40,50]}),jsxRuntimeExports.jsx("fog",{attach:"fog",args:["#87ceeb",100,300]}),jsxRuntimeExports.jsx(Terrain,{}),s.map(tt=>jsxRuntimeExports.jsx(ResourceNodeEntity,{node:tt,playerPos:o,onGather:a},tt.id)),c.map(tt=>jsxRuntimeExports.jsx(PlacedBuildingEntity,{building:tt},tt.id)),jsxRuntimeExports.jsx(Player,{position:o,onPositionChange:e,stats:d,onStatsChange:b,isGathering:_e}),jsxRuntimeExports.jsx(FollowCamera,{target:o})]})}function SurvivalUI({stats:o,inventory:e,showCrafting:s,onToggleCrafting:a,recipes:c,onCraft:d,dayTime:b}){const _e=b<.25?"Dawn":b<.5?"Day":b<.75?"Dusk":"Night";return jsxRuntimeExports.jsxs("div",{className:"absolute inset-0 pointer-events-none select-none",children:[jsxRuntimeExports.jsxs("div",{className:"absolute top-4 left-4 bg-gradient-to-br from-[#0a0a0a]/90 to-[#1a1a1a]/90 p-4 rounded-xl border border-[#1a5a5a]/50 backdrop-blur-sm space-y-3",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("span",{className:"text-red-500 text-lg",children:""}),jsxRuntimeExports.jsx("div",{className:"w-28 h-3 bg-gray-800 rounded-full overflow-hidden",children:jsxRuntimeExports.jsx("div",{className:"h-full bg-gradient-to-r from-red-700 to-red-500",style:{width:`${o.health}%`}})}),jsxRuntimeExports.jsxs("span",{className:"text-white text-xs",children:[Math.round(o.health),"%"]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("span",{className:"text-yellow-500 text-lg",children:""}),jsxRuntimeExports.jsx("div",{className:"w-28 h-3 bg-gray-800 rounded-full overflow-hidden",children:jsxRuntimeExports.jsx("div",{className:"h-full bg-gradient-to-r from-yellow-700 to-yellow-500",style:{width:`${o.hunger}%`}})}),jsxRuntimeExports.jsxs("span",{className:"text-white text-xs",children:[Math.round(o.hunger),"%"]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("span",{className:"text-blue-400 text-lg",children:""}),jsxRuntimeExports.jsx("div",{className:"w-28 h-3 bg-gray-800 rounded-full overflow-hidden",children:jsxRuntimeExports.jsx("div",{className:"h-full bg-gradient-to-r from-blue-700 to-blue-500",style:{width:`${o.thirst}%`}})}),jsxRuntimeExports.jsxs("span",{className:"text-white text-xs",children:[Math.round(o.thirst),"%"]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("span",{className:"text-green-400 text-lg",children:""}),jsxRuntimeExports.jsx("div",{className:"w-28 h-3 bg-gray-800 rounded-full overflow-hidden",children:jsxRuntimeExports.jsx("div",{className:"h-full bg-gradient-to-r from-green-700 to-green-500",style:{width:`${o.stamina}%`}})}),jsxRuntimeExports.jsxs("span",{className:"text-white text-xs",children:[Math.round(o.stamina),"%"]})]})]}),jsxRuntimeExports.jsx("div",{className:"absolute top-4 right-4 bg-gradient-to-br from-[#0a0a0a]/90 to-[#1a1a1a]/90 px-4 py-2 rounded-xl border border-[#c9a227]/50 backdrop-blur-sm",children:jsxRuntimeExports.jsx("div",{className:"text-[#c9a227] font-bold",children:_e})}),jsxRuntimeExports.jsx("div",{className:"absolute bottom-4 left-4 pointer-events-auto",children:jsxRuntimeExports.jsxs("div",{className:"bg-gradient-to-br from-[#0a0a0a]/90 to-[#1a1a1a]/90 p-3 rounded-xl border border-[#c9a227]/50 backdrop-blur-sm",children:[jsxRuntimeExports.jsx("div",{className:"text-[#c9a227] font-bold text-sm mb-2",children:"INVENTORY"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-6 gap-2",children:[e.map(tt=>jsxRuntimeExports.jsxs("div",{className:"w-12 h-12 bg-gray-800/80 rounded-lg flex flex-col items-center justify-center border border-[#1a5a5a]/50 hover:border-[#c9a227] transition-colors relative",children:[jsxRuntimeExports.jsx("span",{className:"text-xl",children:tt.icon}),tt.amount>1&&jsxRuntimeExports.jsx("span",{className:"absolute bottom-0 right-0 text-xs text-white bg-black/80 px-1 rounded",children:tt.amount})]},tt.id)),Array.from({length:Math.max(0,12-e.length)}).map((tt,nt)=>jsxRuntimeExports.jsx("div",{className:"w-12 h-12 bg-gray-800/40 rounded-lg border border-gray-700/30"},`empty-${nt}`))]})]})}),jsxRuntimeExports.jsx("div",{className:"absolute top-20 right-4 pointer-events-auto",children:jsxRuntimeExports.jsx("button",{onClick:a,className:"bg-gradient-to-r from-[#1a5a5a] to-[#2a7a7a] hover:from-[#2a7a7a] hover:to-[#3a9a9a] text-white px-5 py-2 rounded-lg border border-[#c9a227]/50 font-bold transition-colors",children:" Crafting"})}),s&&jsxRuntimeExports.jsxs("div",{className:"absolute top-36 right-4 bg-gradient-to-br from-[#0a0a0a]/95 to-[#1a1a1a]/95 p-4 rounded-xl border border-[#c9a227]/50 w-72 pointer-events-auto backdrop-blur-sm",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center mb-3",children:[jsxRuntimeExports.jsx("span",{className:"text-[#c9a227] font-bold text-lg",children:"CRAFTING"}),jsxRuntimeExports.jsx("button",{onClick:a,className:"text-white/50 hover:text-white",children:""})]}),jsxRuntimeExports.jsx("div",{className:"space-y-2 max-h-80 overflow-y-auto pr-1",children:c.map(tt=>jsxRuntimeExports.jsxs("div",{className:"bg-gray-800/60 p-3 rounded-lg border border-[#1a5a5a]/30 hover:border-[#c9a227]/50 transition-colors",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("span",{className:"text-2xl",children:tt.icon}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("div",{className:"text-white font-bold",children:tt.name}),jsxRuntimeExports.jsx("div",{className:"text-xs text-gray-400",children:tt.ingredients.map(nt=>`${nt.amount}x ${nt.item}`).join(" + ")})]})]}),jsxRuntimeExports.jsx("button",{onClick:()=>d(tt.id),className:"mt-2 w-full bg-gradient-to-r from-[#c9a227] to-[#d4b02f] hover:from-[#d4b02f] hover:to-[#e5c03f] text-black text-sm px-3 py-1.5 rounded font-bold transition-colors",children:"Craft"})]},tt.id))})]}),jsxRuntimeExports.jsx("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 bg-gradient-to-br from-[#0a0a0a]/80 to-[#1a1a1a]/80 px-6 py-3 rounded-xl border border-[#1a5a5a]/30 backdrop-blur-sm",children:jsxRuntimeExports.jsxs("div",{className:"text-white text-sm flex gap-4",children:[jsxRuntimeExports.jsxs("span",{children:[jsxRuntimeExports.jsx("span",{className:"text-[#c9a227] font-bold",children:"WASD"})," Move"]}),jsxRuntimeExports.jsxs("span",{children:[jsxRuntimeExports.jsx("span",{className:"text-[#c9a227] font-bold",children:"SHIFT"})," Sprint"]}),jsxRuntimeExports.jsxs("span",{children:[jsxRuntimeExports.jsx("span",{className:"text-[#c9a227] font-bold",children:"E"})," Gather"]}),jsxRuntimeExports.jsxs("span",{children:[jsxRuntimeExports.jsx("span",{className:"text-[#c9a227] font-bold",children:"C"})," Craft"]})]})})]})}const keyMap=[{name:"forward",keys:["ArrowUp","KeyW"]},{name:"back",keys:["ArrowDown","KeyS"]},{name:"left",keys:["ArrowLeft","KeyA"]},{name:"right",keys:["ArrowRight","KeyD"]},{name:"sprint",keys:["ShiftLeft","ShiftRight"]},{name:"interact",keys:["KeyE"]},{name:"craft",keys:["KeyC"]},{name:"build",keys:["KeyB"]}],RECIPES=[{id:"campfire",name:"Campfire",icon:"",category:"building",ingredients:[{item:"Wood",amount:5},{item:"Stone",amount:3}],result:{item:"Campfire",amount:1}},{id:"axe",name:"Stone Axe",icon:"",category:"tools",ingredients:[{item:"Wood",amount:3},{item:"Stone",amount:2}],result:{item:"Axe",amount:1}},{id:"shelter",name:"Shelter",icon:"",category:"building",ingredients:[{item:"Wood",amount:15},{item:"Leaves",amount:8}],result:{item:"Shelter",amount:1}},{id:"storage",name:"Storage Box",icon:"",category:"building",ingredients:[{item:"Wood",amount:10}],result:{item:"Storage",amount:1}},{id:"cooked_meat",name:"Cooked Meat",icon:"",category:"food",ingredients:[{item:"Berries",amount:3}],result:{item:"Cooked Meat",amount:1}}],SurvivalMMO=()=>{const[o,e]=reactExports.useState("menu"),[s,a]=reactExports.useState(new Vector3(0,0,0)),[c,d]=reactExports.useState({health:100,hunger:100,thirst:100,stamina:100,temperature:70}),[b,_e]=reactExports.useState([]),[tt,nt]=reactExports.useState([]),[it,ot]=reactExports.useState([]),[at,ct]=reactExports.useState(!1),[ut,ft]=reactExports.useState(.3),[dt,lt]=reactExports.useState(!1),ht=reactExports.useCallback(()=>{const wt=[];for(let Et=0;Et<30;Et++)wt.push({id:`tree-${Et}`,position:new Vector3((Math.random()-.5)*150,0,(Math.random()-.5)*150),type:"tree",health:100,maxHealth:100});for(let Et=0;Et<20;Et++)wt.push({id:`rock-${Et}`,position:new Vector3((Math.random()-.5)*150,0,(Math.random()-.5)*150),type:"rock",health:80,maxHealth:80});for(let Et=0;Et<15;Et++)wt.push({id:`bush-${Et}`,position:new Vector3((Math.random()-.5)*150,0,(Math.random()-.5)*150),type:"bush",health:40,maxHealth:40});for(let Et=0;Et<8;Et++)wt.push({id:`ore-${Et}`,position:new Vector3((Math.random()-.5)*150,0,(Math.random()-.5)*150),type:"ore",health:120,maxHealth:120});_e(wt)},[]);reactExports.useEffect(()=>{if(o==="playing"){const wt=setInterval(()=>{d(Et=>{const _t=Math.max(0,Et.hunger-HUNGER_DECAY*.05),vt=Math.max(0,Et.thirst-THIRST_DECAY*.05),Mt=_t<=0||vt<=0?.2:0,jt=Math.max(0,Et.health-Mt);return jt<=0&&e("dead"),{...Et,hunger:_t,thirst:vt,health:jt,stamina:Math.min(100,Et.stamina+STAMINA_REGEN*.05)}}),ft(Et=>(Et+5e-4)%1)},50);return()=>clearInterval(wt)}},[o]),reactExports.useEffect(()=>{const wt=Et=>{if(Et.code==="KeyC"&&ct(_t=>!_t),Et.code==="KeyE"&&o==="playing"){const _t=b.find(vt=>vt.health>0&&vt.position.distanceTo(s)<GATHER_RANGE);_t&&mt(_t.id)}};return window.addEventListener("keydown",wt),()=>window.removeEventListener("keydown",wt)},[o,b,s]);const mt=reactExports.useCallback(wt=>{lt(!0),setTimeout(()=>lt(!1),300),_e(Et=>Et.map(_t=>{if(_t.id===wt&&_t.health>0){const vt=_t.health-GATHER_DAMAGE,jt={tree:{name:"Wood",icon:""},rock:{name:"Stone",icon:""},bush:{name:"Berries",icon:""},ore:{name:"Gold Ore",icon:""}}[_t.type];return ot(Lt=>Lt.find(kt=>kt.name===jt.name)?Lt.map(kt=>kt.name===jt.name?{...kt,amount:kt.amount+2}:kt):[...Lt,{id:`${jt.name}-${Date.now()}`,name:jt.name,amount:2,icon:jt.icon,type:"material"}]),{..._t,health:Math.max(0,vt)}}return _t}))},[]),xt=reactExports.useCallback(wt=>{const Et=RECIPES.find(vt=>vt.id===wt);if(!Et)return;Et.ingredients.every(vt=>{const Mt=it.find(jt=>jt.name===vt.item);return Mt&&Mt.amount>=vt.amount})&&ot(vt=>{let Mt=vt.map(jt=>{const Lt=Et.ingredients.find(Nt=>Nt.item===jt.name);return Lt?{...jt,amount:jt.amount-Lt.amount}:jt}).filter(jt=>jt.amount>0);if(["Campfire","Shelter","Storage"].includes(Et.result.item)){const jt=Et.result.item.toLowerCase();nt(Lt=>[...Lt,{id:`building-${Date.now()}`,position:s.clone().add(new Vector3(3,0,0)),type:jt}])}else{if(Mt.find(Nt=>Nt.name===Et.result.item))return Mt.map(Nt=>Nt.name===Et.result.item?{...Nt,amount:Nt.amount+Et.result.amount}:Nt);const Lt={Axe:"","Cooked Meat":""};return[...Mt,{id:`${Et.result.item}-${Date.now()}`,name:Et.result.item,amount:Et.result.amount,icon:Lt[Et.result.item]||"",type:"tool"}]}return Mt})},[it,s]),St=reactExports.useCallback(wt=>{d(Et=>({...Et,...wt}))},[]),yt=reactExports.useCallback(()=>{a(new Vector3(0,0,0)),d({health:100,hunger:100,thirst:100,stamina:100,temperature:70}),ot([]),nt([]),ht(),ft(.3),e("playing")},[ht]);return o==="menu"||o==="dead"?jsxRuntimeExports.jsxs("div",{className:"w-full h-full bg-gradient-to-br from-[#1a2e1a] via-[#0a0a0a] to-[#2d3b27] flex flex-col items-center justify-center",children:[jsxRuntimeExports.jsx("h1",{className:"text-7xl font-black text-white mb-2",style:{textShadow:"0 0 40px #c9a227, 0 0 80px #1a5a5a"},children:"SURVIVAL FRONTIER"}),jsxRuntimeExports.jsx("p",{className:"text-2xl text-[#c9a227] mb-2",children:"Gather  Craft  Survive"}),o==="dead"&&jsxRuntimeExports.jsx("p",{className:"text-xl text-red-500 mb-4",children:"You couldn't survive the wilderness..."}),jsxRuntimeExports.jsx("button",{onClick:yt,className:"mt-6 px-12 py-5 bg-gradient-to-r from-[#c9a227] to-[#f0d050] hover:from-[#d4b02f] hover:to-[#ffdd66] text-black text-2xl font-black rounded-xl transition-all transform hover:scale-105 shadow-xl",children:o==="dead"?"TRY AGAIN":"START SURVIVAL"}),jsxRuntimeExports.jsx("div",{className:"mt-10 bg-[#0a0a0a]/60 p-6 rounded-xl border border-[#1a5a5a]/50 backdrop-blur-sm",children:jsxRuntimeExports.jsxs("div",{className:"text-white text-lg grid grid-cols-2 gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("span",{className:"bg-[#1a5a5a] text-white px-3 py-1 rounded font-bold",children:"WASD"}),jsxRuntimeExports.jsx("span",{children:"Move"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("span",{className:"bg-[#1a5a5a] text-white px-3 py-1 rounded font-bold",children:"SHIFT"}),jsxRuntimeExports.jsx("span",{children:"Sprint"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("span",{className:"bg-[#1a5a5a] text-white px-3 py-1 rounded font-bold",children:"E"}),jsxRuntimeExports.jsx("span",{children:"Gather Resources"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("span",{className:"bg-[#1a5a5a] text-white px-3 py-1 rounded font-bold",children:"C"}),jsxRuntimeExports.jsx("span",{children:"Open Crafting"})]})]})})]}):jsxRuntimeExports.jsxs("div",{className:"w-full h-full relative bg-black",children:[jsxRuntimeExports.jsx(KeyboardControls,{map:keyMap,children:jsxRuntimeExports.jsx(Canvas,{shadows:!0,camera:{fov:60,near:.1,far:500},children:jsxRuntimeExports.jsx(GameWorld,{playerPosition:s,onPlayerPositionChange:a,resources:b,onGatherResource:mt,buildings:tt,stats:c,onStatsChange:St,isGathering:dt})})}),jsxRuntimeExports.jsx(SurvivalUI,{stats:c,inventory:it,showCrafting:at,onToggleCrafting:()=>ct(!at),recipes:RECIPES,onCraft:xt,dayTime:ut})]})};function _arrayLikeToArray(o,e){(e==null||e>o.length)&&(e=o.length);for(var s=0,a=Array(e);s<e;s++)a[s]=o[s];return a}function _arrayWithHoles(o){if(Array.isArray(o))return o}function _defineProperty$1(o,e,s){return(e=_toPropertyKey(e))in o?Object.defineProperty(o,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):o[e]=s,o}function _iterableToArrayLimit(o,e){var s=o==null?null:typeof Symbol<"u"&&o[Symbol.iterator]||o["@@iterator"];if(s!=null){var a,c,d,b,_e=[],tt=!0,nt=!1;try{if(d=(s=s.call(o)).next,e!==0)for(;!(tt=(a=d.call(s)).done)&&(_e.push(a.value),_e.length!==e);tt=!0);}catch(it){nt=!0,c=it}finally{try{if(!tt&&s.return!=null&&(b=s.return(),Object(b)!==b))return}finally{if(nt)throw c}}return _e}}function _nonIterableRest(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ownKeys$1(o,e){var s=Object.keys(o);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(o);e&&(a=a.filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable})),s.push.apply(s,a)}return s}function _objectSpread2$1(o){for(var e=1;e<arguments.length;e++){var s=arguments[e]!=null?arguments[e]:{};e%2?ownKeys$1(Object(s),!0).forEach(function(a){_defineProperty$1(o,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(s)):ownKeys$1(Object(s)).forEach(function(a){Object.defineProperty(o,a,Object.getOwnPropertyDescriptor(s,a))})}return o}function _objectWithoutProperties(o,e){if(o==null)return{};var s,a,c=_objectWithoutPropertiesLoose(o,e);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(o);for(a=0;a<d.length;a++)s=d[a],e.indexOf(s)===-1&&{}.propertyIsEnumerable.call(o,s)&&(c[s]=o[s])}return c}function _objectWithoutPropertiesLoose(o,e){if(o==null)return{};var s={};for(var a in o)if({}.hasOwnProperty.call(o,a)){if(e.indexOf(a)!==-1)continue;s[a]=o[a]}return s}function _slicedToArray(o,e){return _arrayWithHoles(o)||_iterableToArrayLimit(o,e)||_unsupportedIterableToArray(o,e)||_nonIterableRest()}function _toPrimitive(o,e){if(typeof o!="object"||!o)return o;var s=o[Symbol.toPrimitive];if(s!==void 0){var a=s.call(o,e);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(o)}function _toPropertyKey(o){var e=_toPrimitive(o,"string");return typeof e=="symbol"?e:e+""}function _unsupportedIterableToArray(o,e){if(o){if(typeof o=="string")return _arrayLikeToArray(o,e);var s={}.toString.call(o).slice(8,-1);return s==="Object"&&o.constructor&&(s=o.constructor.name),s==="Map"||s==="Set"?Array.from(o):s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?_arrayLikeToArray(o,e):void 0}}function _defineProperty(o,e,s){return e in o?Object.defineProperty(o,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):o[e]=s,o}function ownKeys(o,e){var s=Object.keys(o);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(o);e&&(a=a.filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable})),s.push.apply(s,a)}return s}function _objectSpread2(o){for(var e=1;e<arguments.length;e++){var s=arguments[e]!=null?arguments[e]:{};e%2?ownKeys(Object(s),!0).forEach(function(a){_defineProperty(o,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(s)):ownKeys(Object(s)).forEach(function(a){Object.defineProperty(o,a,Object.getOwnPropertyDescriptor(s,a))})}return o}function compose$1(){for(var o=arguments.length,e=new Array(o),s=0;s<o;s++)e[s]=arguments[s];return function(a){return e.reduceRight(function(c,d){return d(c)},a)}}function curry$1(o){return function e(){for(var s=this,a=arguments.length,c=new Array(a),d=0;d<a;d++)c[d]=arguments[d];return c.length>=o.length?o.apply(this,c):function(){for(var b=arguments.length,_e=new Array(b),tt=0;tt<b;tt++)_e[tt]=arguments[tt];return e.apply(s,[].concat(c,_e))}}}function isObject$1(o){return{}.toString.call(o).includes("Object")}function isEmpty(o){return!Object.keys(o).length}function isFunction(o){return typeof o=="function"}function hasOwnProperty(o,e){return Object.prototype.hasOwnProperty.call(o,e)}function validateChanges(o,e){return isObject$1(e)||errorHandler$1("changeType"),Object.keys(e).some(function(s){return!hasOwnProperty(o,s)})&&errorHandler$1("changeField"),e}function validateSelector(o){isFunction(o)||errorHandler$1("selectorType")}function validateHandler(o){isFunction(o)||isObject$1(o)||errorHandler$1("handlerType"),isObject$1(o)&&Object.values(o).some(function(e){return!isFunction(e)})&&errorHandler$1("handlersType")}function validateInitial(o){o||errorHandler$1("initialIsRequired"),isObject$1(o)||errorHandler$1("initialType"),isEmpty(o)&&errorHandler$1("initialContent")}function throwError$1(o,e){throw new Error(o[e]||o.default)}var errorMessages$1={initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"},errorHandler$1=curry$1(throwError$1)(errorMessages$1),validators$1={changes:validateChanges,selector:validateSelector,handler:validateHandler,initial:validateInitial};function create(o){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};validators$1.initial(o),validators$1.handler(e);var s={current:o},a=curry$1(didStateUpdate)(s,e),c=curry$1(updateState)(s),d=curry$1(validators$1.changes)(o),b=curry$1(extractChanges)(s);function _e(){var nt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(it){return it};return validators$1.selector(nt),nt(s.current)}function tt(nt){compose$1(a,c,d,b)(nt)}return[_e,tt]}function extractChanges(o,e){return isFunction(e)?e(o.current):e}function updateState(o,e){return o.current=_objectSpread2(_objectSpread2({},o.current),e),e}function didStateUpdate(o,e,s){return isFunction(e)?e(o.current):Object.keys(s).forEach(function(a){var c;return(c=e[a])===null||c===void 0?void 0:c.call(e,o.current[a])}),s}var index={create},config$1={paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.55.1/min/vs"}};function curry(o){return function e(){for(var s=this,a=arguments.length,c=new Array(a),d=0;d<a;d++)c[d]=arguments[d];return c.length>=o.length?o.apply(this,c):function(){for(var b=arguments.length,_e=new Array(b),tt=0;tt<b;tt++)_e[tt]=arguments[tt];return e.apply(s,[].concat(c,_e))}}}function isObject(o){return{}.toString.call(o).includes("Object")}function validateConfig(o){return o||errorHandler("configIsRequired"),isObject(o)||errorHandler("configType"),o.urls?(informAboutDeprecation(),{paths:{vs:o.urls.monacoBase}}):o}function informAboutDeprecation(){console.warn(errorMessages.deprecation)}function throwError(o,e){throw new Error(o[e]||o.default)}var errorMessages={configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:`Deprecation warning!
    You are using deprecated way of configuration.

    Instead of using
      monaco.config({ urls: { monacoBase: '...' } })
    use
      monaco.config({ paths: { vs: '...' } })

    For more please check the link https://github.com/suren-atoyan/monaco-loader#config
  `},errorHandler=curry(throwError)(errorMessages),validators={config:validateConfig},compose=function(){for(var e=arguments.length,s=new Array(e),a=0;a<e;a++)s[a]=arguments[a];return function(c){return s.reduceRight(function(d,b){return b(d)},c)}};function merge(o,e){return Object.keys(e).forEach(function(s){e[s]instanceof Object&&o[s]&&Object.assign(e[s],merge(o[s],e[s]))}),_objectSpread2$1(_objectSpread2$1({},o),e)}var CANCELATION_MESSAGE={type:"cancelation",msg:"operation is manually canceled"};function makeCancelable(o){var e=!1,s=new Promise(function(a,c){o.then(function(d){return e?c(CANCELATION_MESSAGE):a(d)}),o.catch(c)});return s.cancel=function(){return e=!0},s}var _excluded=["monaco"],_state$create=index.create({config:config$1,isInitialized:!1,resolve:null,reject:null,monaco:null}),_state$create2=_slicedToArray(_state$create,2),getState=_state$create2[0],setState=_state$create2[1];function config(o){var e=validators.config(o),s=e.monaco,a=_objectWithoutProperties(e,_excluded);setState(function(c){return{config:merge(c.config,a),monaco:s}})}function init(){var o=getState(function(e){var s=e.monaco,a=e.isInitialized,c=e.resolve;return{monaco:s,isInitialized:a,resolve:c}});if(!o.isInitialized){if(setState({isInitialized:!0}),o.monaco)return o.resolve(o.monaco),makeCancelable(wrapperPromise);if(window.monaco&&window.monaco.editor)return storeMonacoInstance(window.monaco),o.resolve(window.monaco),makeCancelable(wrapperPromise);compose(injectScripts,getMonacoLoaderScript)(configureLoader)}return makeCancelable(wrapperPromise)}function injectScripts(o){return document.body.appendChild(o)}function createScript(o){var e=document.createElement("script");return o&&(e.src=o),e}function getMonacoLoaderScript(o){var e=getState(function(a){var c=a.config,d=a.reject;return{config:c,reject:d}}),s=createScript("".concat(e.config.paths.vs,"/loader.js"));return s.onload=function(){return o()},s.onerror=e.reject,s}function configureLoader(){var o=getState(function(s){var a=s.config,c=s.resolve,d=s.reject;return{config:a,resolve:c,reject:d}}),e=window.require;e.config(o.config),e(["vs/editor/editor.main"],function(s){var a=s.m||s;storeMonacoInstance(a),o.resolve(a)},function(s){o.reject(s)})}function storeMonacoInstance(o){getState().monaco||setState({monaco:o})}function __getMonacoInstance(){return getState(function(o){var e=o.monaco;return e})}var wrapperPromise=new Promise(function(o,e){return setState({resolve:o,reject:e})}),loader={config,init,__getMonacoInstance},le={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}},v=le,ae={container:{display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"}},Y=ae;function Me({children:o}){return React.createElement("div",{style:Y.container},o)}var Z=Me,$=Z;function Ee({width:o,height:e,isEditorReady:s,loading:a,_ref:c,className:d,wrapperProps:b}){return React.createElement("section",{style:{...v.wrapper,width:o,height:e},...b},!s&&React.createElement($,null,a),React.createElement("div",{ref:c,style:{...v.fullWidth,...!s&&v.hide},className:d}))}var ee=Ee,H=reactExports.memo(ee);function Ce(o){reactExports.useEffect(o,[])}var k=Ce;function he(o,e,s=!0){let a=reactExports.useRef(!0);reactExports.useEffect(a.current||!s?()=>{a.current=!1}:o,e)}var l=he;function D(){}function h(o,e,s,a){return De(o,a)||be(o,e,s,a)}function De(o,e){return o.editor.getModel(te(o,e))}function be(o,e,s,a){return o.editor.createModel(e,s,a?te(o,a):void 0)}function te(o,e){return o.Uri.parse(e)}function Oe({original:o,modified:e,language:s,originalLanguage:a,modifiedLanguage:c,originalModelPath:d,modifiedModelPath:b,keepCurrentOriginalModel:_e=!1,keepCurrentModifiedModel:tt=!1,theme:nt="light",loading:it="Loading...",options:ot={},height:at="100%",width:ct="100%",className:ut,wrapperProps:ft={},beforeMount:dt=D,onMount:lt=D}){let[ht,mt]=reactExports.useState(!1),[xt,St]=reactExports.useState(!0),yt=reactExports.useRef(null),wt=reactExports.useRef(null),Et=reactExports.useRef(null),_t=reactExports.useRef(lt),vt=reactExports.useRef(dt),Mt=reactExports.useRef(!1);k(()=>{let kt=loader.init();return kt.then(Ot=>(wt.current=Ot)&&St(!1)).catch(Ot=>(Ot==null?void 0:Ot.type)!=="cancelation"&&console.error("Monaco initialization: error:",Ot)),()=>yt.current?Nt():kt.cancel()}),l(()=>{if(yt.current&&wt.current){let kt=yt.current.getOriginalEditor(),Ot=h(wt.current,o||"",a||s||"text",d||"");Ot!==kt.getModel()&&kt.setModel(Ot)}},[d],ht),l(()=>{if(yt.current&&wt.current){let kt=yt.current.getModifiedEditor(),Ot=h(wt.current,e||"",c||s||"text",b||"");Ot!==kt.getModel()&&kt.setModel(Ot)}},[b],ht),l(()=>{let kt=yt.current.getModifiedEditor();kt.getOption(wt.current.editor.EditorOption.readOnly)?kt.setValue(e||""):e!==kt.getValue()&&(kt.executeEdits("",[{range:kt.getModel().getFullModelRange(),text:e||"",forceMoveMarkers:!0}]),kt.pushUndoStop())},[e],ht),l(()=>{var kt,Ot;(Ot=(kt=yt.current)==null?void 0:kt.getModel())==null||Ot.original.setValue(o||"")},[o],ht),l(()=>{let{original:kt,modified:Ot}=yt.current.getModel();wt.current.editor.setModelLanguage(kt,a||s||"text"),wt.current.editor.setModelLanguage(Ot,c||s||"text")},[s,a,c],ht),l(()=>{var kt;(kt=wt.current)==null||kt.editor.setTheme(nt)},[nt],ht),l(()=>{var kt;(kt=yt.current)==null||kt.updateOptions(ot)},[ot],ht);let jt=reactExports.useCallback(()=>{var Ht;if(!wt.current)return;vt.current(wt.current);let kt=h(wt.current,o||"",a||s||"text",d||""),Ot=h(wt.current,e||"",c||s||"text",b||"");(Ht=yt.current)==null||Ht.setModel({original:kt,modified:Ot})},[s,e,c,o,a,d,b]),Lt=reactExports.useCallback(()=>{var kt;!Mt.current&&Et.current&&(yt.current=wt.current.editor.createDiffEditor(Et.current,{automaticLayout:!0,...ot}),jt(),(kt=wt.current)==null||kt.editor.setTheme(nt),mt(!0),Mt.current=!0)},[ot,nt,jt]);reactExports.useEffect(()=>{ht&&_t.current(yt.current,wt.current)},[ht]),reactExports.useEffect(()=>{!xt&&!ht&&Lt()},[xt,ht,Lt]);function Nt(){var Ot,Ht,Ct,Ut;let kt=(Ot=yt.current)==null?void 0:Ot.getModel();_e||((Ht=kt==null?void 0:kt.original)==null||Ht.dispose()),tt||((Ct=kt==null?void 0:kt.modified)==null||Ct.dispose()),(Ut=yt.current)==null||Ut.dispose()}return React.createElement(H,{width:ct,height:at,isEditorReady:ht,loading:it,_ref:Et,className:ut,wrapperProps:ft})}var ie=Oe;reactExports.memo(ie);function He(o){let e=reactExports.useRef();return reactExports.useEffect(()=>{e.current=o},[o]),e.current}var se=He,_=new Map;function Ve({defaultValue:o,defaultLanguage:e,defaultPath:s,value:a,language:c,path:d,theme:b="light",line:_e,loading:tt="Loading...",options:nt={},overrideServices:it={},saveViewState:ot=!0,keepCurrentModel:at=!1,width:ct="100%",height:ut="100%",className:ft,wrapperProps:dt={},beforeMount:lt=D,onMount:ht=D,onChange:mt,onValidate:xt=D}){let[St,yt]=reactExports.useState(!1),[wt,Et]=reactExports.useState(!0),_t=reactExports.useRef(null),vt=reactExports.useRef(null),Mt=reactExports.useRef(null),jt=reactExports.useRef(ht),Lt=reactExports.useRef(lt),Nt=reactExports.useRef(),kt=reactExports.useRef(a),Ot=se(d),Ht=reactExports.useRef(!1),Ct=reactExports.useRef(!1);k(()=>{let Pt=loader.init();return Pt.then(Wt=>(_t.current=Wt)&&Et(!1)).catch(Wt=>(Wt==null?void 0:Wt.type)!=="cancelation"&&console.error("Monaco initialization: error:",Wt)),()=>vt.current?Gt():Pt.cancel()}),l(()=>{var Wt,sn,Bt,tn;let Pt=h(_t.current,o||a||"",e||c||"",d||s||"");Pt!==((Wt=vt.current)==null?void 0:Wt.getModel())&&(ot&&_.set(Ot,(sn=vt.current)==null?void 0:sn.saveViewState()),(Bt=vt.current)==null||Bt.setModel(Pt),ot&&((tn=vt.current)==null||tn.restoreViewState(_.get(d))))},[d],St),l(()=>{var Pt;(Pt=vt.current)==null||Pt.updateOptions(nt)},[nt],St),l(()=>{!vt.current||a===void 0||(vt.current.getOption(_t.current.editor.EditorOption.readOnly)?vt.current.setValue(a):a!==vt.current.getValue()&&(Ct.current=!0,vt.current.executeEdits("",[{range:vt.current.getModel().getFullModelRange(),text:a,forceMoveMarkers:!0}]),vt.current.pushUndoStop(),Ct.current=!1))},[a],St),l(()=>{var Wt,sn;let Pt=(Wt=vt.current)==null?void 0:Wt.getModel();Pt&&c&&((sn=_t.current)==null||sn.editor.setModelLanguage(Pt,c))},[c],St),l(()=>{var Pt;_e!==void 0&&((Pt=vt.current)==null||Pt.revealLine(_e))},[_e],St),l(()=>{var Pt;(Pt=_t.current)==null||Pt.editor.setTheme(b)},[b],St);let Ut=reactExports.useCallback(()=>{var Pt;if(!(!Mt.current||!_t.current)&&!Ht.current){Lt.current(_t.current);let Wt=d||s,sn=h(_t.current,a||o||"",e||c||"",Wt||"");vt.current=(Pt=_t.current)==null?void 0:Pt.editor.create(Mt.current,{model:sn,automaticLayout:!0,...nt},it),ot&&vt.current.restoreViewState(_.get(Wt)),_t.current.editor.setTheme(b),_e!==void 0&&vt.current.revealLine(_e),yt(!0),Ht.current=!0}},[o,e,s,a,c,d,nt,it,ot,b,_e]);reactExports.useEffect(()=>{St&&jt.current(vt.current,_t.current)},[St]),reactExports.useEffect(()=>{!wt&&!St&&Ut()},[wt,St,Ut]),kt.current=a,reactExports.useEffect(()=>{var Pt,Wt;St&&mt&&((Pt=Nt.current)==null||Pt.dispose(),Nt.current=(Wt=vt.current)==null?void 0:Wt.onDidChangeModelContent(sn=>{Ct.current||mt(vt.current.getValue(),sn)}))},[St,mt]),reactExports.useEffect(()=>{if(St){let Pt=_t.current.editor.onDidChangeMarkers(Wt=>{var Bt;let sn=(Bt=vt.current.getModel())==null?void 0:Bt.uri;if(sn&&Wt.find(tn=>tn.path===sn.path)){let tn=_t.current.editor.getModelMarkers({resource:sn});xt==null||xt(tn)}});return()=>{Pt==null||Pt.dispose()}}return()=>{}},[St,xt]);function Gt(){var Pt,Wt;(Pt=Nt.current)==null||Pt.dispose(),at?ot&&_.set(d,vt.current.saveViewState()):(Wt=vt.current.getModel())==null||Wt.dispose(),vt.current.dispose()}return React.createElement(H,{width:ct,height:ut,isEditorReady:St,loading:tt,_ref:Mt,className:ft,wrapperProps:dt})}var fe=Ve,de=reactExports.memo(fe),Ft=de;const puter$1=typeof window<"u"?window.puter:null;async function puterAIChat(o,e){if(!puter$1)throw new Error("Puter not available");const s=await puter$1.ai.chat(o,e);if(typeof s=="string")return s;let a="";for await(const c of s)a+=c.text||"";return a}async function puterSaveFile(o,e){if(!puter$1)throw new Error("Puter not available");await puter$1.fs.write(o,e)}const LEGION_PRO_URL="https://grudachain-ve8e8.puter.site";class LegionProAPI{constructor(){this.connected=!1,this.lastPing=0}async connect(){try{const e=await fetch(`${LEGION_PRO_URL}/api/health`,{method:"GET",mode:"cors"}).catch(()=>null);return e!=null&&e.ok?(this.connected=!0,this.lastPing=Date.now(),console.log("[LegionPro] Connected to backend"),!0):(console.log("[LegionPro] Using Puter.js AI fallback"),this.connected=!1,!1)}catch{return console.log("[LegionPro] Using Puter.js AI fallback"),this.connected=!1,!1}}async generateCode(e){const s=`Generate ${e.language} code for: ${e.prompt}

Return only the code, no explanations. Use best practices and add helpful comments.`;try{return typeof puter<"u"&&(puter!=null&&puter.ai)?{success:!0,data:{code:await puter.ai.chat(s),language:e.language}}:{success:!1,error:"AI service unavailable"}}catch(a){return{success:!1,error:String(a)}}}async analyzeCode(e){const s={analyze:`Analyze this code and provide a summary of what it does, its structure, and any notable patterns:

${e.code}`,findBugs:`Find potential bugs, issues, and vulnerabilities in this code. List each issue with line context and suggested fix:

${e.code}`,optimize:`Suggest performance optimizations for this code. Show the optimized version:

${e.code}`,addDocs:`Add comprehensive documentation comments to this code. Return the fully documented code:

${e.code}`};try{return typeof puter<"u"&&(puter!=null&&puter.ai)?{success:!0,data:{result:await puter.ai.chat(s[e.action]),action:e.action}}:{success:!1,error:"AI service unavailable"}}catch(a){return{success:!1,error:String(a)}}}async debugCode(e){const s=`Debug this code and fix any issues:

CODE:
${e.code}

${e.error?`ERROR MESSAGE:
${e.error}
`:""}
${e.context?`CONTEXT:
${e.context}
`:""}

Provide:
1. Root cause analysis
2. Step-by-step fix
3. Corrected code
4. Prevention tips`;try{return typeof puter<"u"&&(puter!=null&&puter.ai)?{success:!0,data:{analysis:await puter.ai.chat(s)}}:{success:!1,error:"AI service unavailable"}}catch(a){return{success:!1,error:String(a)}}}async chat(e){try{return typeof puter<"u"&&(puter!=null&&puter.ai)?{success:!0,data:{response:await puter.ai.chat(e)}}:{success:!1,error:"AI service unavailable"}}catch(s){return{success:!1,error:String(s)}}}isConnected(){return this.connected}getBackendUrl(){return LEGION_PRO_URL}}const legionPro=new LegionProAPI,LANGUAGE_MAP={js:"javascript",jsx:"javascript",ts:"typescript",tsx:"typescript",py:"python",html:"html",css:"css",scss:"scss",json:"json",md:"markdown",xml:"xml",yaml:"yaml",yml:"yaml",sh:"shell",bash:"shell",sql:"sql",go:"go",rs:"rust",cpp:"cpp",c:"c",java:"java",php:"php",rb:"ruby",swift:"swift",kt:"kotlin"},FILE_ICONS={javascript:"",typescript:"",python:"",html:"",css:"",json:"",markdown:"",default:"",folder:"",folderOpen:""},GrudaVisualCode$1=()=>{const[tabs,setTabs]=reactExports.useState([{id:"1",name:"index.tsx",path:"/src/index.tsx",content:`import React from 'react';
import ReactDOM from 'react-dom/client';
import App from './App';

const root = ReactDOM.createRoot(document.getElementById('root')!);
root.render(<App />);
`,language:"typescript",modified:!1},{id:"2",name:"App.tsx",path:"/src/App.tsx",content:`import React, { useState } from 'react';

function App() {
  const [count, setCount] = useState(0);
  
  return (
    <div className="app">
      <h1>Hello GRUDA!</h1>
      <button onClick={() => setCount(c => c + 1)}>
        Count: {count}
      </button>
    </div>
  );
}

export default App;
`,language:"typescript",modified:!1}]),[activeTab,setActiveTab]=reactExports.useState("1"),[activePanel,setActivePanel]=reactExports.useState("explorer"),[bottomPanel,setBottomPanel]=reactExports.useState("terminal"),[rightPanel,setRightPanel]=reactExports.useState("ai"),[sidebarWidth,setSidebarWidth]=reactExports.useState(250),[bottomPanelHeight,setBottomPanelHeight]=reactExports.useState(250),[rightPanelWidth,setRightPanelWidth]=reactExports.useState(380),[showSidebar,setShowSidebar]=reactExports.useState(!0),[showMinimap,setShowMinimap]=reactExports.useState(!0),[showCommandPalette,setShowCommandPalette]=reactExports.useState(!1),[commandSearch,setCommandSearch]=reactExports.useState(""),[cursorPosition,setCursorPosition]=reactExports.useState({line:1,col:1}),[selection,setSelection]=reactExports.useState({lines:0,chars:0}),[fileTree,setFileTree]=reactExports.useState([{name:"src",path:"/src",type:"folder",expanded:!0,children:[{name:"components",path:"/src/components",type:"folder",expanded:!1,children:[{name:"Header.tsx",path:"/src/components/Header.tsx",type:"file"},{name:"Footer.tsx",path:"/src/components/Footer.tsx",type:"file"},{name:"Button.tsx",path:"/src/components/Button.tsx",type:"file"}]},{name:"hooks",path:"/src/hooks",type:"folder",expanded:!1,children:[{name:"useAuth.ts",path:"/src/hooks/useAuth.ts",type:"file"},{name:"useApi.ts",path:"/src/hooks/useApi.ts",type:"file"}]},{name:"lib",path:"/src/lib",type:"folder",children:[{name:"utils.ts",path:"/src/lib/utils.ts",type:"file"},{name:"api.ts",path:"/src/lib/api.ts",type:"file"}]},{name:"App.tsx",path:"/src/App.tsx",type:"file"},{name:"index.tsx",path:"/src/index.tsx",type:"file"},{name:"styles.css",path:"/src/styles.css",type:"file"}]},{name:"public",path:"/public",type:"folder",children:[{name:"index.html",path:"/public/index.html",type:"file"},{name:"favicon.ico",path:"/public/favicon.ico",type:"file"}]},{name:"package.json",path:"/package.json",type:"file"},{name:"tsconfig.json",path:"/tsconfig.json",type:"file"},{name:"vite.config.ts",path:"/vite.config.ts",type:"file"},{name:".env",path:"/.env",type:"file"}]),[aiMessages,setAIMessages]=reactExports.useState([{role:"assistant",content:`Welcome to GRUDA AI Assistant!

I can help you with:
 Writing and generating code
 Explaining complex code
 Debugging and fixing errors
 Refactoring suggestions
 Writing tests and documentation
 Code review and optimization

Select code in the editor or ask me anything!`,timestamp:new Date}]),[aiInput,setAIInput]=reactExports.useState(""),[aiLoading,setAILoading]=reactExports.useState(!1),[aiMode,setAIMode]=reactExports.useState("chat"),[terminalLines,setTerminalLines]=reactExports.useState([{id:"1",type:"system",content:"",timestamp:new Date},{id:"2",type:"system",content:"           GRUDA VISUAL CODE Terminal v2.0            ",timestamp:new Date},{id:"3",type:"system",content:"     AI-Powered Development Environment Ready         ",timestamp:new Date},{id:"4",type:"system",content:"",timestamp:new Date},{id:"5",type:"output",content:"",timestamp:new Date}]),[terminalInput,setTerminalInput]=reactExports.useState(""),[terminalHistory,setTerminalHistory]=reactExports.useState([]),[historyIndex,setHistoryIndex]=reactExports.useState(-1),[outputLogs,setOutputLogs]=reactExports.useState(["[GRUDA] IDE initialized successfully","[GRUDA] Language server starting...","[GRUDA] TypeScript language server ready","[GRUDA] ESLint ready","[GRUDA] Prettier ready"]),[ports,setPorts]=reactExports.useState([{port:3e3,name:"React Dev Server",url:"http://localhost:3000",status:"open"},{port:5e3,name:"Vite Dev Server",url:"http://localhost:5000",status:"open"},{port:8080,name:"API Server",url:"http://localhost:8080",status:"closed"}]);reactExports.useState([{id:"dev",name:"npm run dev",port:5e3,status:"running",startTime:new Date,logs:[]}]);const[previewUrl,setPreviewUrl]=reactExports.useState("https://example.com"),[previewLoading,setPreviewLoading]=reactExports.useState(!1),[problems,setProblems]=reactExports.useState([{type:"warning",message:"'count' is declared but never used",file:"/src/App.tsx",line:4}]),[gitStatus,setGitStatus]=reactExports.useState({branch:"main",changes:2,staged:0,ahead:0,behind:0}),[searchQuery,setSearchQuery]=reactExports.useState(""),[searchResults,setSearchResults]=reactExports.useState([]),[replaceQuery,setReplaceQuery]=reactExports.useState(""),editorRef=reactExports.useRef(null),aiChatRef=reactExports.useRef(null),terminalRef=reactExports.useRef(null),terminalInputRef=reactExports.useRef(null),commandInputRef=reactExports.useRef(null),activeFile=tabs.find(o=>o.id===activeTab),getLanguage=o=>{var s;const e=((s=o.split(".").pop())==null?void 0:s.toLowerCase())||"";return LANGUAGE_MAP[e]||"plaintext"},getFileIcon=(o,e=!1,s=!1)=>{if(e)return s?FILE_ICONS.folderOpen:FILE_ICONS.folder;const a=getLanguage(o);return FILE_ICONS[a]||FILE_ICONS.default},handleEditorMount=(o,e)=>{editorRef.current=o,e.editor.defineTheme("gruda-dark",{base:"vs-dark",inherit:!0,rules:[{token:"comment",foreground:"6A9955",fontStyle:"italic"},{token:"keyword",foreground:"C586C0"},{token:"string",foreground:"CE9178"},{token:"number",foreground:"B5CEA8"},{token:"type",foreground:"4EC9B0"},{token:"function",foreground:"DCDCAA"},{token:"variable",foreground:"9CDCFE"}],colors:{"editor.background":"#1e1e1e","editor.foreground":"#d4d4d4","editorCursor.foreground":"#c9a227","editor.lineHighlightBackground":"#2a2a2a","editor.selectionBackground":"#264f78","editorLineNumber.foreground":"#858585","editorLineNumber.activeForeground":"#c9a227"}}),e.editor.setTheme("gruda-dark"),o.onDidChangeCursorPosition(s=>{setCursorPosition({line:s.position.lineNumber,col:s.position.column})}),o.onDidChangeCursorSelection(s=>{const a=s.selection;if(a.isEmpty())setSelection({lines:0,chars:0});else{const c=o.getModel();if(c){const d=c.getValueInRange(a);setSelection({lines:a.endLineNumber-a.startLineNumber+1,chars:d.length})}}}),o.addCommand(e.KeyMod.CtrlCmd|e.KeyCode.KeyS,()=>handleSave()),o.addCommand(e.KeyMod.CtrlCmd|e.KeyMod.Shift|e.KeyCode.KeyP,()=>setShowCommandPalette(!0))},handleEditorChange=o=>{o!==void 0&&setTabs(e=>e.map(s=>s.id===activeTab?{...s,content:o,modified:!0}:s))},handleSave=async()=>{const o=tabs.find(e=>e.id===activeTab);if(o)try{await puterSaveFile(o.path,o.content),setTabs(e=>e.map(s=>s.id===activeTab?{...s,modified:!1}:s)),addOutput(`[GRUDA] Saved: ${o.name}`)}catch{addOutput(`[GRUDA] Error saving: ${o.name}`)}},handleSaveAll=async()=>{for(const o of tabs.filter(e=>e.modified))try{await puterSaveFile(o.path,o.content)}catch{addOutput(`[GRUDA] Error saving: ${o.name}`)}setTabs(o=>o.map(e=>({...e,modified:!1}))),addOutput("[GRUDA] All files saved")},handleNewFile=()=>{const o=Date.now().toString(),e={id:o,name:"untitled.ts",path:`/untitled-${o}.ts`,content:`// New file
`,language:"typescript",modified:!0};setTabs(s=>[...s,e]),setActiveTab(o)},handleOpenFile=o=>{if(o.type==="folder")return;const e=tabs.find(b=>b.path===o.path);if(e){setActiveTab(e.id);return}const s=Date.now().toString(),a=getLanguage(o.name),c=generateFileContent(o.path),d={id:s,name:o.name,path:o.path,content:c,language:a,modified:!1};setTabs(b=>[...b,d]),setActiveTab(s)},generateFileContent=(o,e)=>o.includes("Header")?`import React from 'react';

interface HeaderProps {
  title: string;
  onMenuClick?: () => void;
}

export const Header: React.FC<HeaderProps> = ({ title, onMenuClick }) => {
  return (
    <header className="bg-[#1a5a5a] text-white p-4">
      <div className="flex items-center justify-between">
        <h1 className="text-xl font-bold">{title}</h1>
        <button onClick={onMenuClick} className="p-2">
          Menu
        </button>
      </div>
    </header>
  );
};
`:o.includes("Button")?`import React from 'react';

interface ButtonProps {
  children: React.ReactNode;
  variant?: 'primary' | 'secondary' | 'danger';
  onClick?: () => void;
  disabled?: boolean;
}

export const Button: React.FC<ButtonProps> = ({ 
  children, 
  variant = 'primary', 
  onClick,
  disabled = false
}) => {
  const baseClasses = 'px-4 py-2 rounded font-medium transition-colors';
  const variantClasses = {
    primary: 'bg-[#c9a227] text-black hover:bg-[#d9b237]',
    secondary: 'bg-[#1a5a5a] text-white hover:bg-[#2a6a6a]',
    danger: 'bg-red-500 text-white hover:bg-red-600',
  };

  return (
    <button
      onClick={onClick}
      disabled={disabled}
      className={\`\${baseClasses} \${variantClasses[variant]} \${disabled ? 'opacity-50 cursor-not-allowed' : ''}\`}
    >
      {children}
    </button>
  );
};
`:o.includes("utils")?`export const formatDate = (date: Date): string => {
  return new Intl.DateTimeFormat('en-US', {
    year: 'numeric',
    month: 'long',
    day: 'numeric',
  }).format(date);
};

export const debounce = <T extends (...args: any[]) => any>(
  fn: T,
  delay: number
): ((...args: Parameters<T>) => void) => {
  let timeoutId: ReturnType<typeof setTimeout>;
  return (...args: Parameters<T>) => {
    clearTimeout(timeoutId);
    timeoutId = setTimeout(() => fn(...args), delay);
  };
};

export const classNames = (...classes: (string | undefined | null | false)[]): string => {
  return classes.filter(Boolean).join(' ');
};
`:o.includes("package.json")?`{
  "name": "gruda-app",
  "version": "1.0.0",
  "private": true,
  "scripts": {
    "dev": "vite",
    "build": "tsc && vite build",
    "preview": "vite preview",
    "lint": "eslint . --ext .ts,.tsx",
    "test": "vitest"
  },
  "dependencies": {
    "react": "^18.2.0",
    "react-dom": "^18.2.0"
  },
  "devDependencies": {
    "@types/react": "^18.2.0",
    "@types/react-dom": "^18.2.0",
    "typescript": "^5.0.0",
    "vite": "^5.0.0"
  }
}
`:`// ${o}
// File content would be loaded from the filesystem
`,handleCloseTab=o=>{var s;const e=tabs.findIndex(a=>a.id===o);if(setTabs(a=>a.filter(c=>c.id!==o)),activeTab===o&&tabs.length>1){const a=Math.max(0,e-1);setActiveTab(((s=tabs[a===e?a+1:a])==null?void 0:s.id)||"")}},toggleFolder=o=>{const e=s=>s.map(a=>a.path===o?{...a,expanded:!a.expanded}:a.children?{...a,children:e(a.children)}:a);setFileTree(e(fileTree))},addOutput=o=>{setOutputLogs(e=>[...e,`[${new Date().toLocaleTimeString()}] ${o}`])},addTerminalLine=(o,e)=>{setTerminalLines(s=>[...s,{id:Date.now().toString(),type:o,content:e,timestamp:new Date}]),setTimeout(()=>{var s;(s=terminalRef.current)==null||s.scrollTo(0,terminalRef.current.scrollHeight)},10)},executeTerminalCommand=cmd=>{if(!cmd.trim())return;addTerminalLine("input",`$ ${cmd}`),setTerminalHistory(o=>[...o,cmd]),setHistoryIndex(-1),setTerminalInput("");const parts=cmd.trim().split(" "),command=parts[0].toLowerCase(),args=parts.slice(1);switch(command){case"help":addTerminalLine("output",`
Available Commands:
  help          - Show this help message
  clear         - Clear terminal
  ls            - List files in current directory
  pwd           - Print working directory
  cd <dir>      - Change directory
  cat <file>    - Display file contents
  npm           - Node package manager
  node          - Run JavaScript
  git           - Git version control
  python        - Run Python scripts
  echo          - Print text
  env           - Show environment variables
  ports         - Show open ports
  run <cmd>     - Run a script
  ai <query>    - Ask AI assistant
`);break;case"clear":setTerminalLines([]);break;case"ls":const files=fileTree.map(o=>o.name).join("  ");addTerminalLine("output",files);break;case"pwd":addTerminalLine("output","/home/gruda/workspace");break;case"cd":addTerminalLine("output",`Changed directory to ${args[0]||"~"}`);break;case"cat":if(args[0]){const o=tabs.find(e=>e.name===args[0]||e.path.endsWith(args[0]));o?addTerminalLine("output",o.content):addTerminalLine("error",`cat: ${args[0]}: No such file`)}else addTerminalLine("error","cat: missing operand");break;case"npm":args[0]==="run"&&args[1]?(addTerminalLine("output",`> gruda-app@1.0.0 ${args[1]}`),addTerminalLine("output",`> Starting ${args[1]}...`),setTimeout(()=>{addTerminalLine("output"," Development server running on http://localhost:5000"),setPreviewUrl("http://localhost:5000")},500)):args[0]==="install"||args[0]==="i"?(addTerminalLine("output"," Installing dependencies..."),setTimeout(()=>{addTerminalLine("output"," Installed packages successfully")},1e3)):args[0]==="start"?(addTerminalLine("output","> Starting application..."),setTimeout(()=>{addTerminalLine("output"," Server running on http://localhost:3000")},500)):addTerminalLine("output","npm usage: npm <command> [args]");break;case"git":args[0]==="status"?addTerminalLine("output",`On branch ${gitStatus.branch}
Changes not staged for commit:
  modified: src/App.tsx`):args[0]==="branch"?addTerminalLine("output",`* ${gitStatus.branch}
  develop
  feature/ai`):args[0]==="log"?addTerminalLine("output",`commit abc123 (HEAD -> ${gitStatus.branch})
Author: Developer <dev@gruda.io>
Date: Today

    Initial commit`):addTerminalLine("output","git usage: git <command>");break;case"node":if(args.length>0)try{const code=args.join(" ").replace(/^['"]|['"]$/g,""),result=eval(code);addTerminalLine("output",String(result))}catch(o){addTerminalLine("error",o.message)}else addTerminalLine("output","Node.js v20.0.0 - Enter JavaScript to evaluate");break;case"echo":addTerminalLine("output",args.join(" "));break;case"env":addTerminalLine("output",`NODE_ENV=development
PORT=5000
API_URL=http://localhost:8080`);break;case"ports":const portList=ports.map(o=>`${o.port} - ${o.name} [${o.status}]`).join(`
`);addTerminalLine("output",`Open Ports:
${portList}`);break;case"run":addTerminalLine("output",`Executing: ${args.join(" ")}`),setTimeout(()=>{addTerminalLine("output"," Script completed successfully")},500);break;case"ai":args.length>0?(sendAIMessage(args.join(" ")),addTerminalLine("output","Query sent to AI assistant...")):addTerminalLine("error","Usage: ai <your question>");break;case"python":addTerminalLine("output","Python 3.11.0 - GRUDA Runtime");break;default:addTerminalLine("error",`Command not found: ${command}. Type 'help' for available commands.`)}},handleTerminalKeyDown=o=>{if(o.key==="Enter")executeTerminalCommand(terminalInput);else if(o.key==="ArrowUp"){if(o.preventDefault(),terminalHistory.length>0){const e=historyIndex<terminalHistory.length-1?historyIndex+1:historyIndex;setHistoryIndex(e),setTerminalInput(terminalHistory[terminalHistory.length-1-e]||"")}}else if(o.key==="ArrowDown")if(o.preventDefault(),historyIndex>0){const e=historyIndex-1;setHistoryIndex(e),setTerminalInput(terminalHistory[terminalHistory.length-1-e]||"")}else setHistoryIndex(-1),setTerminalInput("");else if(o.key==="Tab"){o.preventDefault();const e=["help","clear","ls","pwd","cd","cat","npm","git","node","echo","env","ports","run","ai"].filter(s=>s.startsWith(terminalInput));e.length===1&&setTerminalInput(e[0]+" ")}},sendAIMessage=async o=>{var a,c,d;if(!o.trim())return;const e=((c=(a=editorRef.current)==null?void 0:a.getModel())==null?void 0:c.getValueInRange(editorRef.current.getSelection()))||"",s={role:"user",content:o,timestamp:new Date,codeBlock:e||void 0};setAIMessages(b=>[...b,s]),setAIInput(""),setAILoading(!0);try{let b=o;e&&(b=`${o}

Code context:
\`\`\`${(activeFile==null?void 0:activeFile.language)||"typescript"}
${e}
\`\`\``);let _e="";try{const tt=await legionPro.chat(`You are GRUDA AI, an expert programming assistant. Provide concise, helpful code suggestions and explanations. Use markdown code blocks for code.

User: ${b}`);if(tt.success&&((d=tt.data)!=null&&d.response))_e=tt.data.response;else throw new Error("Legion AI unavailable")}catch{try{_e=await puterAIChat(b)}catch{_e=generateLocalAIResponse(o,e)}}setAIMessages(tt=>[...tt,{role:"assistant",content:_e,timestamp:new Date}])}catch{setAIMessages(_e=>[..._e,{role:"assistant",content:"Sorry, I encountered an error. Please try again.",timestamp:new Date}])}finally{setAILoading(!1),setTimeout(()=>{var b;(b=aiChatRef.current)==null||b.scrollTo(0,aiChatRef.current.scrollHeight)},10)}},generateLocalAIResponse=(o,e)=>{const s=o.toLowerCase();return s.includes("explain")?`Here's an explanation of the code:

This code defines a component/function that handles specific functionality. Key points:

1. **Structure**: The code follows standard patterns
2. **Logic**: It processes data and returns results
3. **Best Practices**: Consider adding error handling and types

Would you like me to elaborate on any specific part?`:s.includes("fix")||s.includes("error")||s.includes("bug")?`I've analyzed the code for potential issues:

**Potential Fixes:**
1. Check for null/undefined values
2. Ensure proper type annotations
3. Add error boundaries for async operations

\`\`\`typescript
// Suggested fix:
try {
  // Your code here
} catch (error) {
  console.error('Error:', error);
}
\`\`\``:s.includes("refactor")?`Here's a refactored version with improvements:

\`\`\`typescript
// Refactored code with better practices:
const processData = async <T>(input: T): Promise<Result<T>> => {
  if (!input) {
    return { success: false, error: 'Invalid input' };
  }
  
  try {
    const result = await transform(input);
    return { success: true, data: result };
  } catch (error) {
    return { success: false, error: String(error) };
  }
};
\`\`\`

**Improvements made:**
- Added generics for type safety
- Added proper error handling
- Used Result type pattern`:s.includes("test")?`Here are some test cases for your code:

\`\`\`typescript
import { describe, it, expect } from 'vitest';

describe('Component', () => {
  it('should render correctly', () => {
    // Test implementation
    expect(true).toBe(true);
  });

  it('should handle user interactions', () => {
    // Test user events
  });

  it('should handle edge cases', () => {
    // Test edge cases
  });
});
\`\`\``:`I understand you're asking about: "${o}"

Here are some suggestions:
1. Consider the current implementation patterns
2. Look at similar components for reference
3. Add proper TypeScript types

Would you like me to provide more specific help?`},handleAIAction=o=>{var a,c;const e=((c=(a=editorRef.current)==null?void 0:a.getModel())==null?void 0:c.getValueInRange(editorRef.current.getSelection()))||"",s={explain:"Explain this code in detail:",fix:"Find and fix any bugs in this code:",refactor:"Refactor this code for better readability and performance:",document:"Add comprehensive documentation to this code:",test:"Generate unit tests for this code:",optimize:"Optimize this code for better performance:",review:"Review this code and suggest improvements:"};sendAIMessage(e?`${s[o]||""}

${e}`:s[o]||`Help me ${o} my code`)},handleSearch=()=>{if(!searchQuery)return;const o=[];tabs.forEach(e=>{e.content.split(`
`).forEach((a,c)=>{a.toLowerCase().includes(searchQuery.toLowerCase())&&o.push({file:e.path,line:c+1,content:a.trim()})})}),setSearchResults(o)},commands=reactExports.useMemo(()=>[{id:"save",label:"File: Save",shortcut:"Ctrl+S",action:()=>handleSave()},{id:"saveAll",label:"File: Save All",shortcut:"Ctrl+Shift+S",action:()=>handleSaveAll()},{id:"newFile",label:"File: New File",shortcut:"Ctrl+N",action:()=>handleNewFile()},{id:"closeTab",label:"File: Close Tab",shortcut:"Ctrl+W",action:()=>handleCloseTab(activeTab)},{id:"toggleSidebar",label:"View: Toggle Sidebar",shortcut:"Ctrl+B",action:()=>setShowSidebar(o=>!o)},{id:"toggleAI",label:"View: Toggle AI Panel",shortcut:"Ctrl+Shift+A",action:()=>setRightPanel(o=>o==="ai"?"none":"ai")},{id:"togglePreview",label:"View: Toggle Browser Preview",shortcut:"Ctrl+Shift+B",action:()=>setRightPanel(o=>o==="preview"?"none":"preview")},{id:"toggleMinimap",label:"View: Toggle Minimap",shortcut:"",action:()=>setShowMinimap(o=>!o)},{id:"toggleTerminal",label:"View: Toggle Terminal",shortcut:"Ctrl+`",action:()=>setBottomPanel(o=>o==="terminal"?"none":"terminal")},{id:"toggleOutput",label:"View: Toggle Output",shortcut:"Ctrl+Shift+U",action:()=>setBottomPanel(o=>o==="output"?"none":"output")},{id:"togglePorts",label:"View: Toggle Ports",shortcut:"",action:()=>setBottomPanel(o=>o==="ports"?"none":"ports")},{id:"explorer",label:"View: Explorer",shortcut:"Ctrl+Shift+E",action:()=>{setShowSidebar(!0),setActivePanel("explorer")}},{id:"search",label:"View: Search",shortcut:"Ctrl+Shift+F",action:()=>{setShowSidebar(!0),setActivePanel("search")}},{id:"git",label:"View: Source Control",shortcut:"Ctrl+Shift+G",action:()=>{setShowSidebar(!0),setActivePanel("git")}},{id:"aiExplain",label:"AI: Explain Code",shortcut:"",action:()=>handleAIAction("explain")},{id:"aiFix",label:"AI: Fix Bugs",shortcut:"",action:()=>handleAIAction("fix")},{id:"aiRefactor",label:"AI: Refactor Code",shortcut:"",action:()=>handleAIAction("refactor")},{id:"runDev",label:"Run: Start Development Server",shortcut:"F5",action:()=>executeTerminalCommand("npm run dev")},{id:"runBuild",label:"Run: Build Project",shortcut:"",action:()=>executeTerminalCommand("npm run build")}],[activeTab]),filteredCommands=reactExports.useMemo(()=>commandSearch?commands.filter(o=>o.label.toLowerCase().includes(commandSearch.toLowerCase())):commands,[commands,commandSearch]);reactExports.useEffect(()=>{const o=e=>{(e.ctrlKey||e.metaKey)&&e.shiftKey&&e.key.toLowerCase()==="p"&&(e.preventDefault(),setShowCommandPalette(!0)),e.key==="Escape"&&setShowCommandPalette(!1)};return window.addEventListener("keydown",o),()=>window.removeEventListener("keydown",o)},[]),reactExports.useEffect(()=>{showCommandPalette&&commandInputRef.current&&commandInputRef.current.focus()},[showCommandPalette]);const renderFileTree=(o,e=0)=>o.map(s=>{var a;return jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("div",{className:`flex items-center gap-1 px-2 py-0.5 text-xs cursor-pointer hover:bg-[#2a2d2e] ${tabs.some(c=>c.path===s.path&&c.id===activeTab)?"bg-[#37373d]":""}`,style:{paddingLeft:`${e*12+8}px`},onClick:()=>s.type==="folder"?toggleFolder(s.path):handleOpenFile(s),children:[s.type==="folder"&&jsxRuntimeExports.jsx("span",{className:"text-[10px] text-gray-500",children:s.expanded?"":""}),jsxRuntimeExports.jsx("span",{children:getFileIcon(s.name,s.type==="folder",s.expanded)}),jsxRuntimeExports.jsx("span",{className:`truncate ${(a=tabs.find(c=>c.path===s.path))!=null&&a.modified?"text-[#c9a227]":""}`,children:s.name})]}),s.type==="folder"&&s.expanded&&s.children&&renderFileTree(s.children,e+1)]},s.path)});return jsxRuntimeExports.jsxs("div",{className:"flex flex-col h-full bg-[#1e1e1e] text-white overflow-hidden",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center px-2 py-1 bg-[#3c3c3c] text-xs gap-4 border-b border-[#252526]",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-1",children:[jsxRuntimeExports.jsx("span",{className:"text-[#c9a227] font-bold text-sm",children:" GRUDA"}),jsxRuntimeExports.jsx("span",{className:"text-gray-400",children:"VISUAL CODE"})]}),jsxRuntimeExports.jsx("div",{className:"flex gap-2 text-gray-300",children:["File","Edit","View","Run","Terminal","Help"].map(o=>jsxRuntimeExports.jsx("button",{className:"hover:bg-[#505050] px-2 py-0.5 rounded text-xs",children:o},o))}),jsxRuntimeExports.jsx("div",{className:"flex-1 flex justify-center",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 bg-[#505050] hover:bg-[#606060] px-4 py-1 rounded cursor-pointer min-w-[350px] justify-center",onClick:()=>setShowCommandPalette(!0),children:[jsxRuntimeExports.jsx("span",{className:"text-gray-400",children:""}),jsxRuntimeExports.jsx("span",{className:"text-gray-400 text-xs",children:(activeFile==null?void 0:activeFile.name)||"Search or run command"}),jsxRuntimeExports.jsx("span",{className:"text-gray-500 text-[10px] bg-[#3c3c3c] px-1 rounded",children:"Ctrl+Shift+P"})]})}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-1",children:[jsxRuntimeExports.jsx("button",{className:"hover:bg-[#505050] p-1 rounded text-xs",onClick:handleSave,title:"Save",children:""}),jsxRuntimeExports.jsx("button",{className:"hover:bg-[#505050] p-1 rounded text-xs",onClick:()=>setRightPanel(o=>o==="ai"?"none":"ai"),title:"AI Assistant",children:""}),jsxRuntimeExports.jsx("button",{className:"hover:bg-[#505050] p-1 rounded text-xs",onClick:()=>setRightPanel(o=>o==="preview"?"none":"preview"),title:"Browser Preview",children:""})]})]}),jsxRuntimeExports.jsx("div",{className:"flex items-center bg-[#252526] border-b border-[#3c3c3c] overflow-x-auto",children:tabs.map(o=>jsxRuntimeExports.jsxs("div",{className:`flex items-center gap-2 px-3 py-1.5 text-xs cursor-pointer border-r border-[#3c3c3c] shrink-0 ${activeTab===o.id?"bg-[#1e1e1e] border-t-2 border-t-[#c9a227]":"bg-[#2d2d2d] hover:bg-[#383838]"}`,onClick:()=>setActiveTab(o.id),children:[jsxRuntimeExports.jsx("span",{children:getFileIcon(o.name)}),jsxRuntimeExports.jsx("span",{children:o.name}),o.modified&&jsxRuntimeExports.jsx("span",{className:"text-[#c9a227]",children:""}),jsxRuntimeExports.jsx("button",{onClick:e=>{e.stopPropagation(),handleCloseTab(o.id)},className:"ml-1 hover:bg-[#4c4c4c] rounded px-1 opacity-60 hover:opacity-100",children:""})]},o.id))}),jsxRuntimeExports.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col bg-[#333333] border-r border-[#3c3c3c] w-12",children:[[{id:"explorer",icon:"",label:"Explorer"},{id:"search",icon:"",label:"Search"},{id:"git",icon:"",label:"Source Control"},{id:"debug",icon:"",label:"Debug"},{id:"extensions",icon:"",label:"Extensions"},{id:"ports",icon:"",label:"Ports"}].map(o=>jsxRuntimeExports.jsx("button",{className:`p-3 text-lg hover:bg-[#505050] ${activePanel===o.id&&showSidebar?"bg-[#505050] border-l-2 border-[#c9a227]":""}`,onClick:()=>{setActivePanel(o.id),setShowSidebar(!0)},title:o.label,children:o.icon},o.id)),jsxRuntimeExports.jsx("div",{className:"flex-1"}),jsxRuntimeExports.jsx("button",{className:"p-3 text-lg hover:bg-[#505050]",title:"Settings",children:""})]}),showSidebar&&jsxRuntimeExports.jsxs("div",{className:"bg-[#252526] border-r border-[#3c3c3c] overflow-hidden flex flex-col",style:{width:sidebarWidth},children:[jsxRuntimeExports.jsxs("div",{className:"p-2 text-xs font-bold text-gray-400 uppercase border-b border-[#3c3c3c] flex justify-between items-center",children:[jsxRuntimeExports.jsxs("span",{children:[activePanel==="explorer"&&"Explorer",activePanel==="search"&&"Search",activePanel==="git"&&"Source Control",activePanel==="debug"&&"Debug",activePanel==="extensions"&&"Extensions",activePanel==="ports"&&"Ports"]}),jsxRuntimeExports.jsx("button",{onClick:()=>setShowSidebar(!1),className:"text-gray-500 hover:text-white",children:""})]}),jsxRuntimeExports.jsxs("div",{className:"flex-1 overflow-y-auto",children:[activePanel==="explorer"&&jsxRuntimeExports.jsxs("div",{className:"py-1",children:[jsxRuntimeExports.jsxs("div",{className:"px-2 py-1 text-[10px] text-gray-500 font-bold uppercase flex items-center justify-between",children:[jsxRuntimeExports.jsx("span",{children:"GRUDA WORKSPACE"}),jsxRuntimeExports.jsxs("div",{className:"flex gap-1",children:[jsxRuntimeExports.jsx("button",{className:"hover:bg-[#3c3c3c] p-0.5 rounded",title:"New File",children:""}),jsxRuntimeExports.jsx("button",{className:"hover:bg-[#3c3c3c] p-0.5 rounded",title:"New Folder",children:""}),jsxRuntimeExports.jsx("button",{className:"hover:bg-[#3c3c3c] p-0.5 rounded",title:"Refresh",children:""})]})]}),renderFileTree(fileTree)]}),activePanel==="search"&&jsxRuntimeExports.jsxs("div",{className:"p-2 space-y-2",children:[jsxRuntimeExports.jsx("input",{type:"text",value:searchQuery,onChange:o=>setSearchQuery(o.target.value),onKeyDown:o=>o.key==="Enter"&&handleSearch(),placeholder:"Search files...",className:"w-full bg-[#3c3c3c] border border-[#505050] rounded px-2 py-1 text-sm outline-none focus:border-[#c9a227]"}),jsxRuntimeExports.jsx("input",{type:"text",value:replaceQuery,onChange:o=>setReplaceQuery(o.target.value),placeholder:"Replace with...",className:"w-full bg-[#3c3c3c] border border-[#505050] rounded px-2 py-1 text-sm outline-none focus:border-[#c9a227]"}),jsxRuntimeExports.jsx("button",{onClick:handleSearch,className:"w-full bg-[#1a5a5a] hover:bg-[#2a6a6a] rounded px-2 py-1 text-sm",children:"Search"}),jsxRuntimeExports.jsxs("div",{className:"text-xs text-gray-400",children:[searchResults.length," results found"]}),searchResults.map((o,e)=>jsxRuntimeExports.jsxs("div",{className:"text-xs p-1 hover:bg-[#3c3c3c] cursor-pointer rounded",children:[jsxRuntimeExports.jsxs("div",{className:"text-[#c9a227]",children:[o.file,":",o.line]}),jsxRuntimeExports.jsx("div",{className:"text-gray-300 truncate",children:o.content})]},e))]}),activePanel==="git"&&jsxRuntimeExports.jsxs("div",{className:"p-2 space-y-3",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[jsxRuntimeExports.jsx("span",{children:""}),jsxRuntimeExports.jsx("span",{className:"text-[#c9a227]",children:gitStatus.branch}),gitStatus.ahead>0&&jsxRuntimeExports.jsxs("span",{className:"text-xs bg-[#1a5a5a] px-1 rounded",children:["",gitStatus.ahead]}),gitStatus.behind>0&&jsxRuntimeExports.jsxs("span",{className:"text-xs bg-[#5a1a1a] px-1 rounded",children:["",gitStatus.behind]})]}),jsxRuntimeExports.jsxs("div",{className:"text-xs text-gray-400",children:[gitStatus.changes," changes, ",gitStatus.staged," staged"]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-1",children:[jsxRuntimeExports.jsx("button",{className:"flex-1 bg-[#1a5a5a] hover:bg-[#2a6a6a] rounded px-2 py-1 text-xs",children:"Commit"}),jsxRuntimeExports.jsx("button",{className:"flex-1 bg-[#3c3c3c] hover:bg-[#4c4c4c] rounded px-2 py-1 text-xs",children:"Push"}),jsxRuntimeExports.jsx("button",{className:"flex-1 bg-[#3c3c3c] hover:bg-[#4c4c4c] rounded px-2 py-1 text-xs",children:"Pull"})]}),jsxRuntimeExports.jsx("div",{className:"text-xs text-gray-500 uppercase mt-2",children:"Changes"}),tabs.filter(o=>o.modified).map(o=>jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 text-xs text-yellow-400 hover:bg-[#3c3c3c] px-1 py-0.5 rounded cursor-pointer",children:[jsxRuntimeExports.jsx("span",{className:"text-yellow-500",children:"M"}),jsxRuntimeExports.jsx("span",{className:"flex-1",children:o.name}),jsxRuntimeExports.jsx("button",{className:"text-green-400 hover:text-green-300",children:"+"}),jsxRuntimeExports.jsx("button",{className:"text-red-400 hover:text-red-300",children:""})]},o.id))]}),activePanel==="debug"&&jsxRuntimeExports.jsxs("div",{className:"p-2 space-y-2",children:[jsxRuntimeExports.jsxs("select",{className:"w-full bg-[#3c3c3c] border border-[#505050] rounded px-2 py-1 text-sm",children:[jsxRuntimeExports.jsx("option",{children:"Launch Chrome"}),jsxRuntimeExports.jsx("option",{children:"Node.js Debug"}),jsxRuntimeExports.jsx("option",{children:"Jest Tests"})]}),jsxRuntimeExports.jsxs("button",{className:"w-full bg-green-600 hover:bg-green-700 rounded px-2 py-1 text-sm flex items-center justify-center gap-2",children:[jsxRuntimeExports.jsx("span",{children:""})," Start Debugging"]}),jsxRuntimeExports.jsx("div",{className:"text-xs text-gray-500 uppercase mt-4",children:"Breakpoints"}),jsxRuntimeExports.jsx("div",{className:"text-xs text-gray-400",children:"No breakpoints set"}),jsxRuntimeExports.jsx("div",{className:"text-xs text-gray-500 uppercase mt-4",children:"Variables"}),jsxRuntimeExports.jsx("div",{className:"text-xs text-gray-400",children:"Not debugging"})]}),activePanel==="extensions"&&jsxRuntimeExports.jsxs("div",{className:"p-2 space-y-2",children:[jsxRuntimeExports.jsx("input",{type:"text",placeholder:"Search extensions...",className:"w-full bg-[#3c3c3c] border border-[#505050] rounded px-2 py-1 text-sm outline-none focus:border-[#c9a227]"}),jsxRuntimeExports.jsx("div",{className:"text-xs text-gray-500 uppercase mt-2",children:"Installed"}),[{name:"GRUDA AI",desc:"AI-powered assistant",enabled:!0,icon:""},{name:"TypeScript",desc:"Language support",enabled:!0,icon:""},{name:"ESLint",desc:"Code linting",enabled:!0,icon:""},{name:"Prettier",desc:"Code formatter",enabled:!0,icon:""},{name:"GitLens",desc:"Git supercharged",enabled:!0,icon:""},{name:"Live Server",desc:"Local dev server",enabled:!0,icon:""}].map((o,e)=>jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 p-2 bg-[#2d2d2d] hover:bg-[#3c3c3c] rounded text-xs cursor-pointer",children:[jsxRuntimeExports.jsx("span",{className:"text-lg",children:o.icon}),jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsx("div",{className:"font-medium",children:o.name}),jsxRuntimeExports.jsx("div",{className:"text-gray-500 text-[10px]",children:o.desc})]}),jsxRuntimeExports.jsx("span",{className:"text-green-400",children:""})]},e))]}),activePanel==="ports"&&jsxRuntimeExports.jsxs("div",{className:"p-2 space-y-2",children:[jsxRuntimeExports.jsx("div",{className:"text-xs text-gray-500 uppercase",children:"Forwarded Ports"}),ports.map((o,e)=>jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 p-2 bg-[#2d2d2d] hover:bg-[#3c3c3c] rounded text-xs",children:[jsxRuntimeExports.jsx("span",{className:`w-2 h-2 rounded-full ${o.status==="open"?"bg-green-400":"bg-gray-500"}`}),jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsx("div",{className:"font-medium",children:o.port}),jsxRuntimeExports.jsx("div",{className:"text-gray-500 text-[10px]",children:o.name})]}),o.status==="open"&&jsxRuntimeExports.jsx("button",{onClick:()=>{setPreviewUrl(o.url),setRightPanel("preview")},className:"text-[#c9a227] hover:text-[#d9b237]",children:""})]},e)),jsxRuntimeExports.jsx("button",{className:"w-full bg-[#1a5a5a] hover:bg-[#2a6a6a] rounded px-2 py-1 text-xs mt-2",children:"+ Forward Port"})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[jsxRuntimeExports.jsx("div",{className:"flex items-center gap-1 px-2 py-0.5 bg-[#252526] text-xs text-gray-400 border-b border-[#3c3c3c]",children:activeFile==null?void 0:activeFile.path.split("/").filter(Boolean).map((o,e,s)=>jsxRuntimeExports.jsxs(React.Fragment,{children:[jsxRuntimeExports.jsx("span",{className:e===s.length-1?"text-white":"hover:text-white cursor-pointer",children:o}),e<s.length-1&&jsxRuntimeExports.jsx("span",{className:"mx-1",children:""})]},e))}),jsxRuntimeExports.jsx("div",{className:"flex-1 overflow-hidden",style:{minHeight:"200px"},children:activeFile?jsxRuntimeExports.jsx(Ft,{height:"100%",language:activeFile.language,value:activeFile.content,theme:"vs-dark",onMount:handleEditorMount,onChange:handleEditorChange,loading:jsxRuntimeExports.jsx("div",{className:"flex items-center justify-center h-full bg-[#1e1e1e] text-gray-400",children:"Loading editor..."}),options:{minimap:{enabled:showMinimap},fontSize:14,fontFamily:"'Fira Code', 'Cascadia Code', Consolas, monospace",fontLigatures:!0,lineNumbers:"on",renderLineHighlight:"all",scrollBeyondLastLine:!1,smoothScrolling:!0,cursorBlinking:"smooth",cursorSmoothCaretAnimation:"on",automaticLayout:!0,wordWrap:"on",bracketPairColorization:{enabled:!0},guides:{bracketPairs:!0,indentation:!0},suggest:{showKeywords:!0,showSnippets:!0},quickSuggestions:{other:!0,comments:!0,strings:!0},parameterHints:{enabled:!0},folding:!0,foldingStrategy:"indentation",showFoldingControls:"always",matchBrackets:"always",selectionHighlight:!0,renderWhitespace:"selection",tabSize:2,insertSpaces:!0}},activeFile.id):jsxRuntimeExports.jsx("div",{className:"flex items-center justify-center h-full bg-[#1e1e1e] text-gray-500",children:jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("div",{className:"text-6xl mb-4",children:""}),jsxRuntimeExports.jsx("div",{className:"text-2xl font-bold text-[#c9a227] mb-2",children:"GRUDA VISUAL CODE"}),jsxRuntimeExports.jsx("div",{className:"text-sm text-gray-400",children:"AI-Powered Development Environment"}),jsxRuntimeExports.jsxs("div",{className:"mt-6 space-y-2 text-sm",children:[jsxRuntimeExports.jsxs("div",{children:["Press ",jsxRuntimeExports.jsx("span",{className:"bg-[#3c3c3c] px-2 py-0.5 rounded",children:"Ctrl+Shift+P"})," for command palette"]}),jsxRuntimeExports.jsxs("div",{children:["Press ",jsxRuntimeExports.jsx("span",{className:"bg-[#3c3c3c] px-2 py-0.5 rounded",children:"Ctrl+N"})," for new file"]})]})]})})}),bottomPanel!=="none"&&jsxRuntimeExports.jsxs("div",{className:"bg-[#1e1e1e] border-t border-[#3c3c3c] flex flex-col",style:{height:bottomPanelHeight},children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center bg-[#252526] border-b border-[#3c3c3c] shrink-0",children:[[{id:"problems",label:"PROBLEMS",count:problems.length,icon:""},{id:"output",label:"OUTPUT",count:0,icon:""},{id:"terminal",label:"TERMINAL",count:0,icon:""},{id:"ports",label:"PORTS",count:ports.filter(o=>o.status==="open").length,icon:""}].map(o=>jsxRuntimeExports.jsxs("button",{className:`px-3 py-1.5 text-xs flex items-center gap-1 ${bottomPanel===o.id?"border-b-2 border-[#c9a227] text-white bg-[#1e1e1e]":"text-gray-400 hover:text-white"}`,onClick:()=>setBottomPanel(o.id),children:[jsxRuntimeExports.jsx("span",{children:o.icon}),jsxRuntimeExports.jsx("span",{children:o.label}),o.count>0&&jsxRuntimeExports.jsx("span",{className:"text-[#c9a227] text-[10px] bg-[#3c3c3c] px-1 rounded",children:o.count})]},o.id)),jsxRuntimeExports.jsx("div",{className:"flex-1"}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-1 px-2",children:[jsxRuntimeExports.jsx("button",{className:"p-1 hover:bg-[#3c3c3c] rounded text-gray-400 hover:text-white text-xs",onClick:()=>setBottomPanelHeight(o=>Math.min(o+50,400)),children:""}),jsxRuntimeExports.jsx("button",{className:"p-1 hover:bg-[#3c3c3c] rounded text-gray-400 hover:text-white text-xs",onClick:()=>setBottomPanelHeight(o=>Math.max(o-50,100)),children:""}),jsxRuntimeExports.jsx("button",{className:"p-1 hover:bg-[#3c3c3c] rounded text-gray-400 hover:text-white",onClick:()=>setBottomPanel("none"),children:""})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex-1 overflow-hidden",children:[bottomPanel==="problems"&&jsxRuntimeExports.jsx("div",{className:"h-full overflow-y-auto p-2 text-xs font-mono",children:problems.length===0?jsxRuntimeExports.jsxs("div",{className:"text-gray-400 flex items-center gap-2",children:[jsxRuntimeExports.jsx("span",{children:""})," No problems detected"]}):problems.map((o,e)=>jsxRuntimeExports.jsxs("div",{className:`flex items-center gap-2 p-1 hover:bg-[#2a2d2e] rounded cursor-pointer ${o.type==="error"?"text-red-400":o.type==="warning"?"text-yellow-400":"text-blue-400"}`,children:[jsxRuntimeExports.jsx("span",{children:o.type==="error"?"":o.type==="warning"?"":""}),jsxRuntimeExports.jsxs("span",{className:"text-gray-400",children:[o.file,":",o.line]}),jsxRuntimeExports.jsx("span",{children:o.message})]},e))}),bottomPanel==="output"&&jsxRuntimeExports.jsxs("div",{className:"h-full overflow-y-auto p-2 text-xs font-mono",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-2 border-b border-[#3c3c3c] pb-1",children:[jsxRuntimeExports.jsxs("select",{className:"bg-[#3c3c3c] border-none text-xs rounded px-2 py-0.5",children:[jsxRuntimeExports.jsx("option",{children:"GRUDA IDE"}),jsxRuntimeExports.jsx("option",{children:"TypeScript"}),jsxRuntimeExports.jsx("option",{children:"ESLint"}),jsxRuntimeExports.jsx("option",{children:"Git"})]}),jsxRuntimeExports.jsx("div",{className:"flex-1"}),jsxRuntimeExports.jsx("button",{className:"text-gray-400 hover:text-white text-[10px]",onClick:()=>setOutputLogs([]),children:"Clear"})]}),outputLogs.map((o,e)=>jsxRuntimeExports.jsx("div",{className:"text-gray-300 leading-relaxed",children:o},e))]}),bottomPanel==="terminal"&&jsxRuntimeExports.jsxs("div",{className:"h-full flex flex-col bg-[#0a0a0a]",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 px-2 py-1 bg-[#252526] border-b border-[#3c3c3c] shrink-0",children:[jsxRuntimeExports.jsx("span",{className:"text-green-400 text-xs",children:""}),jsxRuntimeExports.jsx("span",{className:"text-xs text-gray-400",children:"bash"}),jsxRuntimeExports.jsx("span",{className:"text-xs text-gray-600",children:"~/workspace"}),jsxRuntimeExports.jsx("div",{className:"flex-1"}),jsxRuntimeExports.jsx("button",{className:"text-xs text-gray-400 hover:text-white",onClick:()=>setTerminalLines([]),children:"Clear"}),jsxRuntimeExports.jsx("button",{className:"text-xs text-gray-400 hover:text-white",children:"+ New"}),jsxRuntimeExports.jsx("button",{className:"text-xs text-gray-400 hover:text-white",children:"Split"})]}),jsxRuntimeExports.jsxs("div",{ref:terminalRef,className:"flex-1 overflow-y-auto p-2 font-mono text-sm",onClick:()=>{var o;return(o=terminalInputRef.current)==null?void 0:o.focus()},children:[terminalLines.map(o=>jsxRuntimeExports.jsx("div",{className:`leading-relaxed ${o.type==="input"?"text-white":o.type==="error"?"text-red-400":o.type==="system"?"text-[#c9a227]":"text-gray-300"}`,children:o.content},o.id)),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[jsxRuntimeExports.jsx("span",{className:"text-green-400",children:"$"}),jsxRuntimeExports.jsx("input",{ref:terminalInputRef,type:"text",value:terminalInput,onChange:o=>setTerminalInput(o.target.value),onKeyDown:handleTerminalKeyDown,className:"flex-1 bg-transparent outline-none text-white caret-white",placeholder:"",autoFocus:!0})]})]})]}),bottomPanel==="ports"&&jsxRuntimeExports.jsxs("div",{className:"h-full overflow-y-auto p-2",children:[jsxRuntimeExports.jsxs("table",{className:"w-full text-xs",children:[jsxRuntimeExports.jsx("thead",{className:"text-gray-500",children:jsxRuntimeExports.jsxs("tr",{className:"border-b border-[#3c3c3c]",children:[jsxRuntimeExports.jsx("th",{className:"text-left py-1 px-2",children:"Port"}),jsxRuntimeExports.jsx("th",{className:"text-left py-1 px-2",children:"Process"}),jsxRuntimeExports.jsx("th",{className:"text-left py-1 px-2",children:"Address"}),jsxRuntimeExports.jsx("th",{className:"text-left py-1 px-2",children:"Status"}),jsxRuntimeExports.jsx("th",{className:"text-left py-1 px-2",children:"Actions"})]})}),jsxRuntimeExports.jsx("tbody",{children:ports.map((o,e)=>jsxRuntimeExports.jsxs("tr",{className:"hover:bg-[#2a2d2e]",children:[jsxRuntimeExports.jsx("td",{className:"py-1 px-2 text-[#c9a227]",children:o.port}),jsxRuntimeExports.jsx("td",{className:"py-1 px-2",children:o.name}),jsxRuntimeExports.jsx("td",{className:"py-1 px-2 text-gray-400",children:o.url}),jsxRuntimeExports.jsx("td",{className:"py-1 px-2",children:jsxRuntimeExports.jsxs("span",{className:`flex items-center gap-1 ${o.status==="open"?"text-green-400":"text-gray-500"}`,children:[jsxRuntimeExports.jsx("span",{className:`w-1.5 h-1.5 rounded-full ${o.status==="open"?"bg-green-400":"bg-gray-500"}`}),o.status]})}),jsxRuntimeExports.jsx("td",{className:"py-1 px-2",children:jsxRuntimeExports.jsx("div",{className:"flex gap-1",children:o.status==="open"&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("button",{onClick:()=>{setPreviewUrl(o.url),setRightPanel("preview")},className:"text-[#c9a227] hover:text-[#d9b237]",title:"Open in preview",children:""}),jsxRuntimeExports.jsx("button",{className:"text-gray-400 hover:text-white",title:"Copy URL",children:""}),jsxRuntimeExports.jsx("button",{className:"text-gray-400 hover:text-white",title:"Open externally",children:""})]})})})]},e))})]}),jsxRuntimeExports.jsx("button",{className:"mt-2 bg-[#1a5a5a] hover:bg-[#2a6a6a] rounded px-3 py-1 text-xs",children:"+ Forward a Port"})]})]})]})]}),rightPanel!=="none"&&jsxRuntimeExports.jsxs("div",{className:"bg-[#252526] border-l border-[#3c3c3c] flex flex-col",style:{width:rightPanelWidth},children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center bg-[#2d2d2d] border-b border-[#3c3c3c] shrink-0",children:[jsxRuntimeExports.jsxs("button",{className:`px-3 py-1.5 text-xs flex items-center gap-1 ${rightPanel==="ai"?"bg-[#252526] border-b-2 border-[#c9a227] text-white":"text-gray-400 hover:text-white"}`,onClick:()=>setRightPanel("ai"),children:[jsxRuntimeExports.jsx("span",{children:""})," AI Assistant"]}),jsxRuntimeExports.jsxs("button",{className:`px-3 py-1.5 text-xs flex items-center gap-1 ${rightPanel==="preview"?"bg-[#252526] border-b-2 border-[#c9a227] text-white":"text-gray-400 hover:text-white"}`,onClick:()=>setRightPanel("preview"),children:[jsxRuntimeExports.jsx("span",{children:""})," Browser"]}),jsxRuntimeExports.jsx("div",{className:"flex-1"}),jsxRuntimeExports.jsx("button",{className:"px-2 text-gray-400 hover:text-white",onClick:()=>setRightPanel("none"),children:""})]}),rightPanel==="ai"&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"flex gap-1 p-2 border-b border-[#3c3c3c] bg-[#2d2d2d]",children:[{mode:"chat",icon:"",label:"Chat"},{mode:"generate",icon:"",label:"Generate"},{mode:"edit",icon:"",label:"Edit"},{mode:"explain",icon:"",label:"Explain"}].map(o=>jsxRuntimeExports.jsxs("button",{onClick:()=>setAIMode(o.mode),className:`flex items-center gap-1 px-2 py-1 rounded text-xs ${aiMode===o.mode?"bg-[#1a5a5a] text-white":"bg-[#3c3c3c] hover:bg-[#4c4c4c] text-gray-300"}`,children:[jsxRuntimeExports.jsx("span",{children:o.icon}),jsxRuntimeExports.jsx("span",{children:o.label})]},o.mode))}),jsxRuntimeExports.jsx("div",{className:"flex flex-wrap gap-1 p-2 border-b border-[#3c3c3c]",children:[{action:"explain",icon:"",label:"Explain"},{action:"fix",icon:"",label:"Fix Bug"},{action:"refactor",icon:"",label:"Refactor"},{action:"document",icon:"",label:"Document"},{action:"test",icon:"",label:"Test"},{action:"optimize",icon:"",label:"Optimize"},{action:"review",icon:"",label:"Review"}].map(o=>jsxRuntimeExports.jsxs("button",{onClick:()=>handleAIAction(o.action),className:"flex items-center gap-1 px-2 py-1 bg-[#3c3c3c] hover:bg-[#505050] rounded text-[10px]",title:`${o.label} selected code`,children:[jsxRuntimeExports.jsx("span",{children:o.icon}),jsxRuntimeExports.jsx("span",{children:o.label})]},o.action))}),jsxRuntimeExports.jsxs("div",{ref:aiChatRef,className:"flex-1 overflow-y-auto p-3 space-y-3",children:[aiMessages.map((o,e)=>jsxRuntimeExports.jsxs("div",{className:`${o.role==="user"?"ml-6":"mr-2"}`,children:[jsxRuntimeExports.jsxs("div",{className:`text-[10px] mb-1 flex items-center gap-1 ${o.role==="user"?"justify-end text-blue-400":"text-[#c9a227]"}`,children:[o.role==="user"?" You":" GRUDA AI",jsxRuntimeExports.jsx("span",{className:"text-gray-600",children:o.timestamp.toLocaleTimeString()})]}),o.codeBlock&&jsxRuntimeExports.jsxs("div",{className:"bg-[#1e1e1e] border border-[#3c3c3c] rounded p-2 mb-1 text-[10px] font-mono text-gray-400 max-h-20 overflow-y-auto",children:[o.codeBlock.slice(0,200),o.codeBlock.length>200?"...":""]}),jsxRuntimeExports.jsx("div",{className:`p-3 rounded text-sm whitespace-pre-wrap ${o.role==="user"?"bg-[#1a5a5a] text-white":"bg-[#2d2d2d] text-gray-200 border border-[#3c3c3c]"}`,children:o.content})]},e)),aiLoading&&jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 text-gray-400 text-sm p-2",children:[jsxRuntimeExports.jsx("span",{className:"animate-pulse",children:""}),jsxRuntimeExports.jsx("span",{className:"animate-pulse delay-100",children:""}),jsxRuntimeExports.jsx("span",{className:"animate-pulse delay-200",children:""}),jsxRuntimeExports.jsx("span",{className:"ml-2",children:"GRUDA AI is thinking..."})]})]}),jsxRuntimeExports.jsxs("div",{className:"p-3 border-t border-[#3c3c3c] bg-[#2d2d2d]",children:[jsxRuntimeExports.jsx("div",{className:"flex gap-2",children:jsxRuntimeExports.jsx("textarea",{value:aiInput,onChange:o=>setAIInput(o.target.value),onKeyDown:o=>{o.key==="Enter"&&!o.shiftKey&&(o.preventDefault(),sendAIMessage(aiInput))},placeholder:"Ask AI anything... (Select code for context)",className:"flex-1 bg-[#1e1e1e] border border-[#3c3c3c] rounded px-3 py-2 text-sm outline-none focus:border-[#c9a227] resize-none",rows:2,disabled:aiLoading})}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center mt-2",children:[jsxRuntimeExports.jsx("span",{className:"text-[10px] text-gray-500",children:"Shift+Enter for newline"}),jsxRuntimeExports.jsx("button",{onClick:()=>sendAIMessage(aiInput),disabled:aiLoading||!aiInput.trim(),className:"px-4 py-1.5 bg-[#c9a227] hover:bg-[#d9b237] text-black rounded text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:aiLoading?"Thinking...":"Send"})]})]})]}),rightPanel==="preview"&&jsxRuntimeExports.jsxs("div",{className:"flex-1 flex flex-col",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 p-2 bg-[#2d2d2d] border-b border-[#3c3c3c]",children:[jsxRuntimeExports.jsx("button",{className:"text-gray-400 hover:text-white",onClick:()=>setPreviewLoading(!0),children:""}),jsxRuntimeExports.jsx("button",{className:"text-gray-400 hover:text-white",children:""}),jsxRuntimeExports.jsx("button",{className:"text-gray-400 hover:text-white",onClick:()=>{setPreviewLoading(!0),setTimeout(()=>setPreviewLoading(!1),500)},children:""}),jsxRuntimeExports.jsx("input",{type:"text",value:previewUrl,onChange:o=>setPreviewUrl(o.target.value),onKeyDown:o=>o.key==="Enter"&&setPreviewLoading(!0),className:"flex-1 bg-[#1e1e1e] border border-[#3c3c3c] rounded px-2 py-1 text-xs outline-none focus:border-[#c9a227]"}),jsxRuntimeExports.jsx("button",{className:"text-gray-400 hover:text-white",title:"Open in new tab",children:""})]}),jsxRuntimeExports.jsx("div",{className:"flex-1 bg-white relative",children:previewLoading?jsxRuntimeExports.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-[#1e1e1e]",children:jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("div",{className:"text-2xl animate-spin mb-2",children:""}),jsxRuntimeExports.jsx("div",{className:"text-gray-400 text-sm",children:"Loading preview..."})]})}):jsxRuntimeExports.jsx("div",{className:"h-full flex items-center justify-center bg-gradient-to-br from-[#1a5a5a] to-[#0a3a3a]",children:jsxRuntimeExports.jsxs("div",{className:"text-center text-white p-8",children:[jsxRuntimeExports.jsx("div",{className:"text-4xl mb-4",children:""}),jsxRuntimeExports.jsx("h1",{className:"text-2xl font-bold mb-2",children:"Hello GRUDA!"}),jsxRuntimeExports.jsx("p",{className:"text-gray-300 mb-4",children:"Your app preview will appear here"}),jsxRuntimeExports.jsx("div",{className:"bg-[#c9a227] text-black px-6 py-2 rounded font-medium inline-block cursor-pointer hover:bg-[#d9b237]",children:"Count: 0"}),jsxRuntimeExports.jsxs("div",{className:"mt-6 text-xs text-gray-400",children:["Preview of ",previewUrl]})]})})}),jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-center gap-2 p-2 bg-[#2d2d2d] border-t border-[#3c3c3c]",children:[jsxRuntimeExports.jsx("button",{className:"px-2 py-1 bg-[#1a5a5a] rounded text-xs",children:" Desktop"}),jsxRuntimeExports.jsx("button",{className:"px-2 py-1 bg-[#3c3c3c] hover:bg-[#4c4c4c] rounded text-xs",children:" Mobile"}),jsxRuntimeExports.jsx("button",{className:"px-2 py-1 bg-[#3c3c3c] hover:bg-[#4c4c4c] rounded text-xs",children:" Tablet"})]})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between px-3 py-0.5 bg-[#1a5a5a] text-xs shrink-0",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsxs("span",{className:"flex items-center gap-1",children:[" ",gitStatus.branch]}),jsxRuntimeExports.jsxs("span",{className:"flex items-center gap-1",children:[" ",gitStatus.changes]}),jsxRuntimeExports.jsxs("span",{className:"flex items-center gap-1 text-yellow-300",children:[" ",problems.length]}),jsxRuntimeExports.jsxs("span",{className:"flex items-center gap-1 text-green-300",children:[" ",ports.filter(o=>o.status==="open").length," ports"]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsxs("span",{children:["Ln ",cursorPosition.line,", Col ",cursorPosition.col]}),selection.chars>0&&jsxRuntimeExports.jsxs("span",{className:"text-[#c9a227]",children:["(",selection.chars," selected)"]}),jsxRuntimeExports.jsx("span",{children:"Spaces: 2"}),jsxRuntimeExports.jsx("span",{children:"UTF-8"}),jsxRuntimeExports.jsx("span",{className:"uppercase text-[#c9a227]",children:(activeFile==null?void 0:activeFile.language)||"Plain Text"}),jsxRuntimeExports.jsx("span",{className:"font-bold",children:" GRUDA"})]})]}),showCommandPalette&&jsxRuntimeExports.jsx("div",{className:"absolute inset-0 bg-black/60 flex items-start justify-center pt-16 z-50",onClick:()=>setShowCommandPalette(!1),children:jsxRuntimeExports.jsxs("div",{className:"bg-[#252526] border border-[#3c3c3c] rounded-lg shadow-2xl w-[550px] max-h-[450px] overflow-hidden",onClick:o=>o.stopPropagation(),children:[jsxRuntimeExports.jsx("div",{className:"p-3 border-b border-[#3c3c3c]",children:jsxRuntimeExports.jsx("input",{ref:commandInputRef,type:"text",value:commandSearch,onChange:o=>setCommandSearch(o.target.value),placeholder:"Type '>' for commands, '@' for symbols, '#' for search...",className:"w-full bg-[#1e1e1e] border border-[#3c3c3c] rounded px-3 py-2 text-sm outline-none focus:border-[#c9a227]",onKeyDown:o=>{o.key==="Enter"&&filteredCommands.length>0&&(filteredCommands[0].action(),setShowCommandPalette(!1)),o.key==="Escape"&&setShowCommandPalette(!1)}})}),jsxRuntimeExports.jsxs("div",{className:"max-h-[350px] overflow-y-auto",children:[filteredCommands.map((o,e)=>jsxRuntimeExports.jsxs("div",{className:`flex items-center justify-between px-4 py-2 hover:bg-[#2a2d2e] cursor-pointer ${e===0?"bg-[#2a2d2e]":""}`,onClick:()=>{o.action(),setShowCommandPalette(!1)},children:[jsxRuntimeExports.jsx("span",{className:"text-sm",children:o.label}),o.shortcut&&jsxRuntimeExports.jsx("span",{className:"text-xs text-gray-500 bg-[#1e1e1e] px-2 py-0.5 rounded",children:o.shortcut})]},o.id)),filteredCommands.length===0&&jsxRuntimeExports.jsx("div",{className:"px-4 py-3 text-gray-400 text-sm",children:"No commands found"})]})]})})]})},CHANNELS=[{id:"general",name:"general",icon:"#"},{id:"games",name:"games",icon:""},{id:"dev-chat",name:"dev-chat",icon:""},{id:"music",name:"music",icon:""},{id:"random",name:"random",icon:""}],TreatyChat=()=>{const[o,e]=reactExports.useState(!1),[s,a]=reactExports.useState(!0),[c,d]=reactExports.useState(""),[b,_e]=reactExports.useState(""),[tt,nt]=reactExports.useState("#c9a227"),[it,ot]=reactExports.useState("general"),[at,ct]=reactExports.useState([]),[ut,ft]=reactExports.useState([]),[dt,lt]=reactExports.useState(""),[ht,mt]=reactExports.useState([]),[xt,St]=reactExports.useState(!0),[yt,wt]=reactExports.useState(!1),[Et,_t]=reactExports.useState(""),vt=reactExports.useRef(null),Mt=reactExports.useRef(null),jt=reactExports.useRef(null),Lt=reactExports.useRef(null),Nt=reactExports.useCallback(()=>{var sn;if(((sn=vt.current)==null?void 0:sn.readyState)===WebSocket.OPEN)return;a(!0);const Pt=window.location.protocol==="https:"?"wss:":"ws:",Wt=new WebSocket(`${Pt}//${window.location.host}/chat`);vt.current=Wt,Wt.onopen=()=>{console.log("[TreatyChat] Connected to chat server"),e(!0),a(!1)},Wt.onmessage=Bt=>{try{const tn=JSON.parse(Bt.data);switch(tn.type){case"welcome":d(tn.userId),_e(tn.username),nt(tn.color),ot(tn.channel),ft(tn.users||[]),ct(tn.history||[]);break;case"message":ct(cn=>cn.some(vn=>vn.id===tn.id)?cn:[...cn,{id:tn.id,userId:tn.userId,username:tn.username,color:tn.color,content:tn.content,channel:tn.channel,timestamp:tn.timestamp}]);break;case"user_joined":ft(tn.users||[]),ct(cn=>[...cn,{id:`sys_${Date.now()}`,userId:"system",username:"System",color:"#666",content:`${tn.username} joined the channel`,channel:it,timestamp:Date.now()}]);break;case"user_left":ft(tn.users||[]);break;case"user_updated":ft(tn.users||[]);break;case"channel_joined":ot(tn.channel),ft(tn.users||[]),ct(tn.history||[]);break;case"typing":mt(cn=>cn.includes(tn.username)?cn:[...cn,tn.username]),setTimeout(()=>{mt(cn=>cn.filter(vn=>vn!==tn.username))},2e3);break;case"username_changed":_e(tn.username);break}}catch(tn){console.error("[TreatyChat] Message parse error:",tn)}},Wt.onclose=()=>{console.log("[TreatyChat] Disconnected from chat server"),e(!1),a(!1),Lt.current=setTimeout(()=>{Nt()},3e3)},Wt.onerror=Bt=>{console.error("[TreatyChat] WebSocket error:",Bt)}},[it]);reactExports.useEffect(()=>(Nt(),()=>{Lt.current&&clearTimeout(Lt.current),vt.current&&vt.current.close()}),[Nt]),reactExports.useEffect(()=>{var Pt;(Pt=Mt.current)==null||Pt.scrollIntoView({behavior:"smooth"})},[at]);const kt=reactExports.useCallback(()=>{!dt.trim()||!vt.current||vt.current.readyState!==WebSocket.OPEN||(vt.current.send(JSON.stringify({type:"message",content:dt.trim()})),lt(""))},[dt]),Ot=Pt=>{Pt.key==="Enter"&&!Pt.shiftKey&&(Pt.preventDefault(),kt())},Ht=()=>{var Pt;((Pt=vt.current)==null?void 0:Pt.readyState)===WebSocket.OPEN&&(jt.current&&clearTimeout(jt.current),vt.current.send(JSON.stringify({type:"typing"})),jt.current=setTimeout(()=>{},1e3))},Ct=Pt=>{var Wt;((Wt=vt.current)==null?void 0:Wt.readyState)===WebSocket.OPEN&&Pt!==it&&vt.current.send(JSON.stringify({type:"join_channel",channel:Pt}))},Ut=()=>{var Pt;Et.trim()&&((Pt=vt.current)==null?void 0:Pt.readyState)===WebSocket.OPEN&&(vt.current.send(JSON.stringify({type:"change_username",username:Et.trim()})),wt(!1),_t(""))},Gt=Pt=>new Date(Pt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return s&&!o?jsxRuntimeExports.jsx("div",{className:"flex items-center justify-center h-full bg-[#0a0a0a]",children:jsxRuntimeExports.jsxs("div",{className:"text-center p-8",children:[jsxRuntimeExports.jsx("div",{className:"animate-spin w-12 h-12 border-4 border-[#1a5a5a] border-t-[#c9a227] rounded-full mx-auto mb-4"}),jsxRuntimeExports.jsx("p",{className:"text-[#c9a227]",children:"Connecting to Treaty Chat..."})]})}):jsxRuntimeExports.jsxs("div",{className:"flex h-full bg-[#0a0a0a] text-white",children:[jsxRuntimeExports.jsxs("div",{className:"w-16 bg-[#0d0d0d] flex flex-col items-center py-2 gap-2 border-r border-[#1a5a5a]/30",children:[jsxRuntimeExports.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-[#1a5a5a] to-[#c9a227] flex items-center justify-center text-xl font-bold",children:""}),jsxRuntimeExports.jsx("div",{className:"w-8 h-px bg-[#1a5a5a]/50"}),jsxRuntimeExports.jsx("div",{className:"text-[10px] text-gray-500 text-center px-1",children:"Grudge Studio"})]}),jsxRuntimeExports.jsxs("div",{className:"w-56 bg-[#111] flex flex-col border-r border-[#1a5a5a]/30",children:[jsxRuntimeExports.jsxs("div",{className:"p-3 border-b border-[#1a5a5a]/30",children:[jsxRuntimeExports.jsxs("h2",{className:"font-bold text-[#c9a227] flex items-center gap-2",children:[jsxRuntimeExports.jsx("span",{children:""})," Grudge Studio"]}),jsxRuntimeExports.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Treaty Chat Server"})]}),jsxRuntimeExports.jsx("div",{className:"flex-1 overflow-y-auto",children:jsxRuntimeExports.jsxs("div",{className:"p-2",children:[jsxRuntimeExports.jsx("div",{className:"text-xs text-gray-500 uppercase tracking-wide mb-2 px-2",children:"Text Channels"}),CHANNELS.map(Pt=>jsxRuntimeExports.jsxs("button",{onClick:()=>Ct(Pt.id),className:`w-full text-left px-2 py-1.5 rounded flex items-center gap-2 transition-colors ${it===Pt.id?"bg-[#1a5a5a]/50 text-white":"text-gray-400 hover:bg-[#1a1a1a] hover:text-gray-200"}`,children:[jsxRuntimeExports.jsx("span",{className:"text-gray-500",children:Pt.icon}),jsxRuntimeExports.jsx("span",{children:Pt.name})]},Pt.id))]})}),jsxRuntimeExports.jsx("div",{className:"p-2 bg-[#0d0d0d] border-t border-[#1a5a5a]/30",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold",style:{backgroundColor:tt},children:b.charAt(0).toUpperCase()}),jsxRuntimeExports.jsxs("div",{className:"flex-1 min-w-0",children:[yt?jsxRuntimeExports.jsxs("div",{className:"flex gap-1",children:[jsxRuntimeExports.jsx("input",{type:"text",value:Et,onChange:Pt=>_t(Pt.target.value),onKeyDown:Pt=>Pt.key==="Enter"&&Ut(),placeholder:b,className:"w-full bg-[#1a1a1a] text-white text-sm px-2 py-1 rounded border border-[#1a5a5a]/50 focus:outline-none focus:border-[#1a5a5a]",autoFocus:!0}),jsxRuntimeExports.jsx("button",{onClick:Ut,className:"text-[#c9a227] text-xs",children:""}),jsxRuntimeExports.jsx("button",{onClick:()=>wt(!1),className:"text-gray-500 text-xs",children:""})]}):jsxRuntimeExports.jsx("div",{className:"text-sm font-medium truncate cursor-pointer hover:underline",onClick:()=>{wt(!0),_t(b)},style:{color:tt},children:b}),jsxRuntimeExports.jsxs("div",{className:"text-xs text-gray-500 truncate",children:[c.slice(0,12),"..."]})]}),jsxRuntimeExports.jsx("div",{className:`w-2 h-2 rounded-full ${o?"bg-green-500":"bg-red-500"}`})]})})]}),jsxRuntimeExports.jsxs("div",{className:"flex-1 flex flex-col",children:[jsxRuntimeExports.jsxs("div",{className:"h-12 bg-[#111] border-b border-[#1a5a5a]/30 flex items-center justify-between px-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("span",{className:"text-gray-500",children:"#"}),jsxRuntimeExports.jsx("span",{className:"font-medium",children:it})]}),jsxRuntimeExports.jsx("div",{className:"flex items-center gap-2",children:jsxRuntimeExports.jsx("button",{onClick:()=>St(!xt),className:`p-2 rounded transition-colors ${xt?"bg-[#1a5a5a]/50":"hover:bg-[#1a1a1a]"}`,title:"Toggle user list",children:""})})]}),jsxRuntimeExports.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[jsxRuntimeExports.jsxs("div",{className:"flex-1 flex flex-col",children:[jsxRuntimeExports.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[at.length===0?jsxRuntimeExports.jsxs("div",{className:"text-center text-gray-500 py-8",children:[jsxRuntimeExports.jsx("div",{className:"text-4xl mb-2",children:""}),jsxRuntimeExports.jsx("p",{children:"No messages yet. Be the first to say something!"})]}):at.map(Pt=>jsxRuntimeExports.jsx("div",{className:`flex gap-3 ${Pt.userId==="system"?"justify-center":""}`,children:Pt.userId==="system"?jsxRuntimeExports.jsx("div",{className:"text-xs text-gray-500 italic",children:Pt.content}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"w-10 h-10 rounded-full flex-shrink-0 flex items-center justify-center font-bold",style:{backgroundColor:Pt.color},children:Pt.username.charAt(0).toUpperCase()}),jsxRuntimeExports.jsxs("div",{className:"flex-1 min-w-0",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-baseline gap-2",children:[jsxRuntimeExports.jsx("span",{className:"font-medium",style:{color:Pt.color},children:Pt.username}),jsxRuntimeExports.jsx("span",{className:"text-xs text-gray-500",children:Gt(Pt.timestamp)})]}),jsxRuntimeExports.jsx("p",{className:"text-gray-200 break-words whitespace-pre-wrap",children:Pt.content})]})]})},Pt.id)),jsxRuntimeExports.jsx("div",{ref:Mt})]}),ht.length>0&&jsxRuntimeExports.jsxs("div",{className:"px-4 py-1 text-xs text-gray-500",children:[ht.join(", ")," ",ht.length===1?"is":"are"," typing..."]}),jsxRuntimeExports.jsx("div",{className:"p-4 border-t border-[#1a5a5a]/30",children:jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[jsxRuntimeExports.jsx("input",{type:"text",value:dt,onChange:Pt=>{lt(Pt.target.value),Ht()},onKeyDown:Ot,placeholder:`Message #${it}`,className:"flex-1 bg-[#1a1a1a] text-white px-4 py-3 rounded-lg border border-[#1a5a5a]/30 focus:outline-none focus:border-[#1a5a5a] placeholder-gray-500",disabled:!o}),jsxRuntimeExports.jsx("button",{onClick:kt,disabled:!o||!dt.trim(),className:"px-4 py-2 bg-[#1a5a5a] hover:bg-[#1a6a6a] disabled:opacity-50 disabled:cursor-not-allowed text-white rounded-lg font-medium transition-colors",children:"Send"})]})})]}),xt&&jsxRuntimeExports.jsx("div",{className:"w-56 bg-[#111] border-l border-[#1a5a5a]/30 overflow-y-auto",children:jsxRuntimeExports.jsxs("div",{className:"p-3",children:[jsxRuntimeExports.jsxs("div",{className:"text-xs text-gray-500 uppercase tracking-wide mb-2",children:["Online  ",ut.length]}),jsxRuntimeExports.jsx("div",{className:"space-y-1",children:ut.map(Pt=>jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 py-1 px-2 rounded hover:bg-[#1a1a1a]",children:[jsxRuntimeExports.jsxs("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold relative",style:{backgroundColor:Pt.color},children:[Pt.username.charAt(0).toUpperCase(),jsxRuntimeExports.jsx("div",{className:"absolute bottom-0 right-0 w-3 h-3 bg-green-500 rounded-full border-2 border-[#111]"})]}),jsxRuntimeExports.jsxs("span",{className:"text-sm truncate",style:{color:Pt.color},children:[Pt.username,Pt.id===c&&jsxRuntimeExports.jsx("span",{className:"text-gray-500 ml-1",children:"(you)"})]})]},Pt.id))})]})})]})]})]})},VideoEditor=()=>{const[o,e]=reactExports.useState([{id:"video-1",name:"Video 1",type:"video",clips:[]},{id:"video-2",name:"Video 2",type:"video",clips:[]},{id:"audio-1",name:"Audio 1",type:"audio",clips:[]}]),[s,a]=reactExports.useState(0),[c,d]=reactExports.useState(60),[b,_e]=reactExports.useState(!1),[tt,nt]=reactExports.useState(1),[it,ot]=reactExports.useState([]),[at,ct]=reactExports.useState(null),[ut,ft]=reactExports.useState("Untitled Project"),[dt,lt]=reactExports.useState("1920x1080"),[ht,mt]=reactExports.useState("30");reactExports.useRef(null);const xt=reactExports.useRef(null),St=reactExports.useRef(),yt=reactExports.useRef(0);reactExports.useEffect(()=>{if(b){yt.current=performance.now();const Pt=Wt=>{const sn=(Wt-yt.current)/1e3;yt.current=Wt,a(Bt=>{const tn=Bt+sn;return tn>=c?(_e(!1),0):tn}),St.current=requestAnimationFrame(Pt)};St.current=requestAnimationFrame(Pt)}else St.current&&cancelAnimationFrame(St.current);return()=>{St.current&&cancelAnimationFrame(St.current)}},[b,c]);const wt=()=>{var Pt;(Pt=xt.current)==null||Pt.click()},Et=async Pt=>{const Wt=Pt.target.files;if(Wt)for(const sn of Array.from(Wt)){const Bt=URL.createObjectURL(sn),tn=sn.type.startsWith("video")?"video":sn.type.startsWith("audio")?"audio":"image";let cn=5;(tn==="video"||tn==="audio")&&(cn=await _t(Bt,tn)),ot(vn=>[...vn,{id:Date.now().toString()+Math.random(),name:sn.name,type:tn,src:Bt,duration:cn}])}},_t=(Pt,Wt)=>new Promise(sn=>{const Bt=Wt==="video"?document.createElement("video"):document.createElement("audio");Bt.src=Pt,Bt.onloadedmetadata=()=>{sn(Bt.duration||5)},Bt.onerror=()=>sn(5)}),vt=(Pt,Wt)=>{Pt.dataTransfer.setData("mediaId",Wt.id)},Mt=(Pt,Wt)=>{Pt.preventDefault();const sn=Pt.dataTransfer.getData("mediaId"),Bt=it.find(Bn=>Bn.id===sn);if(!Bt||!o.find(Bn=>Bn.id===Wt))return;const cn=Pt.currentTarget.getBoundingClientRect(),vn=Pt.clientX-cn.left,On=Math.max(0,vn/(20*tt)),rr={id:Date.now().toString(),name:Bt.name,type:Bt.type,duration:Bt.duration,startTime:On,src:Bt.src,track:parseInt(Wt.split("-")[1])};e(Bn=>Bn.map(gn=>gn.id===Wt?{...gn,clips:[...gn.clips,rr]}:gn));const Wn=Math.max(...o.flatMap(Bn=>Bn.clips.map(gn=>gn.startTime+gn.duration)),On+Bt.duration);Wn>c&&d(Math.ceil(Wn/10)*10)},jt=Pt=>{Pt.preventDefault()},Lt=()=>{_e(!b)},Nt=()=>{_e(!1),a(0)},kt=Pt=>{const Wt=Math.floor(Pt/60),sn=Math.floor(Pt%60),Bt=Math.floor(Pt%1*parseInt(ht));return`${Wt.toString().padStart(2,"0")}:${sn.toString().padStart(2,"0")}:${Bt.toString().padStart(2,"0")}`},Ot=Pt=>{const Wt=Pt.currentTarget.getBoundingClientRect(),sn=Pt.clientX-Wt.left-80,Bt=Math.max(0,Math.min(c,sn/(20*tt)));a(Bt)},Ht=()=>{at&&(e(Pt=>Pt.map(Wt=>({...Wt,clips:Wt.clips.filter(sn=>sn.id!==at)}))),ct(null))},Ct=()=>{const Pt={project:ut,resolution:dt,frameRate:parseInt(ht),duration:c,tracks:o.map(tn=>({name:tn.name,type:tn.type,clips:tn.clips.map(cn=>({name:cn.name,type:cn.type,startTime:cn.startTime,duration:cn.duration}))}))},Wt=new Blob([JSON.stringify(Pt,null,2)],{type:"application/json"}),sn=URL.createObjectURL(Wt),Bt=document.createElement("a");Bt.href=sn,Bt.download=`${ut.replace(/\s+/g,"_")}.json`,Bt.click(),URL.revokeObjectURL(sn)},Ut=Pt=>{const Wt=o.filter(sn=>sn.type===Pt).length+1;e(sn=>[...sn,{id:`${Pt}-${Wt}`,name:`${Pt.charAt(0).toUpperCase()+Pt.slice(1)} ${Wt}`,type:Pt,clips:[]}])},Gt=o.flatMap(Pt=>Pt.clips.filter(Wt=>s>=Wt.startTime&&s<Wt.startTime+Wt.duration));return jsxRuntimeExports.jsxs("div",{className:"flex flex-col h-full bg-[#0a0a0a] text-white select-none",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-[#1a1a1a] border-b border-[#1a5a5a]",children:[jsxRuntimeExports.jsx("button",{onClick:wt,className:"px-3 py-1.5 text-xs bg-[#1a5a5a] hover:bg-[#1a6a6a] rounded flex items-center gap-1 transition-colors",children:" Import"}),jsxRuntimeExports.jsx("button",{onClick:Ct,className:"px-3 py-1.5 text-xs bg-[#c9a227] hover:bg-[#d9b237] text-black rounded flex items-center gap-1 font-bold transition-colors",children:" Export Project"}),jsxRuntimeExports.jsx("button",{onClick:()=>Ut("video"),className:"px-3 py-1.5 text-xs bg-[#252525] hover:bg-[#353535] rounded transition-colors",children:"+ Video Track"}),jsxRuntimeExports.jsx("button",{onClick:()=>Ut("audio"),className:"px-3 py-1.5 text-xs bg-[#252525] hover:bg-[#353535] rounded transition-colors",children:"+ Audio Track"}),at&&jsxRuntimeExports.jsx("button",{onClick:Ht,className:"px-3 py-1.5 text-xs bg-red-600/80 hover:bg-red-600 rounded transition-colors",children:" Delete Clip"}),jsxRuntimeExports.jsx("div",{className:"flex-1"}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[jsxRuntimeExports.jsx("span",{className:"text-gray-400",children:"Zoom:"}),jsxRuntimeExports.jsx("input",{type:"range",min:"0.5",max:"3",step:"0.1",value:tt,onChange:Pt=>nt(parseFloat(Pt.target.value)),className:"w-20 accent-[#1a5a5a]"}),jsxRuntimeExports.jsxs("span",{className:"text-[#c9a227]",children:[Math.round(tt*100),"%"]})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[jsxRuntimeExports.jsxs("div",{className:"w-48 bg-[#151515] border-r border-[#1a5a5a] flex flex-col",children:[jsxRuntimeExports.jsx("div",{className:"p-2 border-b border-[#1a5a5a] text-xs font-bold text-[#c9a227]",children:"Media Library"}),jsxRuntimeExports.jsx("div",{className:"flex-1 overflow-y-auto p-2 space-y-1",children:it.length===0?jsxRuntimeExports.jsx("div",{className:"text-gray-500 text-xs text-center py-4",children:"Click Import to add media files"}):it.map(Pt=>jsxRuntimeExports.jsxs("div",{className:"p-2 bg-[#1a1a1a] rounded text-xs cursor-grab hover:bg-[#252525] flex items-center gap-2 border border-[#1a5a5a]/30 transition-colors",draggable:!0,onDragStart:Wt=>vt(Wt,Pt),children:[jsxRuntimeExports.jsx("span",{children:Pt.type==="video"?"":Pt.type==="audio"?"":""}),jsxRuntimeExports.jsxs("div",{className:"flex-1 min-w-0",children:[jsxRuntimeExports.jsx("div",{className:"truncate",children:Pt.name}),jsxRuntimeExports.jsx("div",{className:"text-gray-500",children:kt(Pt.duration).slice(0,5)})]})]},Pt.id))})]}),jsxRuntimeExports.jsxs("div",{className:"flex-1 flex flex-col",children:[jsxRuntimeExports.jsxs("div",{className:"flex-1 flex",children:[jsxRuntimeExports.jsxs("div",{className:"flex-1 bg-black flex items-center justify-center relative",children:[Gt.length>0?jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("div",{className:"text-6xl mb-4",children:Gt[0].type==="video"?"":Gt[0].type==="audio"?"":""}),jsxRuntimeExports.jsx("div",{className:"text-xl text-white",children:Gt[0].name}),jsxRuntimeExports.jsxs("div",{className:"text-sm text-gray-400 mt-2",children:["Playing: ",kt(s-Gt[0].startTime)," / ",kt(Gt[0].duration)]})]}):jsxRuntimeExports.jsxs("div",{className:"text-gray-500 text-center",children:[jsxRuntimeExports.jsx("div",{className:"text-4xl mb-2",children:""}),jsxRuntimeExports.jsx("div",{children:"Drag media to timeline to preview"})]}),jsxRuntimeExports.jsx("div",{className:"absolute bottom-4 left-4 text-sm font-mono text-[#c9a227]",children:kt(s)})]}),jsxRuntimeExports.jsxs("div",{className:"w-64 bg-[#151515] border-l border-[#1a5a5a] p-3",children:[jsxRuntimeExports.jsx("div",{className:"text-xs font-bold text-[#c9a227] mb-3",children:"Project Properties"}),jsxRuntimeExports.jsxs("div",{className:"space-y-3 text-xs",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"text-gray-400",children:"Name"}),jsxRuntimeExports.jsx("input",{value:ut,onChange:Pt=>ft(Pt.target.value),className:"w-full mt-1 px-2 py-1 bg-[#0a0a0a] rounded border border-[#1a5a5a] text-white"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"text-gray-400",children:"Duration"}),jsxRuntimeExports.jsx("div",{className:"text-white mt-1 font-mono",children:kt(c)})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"text-gray-400",children:"Resolution"}),jsxRuntimeExports.jsxs("select",{value:dt,onChange:Pt=>lt(Pt.target.value),className:"w-full mt-1 px-2 py-1 bg-[#0a0a0a] rounded border border-[#1a5a5a] text-white",children:[jsxRuntimeExports.jsx("option",{children:"1920x1080 (1080p)"}),jsxRuntimeExports.jsx("option",{children:"1280x720 (720p)"}),jsxRuntimeExports.jsx("option",{children:"3840x2160 (4K)"})]})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"text-gray-400",children:"Frame Rate"}),jsxRuntimeExports.jsxs("select",{value:ht,onChange:Pt=>mt(Pt.target.value),className:"w-full mt-1 px-2 py-1 bg-[#0a0a0a] rounded border border-[#1a5a5a] text-white",children:[jsxRuntimeExports.jsx("option",{value:"30",children:"30 fps"}),jsxRuntimeExports.jsx("option",{value:"24",children:"24 fps"}),jsxRuntimeExports.jsx("option",{value:"60",children:"60 fps"})]})]}),jsxRuntimeExports.jsxs("div",{className:"pt-2 border-t border-[#1a5a5a]",children:[jsxRuntimeExports.jsxs("div",{className:"text-gray-400",children:["Tracks: ",o.length]}),jsxRuntimeExports.jsxs("div",{className:"text-gray-400",children:["Clips: ",o.reduce((Pt,Wt)=>Pt+Wt.clips.length,0)]})]})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"h-56 bg-[#1a1a1a] border-t border-[#1a5a5a] flex flex-col",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3 px-3 py-2 border-b border-[#1a5a5a]",children:[jsxRuntimeExports.jsx("button",{onClick:()=>a(0),className:"hover:text-[#c9a227] transition-colors text-lg",children:""}),jsxRuntimeExports.jsx("button",{onClick:Lt,className:"text-2xl hover:text-[#c9a227] transition-colors",children:b?"":""}),jsxRuntimeExports.jsx("button",{onClick:Nt,className:"hover:text-[#c9a227] transition-colors text-lg",children:""}),jsxRuntimeExports.jsx("button",{onClick:()=>a(c),className:"hover:text-[#c9a227] transition-colors text-lg",children:""}),jsxRuntimeExports.jsxs("div",{className:"text-sm font-mono",children:[jsxRuntimeExports.jsx("span",{className:"text-[#c9a227]",children:kt(s)}),jsxRuntimeExports.jsxs("span",{className:"text-gray-500",children:[" / ",kt(c)]})]}),jsxRuntimeExports.jsx("div",{className:"flex-1"}),jsxRuntimeExports.jsx("div",{className:`text-xs px-2 py-1 rounded ${b?"bg-red-600":"bg-[#252525]"}`,children:b?" REC":" READY"})]}),jsxRuntimeExports.jsx("div",{className:"flex-1 overflow-auto",onClick:Ot,children:jsxRuntimeExports.jsxs("div",{className:"relative min-w-max",style:{width:`${Math.max(c*20*tt+80,100)}px`},children:[jsxRuntimeExports.jsxs("div",{className:"h-6 bg-[#0a0a0a] border-b border-[#1a5a5a] flex items-end sticky top-0 z-10",children:[jsxRuntimeExports.jsx("div",{className:"w-20"}),Array.from({length:Math.ceil(c/5)+1}).map((Pt,Wt)=>jsxRuntimeExports.jsx("div",{className:"absolute text-[10px] text-gray-500",style:{left:80+Wt*5*20*tt},children:kt(Wt*5).slice(0,5)},Wt))]}),jsxRuntimeExports.jsx("div",{className:"absolute top-0 w-0.5 bg-[#c9a227] h-full z-20 pointer-events-none",style:{left:80+s*20*tt},children:jsxRuntimeExports.jsx("div",{className:"absolute -top-0 -left-2 w-4 h-4 bg-[#c9a227] transform rotate-45"})}),o.map(Pt=>jsxRuntimeExports.jsxs("div",{className:"h-14 border-b border-[#1a5a5a]/50 relative flex items-center",onDrop:Wt=>Mt(Wt,Pt.id),onDragOver:jt,children:[jsxRuntimeExports.jsxs("div",{className:"absolute left-0 w-20 h-full bg-[#151515] flex items-center px-2 text-xs border-r border-[#1a5a5a] z-20",children:[jsxRuntimeExports.jsx("span",{className:"mr-1",children:Pt.type==="video"?"":""}),jsxRuntimeExports.jsx("span",{className:"truncate",children:Pt.name})]}),jsxRuntimeExports.jsx("div",{className:"ml-20 h-full relative flex-1",children:Pt.clips.map(Wt=>jsxRuntimeExports.jsxs("div",{className:`absolute h-10 top-2 rounded px-2 flex items-center text-xs truncate cursor-pointer transition-all ${at===Wt.id?"ring-2 ring-[#c9a227] bg-[#1a6a6a]":"bg-[#1a5a5a] hover:bg-[#1a6a6a]"}`,style:{left:Wt.startTime*20*tt,width:Math.max(Wt.duration*20*tt,40)},onClick:sn=>{sn.stopPropagation(),ct(Wt.id)},children:[jsxRuntimeExports.jsx("span",{className:"mr-1",children:Wt.type==="video"?"":Wt.type==="audio"?"":""}),Wt.name]},Wt.id))})]},Pt.id))]})})]})]})]}),jsxRuntimeExports.jsx("input",{ref:xt,type:"file",accept:"video/*,audio/*,image/*",multiple:!0,className:"hidden",onChange:Et}),jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between px-3 py-1 bg-[#1a5a5a] text-xs",children:[jsxRuntimeExports.jsx("span",{children:b?"Playing...":"Ready"}),jsxRuntimeExports.jsx("span",{className:"text-[#c9a227] font-bold",children:"Grudge Studio Video Editor"}),jsxRuntimeExports.jsxs("span",{children:[dt," @ ",ht,"fps"]})]})]})},DEFAULT_HOTKEYS=[{id:"file-manager",name:"Open File Manager",description:"Opens the file explorer",key:"e",ctrl:!0,shift:!1,alt:!1,action:"FileManager"},{id:"notepad",name:"New Notepad",description:"Opens a new text editor",key:"n",ctrl:!0,shift:!1,alt:!1,action:"TextEditor"},{id:"treaty-chat",name:"Open Treaty Chat",description:"Opens the messaging app",key:"t",ctrl:!0,shift:!0,alt:!1,action:"TreatyChat"},{id:"code-editor",name:"Open Code Editor",description:"Opens the code editor",key:"`",ctrl:!0,shift:!1,alt:!1,action:"CodeEditor"},{id:"calculator",name:"Open Calculator",description:"Opens the calculator",key:"c",ctrl:!0,shift:!0,alt:!1,action:"Calculator"},{id:"game-forge",name:"Open GameForge",description:"Opens the game editor",key:"g",ctrl:!0,shift:!0,alt:!1,action:"GameForge"}],HOTKEY_STORAGE_KEY$1="grudge_studio_hotkeys",HotkeyEditor=()=>{const[o,e]=reactExports.useState(DEFAULT_HOTKEYS),[s,a]=reactExports.useState(null),[c,d]=reactExports.useState(!1),[b,_e]=reactExports.useState({}),[tt,nt]=reactExports.useState(""),[it,ot]=reactExports.useState(!1);reactExports.useEffect(()=>{at()},[]);const at=async()=>{try{if(typeof puter<"u"&&puter.kv){const St=await puter.kv.get(HOTKEY_STORAGE_KEY$1);St&&e(JSON.parse(St))}else{const St=localStorage.getItem(HOTKEY_STORAGE_KEY$1);St&&e(JSON.parse(St))}}catch{console.log("Using default hotkeys")}},ct=async()=>{try{const St=JSON.stringify(o);typeof puter<"u"&&puter.kv?await puter.kv.set(HOTKEY_STORAGE_KEY$1,St):localStorage.setItem(HOTKEY_STORAGE_KEY$1,St),ot(!1),window.dispatchEvent(new CustomEvent("hotkeysUpdated",{detail:o}))}catch(St){console.error("Failed to save hotkeys:",St)}},ut=()=>{e(DEFAULT_HOTKEYS),ot(!0)},ft=St=>{a(St.id),_e({...St}),d(!1)},dt=()=>{a(null),_e({}),d(!1)},lt=()=>{!s||!b.key||(e(St=>St.map(yt=>yt.id===s?{...yt,...b}:yt)),ot(!0),a(null),_e({}))},ht=reactExports.useCallback(St=>{c&&(St.preventDefault(),St.stopPropagation(),!["Control","Shift","Alt","Meta"].includes(St.key)&&(_e(yt=>({...yt,key:St.key.length===1?St.key.toLowerCase():St.key,ctrl:St.ctrlKey||St.metaKey,shift:St.shiftKey,alt:St.altKey})),d(!1)))},[c]);reactExports.useEffect(()=>{if(c)return window.addEventListener("keydown",ht),()=>window.removeEventListener("keydown",ht)},[c,ht]);const mt=St=>{const yt=[];return St.ctrl&&yt.push("Ctrl"),St.shift&&yt.push("Shift"),St.alt&&yt.push("Alt"),St.key&&yt.push(St.key.toUpperCase()),yt.join(" + ")||"Not Set"},xt=o.filter(St=>St.name.toLowerCase().includes(tt.toLowerCase())||St.description.toLowerCase().includes(tt.toLowerCase()));return jsxRuntimeExports.jsxs("div",{className:"flex flex-col h-full bg-[#1e1e1e] text-white",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-[#252526] border-b border-[#3c3c3c]",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("span",{className:"text-2xl",children:""}),jsxRuntimeExports.jsx("h1",{className:"text-lg font-semibold text-[#c9a227]",children:"Keyboard Shortcuts"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("button",{onClick:ut,className:"px-3 py-1.5 text-sm bg-[#3c3c3c] hover:bg-[#4c4c4c] rounded transition-colors",children:"Reset to Defaults"}),jsxRuntimeExports.jsx("button",{onClick:ct,disabled:!it,className:`px-4 py-1.5 text-sm rounded transition-colors ${it?"bg-[#1a5a5a] hover:bg-[#1a6a6a] text-white":"bg-[#2a2a2a] text-gray-500 cursor-not-allowed"}`,children:"Save Changes"})]})]}),jsxRuntimeExports.jsx("div",{className:"px-4 py-3 border-b border-[#3c3c3c]",children:jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx("input",{type:"text",placeholder:"Search shortcuts...",value:tt,onChange:St=>nt(St.target.value),className:"w-full px-4 py-2 pl-10 bg-[#3c3c3c] border border-[#4c4c4c] rounded text-sm focus:outline-none focus:border-[#1a5a5a]"}),jsxRuntimeExports.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",children:""})]})}),jsxRuntimeExports.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[jsxRuntimeExports.jsx("div",{className:"space-y-2",children:xt.map(St=>{var yt;return jsxRuntimeExports.jsx("div",{className:`p-4 rounded-lg border transition-colors ${s===St.id?"bg-[#1a5a5a]/20 border-[#1a5a5a]":"bg-[#2d2d2d] border-[#3c3c3c] hover:border-[#4c4c4c]"}`,children:s===St.id?jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsx("span",{className:"font-medium text-[#c9a227]",children:St.name}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[jsxRuntimeExports.jsx("button",{onClick:dt,className:"px-3 py-1 text-sm bg-[#3c3c3c] hover:bg-[#4c4c4c] rounded",children:"Cancel"}),jsxRuntimeExports.jsx("button",{onClick:lt,className:"px-3 py-1 text-sm bg-[#1a5a5a] hover:bg-[#1a6a6a] rounded",children:"Apply"})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[jsxRuntimeExports.jsx("input",{type:"checkbox",checked:b.ctrl||!1,onChange:wt=>_e(Et=>({...Et,ctrl:wt.target.checked})),className:"w-4 h-4 accent-[#1a5a5a]"}),jsxRuntimeExports.jsx("span",{className:"text-sm",children:"Ctrl"})]}),jsxRuntimeExports.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[jsxRuntimeExports.jsx("input",{type:"checkbox",checked:b.shift||!1,onChange:wt=>_e(Et=>({...Et,shift:wt.target.checked})),className:"w-4 h-4 accent-[#1a5a5a]"}),jsxRuntimeExports.jsx("span",{className:"text-sm",children:"Shift"})]}),jsxRuntimeExports.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[jsxRuntimeExports.jsx("input",{type:"checkbox",checked:b.alt||!1,onChange:wt=>_e(Et=>({...Et,alt:wt.target.checked})),className:"w-4 h-4 accent-[#1a5a5a]"}),jsxRuntimeExports.jsx("span",{className:"text-sm",children:"Alt"})]})]}),jsxRuntimeExports.jsx("div",{className:"flex-1",children:jsxRuntimeExports.jsx("button",{onClick:()=>d(!0),className:`px-4 py-2 rounded border text-sm w-full ${c?"bg-[#c9a227]/20 border-[#c9a227] text-[#c9a227] animate-pulse":"bg-[#3c3c3c] border-[#4c4c4c] hover:bg-[#4c4c4c]"}`,children:c?"Press a key...":`Key: ${((yt=b.key)==null?void 0:yt.toUpperCase())||"Click to set"}`})})]}),jsxRuntimeExports.jsxs("div",{className:"text-sm text-gray-400",children:["Preview: ",jsxRuntimeExports.jsx("span",{className:"text-white font-mono bg-[#3c3c3c] px-2 py-1 rounded",children:mt(b)})]})]}):jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsx("div",{className:"font-medium",children:St.name}),jsxRuntimeExports.jsx("div",{className:"text-sm text-gray-400",children:St.description})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4",children:[jsxRuntimeExports.jsx("div",{className:"font-mono text-sm bg-[#3c3c3c] px-3 py-1.5 rounded border border-[#4c4c4c]",children:mt(St)}),jsxRuntimeExports.jsx("button",{onClick:()=>ft(St),className:"px-3 py-1.5 text-sm bg-[#3c3c3c] hover:bg-[#4c4c4c] rounded transition-colors",children:"Edit"})]})]})},St.id)})}),xt.length===0&&jsxRuntimeExports.jsxs("div",{className:"text-center text-gray-400 py-8",children:['No shortcuts found matching "',tt,'"']})]}),jsxRuntimeExports.jsxs("div",{className:"px-4 py-3 bg-[#1a5a5a] text-xs flex items-center justify-between",children:[jsxRuntimeExports.jsx("span",{children:'Click "Edit" to customize a shortcut, then press any key combination'}),jsxRuntimeExports.jsx("span",{className:"text-[#c9a227]",children:"Grudge Studio"})]})]})},GrudaVisualCode=()=>{const{readFile:o,writeFile:e,listDir:s,mkdir:a,isReady:c}=useFileSystem(),[d,b]=reactExports.useState([]),[_e,tt]=reactExports.useState(null),[nt,it]=reactExports.useState([]),[ot,at]=reactExports.useState(!1),[ct,ut]=reactExports.useState(["GRUDA VISUAL CODE v1.0","> Ready"]),[ft,dt]=reactExports.useState(220);reactExports.useEffect(()=>{c&&lt()},[c]);const lt=async()=>{try{const jt=(await s("/")).map(Lt=>({name:Lt.name,path:Lt.path,type:Lt.type==="directory"?"folder":"file",isOpen:!1}));it(jt.length>0?jt:ht())}catch{it(ht())}},ht=()=>[{name:"src",path:"/src",type:"folder",isOpen:!0,children:[{name:"main.ts",path:"/src/main.ts",type:"file"},{name:"app.tsx",path:"/src/app.tsx",type:"file"},{name:"styles.css",path:"/src/styles.css",type:"file"}]},{name:"package.json",path:"/package.json",type:"file"},{name:"README.md",path:"/README.md",type:"file"}],mt=reactExports.useCallback(async Mt=>{if(Mt.type==="folder")return;const jt=d.find(kt=>kt.path===Mt.path);if(jt){tt(jt.id);return}let Lt="";try{const kt=await o(Mt.path);Lt=typeof kt=="string"?kt:new TextDecoder().decode(kt)}catch{Lt=xt(Mt.name)}const Nt={id:`tab-${Date.now()}`,name:Mt.name,path:Mt.path,content:Lt,isDirty:!1};b(kt=>[...kt,Nt]),tt(Nt.id)},[d,o]),xt=Mt=>Mt.endsWith(".ts")||Mt.endsWith(".tsx")?`// ${Mt}

export function main() {
  console.log("Hello from Grudge Studio!");
}
`:Mt.endsWith(".css")?`/* ${Mt} */

:root {
  --primary: #1a5a5a;
  --accent: #c9a227;
}
`:Mt==="package.json"?JSON.stringify({name:"grudge-project",version:"1.0.0"},null,2):`# ${Mt}

Welcome to Grudge Studio!`,St=reactExports.useCallback((Mt,jt)=>{var Lt;jt==null||jt.stopPropagation(),b(Nt=>Nt.filter(kt=>kt.id!==Mt)),_e===Mt&&tt(((Lt=d.find(Nt=>Nt.id!==Mt))==null?void 0:Lt.id)||null)},[_e,d]),yt=reactExports.useCallback((Mt,jt)=>{b(Lt=>Lt.map(Nt=>Nt.id===Mt?{...Nt,content:jt,isDirty:!0}:Nt))},[]),wt=reactExports.useCallback(async Mt=>{const jt=d.find(Lt=>Lt.id===Mt);if(jt)try{await e(jt.path,jt.content),b(Lt=>Lt.map(Nt=>Nt.id===Mt?{...Nt,isDirty:!1}:Nt)),ut(Lt=>[...Lt,`> Saved: ${jt.name}`])}catch{ut(Nt=>[...Nt,`> Error saving ${jt.name}`])}},[d,e]);reactExports.useEffect(()=>{const Mt=jt=>{(jt.ctrlKey||jt.metaKey)&&jt.key==="s"&&(jt.preventDefault(),_e&&wt(_e))};return window.addEventListener("keydown",Mt),()=>window.removeEventListener("keydown",Mt)},[_e,wt]);const Et=d.find(Mt=>Mt.id===_e),_t=(Mt,jt=0)=>Mt.map(Lt=>jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("div",{className:`flex items-center gap-2 px-2 py-1 cursor-pointer hover:bg-[#1a5a5a]/30 transition-colors text-sm ${(Et==null?void 0:Et.path)===Lt.path?"bg-[#1a5a5a]/50 text-[#c9a227]":"text-gray-300"}`,style:{paddingLeft:`${12+jt*16}px`},onClick:()=>{Lt.type==="folder"?it(Nt=>{const kt=Ot=>Ot.map(Ht=>Ht.path===Lt.path?{...Ht,isOpen:!Ht.isOpen}:{...Ht,children:Ht.children?kt(Ht.children):void 0});return kt(Nt)}):mt(Lt)},children:[jsxRuntimeExports.jsx("span",{className:"text-xs",children:Lt.type==="folder"?Lt.isOpen?"":"":vt(Lt.name)}),jsxRuntimeExports.jsx("span",{className:"truncate",children:Lt.name})]}),Lt.type==="folder"&&Lt.isOpen&&Lt.children&&jsxRuntimeExports.jsx("div",{children:_t(Lt.children,jt+1)})]},Lt.path)),vt=Mt=>Mt.endsWith(".ts")||Mt.endsWith(".tsx")?"":Mt.endsWith(".js")||Mt.endsWith(".jsx")?"":Mt.endsWith(".css")?"":Mt.endsWith(".json")?"":Mt.endsWith(".md")?"":"";return jsxRuntimeExports.jsxs("div",{className:"h-full flex flex-col bg-[#0a0a0a] text-white overflow-hidden",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between bg-gradient-to-r from-[#0a0a0a] to-[#1a1a1a] border-b border-[#1a5a5a]/50 px-4 py-2",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("span",{className:"text-xl",children:""}),jsxRuntimeExports.jsx("span",{className:"font-bold text-[#c9a227]",children:"GRUDA VISUAL CODE"})]}),jsxRuntimeExports.jsx("div",{className:"flex items-center gap-2",children:jsxRuntimeExports.jsx("button",{onClick:()=>at(!ot),className:`px-3 py-1 text-xs rounded transition-colors ${ot?"bg-[#1a5a5a] text-white":"bg-[#1a1a1a] text-gray-400 hover:text-white"}`,children:"Terminal"})})]}),jsxRuntimeExports.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[jsxRuntimeExports.jsxs("div",{className:"bg-[#0a0a0a] border-r border-[#1a5a5a]/50 overflow-y-auto",style:{width:ft},children:[jsxRuntimeExports.jsx("div",{className:"p-2 text-xs text-gray-500 uppercase font-bold border-b border-[#1a5a5a]/30",children:"Explorer"}),jsxRuntimeExports.jsx("div",{className:"py-1",children:_t(nt)})]}),jsxRuntimeExports.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[d.length>0&&jsxRuntimeExports.jsx("div",{className:"flex bg-[#0a0a0a] border-b border-[#1a5a5a]/30 overflow-x-auto",children:d.map(Mt=>jsxRuntimeExports.jsxs("div",{className:`flex items-center gap-2 px-4 py-2 cursor-pointer border-r border-[#1a5a5a]/30 text-sm transition-colors ${_e===Mt.id?"bg-[#1a1a1a] text-white border-t-2 border-t-[#c9a227]":"bg-[#0a0a0a] text-gray-500 hover:text-gray-300"}`,onClick:()=>tt(Mt.id),children:[jsxRuntimeExports.jsx("span",{children:vt(Mt.name)}),jsxRuntimeExports.jsx("span",{children:Mt.name}),Mt.isDirty&&jsxRuntimeExports.jsx("span",{className:"text-[#c9a227]",children:""}),jsxRuntimeExports.jsx("button",{onClick:jt=>St(Mt.id,jt),className:"ml-1 text-gray-600 hover:text-white text-xs",children:""})]},Mt.id))}),jsxRuntimeExports.jsx("div",{className:"flex-1 overflow-hidden",children:Et?jsxRuntimeExports.jsx("textarea",{value:Et.content,onChange:Mt=>yt(Et.id,Mt.target.value),className:"w-full h-full bg-[#0a0a0a] text-gray-200 p-4 resize-none outline-none font-mono text-sm leading-6",style:{tabSize:2},spellCheck:!1}):jsxRuntimeExports.jsx("div",{className:"flex items-center justify-center h-full text-gray-600",children:jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("div",{className:"text-6xl mb-4",children:""}),jsxRuntimeExports.jsx("div",{className:"text-xl font-bold text-[#c9a227]",children:"GRUDA VISUAL CODE"}),jsxRuntimeExports.jsx("div",{className:"text-sm mt-2",children:"Select a file to start editing"}),jsxRuntimeExports.jsx("div",{className:"text-xs text-gray-700 mt-4",children:"Ctrl+S to save"})]})})}),ot&&jsxRuntimeExports.jsxs("div",{className:"h-40 bg-[#0a0a0a] border-t border-[#1a5a5a]/50",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between bg-[#1a1a1a] px-3 py-1 border-b border-[#1a5a5a]/30",children:[jsxRuntimeExports.jsx("span",{className:"text-xs text-gray-400",children:"TERMINAL"}),jsxRuntimeExports.jsx("button",{onClick:()=>at(!1),className:"text-gray-600 hover:text-white text-xs",children:""})]}),jsxRuntimeExports.jsx("div",{className:"p-2 h-[calc(100%-28px)] overflow-y-auto font-mono text-xs text-green-400",children:ct.map((Mt,jt)=>jsxRuntimeExports.jsx("div",{children:Mt},jt))})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between bg-[#1a5a5a] px-4 py-1 text-xs",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4",children:[jsxRuntimeExports.jsx("span",{className:"text-[#c9a227]",children:" Ready"}),jsxRuntimeExports.jsxs("span",{className:"text-gray-300",children:[d.length," files open"]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4 text-gray-300",children:[jsxRuntimeExports.jsx("span",{children:"UTF-8"}),jsxRuntimeExports.jsx("span",{children:"LF"}),jsxRuntimeExports.jsx("span",{children:"TypeScript"})]})]})]})},SETTINGS_KEY="grudge_display_settings",defaultSettings={theme:"dark",accentColor:"#1a5a5a",fontSize:"medium",animationsEnabled:!0,transparency:100,desktopIconSize:"medium"},DisplaySettingsApp=()=>{const[o,e]=reactExports.useState(defaultSettings),[s,a]=reactExports.useState(!1);reactExports.useEffect(()=>{c()},[]);const c=async()=>{try{if(typeof puter<"u"&&puter.kv){const nt=await puter.kv.get(SETTINGS_KEY);nt&&e(JSON.parse(nt))}else{const nt=localStorage.getItem(SETTINGS_KEY);nt&&e(JSON.parse(nt))}}catch{console.log("Using default display settings")}},d=async()=>{try{const nt=JSON.stringify(o);typeof puter<"u"&&puter.kv?await puter.kv.set(SETTINGS_KEY,nt):localStorage.setItem(SETTINGS_KEY,nt),a(!0),setTimeout(()=>a(!1),2e3),b(o)}catch(nt){console.error("Failed to save settings:",nt)}},b=nt=>{const it=document.documentElement;it.style.setProperty("--accent-color",nt.accentColor),it.style.setProperty("--transparency",`${nt.transparency}%`);const ot={small:"14px",medium:"16px",large:"18px"};it.style.setProperty("--base-font-size",ot[nt.fontSize]),nt.animationsEnabled?it.style.removeProperty("--animation-duration"):it.style.setProperty("--animation-duration","0s"),window.dispatchEvent(new CustomEvent("displaySettingsChanged",{detail:nt}))},_e=()=>{e(defaultSettings)},tt=[{name:"Teal",value:"#1a5a5a"},{name:"Blue",value:"#2563eb"},{name:"Purple",value:"#7c3aed"},{name:"Green",value:"#059669"},{name:"Red",value:"#dc2626"},{name:"Orange",value:"#ea580c"},{name:"Pink",value:"#db2777"},{name:"Gold",value:"#c9a227"}];return jsxRuntimeExports.jsx("div",{className:"h-full bg-[#0a0a0a] text-white overflow-auto",children:jsxRuntimeExports.jsxs("div",{className:"p-4 space-y-6",children:[jsxRuntimeExports.jsxs("section",{className:"bg-[#1a1a1a] rounded-lg border border-[#1a5a5a] p-4",children:[jsxRuntimeExports.jsx("h2",{className:"text-[#c9a227] font-bold mb-4 flex items-center gap-2",children:" Theme"}),jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"text-sm text-gray-400 mb-2 block",children:"Color Theme"}),jsxRuntimeExports.jsx("div",{className:"flex gap-2",children:["dark","darker","midnight"].map(nt=>jsxRuntimeExports.jsx("button",{onClick:()=>e(it=>({...it,theme:nt})),className:`px-4 py-2 rounded capitalize transition-colors ${o.theme===nt?"bg-[#1a5a5a] text-white":"bg-[#252525] hover:bg-[#303030] text-gray-300"}`,children:nt},nt))})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"text-sm text-gray-400 mb-2 block",children:"Accent Color"}),jsxRuntimeExports.jsx("div",{className:"flex flex-wrap gap-2",children:tt.map(nt=>jsxRuntimeExports.jsx("button",{onClick:()=>e(it=>({...it,accentColor:nt.value})),className:`w-10 h-10 rounded-full border-2 transition-transform hover:scale-110 ${o.accentColor===nt.value?"border-white scale-110":"border-transparent"}`,style:{backgroundColor:nt.value},title:nt.name},nt.value))})]})]})]}),jsxRuntimeExports.jsxs("section",{className:"bg-[#1a1a1a] rounded-lg border border-[#1a5a5a] p-4",children:[jsxRuntimeExports.jsx("h2",{className:"text-[#c9a227] font-bold mb-4 flex items-center gap-2",children:" Display"}),jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"text-sm text-gray-400 mb-2 block",children:"Font Size"}),jsxRuntimeExports.jsx("div",{className:"flex gap-2",children:["small","medium","large"].map(nt=>jsxRuntimeExports.jsx("button",{onClick:()=>e(it=>({...it,fontSize:nt})),className:`px-4 py-2 rounded capitalize transition-colors ${o.fontSize===nt?"bg-[#1a5a5a] text-white":"bg-[#252525] hover:bg-[#303030] text-gray-300"}`,children:nt},nt))})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"text-sm text-gray-400 mb-2 block",children:"Desktop Icon Size"}),jsxRuntimeExports.jsx("div",{className:"flex gap-2",children:["small","medium","large"].map(nt=>jsxRuntimeExports.jsx("button",{onClick:()=>e(it=>({...it,desktopIconSize:nt})),className:`px-4 py-2 rounded capitalize transition-colors ${o.desktopIconSize===nt?"bg-[#1a5a5a] text-white":"bg-[#252525] hover:bg-[#303030] text-gray-300"}`,children:nt},nt))})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("label",{className:"text-sm text-gray-400 mb-2 block",children:["Window Transparency: ",o.transparency,"%"]}),jsxRuntimeExports.jsx("input",{type:"range",min:"50",max:"100",value:o.transparency,onChange:nt=>e(it=>({...it,transparency:parseInt(nt.target.value)})),className:"w-full accent-[#1a5a5a]"})]})]})]}),jsxRuntimeExports.jsxs("section",{className:"bg-[#1a1a1a] rounded-lg border border-[#1a5a5a] p-4",children:[jsxRuntimeExports.jsx("h2",{className:"text-[#c9a227] font-bold mb-4 flex items-center gap-2",children:" Effects"}),jsxRuntimeExports.jsx("div",{className:"space-y-4",children:jsxRuntimeExports.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[jsxRuntimeExports.jsx("input",{type:"checkbox",checked:o.animationsEnabled,onChange:nt=>e(it=>({...it,animationsEnabled:nt.target.checked})),className:"w-5 h-5 accent-[#1a5a5a] rounded"}),jsxRuntimeExports.jsx("span",{children:"Enable animations"})]})})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("button",{onClick:d,className:"px-6 py-2 bg-[#1a5a5a] hover:bg-[#1a6a6a] rounded font-bold transition-colors",children:s?" Saved!":"Save Settings"}),jsxRuntimeExports.jsx("button",{onClick:_e,className:"px-6 py-2 bg-[#252525] hover:bg-[#303030] rounded transition-colors",children:"Reset to Defaults"})]}),jsxRuntimeExports.jsx("div",{className:"text-xs text-gray-500 mt-4",children:"Settings are saved to your Puter cloud storage and sync across devices."})]})})},SystemMonitor=()=>{const{info:o,isReady:e}=useSystemInfo(),{processes:s,terminate:a}=useProcessManager(),{getStats:c,clear:d}=useCache(),b=nt=>{const it=Math.floor(nt/1e3),ot=Math.floor(it/60),at=Math.floor(ot/60),ct=Math.floor(at/24);return ct>0?`${ct}d ${at%24}h ${ot%60}m`:at>0?`${at}h ${ot%60}m ${it%60}s`:ot>0?`${ot}m ${it%60}s`:`${it}s`},_e=nt=>nt<1024?`${nt} B`:nt<1024*1024?`${(nt/1024).toFixed(1)} KB`:`${(nt/(1024*1024)).toFixed(1)} MB`;if(!e||!o)return jsxRuntimeExports.jsx("div",{className:"w-full h-full flex items-center justify-center",style:{background:"#0a0a0a"},children:jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-t-transparent rounded-full mx-auto mb-2",style:{borderColor:"#1a5a5a",borderTopColor:"transparent"}}),jsxRuntimeExports.jsx("p",{className:"text-gray-400",children:"Initializing System Monitor..."})]})});const tt=c();return jsxRuntimeExports.jsx("div",{className:"w-full h-full flex flex-col",style:{background:"#0a0a0a",color:"white"},children:jsxRuntimeExports.jsxs("div",{className:"flex-1 overflow-auto p-4 space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"rounded-lg p-4",style:{background:"#111",border:"1px solid #1a5a5a"},children:[jsxRuntimeExports.jsx("h3",{className:"text-sm font-bold mb-3",style:{color:"#c9a227"},children:"System Overview"}),jsxRuntimeExports.jsxs("div",{className:"space-y-2 text-sm",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between",children:[jsxRuntimeExports.jsx("span",{className:"text-gray-400",children:"Uptime"}),jsxRuntimeExports.jsx("span",{style:{color:"#1a5a5a"},children:b(o.uptime)})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between",children:[jsxRuntimeExports.jsx("span",{className:"text-gray-400",children:"Boot Time"}),jsxRuntimeExports.jsx("span",{className:"text-white",children:o.bootTime.toLocaleTimeString()})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between",children:[jsxRuntimeExports.jsx("span",{className:"text-gray-400",children:"Active Processes"}),jsxRuntimeExports.jsx("span",{style:{color:"#c9a227"},children:o.processes})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"rounded-lg p-4",style:{background:"#111",border:"1px solid #1a5a5a"},children:[jsxRuntimeExports.jsx("h3",{className:"text-sm font-bold mb-3",style:{color:"#c9a227"},children:"Memory & Cache"}),jsxRuntimeExports.jsxs("div",{className:"space-y-2 text-sm",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between",children:[jsxRuntimeExports.jsx("span",{className:"text-gray-400",children:"File Cache"}),jsxRuntimeExports.jsxs("span",{className:"text-white",children:[o.memoryCache," entries"]})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between",children:[jsxRuntimeExports.jsx("span",{className:"text-gray-400",children:"Data Cache"}),jsxRuntimeExports.jsxs("span",{className:"text-white",children:[tt.memoryEntries," entries"]})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between",children:[jsxRuntimeExports.jsx("span",{className:"text-gray-400",children:"Cache Size"}),jsxRuntimeExports.jsx("span",{style:{color:"#1a5a5a"},children:_e(tt.totalSize)})]}),jsxRuntimeExports.jsx("button",{onClick:()=>d(),className:"w-full mt-2 py-1 px-2 rounded text-xs transition-colors",style:{background:"#1a5a5a",color:"white"},children:"Clear Cache"})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"rounded-lg p-4",style:{background:"#111",border:"1px solid #1a5a5a"},children:[jsxRuntimeExports.jsx("h3",{className:"text-sm font-bold mb-3",style:{color:"#c9a227"},children:"Processes"}),s.length===0?jsxRuntimeExports.jsx("p",{className:"text-gray-500 text-sm text-center py-4",children:"No active processes"}):jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-5 gap-2 text-xs text-gray-500 pb-2 border-b border-gray-700",children:[jsxRuntimeExports.jsx("span",{children:"PID"}),jsxRuntimeExports.jsx("span",{className:"col-span-2",children:"Name"}),jsxRuntimeExports.jsx("span",{children:"State"}),jsxRuntimeExports.jsx("span",{children:"Action"})]}),s.map(nt=>jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-5 gap-2 text-sm items-center",children:[jsxRuntimeExports.jsx("span",{style:{color:"#1a5a5a"},children:nt.pid}),jsxRuntimeExports.jsx("span",{className:"col-span-2 text-white truncate",children:nt.name}),jsxRuntimeExports.jsx("span",{className:nt.state==="running"?"text-green-400":"text-yellow-400",children:nt.state}),jsxRuntimeExports.jsx("button",{onClick:()=>a(nt.pid),className:"px-2 py-0.5 rounded text-xs bg-red-600 hover:bg-red-700 transition-colors",children:"End"})]},nt.pid))]})]}),jsxRuntimeExports.jsxs("div",{className:"rounded-lg p-4",style:{background:"#111",border:"1px solid #c9a227"},children:[jsxRuntimeExports.jsx("h3",{className:"text-sm font-bold mb-3",style:{color:"#c9a227"},children:"Storage Tiers"}),jsxRuntimeExports.jsxs("div",{className:"space-y-3",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500"}),jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between text-sm",children:[jsxRuntimeExports.jsx("span",{className:"text-white",children:"Memory Cache"}),jsxRuntimeExports.jsx("span",{className:"text-green-400",children:"Active"})]}),jsxRuntimeExports.jsx("p",{className:"text-xs text-gray-500",children:"Fastest tier - in-memory data"})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-500"}),jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between text-sm",children:[jsxRuntimeExports.jsx("span",{className:"text-white",children:"IndexedDB"}),jsxRuntimeExports.jsx("span",{className:"text-blue-400",children:"Active"})]}),jsxRuntimeExports.jsx("p",{className:"text-xs text-gray-500",children:"Persistent local storage - files & data"})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:"w-3 h-3 rounded-full bg-yellow-500"}),jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between text-sm",children:[jsxRuntimeExports.jsx("span",{className:"text-white",children:"LocalStorage"}),jsxRuntimeExports.jsx("span",{className:"text-yellow-400",children:"Active"})]}),jsxRuntimeExports.jsx("p",{className:"text-xs text-gray-500",children:"Settings & preferences"})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:"w-3 h-3 rounded-full",style:{background:"#1a5a5a"}}),jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between text-sm",children:[jsxRuntimeExports.jsx("span",{className:"text-white",children:"Cloud Storage (Puter)"}),jsxRuntimeExports.jsx("span",{style:{color:"#1a5a5a"},children:typeof window<"u"&&window.puter?"Connected":"Offline"})]}),jsxRuntimeExports.jsx("p",{className:"text-xs text-gray-500",children:"Cross-device sync via Puter.js"})]})]})]})]})]})})},DebuggingAI=()=>{const[o,e]=reactExports.useState(""),[s,a]=reactExports.useState(""),[c,d]=reactExports.useState(""),[b,_e]=reactExports.useState(""),[tt,nt]=reactExports.useState(!1),[it,ot]=reactExports.useState("debug"),at=async()=>{if(o.trim()){nt(!0),_e("");try{const ft=await legionPro.debugCode({code:o,error:s||void 0,context:c||void 0});ft.success?_e(ft.data.analysis):_e(`Error: ${ft.error}`)}catch(ft){_e(`Error: ${String(ft)}`)}finally{nt(!1)}}},ct=async ft=>{if(o.trim()){nt(!0),_e("");try{const dt=await legionPro.analyzeCode({code:o,action:ft});dt.success?_e(dt.data.result):_e(`Error: ${dt.error}`)}catch(dt){_e(`Error: ${String(dt)}`)}finally{nt(!1)}}},ut=async()=>{if(c.trim()){nt(!0),_e("");try{const ft=await legionPro.generateCode({prompt:c,language:"javascript"});ft.success?_e(ft.data.code):_e(`Error: ${ft.error}`)}catch(ft){_e(`Error: ${String(ft)}`)}finally{nt(!1)}}};return jsxRuntimeExports.jsxs("div",{className:"w-full h-full flex flex-col",style:{background:"#0a0a0a",color:"white"},children:[jsxRuntimeExports.jsx("div",{className:"flex border-b",style:{borderColor:"#1a5a5a"},children:["debug","analyze","generate"].map(ft=>jsxRuntimeExports.jsxs("button",{onClick:()=>ot(ft),className:"px-4 py-2 text-sm font-medium transition-colors",style:{background:it===ft?"#1a5a5a":"transparent",color:it===ft?"white":"#888"},children:[ft==="debug"&&" Debug",ft==="analyze"&&" Analyze",ft==="generate"&&" Generate"]},ft))}),jsxRuntimeExports.jsxs("div",{className:"flex-1 overflow-auto p-4",children:[it==="debug"&&jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"text-sm mb-1 block",style:{color:"#c9a227"},children:"Code to Debug"}),jsxRuntimeExports.jsx("textarea",{value:o,onChange:ft=>e(ft.target.value),placeholder:"Paste your code here...",className:"w-full h-40 p-3 rounded font-mono text-sm resize-none",style:{background:"#111",border:"1px solid #1a5a5a",color:"white"}})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"text-sm mb-1 block",style:{color:"#c9a227"},children:"Error Message (optional)"}),jsxRuntimeExports.jsx("textarea",{value:s,onChange:ft=>a(ft.target.value),placeholder:"Paste any error messages...",className:"w-full h-20 p-3 rounded font-mono text-sm resize-none",style:{background:"#111",border:"1px solid #333",color:"white"}})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"text-sm mb-1 block",style:{color:"#c9a227"},children:"Context (optional)"}),jsxRuntimeExports.jsx("input",{value:c,onChange:ft=>d(ft.target.value),placeholder:"What should this code do?",className:"w-full p-3 rounded text-sm",style:{background:"#111",border:"1px solid #333",color:"white"}})]}),jsxRuntimeExports.jsx("button",{onClick:at,disabled:tt||!o.trim(),className:"px-4 py-2 rounded font-medium transition-colors disabled:opacity-50",style:{background:"#c9a227",color:"#0a0a0a"},children:tt?" Debugging...":" Debug Code"})]}),it==="analyze"&&jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"text-sm mb-1 block",style:{color:"#c9a227"},children:"Code to Analyze"}),jsxRuntimeExports.jsx("textarea",{value:o,onChange:ft=>e(ft.target.value),placeholder:"Paste your code here...",className:"w-full h-48 p-3 rounded font-mono text-sm resize-none",style:{background:"#111",border:"1px solid #1a5a5a",color:"white"}})]}),jsxRuntimeExports.jsxs("div",{className:"flex flex-wrap gap-2",children:[jsxRuntimeExports.jsx("button",{onClick:()=>ct("analyze"),disabled:tt||!o.trim(),className:"px-3 py-2 rounded text-sm transition-colors disabled:opacity-50",style:{background:"#1a5a5a",color:"white"},children:" Analyze"}),jsxRuntimeExports.jsx("button",{onClick:()=>ct("findBugs"),disabled:tt||!o.trim(),className:"px-3 py-2 rounded text-sm transition-colors disabled:opacity-50",style:{background:"#1a5a5a",color:"white"},children:" Find Bugs"}),jsxRuntimeExports.jsx("button",{onClick:()=>ct("optimize"),disabled:tt||!o.trim(),className:"px-3 py-2 rounded text-sm transition-colors disabled:opacity-50",style:{background:"#1a5a5a",color:"white"},children:" Optimize"}),jsxRuntimeExports.jsx("button",{onClick:()=>ct("addDocs"),disabled:tt||!o.trim(),className:"px-3 py-2 rounded text-sm transition-colors disabled:opacity-50",style:{background:"#1a5a5a",color:"white"},children:" Add Docs"})]})]}),it==="generate"&&jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"text-sm mb-1 block",style:{color:"#c9a227"},children:"Describe what you want"}),jsxRuntimeExports.jsx("textarea",{value:c,onChange:ft=>d(ft.target.value),placeholder:"Example: Create a function that validates email addresses...",className:"w-full h-32 p-3 rounded text-sm resize-none",style:{background:"#111",border:"1px solid #1a5a5a",color:"white"}})]}),jsxRuntimeExports.jsx("button",{onClick:ut,disabled:tt||!c.trim(),className:"px-4 py-2 rounded font-medium transition-colors disabled:opacity-50",style:{background:"#c9a227",color:"#0a0a0a"},children:tt?" Generating...":" Generate Code"})]}),b&&jsxRuntimeExports.jsxs("div",{className:"mt-4",children:[jsxRuntimeExports.jsx("label",{className:"text-sm mb-1 block",style:{color:"#c9a227"},children:"Result"}),jsxRuntimeExports.jsx("div",{className:"p-4 rounded font-mono text-sm whitespace-pre-wrap overflow-auto max-h-80",style:{background:"#111",border:"1px solid #1a5a5a"},children:b}),jsxRuntimeExports.jsx("button",{onClick:()=>navigator.clipboard.writeText(b),className:"mt-2 px-3 py-1 rounded text-sm",style:{background:"#333",color:"white"},children:" Copy"})]}),tt&&jsxRuntimeExports.jsxs("div",{className:"mt-4 flex items-center gap-2 text-gray-400",children:[jsxRuntimeExports.jsx("div",{className:"w-4 h-4 border-2 border-t-transparent rounded-full animate-spin",style:{borderColor:"#1a5a5a",borderTopColor:"transparent"}}),jsxRuntimeExports.jsx("span",{children:"Processing with AI..."})]})]})]})};class ExtensionSystem{constructor(){this.extensions=new Map,this.loadedModules=new Map,this.api=this.createAPI()}createAPI(){return{storage:{get:async e=>{try{const s=localStorage.getItem(`ext_${e}`);return s?JSON.parse(s):null}catch{return null}},set:async(e,s)=>{localStorage.setItem(`ext_${e}`,JSON.stringify(s))},delete:async e=>{localStorage.removeItem(`ext_${e}`)}},ui:{showNotification:(e,s="info")=>{console.log(`[Extension ${s}] ${e}`),window.dispatchEvent(new CustomEvent("extensionNotification",{detail:{message:e,type:s}}))},openWindow:(e,s,a={width:600,height:400})=>{window.dispatchEvent(new CustomEvent("openApp",{detail:s}))}},fs:{readFile:async e=>{try{return typeof puter<"u"&&(puter!=null&&puter.fs)?await puter.fs.read(e):null}catch{return null}},writeFile:async(e,s)=>{typeof puter<"u"&&(puter!=null&&puter.fs)&&await puter.fs.write(e,s)},listDir:async e=>{try{return typeof puter<"u"&&(puter!=null&&puter.fs)?(await puter.fs.readdir(e)).map(a=>a.name):[]}catch{return[]}}},ai:{chat:async e=>typeof puter<"u"&&(puter!=null&&puter.ai)?await puter.ai.chat(e):"AI unavailable",generateCode:async(e,s)=>typeof puter<"u"&&(puter!=null&&puter.ai)?await puter.ai.chat(`Generate ${s} code: ${e}`):"// AI unavailable"}}}async loadExtensions(){try{const e=localStorage.getItem("grudge_extensions");if(e&&JSON.parse(e).forEach(a=>this.extensions.set(a.id,a)),typeof puter<"u"&&(puter!=null&&puter.kv)){const s=await puter.kv.get("extensions");s&&JSON.parse(s).forEach(c=>{this.extensions.has(c.id)||this.extensions.set(c.id,c)})}console.log(`[ExtensionSystem] Loaded ${this.extensions.size} extensions`)}catch(e){console.warn("[ExtensionSystem] Error loading extensions:",e)}}async installExtension(e,s){const a={id:`ext_${Date.now()}_${Math.random().toString(36).slice(2,8)}`,name:e.name,version:e.version,author:e.author,description:e.description,category:e.category,icon:e.icon||"",entryPoint:s,permissions:e.permissions||[],enabled:!0,installed:new Date};return this.extensions.set(a.id,a),await this.saveExtensions(),console.log(`[ExtensionSystem] Installed: ${a.name}`),a}async uninstallExtension(e){return this.extensions.has(e)?(this.extensions.delete(e),this.loadedModules.delete(e),await this.saveExtensions(),!0):!1}async enableExtension(e){const s=this.extensions.get(e);return s?(s.enabled=!0,await this.saveExtensions(),!0):!1}async disableExtension(e){const s=this.extensions.get(e);return s?(s.enabled=!1,this.loadedModules.delete(e),await this.saveExtensions(),!0):!1}async saveExtensions(){const e=Array.from(this.extensions.values());localStorage.setItem("grudge_extensions",JSON.stringify(e)),typeof puter<"u"&&(puter!=null&&puter.kv)&&await puter.kv.set("extensions",JSON.stringify(e))}getExtensions(){return Array.from(this.extensions.values())}getEnabledExtensions(){return this.getExtensions().filter(e=>e.enabled)}getExtension(e){return this.extensions.get(e)}getAPI(){return this.api}async runExtension(e){const s=this.extensions.get(e);if(!s||!s.enabled)throw new Error("Extension not found or disabled");try{const c=new Function("api",s.entryPoint)(this.api);return this.loadedModules.set(e,c),c}catch(a){throw console.error(`[ExtensionSystem] Error running ${s.name}:`,a),a}}}const extensionSystem=new ExtensionSystem,ExtensionManager=()=>{const[o,e]=reactExports.useState([]),[s,a]=reactExports.useState(!1),[c,d]=reactExports.useState({name:"",version:"1.0.0",author:"",description:"",category:"utility"}),[b,_e]=reactExports.useState(""),[tt,nt]=reactExports.useState(!1);reactExports.useEffect(()=>{it()},[]);const it=async()=>{await extensionSystem.loadExtensions(),e(extensionSystem.getExtensions())},ot=async()=>{if(!(!c.name||!b.trim())){nt(!0);try{await extensionSystem.installExtension(c,b),e(extensionSystem.getExtensions()),a(!1),d({name:"",version:"1.0.0",author:"",description:"",category:"utility"}),_e("")}catch(dt){console.error("Install failed:",dt)}finally{nt(!1)}}},at=async dt=>{await extensionSystem.uninstallExtension(dt),e(extensionSystem.getExtensions())},ct=async(dt,lt)=>{lt?await extensionSystem.enableExtension(dt):await extensionSystem.disableExtension(dt),e(extensionSystem.getExtensions())},ut=async dt=>{try{await extensionSystem.runExtension(dt)}catch(lt){console.error("Run failed:",lt)}},ft=[{name:"Dark Mode Toggle",version:"1.0.0",author:"Grudge Team",description:"Quickly toggle between dark and light modes",category:"utility",main:`
api.ui.showNotification('Dark Mode extension loaded!', 'success');
return {
  toggle: () => {
    api.ui.showNotification('Toggling dark mode...', 'info');
  }
};`},{name:"Code Formatter",version:"1.0.0",author:"Grudge Team",description:"Format and beautify code",category:"tool",main:`
api.ui.showNotification('Code Formatter ready!', 'success');
return {
  format: async (code) => {
    return await api.ai.chat('Format this code nicely: ' + code);
  }
};`}];return jsxRuntimeExports.jsxs("div",{className:"w-full h-full flex flex-col",style:{background:"#0a0a0a",color:"white"},children:[jsxRuntimeExports.jsxs("div",{className:"p-4 border-b flex justify-between items-center",style:{borderColor:"#1a5a5a"},children:[jsxRuntimeExports.jsx("h2",{className:"font-bold",style:{color:"#c9a227"},children:"Extension Manager"}),jsxRuntimeExports.jsx("button",{onClick:()=>a(!s),className:"px-3 py-1 rounded text-sm",style:{background:"#1a5a5a",color:"white"},children:s?" Cancel":"+ Install Extension"})]}),jsxRuntimeExports.jsxs("div",{className:"flex-1 overflow-auto p-4",children:[s&&jsxRuntimeExports.jsxs("div",{className:"mb-6 p-4 rounded-lg",style:{background:"#111",border:"1px solid #1a5a5a"},children:[jsxRuntimeExports.jsx("h3",{className:"font-bold mb-3",style:{color:"#c9a227"},children:"Create New Extension"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-3",children:[jsxRuntimeExports.jsx("input",{placeholder:"Extension Name",value:c.name,onChange:dt=>d({...c,name:dt.target.value}),className:"p-2 rounded text-sm",style:{background:"#0a0a0a",border:"1px solid #333",color:"white"}}),jsxRuntimeExports.jsx("input",{placeholder:"Version",value:c.version,onChange:dt=>d({...c,version:dt.target.value}),className:"p-2 rounded text-sm",style:{background:"#0a0a0a",border:"1px solid #333",color:"white"}}),jsxRuntimeExports.jsx("input",{placeholder:"Author",value:c.author,onChange:dt=>d({...c,author:dt.target.value}),className:"p-2 rounded text-sm",style:{background:"#0a0a0a",border:"1px solid #333",color:"white"}}),jsxRuntimeExports.jsxs("select",{value:c.category,onChange:dt=>d({...c,category:dt.target.value}),className:"p-2 rounded text-sm",style:{background:"#0a0a0a",border:"1px solid #333",color:"white"},children:[jsxRuntimeExports.jsx("option",{value:"utility",children:"Utility"}),jsxRuntimeExports.jsx("option",{value:"tool",children:"Tool"}),jsxRuntimeExports.jsx("option",{value:"game",children:"Game"}),jsxRuntimeExports.jsx("option",{value:"theme",children:"Theme"}),jsxRuntimeExports.jsx("option",{value:"integration",children:"Integration"})]})]}),jsxRuntimeExports.jsx("input",{placeholder:"Description",value:c.description,onChange:dt=>d({...c,description:dt.target.value}),className:"w-full p-2 rounded text-sm mb-3",style:{background:"#0a0a0a",border:"1px solid #333",color:"white"}}),jsxRuntimeExports.jsx("textarea",{placeholder:"Extension code (JavaScript)...",value:b,onChange:dt=>_e(dt.target.value),className:"w-full h-32 p-2 rounded text-sm font-mono mb-3 resize-none",style:{background:"#0a0a0a",border:"1px solid #333",color:"white"}}),jsxRuntimeExports.jsx("button",{onClick:ot,disabled:tt||!c.name||!b.trim(),className:"px-4 py-2 rounded font-medium disabled:opacity-50",style:{background:"#c9a227",color:"#0a0a0a"},children:tt?" Installing...":" Install Extension"})]}),jsxRuntimeExports.jsxs("div",{className:"mb-6",children:[jsxRuntimeExports.jsxs("h3",{className:"font-bold mb-3",style:{color:"#1a5a5a"},children:["Installed Extensions (",o.length,")"]}),o.length===0?jsxRuntimeExports.jsx("p",{className:"text-gray-500 text-sm",children:"No extensions installed"}):jsxRuntimeExports.jsx("div",{className:"space-y-2",children:o.map(dt=>jsxRuntimeExports.jsxs("div",{className:"p-3 rounded-lg flex items-center justify-between",style:{background:"#111",border:"1px solid #333"},children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("span",{className:"text-2xl",children:dt.icon}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("div",{className:"font-medium",children:dt.name}),jsxRuntimeExports.jsxs("div",{className:"text-xs text-gray-500",children:["v",dt.version," by ",dt.author,"  ",dt.category]})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("button",{onClick:()=>ct(dt.id,!dt.enabled),className:`px-2 py-1 rounded text-xs ${dt.enabled?"bg-green-600":"bg-gray-600"}`,children:dt.enabled?"Enabled":"Disabled"}),jsxRuntimeExports.jsx("button",{onClick:()=>ut(dt.id),disabled:!dt.enabled,className:"px-2 py-1 rounded text-xs disabled:opacity-50",style:{background:"#1a5a5a"},children:" Run"}),jsxRuntimeExports.jsx("button",{onClick:()=>at(dt.id),className:"px-2 py-1 rounded text-xs bg-red-600",children:""})]})]},dt.id))})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"font-bold mb-3",style:{color:"#1a5a5a"},children:"Sample Extensions"}),jsxRuntimeExports.jsx("div",{className:"space-y-2",children:ft.map((dt,lt)=>jsxRuntimeExports.jsxs("div",{className:"p-3 rounded-lg flex items-center justify-between",style:{background:"#111",border:"1px solid #1a5a5a"},children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("div",{className:"font-medium",children:dt.name}),jsxRuntimeExports.jsx("div",{className:"text-xs text-gray-500",children:dt.description})]}),jsxRuntimeExports.jsx("button",{onClick:async()=>{await extensionSystem.installExtension(dt,dt.main),e(extensionSystem.getExtensions())},className:"px-3 py-1 rounded text-sm",style:{background:"#c9a227",color:"#0a0a0a"},children:"Install"})]},lt))})]})]})]})};class PostgresMLClient{constructor(){this.connected=!1,this.useCloud=!1,this.embeddingsCache=new Map,this.documents=new Map}async connect(e){try{return e!=null&&e.connectionString?(console.log("[PostgresML] Connecting to PostgresML Cloud..."),this.useCloud=!0,this.connected=!0,!0):(console.log("[PostgresML] Using local vector operations with Puter AI"),this.connected=!0,this.useCloud=!1,await this.loadFromStorage(),!0)}catch(s){return console.warn("[PostgresML] Connection failed, using fallback:",s),this.connected=!0,!0}}async loadFromStorage(){try{if(typeof puter<"u"&&(puter!=null&&puter.kv)){const e=await puter.kv.get("postgresml_documents");if(e){const s=JSON.parse(e);Object.entries(s).forEach(([a,c])=>{this.documents.set(a,c)})}}}catch{console.warn("[PostgresML] Could not load from storage")}}async saveToStorage(){try{if(typeof puter<"u"&&(puter!=null&&puter.kv)){const e={};this.documents.forEach((s,a)=>{e[a]=s}),await puter.kv.set("postgresml_documents",JSON.stringify(e))}}catch{console.warn("[PostgresML] Could not save to storage")}}async chunk(e,s={}){const a=s.chunkSize||512,c=s.overlap||50,d=e.split(/\s+/),b=[],_e=[];let tt=0;for(;tt<d.length;){const nt=Math.min(tt+a,d.length);if(b.push(d.slice(tt,nt).join(" ")),_e.push({start:tt,end:nt}),tt=nt-c,tt>=d.length-c)break}return{chunks:b,metadata:_e}}async embed(e){if(this.embeddingsCache.has(e))return{embedding:this.embeddingsCache.get(e),text:e};try{const s=await this.generateSimpleEmbedding(e);return this.embeddingsCache.set(e,s),{embedding:s,text:e}}catch{return console.warn("[PostgresML] Embedding generation failed"),{embedding:this.generateSimpleEmbedding(e),text:e}}}generateSimpleEmbedding(e){const s=new Array(384).fill(0);e.toLowerCase().replace(/[^a-z0-9\s]/g,"").split(/\s+/).filter(b=>b.length>0).forEach((b,_e)=>{for(let tt=0;tt<b.length&&tt<10;tt++){const nt=b.charCodeAt(tt),it=(_e*10+tt)%384;s[it]=(s[it]+nt/255)/2}});const d=Math.sqrt(s.reduce((b,_e)=>b+_e*_e,0))||1;return s.map(b=>b/d)}cosineSimilarity(e,s){if(e.length!==s.length)return 0;let a=0,c=0,d=0;for(let _e=0;_e<e.length;_e++)a+=e[_e]*s[_e],c+=e[_e]*e[_e],d+=s[_e]*s[_e];const b=Math.sqrt(c)*Math.sqrt(d);return b===0?0:a/b}async addDocument(e,s,a){const{embedding:c}=await this.embed(s);this.documents.set(e,{content:s,embedding:c,metadata:a}),await this.saveToStorage()}async removeDocument(e){const s=this.documents.delete(e);return s&&await this.saveToStorage(),s}async search(e,s=10){const{embedding:a}=await this.embed(e),c=[];return this.documents.forEach((d,b)=>{const _e=this.cosineSimilarity(a,d.embedding);c.push({id:b,content:d.content,similarity:_e,metadata:d.metadata})}),c.sort((d,b)=>b.similarity-d.similarity).slice(0,s)}async classify(e,s){try{if(typeof puter<"u"&&(puter!=null&&puter.ai)){const a=`Classify the following text into one of these categories: ${s.join(", ")}

Text: "${e}"

Respond with ONLY the category name, nothing else.`,d=(await puter.ai.chat(a)).trim().toLowerCase();return s.map(b=>({label:b,score:b.toLowerCase()===d?.9:.1/(s.length-1)})).sort((b,_e)=>_e.score-b.score)}}catch{console.warn("[PostgresML] Classification failed")}return s.map((a,c)=>({label:a,score:c===0?.5:.5/(s.length-1)}))}async summarize(e,s=100){try{if(typeof puter<"u"&&(puter!=null&&puter.ai))return await puter.ai.chat(`Summarize this text in ${s} words or less:

${e}`)}catch{console.warn("[PostgresML] Summarization failed")}return e.split(/[.!?]+/).filter(c=>c.trim()).slice(0,2).join(". ")+"."}async generateCode(e,s="javascript"){try{if(typeof puter<"u"&&(puter!=null&&puter.ai))return await puter.ai.chat(`Generate ${s} code for: ${e}

Return only the code, no explanations.`)}catch{console.warn("[PostgresML] Code generation failed")}return`// Code generation unavailable
// Prompt: ${e}`}async answerQuestion(e,s){try{if(typeof puter<"u"&&(puter!=null&&puter.ai))return await puter.ai.chat(`Based on this context:
${s}

Answer this question: ${e}`)}catch{console.warn("[PostgresML] Question answering failed")}return"Unable to answer at this time."}getDocumentCount(){return this.documents.size}isConnected(){return this.connected}isUsingCloud(){return this.useCloud}}const postgresML=new PostgresMLClient;class SmartSearch{constructor(){this.initialized=!1}async initialize(){this.initialized||(await postgresML.connect(),this.initialized=!0,console.log("[SmartSearch] Initialized with vector search"))}async indexItem(e){await this.initialize();const s=`${e.title} ${e.content}`;await postgresML.addDocument(e.id,s,{type:e.type,title:e.title,...e.metadata}),console.log(`[SmartSearch] Indexed: ${e.title}`)}async indexMany(e){for(const s of e)await this.indexItem(s)}async search(e,s={}){await this.initialize();const a=await postgresML.search(e,s.limit||20);return s.type?a.filter(c=>{var d;return((d=c.metadata)==null?void 0:d.type)===s.type}):a}async searchProjects(e){return this.search(e,{type:"project"})}async searchExtensions(e){return this.search(e,{type:"extension"})}async searchCode(e){return this.search(e,{type:"code"})}async removeItem(e){return await this.initialize(),postgresML.removeDocument(e)}async autoClassify(e){var c,d;await this.initialize();const s=["game","tool","utility","theme","integration","script","asset"],a=await postgresML.classify(e,s);return{category:((c=a[0])==null?void 0:c.label)||"utility",confidence:((d=a[0])==null?void 0:d.score)||0}}async generateDescription(e,s){return await this.initialize(),postgresML.summarize(`${e}: ${s}`,50)}async suggestTags(e){await this.initialize();const s=["game","3d","2d","multiplayer","puzzle","action","rpg","tool","editor","utility","theme","dark","light","ai","database","api","ui","animation","audio","network"];return(await postgresML.classify(e,s)).filter(c=>c.score>.3).slice(0,5).map(c=>c.label)}getIndexedCount(){return postgresML.getDocumentCount()}}const smartSearch=new SmartSearch,SmartSearchPanel=()=>{const[o,e]=reactExports.useState(""),[s,a]=reactExports.useState([]),[c,d]=reactExports.useState(!1),[b,_e]=reactExports.useState("all"),[tt,nt]=reactExports.useState(0),[it,ot]=reactExports.useState(!1),[at,ct]=reactExports.useState({title:"",content:"",type:"project"});reactExports.useEffect(()=>{ut()},[]);const ut=async()=>{await smartSearch.initialize(),nt(smartSearch.getIndexedCount())},ft=async()=>{if(o.trim()){d(!0);try{const ht=b==="all"?await smartSearch.search(o):await smartSearch.search(o,{type:b});a(ht)}catch(ht){console.error("Search failed:",ht)}finally{d(!1)}}},dt=async()=>{!at.title||!at.content||(await smartSearch.indexItem({id:`item_${Date.now()}`,type:at.type,title:at.title,content:at.content}),ct({title:"",content:"",type:"project"}),nt(smartSearch.getIndexedCount()),ot(!1))},lt={project:"#1a5a5a",extension:"#c9a227",code:"#4a9eff",asset:"#ff6b6b",game:"#6bff6b"};return jsxRuntimeExports.jsxs("div",{className:"w-full h-full flex flex-col",style:{background:"#0a0a0a",color:"white"},children:[jsxRuntimeExports.jsxs("div",{className:"p-4 border-b",style:{borderColor:"#1a5a5a"},children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[jsxRuntimeExports.jsx("h2",{className:"font-bold",style:{color:"#c9a227"},children:"Smart Search"}),jsxRuntimeExports.jsxs("span",{className:"text-xs px-2 py-1 rounded",style:{background:"#1a5a5a"},children:[tt," indexed"]})]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[jsxRuntimeExports.jsx("input",{value:o,onChange:ht=>e(ht.target.value),onKeyDown:ht=>ht.key==="Enter"&&ft(),placeholder:"Search projects, extensions, code...",className:"flex-1 p-2 rounded text-sm",style:{background:"#111",border:"1px solid #333",color:"white"}}),jsxRuntimeExports.jsx("button",{onClick:ft,disabled:c,className:"px-4 py-2 rounded font-medium disabled:opacity-50",style:{background:"#1a5a5a",color:"white"},children:c?"...":""}),jsxRuntimeExports.jsx("button",{onClick:()=>ot(!it),className:"px-3 py-2 rounded",style:{background:"#333",color:"white"},children:"+"})]}),jsxRuntimeExports.jsx("div",{className:"flex gap-2 mt-2",children:["all","project","extension","code","asset","game"].map(ht=>jsxRuntimeExports.jsx("button",{onClick:()=>_e(ht),className:"px-2 py-1 rounded text-xs transition-colors",style:{background:b===ht?lt[ht]||"#1a5a5a":"#222",color:"white"},children:ht},ht))})]}),it&&jsxRuntimeExports.jsxs("div",{className:"p-4 border-b",style:{borderColor:"#333",background:"#111"},children:[jsxRuntimeExports.jsx("h3",{className:"text-sm font-medium mb-2",style:{color:"#c9a227"},children:"Add to Index"}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsx("input",{value:at.title,onChange:ht=>ct({...at,title:ht.target.value}),placeholder:"Title",className:"w-full p-2 rounded text-sm",style:{background:"#0a0a0a",border:"1px solid #333",color:"white"}}),jsxRuntimeExports.jsx("textarea",{value:at.content,onChange:ht=>ct({...at,content:ht.target.value}),placeholder:"Content/Description",className:"w-full p-2 rounded text-sm h-20 resize-none",style:{background:"#0a0a0a",border:"1px solid #333",color:"white"}}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[jsxRuntimeExports.jsxs("select",{value:at.type,onChange:ht=>ct({...at,type:ht.target.value}),className:"p-2 rounded text-sm",style:{background:"#0a0a0a",border:"1px solid #333",color:"white"},children:[jsxRuntimeExports.jsx("option",{value:"project",children:"Project"}),jsxRuntimeExports.jsx("option",{value:"extension",children:"Extension"}),jsxRuntimeExports.jsx("option",{value:"code",children:"Code"}),jsxRuntimeExports.jsx("option",{value:"asset",children:"Asset"}),jsxRuntimeExports.jsx("option",{value:"game",children:"Game"})]}),jsxRuntimeExports.jsx("button",{onClick:dt,className:"px-4 py-2 rounded text-sm",style:{background:"#c9a227",color:"#0a0a0a"},children:"Add Item"})]})]})]}),jsxRuntimeExports.jsx("div",{className:"flex-1 overflow-auto p-4",children:s.length===0?jsxRuntimeExports.jsxs("div",{className:"text-center py-10 text-gray-500",children:[jsxRuntimeExports.jsx("div",{className:"text-4xl mb-2",children:""}),jsxRuntimeExports.jsx("p",{children:"Search for projects, extensions, or code"}),jsxRuntimeExports.jsx("p",{className:"text-xs mt-2",children:"Uses vector embeddings for semantic search"})]}):jsxRuntimeExports.jsx("div",{className:"space-y-3",children:s.map((ht,mt)=>{var xt,St,yt;return jsxRuntimeExports.jsx("div",{className:"p-3 rounded-lg",style:{background:"#111",border:"1px solid #333"},children:jsxRuntimeExports.jsxs("div",{className:"flex items-start justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:lt[(xt=ht.metadata)==null?void 0:xt.type]||"#333"},children:((St=ht.metadata)==null?void 0:St.type)||"item"}),jsxRuntimeExports.jsx("span",{className:"font-medium",children:((yt=ht.metadata)==null?void 0:yt.title)||ht.id})]}),jsxRuntimeExports.jsxs("p",{className:"text-sm text-gray-400 mt-1 line-clamp-2",children:[ht.content.substring(0,150),"..."]})]}),jsxRuntimeExports.jsxs("div",{className:"text-right",children:[jsxRuntimeExports.jsxs("div",{className:"text-xs font-mono",style:{color:ht.similarity>.7?"#6bff6b":ht.similarity>.4?"#c9a227":"#888"},children:[(ht.similarity*100).toFixed(1),"%"]}),jsxRuntimeExports.jsx("div",{className:"text-xs text-gray-500",children:"match"})]})]})},mt)})})})]})},Window=({window:o})=>{const{updateWindow:e,closeWindow:s,focusWindow:a}=useDesktop(),[c,d]=reactExports.useState(!1),[b,_e]=reactExports.useState(!1),[tt,nt]=reactExports.useState(!1),[it,ot]=reactExports.useState({x:0,y:0}),[at,ct]=reactExports.useState({position:o.position,size:o.size}),ut=reactExports.useRef(null),ft=(xt,St)=>{xt.preventDefault(),a(o.id),St==="drag"?(d(!0),ot({x:xt.clientX-o.position.x,y:xt.clientY-o.position.y})):(_e(!0),ot({x:xt.clientX-o.size.width,y:xt.clientY-o.size.height}))},dt=xt=>{c?e(o.id,{position:{x:Math.max(0,xt.clientX-it.x),y:Math.max(0,xt.clientY-it.y)}}):b&&e(o.id,{size:{width:Math.max(300,xt.clientX-it.x),height:Math.max(200,xt.clientY-it.y)}})},lt=()=>{d(!1),_e(!1)},ht=()=>{tt?e(o.id,{position:at.position,size:at.size}):(ct({position:o.position,size:o.size}),e(o.id,{position:{x:0,y:0},size:{width:globalThis.innerWidth,height:globalThis.innerHeight-40}})),nt(!tt)};React.useEffect(()=>{if(c||b)return document.addEventListener("mousemove",dt),document.addEventListener("mouseup",lt),()=>{document.removeEventListener("mousemove",dt),document.removeEventListener("mouseup",lt)}},[c,b,it]);const mt=()=>{var xt;switch(o.component){case"Calculator":return jsxRuntimeExports.jsx(Calculator,{});case"GrudaChainBox":return jsxRuntimeExports.jsx(GrudaChainBox,{});case"GameForge":return jsxRuntimeExports.jsx(GameForge,{});case"MediaFireWorldLoader":return jsxRuntimeExports.jsx(MediaFireWorldLoader,{onWorldLoaded:()=>{},apiKey:"UT50RbrklYsWnZtHRoeFNtsjRc9mX7gf3"});case"FileManager":return jsxRuntimeExports.jsx(FileManager,{});case"TextEditor":return jsxRuntimeExports.jsx(TextEditor,{...o.props||{}});case"ExtractionResults":return(xt=o.props)!=null&&xt.archiveInfo?jsxRuntimeExports.jsx(ExtractionResults,{archiveInfo:o.props.archiveInfo}):jsxRuntimeExports.jsx("div",{className:"p-4 text-center text-gray-400 bg-[#0a0a0a]",children:"No archive info available"});case"PlayerCreation":return jsxRuntimeExports.jsx(PlayerCreation,{});case"FPSArena":return jsxRuntimeExports.jsx(FPSArena,{});case"DungeonCrawler":return jsxRuntimeExports.jsx(DungeonCrawler,{});case"RacingGame":return jsxRuntimeExports.jsx(RacingGame,{});case"BasketballGame":return jsxRuntimeExports.jsx(BasketballGame,{});case"HighwayDriving":return jsxRuntimeExports.jsx(HighwayDriving,{});case"CrimeCityDriving":return jsxRuntimeExports.jsx(CrimeCityDriving,{});case"RPGFantasy":return jsxRuntimeExports.jsx(RPGFantasy,{});case"SurvivalMMO":return jsxRuntimeExports.jsx(SurvivalMMO,{});case"CodeEditor":return jsxRuntimeExports.jsx(GrudaVisualCode$1,{});case"TreatyChat":return jsxRuntimeExports.jsx(TreatyChat,{});case"VideoEditor":return jsxRuntimeExports.jsx(VideoEditor,{});case"HotkeyEditor":return jsxRuntimeExports.jsx(HotkeyEditor,{});case"GrudaVisualCode":return jsxRuntimeExports.jsx(GrudaVisualCode,{});case"DisplaySettings":return jsxRuntimeExports.jsx(DisplaySettingsApp,{});case"SystemMonitor":return jsxRuntimeExports.jsx(SystemMonitor,{});case"DebuggingAI":return jsxRuntimeExports.jsx(DebuggingAI,{});case"ExtensionManager":return jsxRuntimeExports.jsx(ExtensionManager,{});case"SmartSearch":return jsxRuntimeExports.jsx(SmartSearchPanel,{});default:return jsxRuntimeExports.jsx("div",{className:"p-4 text-center bg-[#0a0a0a]",children:jsxRuntimeExports.jsxs("p",{className:"text-gray-400",children:["Unknown application: ",o.component]})})}};return jsxRuntimeExports.jsxs("div",{ref:ut,className:"fixed bg-[#0a0a0a] border border-[#1a5a5a] shadow-2xl flex flex-col rounded-lg overflow-hidden",style:{left:o.position.x,top:o.position.y,width:o.size.width,height:o.size.height,zIndex:o.zIndex},onClick:()=>a(o.id),children:[jsxRuntimeExports.jsxs("div",{className:"bg-gradient-to-r from-[#1a5a5a] to-[#0a3a3a] text-white px-3 py-2 flex items-center justify-between cursor-move select-none",onMouseDown:xt=>ft(xt,"drag"),onDoubleClick:ht,children:[jsxRuntimeExports.jsx("div",{className:"flex items-center gap-2",children:jsxRuntimeExports.jsx("span",{className:"text-sm font-bold text-[#c9a227]",children:o.title})}),jsxRuntimeExports.jsxs("div",{className:"flex gap-1",children:[jsxRuntimeExports.jsx("button",{className:"w-6 h-5 bg-[#252525] hover:bg-[#353535] rounded flex items-center justify-center text-xs text-gray-400 hover:text-white transition-colors",onClick:xt=>{xt.stopPropagation()},title:"Minimize",children:"_"}),jsxRuntimeExports.jsx("button",{className:"w-6 h-5 bg-[#252525] hover:bg-[#353535] rounded flex items-center justify-center text-xs text-gray-400 hover:text-white transition-colors",onClick:xt=>{xt.stopPropagation(),ht()},title:tt?"Restore":"Maximize",children:tt?"":""}),jsxRuntimeExports.jsx("button",{className:"w-6 h-5 bg-red-600/80 hover:bg-red-600 rounded text-white flex items-center justify-center text-xs transition-colors",onClick:xt=>{xt.stopPropagation(),s(o.id)},title:"Close",children:""})]})]}),jsxRuntimeExports.jsx("div",{className:"flex-1 overflow-hidden bg-[#0a0a0a]",children:mt()}),jsxRuntimeExports.jsx("div",{className:"absolute bottom-0 right-0 w-4 h-4 cursor-se-resize",onMouseDown:xt=>ft(xt,"resize"),style:{background:"linear-gradient(135deg, transparent 50%, #1a5a5a 50%)"}})]})},WindowManager=()=>{const{windows:o}=useDesktop();return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:Object.values(o).map(e=>jsxRuntimeExports.jsx(reactExports.Suspense,{fallback:jsxRuntimeExports.jsxs("div",{className:"fixed bg-gray-200 border-2 border-gray-400 shadow-lg",style:{left:e.position.x,top:e.position.y,width:e.size.width,height:e.size.height,zIndex:e.zIndex},children:[jsxRuntimeExports.jsx("div",{className:"bg-gray-300 p-2 border-b border-gray-400",children:jsxRuntimeExports.jsx("span",{className:"text-sm font-bold",children:e.title})}),jsxRuntimeExports.jsx("div",{className:"flex items-center justify-center h-full",children:jsxRuntimeExports.jsx("div",{className:"text-sm text-gray-500",children:"Loading..."})})]}),children:jsxRuntimeExports.jsx(Window,{window:e})},e.id))})},Taskbar=({onStartClick:o})=>{const{windows:e,focusWindow:s}=useDesktop(),[a,c]=reactExports.useState(new Date);return reactExports.useEffect(()=>{const d=setInterval(()=>c(new Date),1e3);return()=>clearInterval(d)},[]),jsxRuntimeExports.jsxs("div",{className:"fixed bottom-0 left-0 right-0 h-12 bg-gradient-to-r from-[#0a0a0a] via-[#111] to-[#0a0a0a] border-t border-[#1a5a5a] flex items-center px-2 z-50",children:[jsxRuntimeExports.jsxs("button",{className:"bg-gradient-to-b from-[#1a5a5a] to-[#0f3f3f] border border-[#c9a227] hover:from-[#236b6b] hover:to-[#1a5a5a] px-4 py-2 mr-3 text-sm font-bold flex items-center gap-2 rounded transition-all",onClick:o,children:[jsxRuntimeExports.jsx("span",{className:"text-lg",children:""}),jsxRuntimeExports.jsx("span",{className:"text-[#c9a227]",children:"Start"})]}),jsxRuntimeExports.jsx("div",{className:"flex-1 flex gap-1 overflow-x-auto",children:Object.values(e).map(d=>jsxRuntimeExports.jsx("button",{className:"bg-[#1a1a1a] border border-[#1a5a5a] hover:bg-[#1a5a5a]/50 hover:border-[#c9a227] px-3 py-1.5 text-xs text-white max-w-44 truncate rounded transition-all",onClick:()=>s(d.id),children:d.title},d.id))}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3 text-xs text-gray-300 ml-2 border-l border-[#1a5a5a] pl-3",children:[jsxRuntimeExports.jsx("span",{className:"cursor-pointer hover:text-[#c9a227]",children:""}),jsxRuntimeExports.jsx("span",{className:"cursor-pointer hover:text-[#c9a227]",children:""}),jsxRuntimeExports.jsx("span",{className:"font-mono text-[#c9a227] bg-[#0a0a0a] px-2 py-1 rounded",children:a.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})]})},StartMenu=({onClose:o})=>{const{openWindow:e}=useDesktop(),s=[{id:"gruda-chain-box",name:"GRUDA CHAIN BOX",icon:"",component:"GrudaChainBox",size:{width:1e3,height:700}},{id:"gameforge",name:"GameForge Editor",icon:"",component:"GameForge",size:{width:1200,height:800}},{id:"file-manager",name:"File Manager",icon:"",component:"FileManager",size:{width:700,height:500}},{id:"notepad",name:"Notepad",icon:"",component:"TextEditor",size:{width:600,height:400}},{id:"calculator",name:"Calculator",icon:"",component:"Calculator",size:{width:300,height:400}},{id:"world-loader",name:"Minecraft World Loader",icon:"",component:"MediaFireWorldLoader",size:{width:600,height:500}}],a=c=>{const d={x:100+Math.random()*200,y:100+Math.random()*150};e({id:`${c.id}-${Date.now()}`,title:c.name,component:c.component,position:d,size:c.size,props:{}}),o()};return jsxRuntimeExports.jsxs("div",{className:"fixed bottom-10 left-2 bg-[#1a1a1a] border border-[#1a5a5a] shadow-2xl w-72 z-40 rounded-lg overflow-hidden",children:[jsxRuntimeExports.jsx("div",{className:"bg-gradient-to-r from-[#1a5a5a] to-[#0a3a3a] text-white p-4 border-b border-[#1a5a5a]",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("span",{className:"text-2xl",children:""}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("div",{className:"text-sm font-bold text-[#c9a227]",children:"GRUDGE LAUNCHER"}),jsxRuntimeExports.jsx("div",{className:"text-xs opacity-80",children:"Game Development Platform"})]})]})}),jsxRuntimeExports.jsxs("div",{className:"p-2 max-h-80 overflow-y-auto",children:[s.map(c=>jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3 p-2.5 hover:bg-[#1a5a5a] text-white cursor-pointer rounded transition-colors",onClick:()=>a(c),children:[jsxRuntimeExports.jsx("span",{className:"text-xl",children:c.icon}),jsxRuntimeExports.jsx("span",{className:"text-sm",children:c.name})]},c.id)),jsxRuntimeExports.jsx("div",{className:"border-t border-[#1a5a5a]/50 my-2"}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3 p-2.5 hover:bg-[#1a5a5a] text-white cursor-pointer rounded transition-colors",onClick:()=>{e({id:`settings-${Date.now()}`,title:"Display Settings",component:"DisplaySettings",size:{width:500,height:400}}),o()},children:[jsxRuntimeExports.jsx("span",{className:"text-xl",children:""}),jsxRuntimeExports.jsx("span",{className:"text-sm",children:"Display Settings"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3 p-2.5 hover:bg-red-900/50 text-white cursor-pointer rounded transition-colors",onClick:()=>{confirm("Are you sure you want to reload the desktop?")&&window.location.reload()},children:[jsxRuntimeExports.jsx("span",{className:"text-xl",children:""}),jsxRuntimeExports.jsx("span",{className:"text-sm",children:"Restart Desktop"})]})]})]})},useContextMenu=()=>{const[o,e]=reactExports.useState({visible:!1,x:0,y:0,items:[]}),s=reactExports.useCallback((c,d,b)=>{c.preventDefault(),c.stopPropagation();const _e=200,tt=Math.min(d.length*40+20,400);let nt=c.clientX,it=c.clientY;b?(nt=Math.max(b.left,Math.min(nt,b.right-_e)),it=Math.max(b.top,Math.min(it,b.bottom-tt))):(nt=Math.min(nt,window.innerWidth-_e),it=Math.min(it,window.innerHeight-tt)),nt=Math.max(0,nt),it=Math.max(0,it),e({visible:!0,x:nt,y:it,items:d})},[]),a=reactExports.useCallback(()=>{e(c=>({...c,visible:!1}))},[]);return{menu:o,showMenu:s,hideMenu:a}},ContextMenu=({x:o,y:e,items:s,onClose:a})=>(reactExports.useEffect(()=>{const c=()=>a(),d=b=>{b.key==="Escape"&&a()};return document.addEventListener("click",c),document.addEventListener("keydown",d),()=>{document.removeEventListener("click",c),document.removeEventListener("keydown",d)}},[a]),jsxRuntimeExports.jsx("div",{className:"fixed z-[10000] bg-[#1a1a1a] border border-[#1a5a5a] rounded shadow-xl min-w-[180px] py-1",style:{left:o,top:e},onClick:c=>c.stopPropagation(),children:s.map((c,d)=>c.divider?jsxRuntimeExports.jsx("div",{className:"h-px bg-[#1a5a5a]/50 my-1 mx-2"},d):jsxRuntimeExports.jsxs("button",{className:`w-full px-4 py-2 text-left text-sm flex items-center gap-3 transition-colors ${c.disabled?"text-gray-500 cursor-not-allowed":"text-white hover:bg-[#1a5a5a] cursor-pointer"}`,onClick:()=>{!c.disabled&&c.action&&(c.action(),a())},disabled:c.disabled,children:[c.icon&&jsxRuntimeExports.jsx("span",{className:"w-5 text-center",children:c.icon}),jsxRuntimeExports.jsx("span",{children:c.label})]},d))})),useDesktopContextMenu=()=>{const{openWindow:o}=useDesktop(),{menu:e,showMenu:s,hideMenu:a}=useContextMenu();return{menu:e,showMenu:s,hideMenu:a,getDesktopMenuItems:()=>[{label:"Refresh",icon:"",action:()=>window.location.reload()},{divider:!0},{label:"New Folder",icon:"",action:()=>o({id:`file-manager-${Date.now()}`,title:"File Manager",component:"FileManager",size:{width:700,height:500}})},{label:"New Text Document",icon:"",action:()=>o({id:`notepad-${Date.now()}`,title:"Notepad",component:"TextEditor",size:{width:600,height:400}})},{divider:!0},{label:"Treaty Chat",icon:"",action:()=>o({id:`treaty-chat-${Date.now()}`,title:"Treaty Chat",component:"TreatyChat",size:{width:900,height:600}})},{label:"Code Editor",icon:"",action:()=>o({id:`code-editor-${Date.now()}`,title:"Code Editor",component:"CodeEditor",size:{width:1e3,height:700}})},{label:"Video Editor",icon:"",action:()=>o({id:`video-editor-${Date.now()}`,title:"Video Editor",component:"VideoEditor",size:{width:1100,height:700}})},{divider:!0},{label:"Display Settings",icon:"",action:()=>o({id:`settings-${Date.now()}`,title:"Display Settings",component:"DisplaySettings",size:{width:500,height:500}})},{label:"Hotkey Editor",icon:"",action:()=>o({id:`hotkeys-${Date.now()}`,title:"Hotkey Editor",component:"HotkeyEditor",size:{width:600,height:500}})}],getIconMenuItems:(b,_e)=>[{label:"Open",icon:"",action:_e},{divider:!0},{label:"Run as Admin",icon:"",action:()=>{console.log(`Running ${b} as admin`),_e()}},{label:"Add to Favorites",icon:"",action:()=>{console.log(`Added ${b} to favorites`),alert(`${b} added to favorites!`)}},{divider:!0},{label:"Create Shortcut",icon:"",action:()=>{console.log(`Created shortcut for ${b}`),alert(`Shortcut created for ${b}`)}},{label:"Properties",icon:"",action:()=>{o({id:`properties-${Date.now()}`,title:`Properties - ${b}`,component:"DisplaySettings",size:{width:400,height:350}})}}]}},HOTKEY_STORAGE_KEY="grudge_studio_hotkeys",globalHotkeys=new Map,actionMap={FileManager:()=>window.dispatchEvent(new CustomEvent("openApp",{detail:"FileManager"})),TextEditor:()=>window.dispatchEvent(new CustomEvent("openApp",{detail:"TextEditor"})),TreatyChat:()=>window.dispatchEvent(new CustomEvent("openApp",{detail:"TreatyChat"})),CodeEditor:()=>window.dispatchEvent(new CustomEvent("openApp",{detail:"CodeEditor"})),Calculator:()=>window.dispatchEvent(new CustomEvent("openApp",{detail:"Calculator"})),GameForge:()=>window.dispatchEvent(new CustomEvent("openApp",{detail:"GameForge"})),HotkeyEditor:()=>window.dispatchEvent(new CustomEvent("openApp",{detail:"HotkeyEditor"}))};function useGlobalHotkeys(o){reactExports.useEffect(()=>(o.forEach(e=>{const s=getHotkeyId(e);globalHotkeys.set(s,e)}),()=>{o.forEach(e=>{const s=getHotkeyId(e);globalHotkeys.delete(s)})}),[o])}function getHotkeyId(o){const e=[];return o.ctrl&&e.push("ctrl"),o.shift&&e.push("shift"),o.alt&&e.push("alt"),e.push(o.key.toLowerCase()),e.join("+")}function useDynamicHotkeys(){const[o,e]=reactExports.useState([]),s=reactExports.useCallback(async()=>{var a;try{let c=null;if(typeof window<"u"&&((a=window.puter)!=null&&a.kv)?c=await window.puter.kv.get(HOTKEY_STORAGE_KEY):c=localStorage.getItem(HOTKEY_STORAGE_KEY),c){const b=JSON.parse(c).map(_e=>({key:_e.key,ctrl:_e.ctrl,shift:_e.shift,alt:_e.alt,action:actionMap[_e.action]||(()=>{}),description:_e.id}));return e(b),b}}catch{console.log("Using default hotkeys")}return e(defaultDesktopHotkeys),defaultDesktopHotkeys},[]);return reactExports.useEffect(()=>{s();const a=c=>{const d=c.detail.map(b=>({key:b.key,ctrl:b.ctrl,shift:b.shift,alt:b.alt,action:actionMap[b.action]||(()=>{}),description:b.id}));globalHotkeys.clear(),d.forEach(b=>{const _e=getHotkeyId(b);globalHotkeys.set(_e,b)}),e(d)};return window.addEventListener("hotkeysUpdated",a),()=>window.removeEventListener("hotkeysUpdated",a)},[s]),useGlobalHotkeys(o),o}function HotkeyProvider({children:o}){return reactExports.useEffect(()=>{const e=s=>{const a=s.target;if(a.tagName==="INPUT"||a.tagName==="TEXTAREA"||a.isContentEditable)return;const c=[];(s.ctrlKey||s.metaKey)&&c.push("ctrl"),s.shiftKey&&c.push("shift"),s.altKey&&c.push("alt"),c.push(s.key.toLowerCase());const d=c.join("+"),b=globalHotkeys.get(d);b&&(b.preventDefault!==!1&&s.preventDefault(),b.action())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[]),jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:o})}const defaultDesktopHotkeys=[{key:"e",ctrl:!0,description:"Open File Manager",action:()=>{window.dispatchEvent(new CustomEvent("openApp",{detail:"FileManager"}))}},{key:"n",ctrl:!0,description:"New Notepad",action:()=>{window.dispatchEvent(new CustomEvent("openApp",{detail:"TextEditor"}))}},{key:"t",ctrl:!0,shift:!0,description:"Open Treaty Chat",action:()=>{window.dispatchEvent(new CustomEvent("openApp",{detail:"TreatyChat"}))}},{key:"`",ctrl:!0,description:"Open Code Editor",action:()=>{window.dispatchEvent(new CustomEvent("openApp",{detail:"CodeEditor"}))}},{key:"c",ctrl:!0,shift:!0,description:"Open Calculator",action:()=>{window.dispatchEvent(new CustomEvent("openApp",{detail:"Calculator"}))}},{key:"g",ctrl:!0,shift:!0,description:"Open GameForge",action:()=>{window.dispatchEvent(new CustomEvent("openApp",{detail:"GameForge"}))}}];function useInputMode(){const[o,e]=reactExports.useState("mouse"),[s,a]=reactExports.useState(!1),[c,d]=reactExports.useState({width:window.innerWidth,height:window.innerHeight});return reactExports.useEffect(()=>{const b=()=>{d({width:window.innerWidth,height:window.innerHeight}),a(window.innerWidth<768||"ontouchstart"in window)},_e=()=>e("touch"),tt=it=>{(it.movementX!==0||it.movementY!==0)&&e("mouse")},nt=()=>e("keyboard");return b(),window.addEventListener("resize",b),window.addEventListener("orientationchange",b),window.addEventListener("touchstart",_e,{passive:!0}),window.addEventListener("mousemove",tt,{passive:!0}),window.addEventListener("keydown",nt,{passive:!0}),()=>{window.removeEventListener("resize",b),window.removeEventListener("orientationchange",b),window.removeEventListener("touchstart",_e),window.removeEventListener("mousemove",tt),window.removeEventListener("keydown",nt)}},[]),{inputMode:o,isMobile:s,viewport:c}}const Desktop=()=>{const{openWindow:o}=useDesktop(),[e,s]=reactExports.useState(!1),{inputMode:a,isMobile:c,viewport:d}=useInputMode(),[b,_e]=reactExports.useState(null),[tt,nt]=reactExports.useState(null),{menu:it,showMenu:ot,hideMenu:at,getDesktopMenuItems:ct,getIconMenuItems:ut}=useDesktopContextMenu();useGrudaOS(),useDynamicHotkeys();const ft=reactExports.useMemo(()=>[{id:"gruda-chain-box",name:"GRUDA CHAIN BOX",icon:"",component:"GrudaChainBox",size:{width:1e3,height:700}},{id:"gameforge",name:"GameForge",icon:"",component:"GameForge",size:{width:1200,height:800}},{id:"fps-arena",name:"FPS Arena",icon:"",component:"FPSArena",size:{width:900,height:600}},{id:"dungeon-crawler",name:"Dungeon Crawler",icon:"",component:"DungeonCrawler",size:{width:900,height:600}},{id:"racing-game",name:"Turbo Racer",icon:"",component:"RacingGame",size:{width:900,height:600}},{id:"basketball-game",name:"Hoops Master",icon:"",component:"BasketballGame",size:{width:900,height:600}},{id:"highway-driving",name:"Highway Racer",icon:"",component:"HighwayDriving",size:{width:1e3,height:700}},{id:"crime-city",name:"Crime City",icon:"",component:"CrimeCityDriving",size:{width:1e3,height:700}},{id:"rpg-fantasy",name:"Realm Quest",icon:"",component:"RPGFantasy",size:{width:1e3,height:700}},{id:"survival-mmo",name:"Survival Frontier",icon:"",component:"SurvivalMMO",size:{width:1e3,height:700}},{id:"file-manager",name:"File Manager",icon:"",component:"FileManager",size:{width:700,height:500}},{id:"notepad",name:"Notepad",icon:"",component:"TextEditor",size:{width:600,height:400}},{id:"calculator",name:"Calculator",icon:"",component:"Calculator",size:{width:300,height:400}},{id:"media-fire-loader",name:"World Loader",icon:"",component:"MediaFireWorldLoader",size:{width:600,height:500}},{id:"code-editor",name:"Code Editor",icon:"",component:"CodeEditor",size:{width:1e3,height:700}},{id:"treaty-chat",name:"Treaty Chat",icon:"",component:"TreatyChat",size:{width:900,height:600}},{id:"video-editor",name:"Video Editor",icon:"",component:"VideoEditor",size:{width:1100,height:700}},{id:"hotkey-editor",name:"Keyboard Shortcuts",icon:"",component:"HotkeyEditor",size:{width:700,height:500}},{id:"gruda-visual-code",name:"GRUDA VISUAL CODE",icon:"",component:"GrudaVisualCode",size:{width:1200,height:800}},{id:"system-monitor",name:"System Monitor",icon:"",component:"SystemMonitor",size:{width:600,height:500}},{id:"debugging-ai",name:"AI Debugger",icon:"",component:"DebuggingAI",size:{width:700,height:600}},{id:"extensions",name:"Extensions",icon:"",component:"ExtensionManager",size:{width:700,height:550}},{id:"smart-search",name:"Smart Search",icon:"",component:"SmartSearch",size:{width:650,height:550}}],[]),dt=reactExports.useCallback(vt=>{const Mt=c?{x:0,y:0}:{x:50+Math.random()*150,y:50+Math.random()*100},jt=c?{width:d.width,height:d.height-48}:{width:Math.min(vt.size.width,d.width-100),height:Math.min(vt.size.height,d.height-100)};o({id:`${vt.id}-${Date.now()}`,title:vt.name,component:vt.component,position:Mt,size:jt,props:{}})},[c,d,o]);reactExports.useEffect(()=>{const vt=Mt=>{const Lt={FileManager:{id:"file-manager",name:"File Manager",icon:"",component:"FileManager",size:{width:700,height:500}},TextEditor:{id:"notepad",name:"Notepad",icon:"",component:"TextEditor",size:{width:600,height:400}},TreatyChat:{id:"treaty-chat",name:"Treaty Chat",icon:"",component:"TreatyChat",size:{width:900,height:600}},CodeEditor:{id:"code-editor",name:"Code Editor",icon:"",component:"CodeEditor",size:{width:1e3,height:700}},Calculator:{id:"calculator",name:"Calculator",icon:"",component:"Calculator",size:{width:300,height:400}},GameForge:{id:"gameforge",name:"GameForge",icon:"",component:"GameForge",size:{width:1200,height:800}},HotkeyEditor:{id:"hotkey-editor",name:"Keyboard Shortcuts",icon:"",component:"HotkeyEditor",size:{width:700,height:500}},GrudaVisualCode:{id:"gruda-visual-code",name:"GRUDA VISUAL CODE",icon:"",component:"GrudaVisualCode",size:{width:1200,height:800}}}[Mt.detail];Lt&&dt(Lt)};return window.addEventListener("openApp",vt),()=>window.removeEventListener("openApp",vt)},[dt]);const lt=reactExports.useCallback(vt=>{vt.target.closest(".desktop-icon")||nt(null),s(!1),at()},[at]),ht=vt=>{vt.preventDefault(),!vt.target.closest(".desktop-icon")&&ot(vt,ct())},mt=(vt,Mt)=>{vt.preventDefault(),vt.stopPropagation(),ot(vt,ut(Mt.name,()=>dt(Mt)))},xt=reactExports.useCallback((vt,Mt)=>{if(Mt.stopPropagation(),a==="touch"){const jt=Date.now();b&&b.id===vt.id&&jt-b.time<300?(dt(vt),_e(null),nt(null)):(_e({id:vt.id,time:jt}),nt(vt.id))}else nt(vt.id)},[a,b,dt]),St=reactExports.useCallback(vt=>{a!=="touch"&&dt(vt)},[a,dt]),yt=c?d.width<400?3:4:1,wt=c?"w-16":"w-20",Et=c?"text-[10px]":"text-xs",_t=c?"text-2xl":"text-3xl";return jsxRuntimeExports.jsxs("div",{className:"relative w-full h-screen overflow-hidden select-none",style:{width:"100vw",height:"100vh",minHeight:"-webkit-fill-available",background:"linear-gradient(135deg, #0a0a0a 0%, #1a3a3a 30%, #1a5a5a 60%, #c9a227 100%)",backgroundSize:"400% 400%",animation:"gradientShift 15s ease infinite",touchAction:"none"},onClick:lt,onTouchEnd:lt,onContextMenu:ht,children:[jsxRuntimeExports.jsx("div",{className:`absolute top-4 left-4 right-4 ${c?"grid gap-2":"flex flex-col gap-2"}`,style:c?{gridTemplateColumns:`repeat(${yt}, minmax(0, 1fr))`}:void 0,children:ft.map(vt=>jsxRuntimeExports.jsxs("div",{className:`desktop-icon flex flex-col items-center p-2 cursor-pointer rounded transition-all ${wt} ${tt===vt.id?"bg-white/30 ring-2 ring-[#c9a227]":"hover:bg-white/20"}`,onClick:Mt=>xt(vt,Mt),onTouchEnd:Mt=>xt(vt,Mt),onDoubleClick:()=>St(vt),onContextMenu:Mt=>mt(Mt,vt),children:[jsxRuntimeExports.jsx("div",{className:`${_t} mb-1 drop-shadow-lg`,children:vt.icon}),jsxRuntimeExports.jsx("div",{className:`${Et} text-white text-center font-bold leading-tight`,style:{textShadow:"1px 1px 2px rgba(0,0,0,0.8)"},children:vt.name})]},vt.id))}),jsxRuntimeExports.jsx(WindowManager,{}),e&&jsxRuntimeExports.jsx(StartMenu,{onClose:()=>s(!1)}),jsxRuntimeExports.jsx(Taskbar,{onStartClick:vt=>{vt.stopPropagation(),s(!e)}}),it.visible&&jsxRuntimeExports.jsx(ContextMenu,{x:it.x,y:it.y,items:it.items,onClose:at}),jsxRuntimeExports.jsx("style",{children:`
        @keyframes gradientShift {
          0% { background-position: 0% 50%; }
          50% { background-position: 100% 50%; }
          100% { background-position: 0% 50%; }
        }
        
        .desktop-icon {
          -webkit-tap-highlight-color: transparent;
          -webkit-touch-callout: none;
          user-select: none;
        }
        
        .desktop-icon:active {
          transform: scale(0.95);
        }
        
        @media (hover: hover) and (pointer: fine) {
          .desktop-icon:hover {
            transform: scale(1.05);
          }
          .desktop-icon:active {
            transform: scale(0.98);
          }
        }
      `})]})},AudioContext=reactExports.createContext(null);create$1((o,e)=>({backgroundMusic:null,hitSound:null,successSound:null,isMuted:!0,setBackgroundMusic:s=>o({backgroundMusic:s}),setHitSound:s=>o({hitSound:s}),setSuccessSound:s=>o({successSound:s}),toggleMute:()=>{const{isMuted:s}=e(),a=!s;o({isMuted:a}),console.log(`Sound ${a?"muted":"unmuted"}`)},playHit:()=>{const{hitSound:s,isMuted:a}=e();if(s){if(a){console.log("Hit sound skipped (muted)");return}const c=s.cloneNode();c.volume=.3,c.play().catch(d=>{console.log("Hit sound play prevented:",d)})}},playSuccess:()=>{const{successSound:s,isMuted:a}=e();if(s){if(a){console.log("Success sound skipped (muted)");return}s.currentTime=0,s.play().catch(c=>{console.log("Success sound play prevented:",c)})}}}));const AudioProvider=({children:o})=>jsxRuntimeExports.jsx(AudioContext.Provider,{value:null,children:o}),queryClient=new QueryClient({defaultOptions:{queries:{retry:!1,refetchOnWindowFocus:!1}}});function App(){return jsxRuntimeExports.jsx(QueryClientProvider,{client:queryClient,children:jsxRuntimeExports.jsx(HotkeyProvider,{children:jsxRuntimeExports.jsx(AudioProvider,{children:jsxRuntimeExports.jsx(DesktopProvider,{children:jsxRuntimeExports.jsx(GameStateProvider,{children:jsxRuntimeExports.jsx(Desktop,{})})})})})})}createRoot$1(document.getElementById("root")).render(jsxRuntimeExports.jsx(App,{}));
